---
title: "TIAS Report"
output: 
  html_document: 
    theme: yeti 
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# detach all libraries

detachAllPackages <- function() {
  basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
  package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
  package.list <- setdiff(package.list, basic.packages)
  if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()

# function to load libraries

pkgTest <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
  if (length(new.pkg)) 
    install.packages(new.pkg,  dependencies = TRUE)
  sapply(pkg,  require,  character.only = TRUE)
}

# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)

lapply(c("tidyverse"),pkgTest)
lapply(c("ggplot2"), pkgTest)
lapply(c("ggthemes"), pkgTest)
lapply(c("ggpubr"), pkgTest)
lapply(c("naniar"), pkgTest)
lapply(c("DescTools"), pkgTest)
lapply(c("corrplot"), pkgTest)
lapply(c("ResourceSelection"), pkgTest)
lapply(c("lmtest"), pkgTest)
lapply(c("lattice"), pkgTest)
lapply(c("data.table"), pkgTest)
lapply(c("foreign"), pkgTest)
lapply(c("gplots"), pkgTest)
lapply(c("MASS"), pkgTest)
lapply(c("sjPlot"), pkgTest)
lapply(c("sjmisc"), pkgTest)
lapply(c("sjlabelled"), pkgTest)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggpubr)
library(naniar)
library(DescTools)
library(ResourceSelection)
library(lmtest)
library(lattice)
library(data.table)
library(RColorBrewer)
library(foreign)
library(gplots)
library(MASS)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
```

# TIAS Analysis Setup 

```{r}
# Import the TIAS data. This dataset was downloaded from the PSID website and includes values for all waves. The raw csv file can be found on github. 

TIAS <- fread("https://raw.githubusercontent.com/carolinelee78/FTL/main/data/raw/PSID/TIAS/TIAS.csv")

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS$PSID_ID <- (TIAS$ER30001 * 1000) + TIAS$ER30002

ALL_PSID_ID <- TIAS$PSID_ID

### TIAS 2005 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2005.    

TIAS2005 <- TIAS[!is.na(TIAS$TAS05),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2005$CAT <- with(TIAS2005, ifelse(
  TA050042 == 1 & TA050043 %in% c("1", "96") & TA050595 %in% c("5", "0") & TA050946 %in% c("1", "2", "3", "4", "5", "6", "7") & TA050631 %in% c("5", "0") & TA050127 == 3 & TA050769 < 60 & 
    TA050712 == 0 & TA050715 == 0 & TA050711 == 0 & TA050716 == 0 & TA050678 %in% c("3", "5", "7", "0") & TA050785 == 0 & TA050809 == 0 & TA050793 %in% c("0", "1", "2", "3") & TA050777 == 0 & TA050825 == 0 & 
    TA050817 == 0 & TA050798 == 0 & TA050394 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA050091 == 0, "FTL_05", ifelse(
      TA050042 == 1 & TA050043 %in% c("1", "96") & TA050595 %in% c("5", "0") & TA050946 %in% c("1", "2", "3", "4", "5", "6", "7") & TA050631 %in% c("5", "0") & TA050127 == 3 & TA050769 < 60 & 
        TA050712 == 0 & TA050715 == 0 & TA050711 == 0 & TA050716 == 0 & TA050678 %in% c("3", "5", "7", "0") & TA050785 == 0 & TA050809 == 0 & TA050793 %in% c("0", "1", "2", "3") & TA050777 == 0 & TA050825 == 0 & 
        TA050817 == 0 & TA050798 == 0 & TA050394 == 0 & TA050371 == 1 & TA050091 == 0, "FTL_05", "IAC_05")))

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2005$PSID_ID <- (TIAS2005$ER30001 * 1000) + TIAS2005$ER30002

# Before subsetting the data to only include data for the wave of interest, we are adding PSID IDs for each participant

T05_ID <- TIAS2005$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2005 wave 

FTL05_ID <- TIAS2005[TIAS2005$CAT == "FTL_05", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2005 wave 

nrow(FTL05_ID)

# View the number of FTL vs. IAC participants for the 2005 wave 

table(TIAS2005$CAT)

FTL05_ID_VEC <- unname(unlist(FTL05_ID))

# Create a new variable ('CAT_05') for FTL vs. IAC vs. NA (no data) categorization in the 2005 wave 

TIAS$CAT_05 <- with(TIAS, ifelse(
  PSID_ID %in% FTL05_ID_VEC, "FTL_05", ifelse(
    PSID_ID %in% T05_ID, "IAC_05", "NA_05")))

# View the distribution for CAT_05

table(TIAS$CAT_05)

# View the IDs of participants who have been identified as FTL for the 2005 wave 

print(FTL05_ID_VEC)

### TIAS 2007 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2007.    

TIAS2007 <- TIAS[!is.na(TIAS$TAS07),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2007$CAT <- with(TIAS2007, ifelse(
  TA070042 == 1 & TA070043 %in% c("1", "96") & TA070570 %in% c("5", "0") & TA070927 %in% c("1", "2", "3", "4", "5", "6", "7") & TA070602 %in% c("5", "0") & TA070127 == 3 & TA070740 < 60 & 
  TA070683 == 0 & TA070686 == 0 & TA070682 == 0 & TA070687 == 0 & TA070649 %in% c("3", "5", "7", "0") & TA070756 == 0 & TA070777 == 0 & TA070764 %in% c("0", "1", "2", "3") & TA070748 == 0 & TA070793 == 0 & 
  TA070785 == 0 & TA070769 == 0 & TA070368 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA070091 == 0, "FTL_07", ifelse(
      TA070042 == 1 & TA070043 %in% c("1", "96") & TA070570 %in% c("5", "0") & TA070927 %in% c("1", "2", "3", "4", "5", "6", "7") & TA070602 %in% c("5", "0") & TA070127 == 3 & TA070740 < 60 & 
      TA070683 == 0 & TA070686 == 0 & TA070682 == 0 & TA070687 == 0 & TA070649 %in% c("3", "5", "7", "0") & TA070756 == 0 & TA070777 == 0 & TA070764 %in% c("0", "1", "2", "3") & TA070748 == 0 & TA070793 == 0 & 
      TA070785 == 0 & TA070769 == 0 & TA070368 == 0 & TA050371 == 1 & TA070091 == 0, "FTL_07", "IAC_07")))

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2007$PSID_ID <- (TIAS2007$ER30001 * 1000) + TIAS2007$ER30002

# Before subsetting the data to only include data for the wave of interest, we are adding PSID IDs for each participant

T07_ID <- TIAS2007$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2007 wave 

FTL07_ID <- TIAS2007[TIAS2007$CAT == "FTL_07", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2007 wave 

nrow(FTL07_ID)

# View the number of FTL vs. IAC participants for the 2007 wave 

table(TIAS2007$CAT)

FTL07_ID_VEC <- unname(unlist(FTL07_ID))

# Create a new variable ('CAT_07') for FTL vs. IAC vs. NA (no data) categorization in the 2007 wave 

TIAS$CAT_07 <- with(TIAS, ifelse(
  PSID_ID %in% FTL07_ID_VEC, "FTL_07", ifelse(
    PSID_ID %in% T07_ID, "IAC_07", "NA_07")))

# View the distribution for CAT_07

table(TIAS$CAT_07)

# View the IDs of participants who have been identified as FTL for the 2007 wave 

print(FTL07_ID_VEC)

### TIAS 2009 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2009.    

TIAS2009 <- TIAS[!is.na(TIAS$TAS09),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.   

TIAS2009$CAT <- with(TIAS2009, ifelse(
  TA090043 == 1 & TA090044 %in% c("1", "96") & TA090612 %in% c("5", "0") & TA090991 %in% c("1", "2", "3", "4", "5", "6", "7") & TA090655 %in% c("5", "0") & TA090136 == 3 & TA090799 < 60 & 
  TA090739 == 0 & TA090742 == 0 & TA090738 == 0 & TA090743 == 0 & TA090705 %in% c("3", "5", "7", "0") & TA090815 == 0 & TA090836 == 0 & TA090823 %in% c("0", "1", "2", "3") & TA090807 == 0 & TA090852 == 0 & 
  TA090844 == 0 & TA090828 == 0 & TA090385 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA090100 == 0, "FTL_09", ifelse(
      TA090043 == 1 & TA090044 %in% c("1", "96") & TA090612 %in% c("5", "0") & TA090991 %in% c("1", "2", "3", "4", "5", "6", "7") & TA090655 %in% c("5", "0") & TA090136 == 3 & TA090799 < 60 & 
      TA090739 == 0 & TA090742 == 0 & TA090738 == 0 & TA090743 == 0 & TA090705 %in% c("3", "5", "7", "0") & TA090815 == 0 & TA090836 == 0 & TA090823 %in% c("0", "1", "2", "3") & TA090807 == 0 & TA090852 == 0 & 
      TA090844 == 0 & TA090828 == 0 & TA090385 == 0 & TA090361 == 1 & TA090100 == 0, "FTL_09", "IAC_09")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T09_ID <- TIAS2009$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2009$PSID_ID <- (TIAS2009$ER30001 * 1000) + TIAS2009$ER30002

# Extract IDs of participants who have been identified as FTL for the 2009 wave 

FTL09_ID <- TIAS2009[TIAS2009$CAT == "FTL_09", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2009 wave 

length(FTL09_ID)

# View the number of FTL vs. IAC participants for the 2009 wave 

table(TIAS2009$CAT)

FTL09_ID_VEC <- unname(unlist(FTL09_ID))

# Create a new variable ('CAT_09') for FTL vs. IAC vs. NA (no data) categorization in the 2009 wave 

TIAS$CAT_09 <- with(TIAS, ifelse(
  PSID_ID %in% FTL09_ID_VEC, "FTL_09", ifelse(
    PSID_ID %in% T09_ID, "IAC_09", "NA_09")))

# View the distribution for CAT_09

table(TIAS$CAT_09)

# View the IDs of participants who have been identified as FTL for the 2009 wave 

print(FTL09_ID_VEC)

### TIAS 2011 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2011.   

TIAS2011 <- TIAS[!is.na(TIAS$TAS11),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2011$CAT <- with(TIAS2011, ifelse(
  TA110044 == 1 & TA110045 %in% c("1", "96") & TA110699 %in% c("5", "0") & TA111133 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA110743 %in% c("5", "0") & TA110137 == 3 & TA110915 < 60 & 
  TA110829 == 0 & TA110832 == 0 & TA110828 == 0 & TA110833 == 0 & TA110793 %in% c("3", "5", "7", "0") & TA110931 == 0 & TA110952 == 0 & TA110939 %in% c("0", "1", "2", "3") & TA110923 == 0 & TA110968 == 0 & 
  TA110960 == 0 & TA110944 == 0 & TA110462 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA110101 == 0, "FTL_11", ifelse( 
      TA110044 == 1 & TA110045 %in% c("1", "96") & TA110699 %in% c("5", "0") & TA111133 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA110743 %in% c("5", "0") & TA110137 == 3 & TA110915 < 60 & 
      TA110829 == 0 & TA110832 == 0 & TA110828 == 0 & TA110833 == 0 & TA110793 %in% c("3", "5", "7", "0") & TA110931 == 0 & TA110952 == 0 & TA110939 %in% c("0", "1", "2", "3") & TA110923 == 0 & TA110968 == 0 & 
      TA110960 == 0 & TA110944 == 0 & TA110462 == 0 & TA110351 == 1 & TA110101 == 0,  "FTL_11", "IAC_11")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T11_ID <- TIAS2011$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2011 wave 

FTL11_ID <- TIAS2011[TIAS2011$CAT == "FTL_11", "PSID_ID"]

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2011$PSID_ID <- (TIAS2011$ER30001 * 1000) + TIAS2011$ER30002

# Count the number of participants who have been identified as FTL for the 2011 wave 

nrow(FTL11_ID)

# View the number of FTL vs. IAC participants for the 2011 wave 

table(TIAS2011$CAT)

FTL11_ID_VEC <- unname(unlist(FTL11_ID))

# Create a new variable ('CAT_11') for FTL vs. IAC vs. NA (no data) categorization in the 2011 wave 

TIAS$CAT_11 <- with(TIAS, ifelse(
  PSID_ID %in% FTL11_ID_VEC, "FTL_11", ifelse(
    PSID_ID %in% T11_ID, "IAC_11", "NA_11")))

# View the distribution for CAT_11

table(TIAS$CAT_11)

# View the IDs of participants who have been identified as FTL for the 2011 wave 

print(FTL11_ID)

print(FTL11_ID_VEC)

### TIAS 2013 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2013.   

TIAS2013 <- TIAS[!is.na(TIAS$TAS13),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.   

TIAS2013$CAT <- with(TIAS2013, ifelse(
  TA130043 == 1 & TA130044 %in% c("1", "96") & TA130719 %in% c("5", "0") & TA131225 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA130763 %in% c("5", "0") & TA130136 == 3 & TA130948 < 60 & 
    TA130852 == 0 & TA130855 == 0 & TA130851 == 0 & TA130856 == 0 & TA130813 %in% c("3", "5", "7", "0") & TA130964 == 0 & TA130982 == 0 & TA130972 %in% c("0", "1", "2", "3") & TA130956 == 0 & TA131001 == 0 & 
    TA130993 == 0 & TA130977 == 0 & TA130482 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA130100 == 0, "FTL_13", ifelse(
      TA130043 == 1 & TA130044 %in% c("1", "96") & TA130719 %in% c("5", "0") & TA131225 %in% c("1", "2", "3", "4", "5", "6", "7") & TA130763 %in% c("5", "0") & TA130136 == 3 & TA130948 < 60 & 
        TA130852 == 0 & TA130855 == 0 & TA130851 == 0 & TA130856 == 0 & TA130813 %in% c("3", "5", "7", "0") & TA130964 == 0 & TA130982 == 0 & TA130972 %in% c("0", "1", "2", "3") & TA130956 == 0 & TA131001 == 0 & 
        TA130993 == 0 & TA130977 == 0 & TA130482 == 0 & TA130350 == 1 & TA130100 == 0, "FTL_13", "IAC_13")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T13_ID <- TIAS2013$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2013$PSID_ID <- (TIAS2013$ER30001 * 1000) + TIAS2013$ER30002

# Extract IDs of participants who have been identified as FTL for the 2013 wave 

FTL13_ID <- TIAS2013[TIAS2013$CAT == "FTL_13", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2013 wave 

nrow(FTL13_ID)

# View the number of FTL vs. IAC participants for the 2013 wave 

table(TIAS2013$CAT)

FTL13_ID_VEC <- unname(unlist(FTL13_ID))

# Create a new variable ('CAT_13') for FTL vs. IAC vs. NA (no data) categorization in the 2013 wave 

TIAS$CAT_13 <- with(TIAS, ifelse(
  PSID_ID %in% FTL13_ID_VEC, "FTL_13", ifelse(
    PSID_ID %in% T13_ID, "IAC_13", "NA_13")))

# View the distribution for CAT_13

table(TIAS$CAT_13)

# View the IDs of participants who have been identified as FTL for the 2013 wave 

print(FTL13_ID_VEC)

### TIAS 2015 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2015.    

TIAS2015 <- TIAS[!is.na(TIAS$TAS15),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.  

TIAS2015$CAT <- with(TIAS2015, ifelse(
  TA150043 == 1 & TA150044 %in% c("1", "96") & TA150731 %in% c("5", "0") & TA151285 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA150776 %in% c("5", "0") & TA150128 == 3 & TA150970 < 60 & 
  TA150869 == 0 & TA150872 == 0 & TA150868 == 0 & TA150873 == 0 & TA150826 %in% c("3", "5", "7", "0") & TA150986 == 0 & TA151007 == 0 & TA150994 %in% c("0", "1", "2", "3") & TA150978 == 0 & TA151023 == 0 & 
  TA151015 == 0 & TA150999 == 0 & TA150491 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA150092 == 0, "FTL_15", ifelse( 
      TA150043 == 1 & TA150044 %in% c("1", "96") & TA150731 %in% c("5", "0") & TA151285 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA150776 %in% c("5", "0") & TA150128 == 3 & TA150970 < 60 & 
      TA150869 == 0 & TA150872 == 0 & TA150868 == 0 & TA150873 == 0 & TA150826 %in% c("3", "5", "7", "0") & TA150986 == 0 & TA151007 == 0 & TA150994 %in% c("0", "1", "2", "3") & TA150978 == 0 & TA151023 == 0 & 
      TA151015 == 0 & TA150999 == 0 & TA150491 == 0 & TA150352 == 1 & TA150092 == 0, "FTL_15", "IAC_15")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T15_ID <- TIAS2015$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2015 wave 

FTL15_ID <- TIAS2015[TIAS2015$CAT == "FTL_15", "PSID_ID"]

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2015$PSID_ID <- (TIAS2015$ER30001 * 1000) + TIAS2015$ER30002

# Count the number of participants who have been identified as FTL for the 2015 wave 

nrow(FTL15_ID)

# View the number of FTL vs. IAC participants for the 2015 wave 

table(TIAS2015$CAT)

FTL15_ID_VEC <- unname(unlist(FTL15_ID))

# Create a new variable ('CAT_15') for FTL vs. IAC vs. NA (no data) categorization in the 2015 wave 

TIAS$CAT_15 <- with(TIAS, ifelse(
  PSID_ID %in% FTL15_ID_VEC, "FTL_15", ifelse(
    PSID_ID %in% T15_ID, "IAC_15", "NA_15")))

# View the distribution for CAT_15

table(TIAS$CAT_15)

# View the IDs of participants who have been identified as FTL for the 2015 wave 

print(FTL15_ID_VEC)

### TIAS 2017 IAC vs. FTL ============================== 

# This selects the data only from the wave of interest, which in this case is 2017. 

TIAS2017 <- TIAS[!is.na(TIAS$TAS17),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2017$CAT <- with(TIAS2017, ifelse(
  TA170058 == 1 & TA170059 %in% c("1", "96") & TA170790 %in% c("3", "5") & TA171980 %in% c("1", "2", "3", "4", "5", "6", "7", "95") & TA170416 %in% c("5", "0") & TA170183 == 3 & TA171827 < 60 & 
  TA170909 == 0 & TA170912 == 0 & TA170913 == 0 & TA170866 %in% c("3", "5", "7", "0") & TA171869 == 0 & TA171885 == 0 & TA171835 %in% c("0", "1", "2", "3") & 
  TA171861 == 0 & TA171877 == 0 & TA171893 == 0 & TA171840 == 0 & TA170176 == 0,"FTL_17", "IAC_17"))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T17_ID <- TIAS2017$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2017$PSID_ID <- (TIAS2017$ER30001 * 1000) + TIAS2017$ER30002

# Extract IDs of participants who have been identified as FTL for the 2017 wave 

FTL17_ID <- TIAS2017[TIAS2017$CAT == "FTL_17", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2017 wave 

nrow(FTL17_ID)

# View the number of FTL vs. IAC participants for the 2017 wave 

table(TIAS2017$CAT)

FTL17_ID_VEC <- unname(unlist(FTL17_ID))

# Create a new variable ('CAT_17') for FTL vs. IAC vs. NA (no data) categorization in the 2017 wave 

TIAS$CAT_17 <- with(TIAS, ifelse(
  PSID_ID %in% FTL17_ID_VEC, "FTL_17", ifelse(
    PSID_ID %in% T17_ID, "IAC_17", "NA_17")))

# View the distribution for CAT_17

table(TIAS$CAT_17)

# View the IDs of participants who have been identified as FTL for the 2017 wave 

print(FTL17_ID_VEC)

### TIAS FTL Wave Count ============================== 

count.ftlwave <- function(x){
  as.integer(as.logical(x %in% FTL05_ID_VEC)) + as.integer(as.logical(x %in% FTL07_ID_VEC)) + as.integer(as.logical(x %in% FTL09_ID_VEC)) +
    as.integer(as.logical(x %in% FTL11_ID_VEC)) + as.integer(as.logical(x %in% FTL13_ID_VEC)) + as.integer(as.logical(x %in% FTL15_ID_VEC)) + as.integer(as.logical(x %in% FTL17_ID_VEC))
}

PSID_LIST <- lapply(ALL_PSID_ID, count.ftlwave)

TIAS$FTL_COUNT <- unlist(PSID_LIST)

table(TIAS$FTL_COUNT)

TIAS2005 <- TIAS[!is.na(TIAS$TAS05),]

table(TIAS2005$FTL_COUNT)

TIAS2007 <- TIAS[!is.na(TIAS$TAS07),]

table(TIAS2007$FTL_COUNT)

TIAS2009 <- TIAS[!is.na(TIAS$TAS09),]

table(TIAS2009$FTL_COUNT)

TIAS2011 <- TIAS[!is.na(TIAS$TAS11),]

table(TIAS2011$FTL_COUNT)

TIAS2013 <- TIAS[!is.na(TIAS$TAS13),]

table(TIAS2013$FTL_COUNT)

TIAS2015 <- TIAS[!is.na(TIAS$TAS15),]

table(TIAS2015$FTL_COUNT)

TIAS2017 <- TIAS[!is.na(TIAS$TAS17),]

table(TIAS2017$FTL_COUNT)

# Creating a subsetted dataframe including only FTL participants for the 2005 wave 

TIAS2005_FTL <- subset(TIAS, CAT_05 == "FTL_05")

# Creating a subsetted dataframe including only IAC participants for the 2005 wave 

TIAS2005_IAC <- subset(TIAS, CAT_05 == "IAC_05")

# Creating a subsetted dataframe including only FTL participants for the 2007 wave 

TIAS2007_FTL <- subset(TIAS, CAT_07 == "FTL_07")

# Creating a subsetted dataframe including only IAC participants for the 2007 wave 

TIAS2007_IAC <- subset(TIAS, CAT_07 == "IAC_07")

# Creating a subsetted dataframe including only FTL participants for the 2009 wave 

TIAS2009_FTL <- subset(TIAS, CAT_09 == "FTL_09")

# Creating a subsetted dataframe including only IAC participants for the 2009 wave 

TIAS2009_IAC <- subset(TIAS, CAT_09 == "IAC_09")

# Creating a subsetted dataframe including only FTL participants for the 2011 wave 

TIAS2011_FTL <- subset(TIAS, CAT_11 == "FTL_11")

# Creating a subsetted dataframe including only IAC participants for the 2011 wave 

TIAS2011_IAC <- subset(TIAS, CAT_11 == "IAC_11")

# Creating a subsetted dataframe including only FTL participants for the 2013 wave 

TIAS2013_FTL <- subset(TIAS, CAT_13 == "FTL_13")

# Creating a subsetted dataframe including only IAC participants for the 2013 wave 

TIAS2013_IAC <- subset(TIAS, CAT_13 == "IAC_13")

# Creating a subsetted dataframe including only FTL participants for the 2015 wave 

TIAS2015_FTL <- subset(TIAS, CAT_15 == "FTL_15")

# Creating a subsetted dataframe including only IAC participants for the 2015 wave 

TIAS2015_IAC <- subset(TIAS, CAT_15 == "IAC_15")

# Creating a subsetted dataframe including only FTL participants for the 2017 wave 

TIAS2017_FTL <- subset(TIAS, CAT_17 == "FTL_17")

# Creating a subsetted dataframe including only IAC participants for the 2017 wave 

TIAS2017_IAC <- subset(TIAS, CAT_17 == "IAC_17")

ALL_FTL_ID <- c(FTL05_ID_VEC, FTL07_ID_VEC, FTL09_ID_VEC, FTL11_ID_VEC, FTL13_ID_VEC, FTL15_ID_VEC, FTL17_ID_VEC)

length(ALL_FTL_ID)

FTL_ID <- unique(ALL_FTL_ID)

# Creating a variable distinguishing participants who identified as FTL for at least one wave (greater than or equal to 1; GREQ1) vs. who never identified as FTL

TIAS$GREQ1_FTL <- with(TIAS, ifelse(PSID_ID %in% FTL_ID, "FTL", "IAC"))      

TIAS_FTL <- subset(TIAS, GREQ1_FTL == "FTL")

TIAS_IAC <- subset(TIAS, GREQ1_FTL == "IAC")
```

# Regression Analyses 

## Amphetamine Usage 

```{r}
# =================== 2005 ===================  

amp_05 <- dplyr::select(TIAS, TA050784, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_05 <- na.omit(amp_05) # removing rows with NA 

amp_05 <- amp_05 %>% rename(AMP = TA050784, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_05 <- amp_05 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_05$AMP <- as.factor(amp_05$AMP)

amp_05 <- amp_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_05$Sex <- as.integer(amp_05$Sex) # character to integer

amp_05 <- amp_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_05$FTL <- as.integer(amp_05$FTL) # character to integer

amp_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070755 = 8))  

amp_07 <- dplyr::select(TIAS, TA070755, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_07 <- na.omit(amp_07) # removing rows with NA 

amp_07 <- amp_07 %>% rename(AMP = TA070755, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_07 <- amp_07 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_07$AMP <- as.factor(amp_07$AMP)

amp_07 <- amp_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_07$Sex <- as.integer(amp_07$Sex) # character to integer

amp_07 <- amp_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_07$FTL <- as.integer(amp_07$FTL) # character to integer

amp_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090814 = 9))  

amp_09 <- dplyr::select(TIAS, TA090814, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_09 <- na.omit(amp_09) # removing rows with NA 

amp_09 <- amp_09 %>% rename(AMP = TA090814, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_09 <- amp_09 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_09$AMP <- as.factor(amp_09$AMP)

amp_09 <- amp_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_09$Sex <- as.integer(amp_09$Sex) # character to integer

amp_09 <- amp_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_09$FTL <- as.integer(amp_09$FTL) # character to integer

amp_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110930 = 9))

amp_11 <- dplyr::select(TIAS, TA110930, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_11 <- na.omit(amp_11) # removing rows with NA 

amp_11 <- amp_11 %>% rename(AMP = TA110930, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_11 <- amp_11 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_11$AMP <- as.factor(amp_11$AMP)

amp_11 <- amp_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_11$Sex <- as.integer(amp_11$Sex) # character to integer

amp_11 <- amp_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_11$FTL <- as.integer(amp_11$FTL) # character to integer

amp_11$Year <- c(rep(4, 1906)) # adding year 

# =================== 2013 =================== 

amp_13 <- dplyr::select(TIAS, TA130963, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_13 <- na.omit(amp_13) # removing rows with NA 

amp_13 <- amp_13 %>% rename(AMP = TA130963, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_13 <- amp_13 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_13$AMP <- as.factor(amp_13$AMP)

amp_13 <- amp_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_13$Sex <- as.integer(amp_13$Sex) # character to integer

amp_13 <- amp_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_13$FTL <- as.integer(amp_13$FTL) # character to integer

amp_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

amp_15 <- dplyr::select(TIAS, TA150985, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_15 <- na.omit(amp_15) # removing rows with NA 

amp_15 <- amp_15 %>% rename(AMP = TA150985, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_15 <- amp_15 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_15$AMP <- as.factor(amp_15$AMP)

amp_15 <- amp_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_15$Sex <- as.integer(amp_15$Sex) # character to integer

amp_15 <- amp_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_15$FTL <- as.integer(amp_15$FTL) # character to integer

amp_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171868 = 9))

amp_17 <- dplyr::select(TIAS, TA171868, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_17 <- na.omit(amp_17) # removing rows with NA 

amp_17 <- amp_17 %>% rename(AMP = TA171868, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_17 <- amp_17 %>% mutate(AMP = dplyr::recode(AMP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

amp_17$AMP <- as.factor(amp_17$AMP)

amp_17 <- amp_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_17$Sex <- as.integer(amp_17$Sex) # character to integer

amp_17 <- amp_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_17$FTL <- as.integer(amp_17$FTL) # character to integer

amp_17$Year <- c(rep(7, 2525)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

amp_df <- rbind(amp_05, amp_07, amp_09, amp_11, amp_13, amp_15, amp_17)

amp_m1 <- polr(AMP ~ FTL, data = amp_df, Hess = TRUE)

amp_m2 <- polr(AMP ~ FTL + Age + Sex + Year, data = amp_df, Hess = TRUE)

amp_m3 <- polr(AMP ~ FTL + Age + FTL*Age, data = amp_df, Hess = TRUE)

amp_m4 <- polr(AMP ~ FTL + Sex + FTL*Sex, data = amp_df, Hess = TRUE)

amp_m5 <- polr(AMP ~ FTL + Year + FTL*Year, data = amp_df, Hess = TRUE)

amp_m6 <- polr(AMP ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = amp_df, Hess = TRUE)

tab_model(amp_m1, amp_m2, amp_m3, amp_m4, amp_m5, amp_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Barbiturate Usage 

```{r}
# =================== 2005 ===================  

brb_05 <- dplyr::select(TIAS, TA050808, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_05 <- na.omit(brb_05) # removing rows with NA 

brb_05 <- brb_05 %>% rename(BRB = TA050808, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_05 <- brb_05 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_05$BRB <- as.factor(brb_05$BRB)

brb_05 <- brb_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_05$Sex <- as.integer(brb_05$Sex) # character to integer

brb_05 <- brb_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_05$FTL <- as.integer(brb_05$FTL) # character to integer

brb_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

brb_07 <- dplyr::select(TIAS, TA070776, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_07 <- na.omit(brb_07) # removing rows with NA 

brb_07 <- brb_07 %>% rename(BRB = TA070776, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_07 <- brb_07 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_07$BRB <- as.factor(brb_07$BRB)

brb_07 <- brb_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_07$Sex <- as.integer(brb_07$Sex) # character to integer

brb_07 <- brb_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_07$FTL <- as.integer(brb_07$FTL) # character to integer

brb_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

brb_09 <- dplyr::select(TIAS, TA090835, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_09 <- na.omit(brb_09) # removing rows with NA 

brb_09 <- brb_09 %>% rename(BRB = TA090835, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_09 <- brb_09 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_09$BRB <- as.factor(brb_09$BRB)

brb_09 <- brb_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_09$Sex <- as.integer(brb_09$Sex) # character to integer

brb_09 <- brb_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_09$FTL <- as.integer(brb_09$FTL) # character to integer

brb_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

brb_11 <- dplyr::select(TIAS, TA110951, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_11 <- na.omit(brb_11) # removing rows with NA 

brb_11 <- brb_11 %>% rename(BRB = TA110951, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_11 <- brb_11 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_11$BRB <- as.factor(brb_11$BRB)

brb_11 <- brb_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_11$Sex <- as.integer(brb_11$Sex) # character to integer

brb_11 <- brb_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_11$FTL <- as.integer(brb_11$FTL) # character to integer

brb_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

brb_13 <- dplyr::select(TIAS, TA130984, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_13 <- na.omit(brb_13) # removing rows with NA 

brb_13 <- brb_13 %>% rename(BRB = TA130984, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_13 <- brb_13 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_13$BRB <- as.factor(brb_13$BRB)

brb_13 <- brb_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_13$Sex <- as.integer(brb_13$Sex) # character to integer

brb_13 <- brb_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_13$FTL <- as.integer(brb_13$FTL) # character to integer

brb_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

brb_15 <- dplyr::select(TIAS, TA151006, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_15 <- na.omit(brb_15) # removing rows with NA 

brb_15 <- brb_15 %>% rename(BRB = TA151006, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_15 <- brb_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_15 <- brb_15 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_15$BRB <- as.factor(brb_15$BRB)

brb_15$Sex <- as.integer(brb_15$Sex) # character to integer

brb_15 <- brb_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_15$FTL <- as.integer(brb_15$FTL) # character to integer

brb_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

brb_17 <- dplyr::select(TIAS, TA171868, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_17 <- na.omit(brb_17) # removing rows with NA 

brb_17 <- brb_17 %>% rename(BRB = TA171868, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_17 <- brb_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_17 <- brb_17 %>% mutate(BRB = dplyr::recode(BRB, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

brb_17$BRB <- as.factor(brb_17$BRB)

brb_17$Sex <- as.integer(brb_17$Sex) # character to integer

brb_17 <- brb_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_17$FTL <- as.integer(brb_17$FTL) # character to integer

brb_17$Year <- c(rep(7, 2525)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

brb_df <- rbind(brb_05, brb_07, brb_09, brb_11, brb_13, brb_15, brb_17)

brb_m1 <- polr(BRB ~ FTL, data = brb_df, Hess = TRUE)

brb_m2 <- polr(BRB ~ FTL + Age + Sex + Year, data = brb_df, Hess = TRUE)

brb_m3 <- polr(BRB ~ FTL + Age + FTL*Age, data = brb_df, Hess = TRUE)

brb_m4 <- polr(BRB ~ FTL + Sex + FTL*Sex, data = brb_df, Hess = TRUE)

brb_m5 <- polr(BRB ~ FTL + Year + FTL*Year, data = brb_df, Hess = TRUE)

brb_m6 <- polr(BRB ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = brb_df, Hess = TRUE)

tab_model(brb_m1, brb_m2, brb_m3, brb_m4, brb_m5, brb_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Marijuana Usage 

```{r}
# =================== 2005 ===================  

mar_05 <- dplyr::select(TIAS, TA050792, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_05 <- na.omit(mar_05) # removing rows with NA 

mar_05 <- mar_05 %>% rename(MAR = TA050792, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_05 <- mar_05 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_05$MAR <- as.factor(mar_05$MAR)

mar_05 <- mar_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_05$Sex <- as.integer(mar_05$Sex) # character to integer

mar_05 <- mar_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_05$FTL <- as.integer(mar_05$FTL) # character to integer

mar_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

mar_07 <- dplyr::select(TIAS, TA070763, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_07 <- na.omit(mar_07) # removing rows with NA 

mar_07 <- mar_07 %>% rename(MAR = TA070763, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_07 <- mar_07 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_07$MAR <- as.factor(mar_07$MAR)

mar_07 <- mar_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_07$Sex <- as.integer(mar_07$Sex) # character to integer

mar_07 <- mar_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_07$FTL <- as.integer(mar_07$FTL) # character to integer

mar_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

mar_09 <- dplyr::select(TIAS, TA090822, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_09 <- na.omit(mar_09) # removing rows with NA 

mar_09 <- mar_09 %>% rename(MAR = TA090822, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_09 <- mar_09 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_09$MAR <- as.factor(mar_09$MAR)

mar_09 <- mar_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_09$Sex <- as.integer(mar_09$Sex) # character to integer

mar_09 <- mar_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_09$FTL <- as.integer(mar_09$FTL) # character to integer

mar_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110938 = 9)) 

mar_11 <- dplyr::select(TIAS, TA110938, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_11 <- na.omit(mar_11) # removing rows with NA 

mar_11 <- mar_11 %>% rename(MAR = TA110938, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_11 <- mar_11 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_11$MAR <- as.factor(mar_11$MAR)

mar_11 <- mar_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_11$Sex <- as.integer(mar_11$Sex) # character to integer

mar_11 <- mar_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_11$FTL <- as.integer(mar_11$FTL) # character to integer

mar_11$Year <- c(rep(4, 1906)) # adding year 

# =================== 2013 =================== 

mar_13 <- dplyr::select(TIAS, TA130971, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_13 <- na.omit(mar_13) # removing rows with NA 

mar_13 <- mar_13 %>% rename(MAR = TA130971, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_13 <- mar_13 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_13$MAR <- as.factor(mar_13$MAR)

mar_13 <- mar_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_13$Sex <- as.integer(mar_13$Sex) # character to integer

mar_13 <- mar_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_13$FTL <- as.integer(mar_13$FTL) # character to integer

mar_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

mar_15 <- dplyr::select(TIAS, TA150993, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_15 <- na.omit(mar_15) # removing rows with NA 

mar_15 <- mar_15 %>% rename(MAR = TA150993, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_15 <- mar_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_15 <- mar_15 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_15$MAR <- as.factor(mar_15$MAR)

mar_15$Sex <- as.integer(mar_15$Sex) # character to integer

mar_15 <- mar_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_15$FTL <- as.integer(mar_15$FTL) # character to integer

mar_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

mar_17 <- dplyr::select(TIAS, TA171860, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

mar_17 <- na.omit(mar_17) # removing rows with NA 

mar_17 <- mar_17 %>% rename(MAR = TA171860, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

mar_17 <- mar_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

mar_17 <- mar_17 %>% mutate(MAR = dplyr::recode(MAR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

mar_17$MAR <- as.factor(mar_17$MAR)

mar_17$Sex <- as.integer(mar_17$Sex) # character to integer

mar_17 <- mar_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

mar_17$FTL <- as.integer(mar_17$FTL) # character to integer

mar_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

mar_df <- rbind(mar_05, mar_07, mar_09, mar_11, mar_13, mar_15, mar_17)

mar_m1 <- polr(MAR ~ FTL, data = mar_df, Hess = TRUE)

mar_m2 <- polr(MAR ~ FTL + Age + Sex + Year, data = mar_df, Hess = TRUE)

mar_m3 <- polr(MAR ~ FTL + Age + FTL*Age, data = mar_df, Hess = TRUE)

mar_m4 <- polr(MAR ~ FTL + Sex + FTL*Sex, data = mar_df, Hess = TRUE)

mar_m5 <- polr(MAR ~ FTL + Year + FTL*Year, data = mar_df, Hess = TRUE)

mar_m6 <- polr(MAR ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = mar_df, Hess = TRUE)

tab_model(mar_m1, mar_m2, mar_m3, mar_m4, mar_m5, mar_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Diet Pill Usage 

```{r}
# =================== 2005 ===================  

dip_05 <- dplyr::select(TIAS, TA050792, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_05 <- na.omit(dip_05) # removing rows with NA 

dip_05 <- dip_05 %>% rename(DIP = TA050792, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_05 <- dip_05 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_05$DIP <- as.factor(dip_05$DIP)

dip_05 <- dip_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_05$Sex <- as.integer(dip_05$Sex) # character to integer

dip_05 <- dip_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_05$FTL <- as.integer(dip_05$FTL) # character to integer

dip_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

dip_07 <- dplyr::select(TIAS, TA070763, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_07 <- na.omit(dip_07) # removing rows with NA 

dip_07 <- dip_07 %>% rename(DIP = TA070763, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_07 <- dip_07 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_07$DIP <- as.factor(dip_07$DIP)

dip_07 <- dip_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_07$Sex <- as.integer(dip_07$Sex) # character to integer

dip_07 <- dip_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_07$FTL <- as.integer(dip_07$FTL) # character to integer

dip_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

dip_09 <- dplyr::select(TIAS, TA090822, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_09 <- na.omit(dip_09) # removing rows with NA 

dip_09 <- dip_09 %>% rename(DIP = TA090822, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_09 <- dip_09 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_09$DIP <- as.factor(dip_09$DIP)

dip_09 <- dip_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_09$Sex <- as.integer(dip_09$Sex) # character to integer

dip_09 <- dip_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_09$FTL <- as.integer(dip_09$FTL) # character to integer

dip_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

dip_11 <- dplyr::select(TIAS, TA110938, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_11 <- na.omit(dip_11) # removing rows with NA 

dip_11 <- dip_11 %>% rename(DIP = TA110938, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_11 <- dip_11 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_11$DIP <- as.factor(dip_11$DIP)

dip_11 <- dip_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_11$Sex <- as.integer(dip_11$Sex) # character to integer

dip_11 <- dip_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_11$FTL <- as.integer(dip_11$FTL) # character to integer

dip_11$Year <- c(rep(4, 1906)) # adding year 

# =================== 2013 =================== 

dip_13 <- dplyr::select(TIAS, TA130971, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_13 <- na.omit(dip_13) # removing rows with NA 

dip_13 <- dip_13 %>% rename(DIP = TA130971, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_13 <- dip_13 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_13$DIP <- as.factor(dip_13$DIP)

dip_13 <- dip_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_13$Sex <- as.integer(dip_13$Sex) # character to integer

dip_13 <- dip_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_13$FTL <- as.integer(dip_13$FTL) # character to integer

dip_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

dip_15 <- dplyr::select(TIAS, TA150993, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_15 <- na.omit(dip_15) # removing rows with NA 

dip_15 <- dip_15 %>% rename(DIP = TA150993, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_15 <- dip_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_15 <- dip_15 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_15$DIP <- as.factor(dip_15$DIP)

dip_15$Sex <- as.integer(dip_15$Sex) # character to integer

dip_15 <- dip_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_15$FTL <- as.integer(dip_15$FTL) # character to integer

dip_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

dip_17 <- dplyr::select(TIAS, TA171860, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dip_17 <- na.omit(dip_17) # removing rows with NA 

dip_17 <- dip_17 %>% rename(DIP = TA171860, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dip_17 <- dip_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dip_17 <- dip_17 %>% mutate(DIP = dplyr::recode(DIP, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

dip_17$DIP <- as.factor(dip_17$DIP)

dip_17$Sex <- as.integer(dip_17$Sex) # character to integer

dip_17 <- dip_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dip_17$FTL <- as.integer(dip_17$FTL) # character to integer

dip_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

dip_df <- rbind(dip_05, dip_07, dip_09, dip_11, dip_13, dip_15, dip_17)

dip_m1 <- polr(DIP ~ FTL, data = dip_df, Hess = TRUE)

dip_m2 <- polr(DIP ~ FTL + Age + Sex + Year, data = dip_df, Hess = TRUE)

dip_m3 <- polr(DIP ~ FTL + Age + FTL*Age, data = dip_df, Hess = TRUE)

dip_m4 <- polr(DIP ~ FTL + Sex + FTL*Sex, data = dip_df, Hess = TRUE)

dip_m5 <- polr(DIP ~ FTL + Year + FTL*Year, data = dip_df, Hess = TRUE)

dip_m6 <- polr(DIP ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = dip_df, Hess = TRUE)

tab_model(dip_m1, dip_m2, dip_m3, dip_m4, dip_m5, dip_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Steroid Usage 

```{r}
# =================== 2005 ===================  

str_05 <- dplyr::select(TIAS, TA050824, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_05 <- na.omit(str_05) # removing rows with NA 

str_05 <- str_05 %>% rename(STR = TA050824, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_05 <- str_05 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_05$STR <- as.factor(str_05$STR)

str_05 <- str_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_05$Sex <- as.integer(str_05$Sex) # character to integer

str_05 <- str_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_05$FTL <- as.integer(str_05$FTL) # character to integer

str_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

str_07 <- dplyr::select(TIAS, TA070792, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_07 <- na.omit(str_07) # removing rows with NA 

str_07 <- str_07 %>% rename(STR = TA070792, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_07 <- str_07 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_07$STR <- as.factor(str_07$STR)

str_07 <- str_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_07$Sex <- as.integer(str_07$Sex) # character to integer

str_07 <- str_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_07$FTL <- as.integer(str_07$FTL) # character to integer

str_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

str_09 <- dplyr::select(TIAS, TA090851, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_09 <- na.omit(str_09) # removing rows with NA 

str_09 <- str_09 %>% rename(STR = TA090851, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_09 <- str_09 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_09$STR <- as.factor(str_09$STR)

str_09 <- str_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_09$Sex <- as.integer(str_09$Sex) # character to integer

str_09 <- str_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_09$FTL <- as.integer(str_09$FTL) # character to integer

str_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

str_11 <- dplyr::select(TIAS, TA110967, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_11 <- na.omit(str_11) # removing rows with NA 

str_11 <- str_11 %>% rename(STR = TA110967, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_11 <- str_11 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_11$STR <- as.factor(str_11$STR)

str_11 <- str_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_11$Sex <- as.integer(str_11$Sex) # character to integer

str_11 <- str_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_11$FTL <- as.integer(str_11$FTL) # character to integer

str_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131000 = 9)) 

str_13 <- dplyr::select(TIAS, TA131000, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_13 <- na.omit(str_13) # removing rows with NA 

str_13 <- str_13 %>% rename(STR = TA131000, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_13 <- str_13 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_13$STR <- as.factor(str_13$STR)

str_13 <- str_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_13$Sex <- as.integer(str_13$Sex) # character to integer

str_13 <- str_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_13$FTL <- as.integer(str_13$FTL) # character to integer

str_13$Year <- c(rep(5, 1803)) # adding year 

# =================== 2015 =================== 

str_15 <- dplyr::select(TIAS, TA151022, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_15 <- na.omit(str_15) # removing rows with NA 

str_15 <- str_15 %>% rename(STR = TA151022, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_15 <- str_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_15 <- str_15 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_15$STR <- as.factor(str_15$STR)

str_15$Sex <- as.integer(str_15$Sex) # character to integer

str_15 <- str_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_15$FTL <- as.integer(str_15$FTL) # character to integer

str_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

str_17 <- dplyr::select(TIAS, TA171884, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

str_17 <- na.omit(str_17) # removing rows with NA 

str_17 <- str_17 %>% rename(STR = TA171884, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

str_17 <- str_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

str_17 <- str_17 %>% mutate(STR = dplyr::recode(STR, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

str_17$STR <- as.factor(str_17$STR)

str_17$Sex <- as.integer(str_17$Sex) # character to integer

str_17 <- str_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

str_17$FTL <- as.integer(str_17$FTL) # character to integer

str_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

str_df <- rbind(str_05, str_07, str_09, str_11, str_13, str_15, str_17)

str_m1 <- polr(STR ~ FTL, data = str_df, Hess = TRUE)

str_m2 <- polr(STR ~ FTL + Age + Sex + Year, data = str_df, Hess = TRUE)

str_m3 <- polr(STR ~ FTL + Age + FTL*Age, data = str_df, Hess = TRUE)

str_m4 <- polr(STR ~ FTL + Sex + FTL*Sex, data = str_df, Hess = TRUE)

str_m5 <- polr(STR ~ FTL + Year + FTL*Year, data = str_df, Hess = TRUE)

str_m6 <- polr(STR ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = str_df, Hess = TRUE)

tab_model(str_m1, str_m2, str_m3, str_m4, str_m5, str_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Tranquilizer Usage 

```{r}
# =================== 2005 ===================  

trq_05 <- dplyr::select(TIAS, TA050816, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_05 <- na.omit(trq_05) # removing rows with NA 

trq_05 <- trq_05 %>% rename(TRQ = TA050816, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_05 <- trq_05 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_05$TRQ <- as.factor(trq_05$TRQ)

trq_05 <- trq_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_05$Sex <- as.integer(trq_05$Sex) # character to integer

trq_05 <- trq_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_05$FTL <- as.integer(trq_05$FTL) # character to integer

trq_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

trq_07 <- dplyr::select(TIAS, TA070784, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_07 <- na.omit(trq_07) # removing rows with NA 

trq_07 <- trq_07 %>% rename(TRQ = TA070784, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_07 <- trq_07 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_07$TRQ <- as.factor(trq_07$TRQ)

trq_07 <- trq_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_07$Sex <- as.integer(trq_07$Sex) # character to integer

trq_07 <- trq_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_07$FTL <- as.integer(trq_07$FTL) # character to integer

trq_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

trq_09 <- dplyr::select(TIAS, TA090843, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_09 <- na.omit(trq_09) # removing rows with NA 

trq_09 <- trq_09 %>% rename(TRQ = TA090843, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_09 <- trq_09 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_09$TRQ <- as.factor(trq_09$TRQ)

trq_09 <- trq_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_09$Sex <- as.integer(trq_09$Sex) # character to integer

trq_09 <- trq_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_09$FTL <- as.integer(trq_09$FTL) # character to integer

trq_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

trq_11 <- dplyr::select(TIAS, TA110959, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_11 <- na.omit(trq_11) # removing rows with NA 

trq_11 <- trq_11 %>% rename(TRQ = TA110959, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_11 <- trq_11 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_11$TRQ <- as.factor(trq_11$TRQ)

trq_11 <- trq_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_11$Sex <- as.integer(trq_11$Sex) # character to integer

trq_11 <- trq_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_11$FTL <- as.integer(trq_11$FTL) # character to integer

trq_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

trq_13 <- dplyr::select(TIAS, TA130992, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_13 <- na.omit(trq_13) # removing rows with NA 

trq_13 <- trq_13 %>% rename(TRQ = TA130992, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_13 <- trq_13 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_13$TRQ <- as.factor(trq_13$TRQ)

trq_13 <- trq_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_13$Sex <- as.integer(trq_13$Sex) # character to integer

trq_13 <- trq_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_13$FTL <- as.integer(trq_13$FTL) # character to integer

trq_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

trq_15 <- dplyr::select(TIAS, TA151014, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_15 <- na.omit(trq_15) # removing rows with NA 

trq_15 <- trq_15 %>% rename(TRQ = TA151014, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_15 <- trq_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_15 <- trq_15 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_15$TRQ <- as.factor(trq_15$TRQ)

trq_15$Sex <- as.integer(trq_15$Sex) # character to integer

trq_15 <- trq_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_15$FTL <- as.integer(trq_15$FTL) # character to integer

trq_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

trq_17 <- dplyr::select(TIAS, TA171876, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

trq_17 <- na.omit(trq_17) # removing rows with NA 

trq_17 <- trq_17 %>% rename(TRQ = TA171876, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

trq_17 <- trq_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

trq_17 <- trq_17 %>% mutate(TRQ = dplyr::recode(TRQ, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

trq_17$TRQ <- as.factor(trq_17$TRQ)

trq_17$Sex <- as.integer(trq_17$Sex) # character to integer

trq_17 <- trq_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

trq_17$FTL <- as.integer(trq_17$FTL) # character to integer

trq_17$Year <- c(rep(7, 2526)) # adding year 
```

## Cocaine Usage 

```{r}
# =================== 2005 ===================  

ccn_05 <- dplyr::select(TIAS, TA050797, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_05 <- na.omit(ccn_05) # removing rows with NA 

ccn_05 <- ccn_05 %>% rename(CCN = TA050797, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_05 <- ccn_05 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_05$CCN <- as.factor(ccn_05$CCN)

ccn_05 <- ccn_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_05$Sex <- as.integer(ccn_05$Sex) # character to integer

ccn_05 <- ccn_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_05$FTL <- as.integer(ccn_05$FTL) # character to integer

ccn_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

ccn_07 <- dplyr::select(TIAS, TA070768, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_07 <- na.omit(ccn_07) # removing rows with NA 

ccn_07 <- ccn_07 %>% rename(CCN = TA070768, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_07 <- ccn_07 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_07$CCN <- as.factor(ccn_07$CCN)

ccn_07 <- ccn_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_07$Sex <- as.integer(ccn_07$Sex) # character to integer

ccn_07 <- ccn_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_07$FTL <- as.integer(ccn_07$FTL) # character to integer

ccn_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

ccn_09 <- dplyr::select(TIAS, TA090827, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_09 <- na.omit(ccn_09) # removing rows with NA 

ccn_09 <- ccn_09 %>% rename(CCN = TA090827, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_09 <- ccn_09 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_09$CCN <- as.factor(ccn_09$CCN)

ccn_09 <- ccn_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_09$Sex <- as.integer(ccn_09$Sex) # character to integer

ccn_09 <- ccn_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_09$FTL <- as.integer(ccn_09$FTL) # character to integer

ccn_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

ccn_11 <- dplyr::select(TIAS, TA110943, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_11 <- na.omit(ccn_11) # removing rows with NA 

ccn_11 <- ccn_11 %>% rename(CCN = TA110943, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_11 <- ccn_11 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_11$CCN <- as.factor(ccn_11$CCN)

ccn_11 <- ccn_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_11$Sex <- as.integer(ccn_11$Sex) # character to integer

ccn_11 <- ccn_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_11$FTL <- as.integer(ccn_11$FTL) # character to integer

ccn_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

ccn_13 <- dplyr::select(TIAS, TA130976, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_13 <- na.omit(ccn_13) # removing rows with NA 

ccn_13 <- ccn_13 %>% rename(CCN = TA130976, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_13 <- ccn_13 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_13$CCN <- as.factor(ccn_13$CCN)

ccn_13 <- ccn_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_13$Sex <- as.integer(ccn_13$Sex) # character to integer

ccn_13 <- ccn_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_13$FTL <- as.integer(ccn_13$FTL) # character to integer

ccn_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

ccn_15 <- dplyr::select(TIAS, TA150998, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_15 <- na.omit(ccn_15) # removing rows with NA 

ccn_15 <- ccn_15 %>% rename(CCN = TA150998, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_15 <- ccn_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_15 <- ccn_15 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_15$CCN <- as.factor(ccn_15$CCN)

ccn_15$Sex <- as.integer(ccn_15$Sex) # character to integer

ccn_15 <- ccn_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_15$FTL <- as.integer(ccn_15$FTL) # character to integer

ccn_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

ccn_17 <- dplyr::select(TIAS, TA171839, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ccn_17 <- na.omit(ccn_17) # removing rows with NA 

ccn_17 <- ccn_17 %>% rename(CCN = TA171839, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ccn_17 <- ccn_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ccn_17 <- ccn_17 %>% mutate(CCN = dplyr::recode(CCN, `0` = "Never", `1` = "1-2 times", `2` = "3-5 times", `3` = "6-9 times", `4` = "10-19 times", `5` = "20-39 times", `6` = "40 or more times")) # recoding values 

ccn_17$CCN <- as.factor(ccn_17$CCN)

ccn_17$Sex <- as.integer(ccn_17$Sex) # character to integer

ccn_17 <- ccn_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ccn_17$FTL <- as.integer(ccn_17$FTL) # character to integer

ccn_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

ccn_df <- rbind(ccn_05, ccn_07, ccn_09, ccn_11, ccn_13, ccn_15, ccn_17)

ccn_m1 <- polr(CCN ~ FTL, data = ccn_df, Hess = TRUE)

ccn_m2 <- polr(CCN ~ FTL + Age + Sex + Year, data = ccn_df, Hess = TRUE)

ccn_m3 <- polr(CCN ~ FTL + Age + FTL*Age, data = ccn_df, Hess = TRUE)

ccn_m4 <- polr(CCN ~ FTL + Sex + FTL*Sex, data = ccn_df, Hess = TRUE)

ccn_m5 <- polr(CCN ~ FTL + Year + FTL*Year, data = ccn_df, Hess = TRUE)

ccn_m6 <- polr(CCN ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = ccn_df, Hess = TRUE)

tab_model(ccn_m1, ccn_m2, ccn_m3, ccn_m4, ccn_m5, ccn_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Average Alcohol Consumption Frequency Over Past Year 

```{r}
# =================== 2005 ===================  

aac_05 <- dplyr::select(TIAS, TA050767, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_05 <- na.omit(aac_05) # removing rows with NA 

aac_05 <- aac_05 %>% rename(AAC = TA050767, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_05 <- aac_05 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_05$AAC <- as.factor(aac_05$AAC)

aac_05 <- aac_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_05$Sex <- as.integer(aac_05$Sex) # character to integer

aac_05 <- aac_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_05$FTL <- as.integer(aac_05$FTL) # character to integer

aac_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

aac_07 <- dplyr::select(TIAS, TA070738, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_07 <- na.omit(aac_07) # removing rows with NA 

aac_07 <- aac_07 %>% rename(AAC = TA070738, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_07 <- aac_07 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_07$AAC <- as.factor(aac_07$AAC)

aac_07 <- aac_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_07$Sex <- as.integer(aac_07$Sex) # character to integer

aac_07 <- aac_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_07$FTL <- as.integer(aac_07$FTL) # character to integer

aac_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090797 = 9)) 

aac_09 <- dplyr::select(TIAS, TA090827, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_09 <- na.omit(aac_09) # removing rows with NA 

aac_09 <- aac_09 %>% rename(AAC = TA090827, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_09 <- aac_09 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_09$AAC <- as.factor(aac_09$AAC)

aac_09 <- aac_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_09$Sex <- as.integer(aac_09$Sex) # character to integer

aac_09 <- aac_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_09$FTL <- as.integer(aac_09$FTL) # character to integer

aac_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110913 = c(8, 9)))

aac_11 <- dplyr::select(TIAS, TA110913, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_11 <- na.omit(aac_11) # removing rows with NA 

aac_11 <- aac_11 %>% rename(AAC = TA110913, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_11 <- aac_11 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_11$AAC <- as.factor(aac_11$AAC)

aac_11 <- aac_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_11$Sex <- as.integer(aac_11$Sex) # character to integer

aac_11 <- aac_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_11$FTL <- as.integer(aac_11$FTL) # character to integer

aac_11$Year <- c(rep(4, 1904)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130946 = 9)) 

aac_13 <- dplyr::select(TIAS, TA130946, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_13 <- na.omit(aac_13) # removing rows with NA 

aac_13 <- aac_13 %>% rename(AAC = TA130946, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_13 <- aac_13 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_13$AAC <- as.factor(aac_13$AAC)

aac_13 <- aac_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_13$Sex <- as.integer(aac_13$Sex) # character to integer

aac_13 <- aac_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_13$FTL <- as.integer(aac_13$FTL) # character to integer

aac_13$Year <- c(rep(5, 1803)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150968 = 8)) 

aac_15 <- dplyr::select(TIAS, TA150968, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_15 <- na.omit(aac_15) # removing rows with NA 

aac_15 <- aac_15 %>% rename(AAC = TA150968, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_15 <- aac_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_15 <- aac_15 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_15$AAC <- as.factor(aac_15$AAC)

aac_15$Sex <- as.integer(aac_15$Sex) # character to integer

aac_15 <- aac_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_15$FTL <- as.integer(aac_15$FTL) # character to integer

aac_15$Year <- c(rep(6, 1640)) # adding year 

# =================== 2017 =================== 

aac_17 <- dplyr::select(TIAS, TA171825, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

aac_17 <- na.omit(aac_17) # removing rows with NA 

aac_17 <- aac_17 %>% rename(AAC = TA171825, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

aac_17 <- aac_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

aac_17 <- aac_17 %>% mutate(AAC = dplyr::recode(AAC, `0` = "Never", `1` = "Less than once a month", `2` = "About once a month", `3` = "Several times a month", `4` = "About once a week", `5` = "Several times a week", `6` = "Every day")) # recoding values 

aac_17$AAC <- as.factor(aac_17$AAC)

aac_17$Sex <- as.integer(aac_17$Sex) # character to integer

aac_17 <- aac_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

aac_17$FTL <- as.integer(aac_17$FTL) # character to integer

aac_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

aac_df <- rbind(aac_05, aac_07, aac_09, aac_11, aac_13, aac_15, aac_17)

aac_m1 <- polr(AAC ~ FTL, data = aac_df, Hess = TRUE)

aac_m2 <- polr(AAC ~ FTL + Age + Sex + Year, data = aac_df, Hess = TRUE)

aac_m3 <- polr(AAC ~ FTL + Age + FTL*Age, data = aac_df, Hess = TRUE)

aac_m4 <- polr(AAC ~ FTL + Sex + FTL*Sex, data = aac_df, Hess = TRUE)

aac_m5 <- polr(AAC ~ FTL + Year + FTL*Year, data = aac_df, Hess = TRUE)

aac_m6 <- polr(AAC ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = aac_df, Hess = TRUE)

tab_model(aac_m1, aac_m2, aac_m3, aac_m4, aac_m5, aac_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Average Daily Alcohol Consumption 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050768 = 98)) 

dac_05 <- dplyr::select(TIAS, TA050768, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_05 <- na.omit(dac_05) # removing rows with NA 

dac_05 <- dac_05 %>% rename(DAC = TA050768, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_05 <- dac_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_05$Sex <- as.integer(dac_05$Sex) # character to integer

dac_05 <- dac_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_05$FTL <- as.integer(dac_05$FTL) # character to integer

dac_05$Year <- c(rep(1, 742)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070739 = c(98, 99)))

dac_07 <- dplyr::select(TIAS, TA070739, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_07 <- na.omit(dac_07) # removing rows with NA 

dac_07 <- dac_07 %>% rename(DAC = TA070739, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_07 <- dac_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_07$Sex <- as.integer(dac_07$Sex) # character to integer

dac_07 <- dac_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_07$FTL <- as.integer(dac_07$FTL) # character to integer

dac_07$Year <- c(rep(2, 1105)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090798 = c(98, 99))) 

dac_09 <- dplyr::select(TIAS, TA090798, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_09 <- na.omit(dac_09) # removing rows with NA 

dac_09 <- dac_09 %>% rename(DAC = TA090798, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_09 <- dac_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_09$Sex <- as.integer(dac_09$Sex) # character to integer

dac_09 <- dac_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_09$FTL <- as.integer(dac_09$FTL) # character to integer

dac_09$Year <- c(rep(3, 1535)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110914 = c(98, 99)))

dac_11 <- dplyr::select(TIAS, TA110914, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_11 <- na.omit(dac_11) # removing rows with NA 

dac_11 <- dac_11 %>% rename(DAC = TA110914, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_11 <- dac_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_11$Sex <- as.integer(dac_11$Sex) # character to integer

dac_11 <- dac_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_11$FTL <- as.integer(dac_11$FTL) # character to integer

dac_11$Year <- c(rep(4, 1900)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130947 = c(98, 99)))  

dac_13 <- dplyr::select(TIAS, TA130947, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_13 <- na.omit(dac_13) # removing rows with NA 

dac_13 <- dac_13 %>% rename(DAC = TA130947, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_13 <- dac_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_13$Sex <- as.integer(dac_13$Sex) # character to integer

dac_13 <- dac_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_13$FTL <- as.integer(dac_13$FTL) # character to integer

dac_13$Year <- c(rep(5, 1796)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150969 = 98)) 

dac_15 <- dplyr::select(TIAS, TA150969, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_15 <- na.omit(dac_15) # removing rows with NA 

dac_15 <- dac_15 %>% rename(DAC = TA150969, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_15 <- dac_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_15$Sex <- as.integer(dac_15$Sex) # character to integer

dac_15 <- dac_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_15$FTL <- as.integer(dac_15$FTL) # character to integer

dac_15$Year <- c(rep(6, 1635)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171826 = 98)) 

dac_17 <- dplyr::select(TIAS, TA171826, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dac_17 <- na.omit(dac_17) # removing rows with NA 

dac_17 <- dac_17 %>% rename(DAC = TA171826, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dac_17 <- dac_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dac_17$Sex <- as.integer(dac_17$Sex) # character to integer

dac_17 <- dac_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dac_17$FTL <- as.integer(dac_17$FTL) # character to integer

dac_17$Year <- c(rep(7, 2518)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# multivariate linear regression 

dac_df <- rbind(dac_05, dac_07, dac_09, dac_11, dac_13, dac_15, dac_17)

dac_m1 <- lm(DAC ~ FTL, data = dac_df)

dac_m2 <- lm(DAC ~ FTL + Age + Sex + Year, data = dac_df)

dac_m3 <- lm(DAC ~ FTL + Age + FTL*Age, data = dac_df)

dac_m4 <- lm(DAC ~ FTL + Sex + FTL*Sex, data = dac_df)

dac_m5 <- lm(DAC ~ FTL + Year + FTL*Year, data = dac_df)

dac_m6 <- lm(DAC ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = dac_df)

tab_model(dac_m1, dac_m2, dac_m3, dac_m4, dac_m5, dac_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Degree to Which Condition Limits Daily Activities 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050723 = c(0, 9)))

dcn_05 <- dplyr::select(TIAS, TA050723, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_05 <- na.omit(dcn_05) # removing rows with NA 

dcn_05 <- dcn_05 %>% rename(DCN = TA050723, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_05 <- dcn_05 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_05$DCN <- as.factor(dcn_05$DCN)

dcn_05 <- dcn_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_05$Sex <- as.integer(dcn_05$Sex) # character to integer

dcn_05 <- dcn_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_05$FTL <- as.integer(dcn_05$FTL) # character to integer

dcn_05$Year <- c(rep(1, 79)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070694 = 0)) 

dcn_07 <- dplyr::select(TIAS, TA070694, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_07 <- na.omit(dcn_07) # removing rows with NA 

dcn_07 <- dcn_07 %>% rename(DCN = TA070694, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_07 <- dcn_07 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_07$DCN <- as.factor(dcn_07$DCN)

dcn_07 <- dcn_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_07$Sex <- as.integer(dcn_07$Sex) # character to integer

dcn_07 <- dcn_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_07$FTL <- as.integer(dcn_07$FTL) # character to integer

dcn_07$Year <- c(rep(2, 132)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090750 = c(0, 9)))

dcn_09 <- dplyr::select(TIAS, TA090750, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_09 <- na.omit(dcn_09) # removing rows with NA 

dcn_09 <- dcn_09 %>% rename(DCN = TA090750, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_09 <- dcn_09 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_09$DCN <- as.factor(dcn_09$DCN)

dcn_09 <- dcn_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_09$Sex <- as.integer(dcn_09$Sex) # character to integer

dcn_09 <- dcn_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_09$FTL <- as.integer(dcn_09$FTL) # character to integer

dcn_09$Year <- c(rep(3, 185)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110842 = c(0, 9)))

dcn_11 <- dplyr::select(TIAS, TA110842, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_11 <- na.omit(dcn_11) # removing rows with NA 

dcn_11 <- dcn_11 %>% rename(DCN = TA110842, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_11 <- dcn_11 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_11$DCN <- as.factor(dcn_11$DCN)

dcn_11 <- dcn_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_11$Sex <- as.integer(dcn_11$Sex) # character to integer

dcn_11 <- dcn_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_11$FTL <- as.integer(dcn_11$FTL) # character to integer

dcn_11$Year <- c(rep(4, 225)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130866 = c(0, 9)))

dcn_13 <- dplyr::select(TIAS, TA130866, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_13 <- na.omit(dcn_13) # removing rows with NA 

dcn_13 <- dcn_13 %>% rename(DCN = TA130866, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_13 <- dcn_13 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_13$DCN <- as.factor(dcn_13$DCN)

dcn_13 <- dcn_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_13$Sex <- as.integer(dcn_13$Sex) # character to integer

dcn_13 <- dcn_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_13$FTL <- as.integer(dcn_13$FTL) # character to integer

dcn_13$Year <- c(rep(5, 223)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150883 = c(0, 8)))

dcn_15 <- dplyr::select(TIAS, TA150883, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_15 <- na.omit(dcn_15) # removing rows with NA 

dcn_15 <- dcn_15 %>% rename(DCN = TA150883, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_15 <- dcn_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_15 <- dcn_15 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `3` = "Somewhat", `5` = "Just a little", `7` = "Not at all")) # recoding values 

dcn_15$DCN <- as.factor(dcn_15$DCN)

dcn_15$Sex <- as.integer(dcn_15$Sex) # character to integer

dcn_15 <- dcn_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_15$FTL <- as.integer(dcn_15$FTL) # character to integer

dcn_15$Year <- c(rep(6, 186)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170923 = c(0, 9)))

dcn_17 <- dplyr::select(TIAS, TA170923, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dcn_17 <- na.omit(dcn_17) # removing rows with NA 

dcn_17 <- dcn_17 %>% rename(DCN = TA170923, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dcn_17 <- dcn_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dcn_17 <- dcn_17 %>% mutate(DCN = dplyr::recode(DCN, `1` = "A lot", `2` = "Somewhat", `3` = "Just a little", `4` = "Not at all")) # recoding values 

dcn_17$DCN <- as.factor(dcn_17$DCN)

dcn_17$Sex <- as.integer(dcn_17$Sex) # character to integer

dcn_17 <- dcn_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dcn_17$FTL <- as.integer(dcn_17$FTL) # character to integer

dcn_17$Year <- c(rep(7, 247)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

dcn_df <- rbind(dcn_05, dcn_07, dcn_09, dcn_11, dcn_13, dcn_15, dcn_17)

dcn_m1 <- polr(DCN ~ FTL, data = dcn_df, Hess = TRUE)

dcn_m2 <- polr(DCN ~ FTL + Age + Sex + Year, data = dcn_df, Hess = TRUE)

dcn_m3 <- polr(DCN ~ FTL + Age + FTL*Age, data = dcn_df, Hess = TRUE)

dcn_m4 <- polr(DCN ~ FTL + Sex + FTL*Sex, data = dcn_df, Hess = TRUE)

dcn_m5 <- polr(DCN ~ FTL + Year + FTL*Year, data = dcn_df, Hess = TRUE)

dcn_m6 <- polr(DCN ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = dcn_df, Hess = TRUE)

tab_model(dcn_m1, dcn_m2, dcn_m3, dcn_m4, dcn_m5, dcn_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Depression Over Past Year 

```{r}  
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050733 = 9)) 

dep_05 <- dplyr::select(TIAS, TA050733, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_05 <- na.omit(dep_05) # removing rows with NA 

dep_05 <- dep_05 %>% rename(DEP = TA050733, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_05 <- dep_05 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values

dep_05$DEP <- as.numeric(dep_05$DEP) # integer to numeric

dep_05 <- dep_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_05$Sex <- as.integer(dep_05$Sex) # character to integer

dep_05 <- dep_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_05$FTL <- as.integer(dep_05$FTL) # character to integer

dep_05$Year <- c(rep(1, 744)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070704 = 9)) 

dep_07 <- dplyr::select(TIAS, TA070704, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_07 <- na.omit(dep_07) # removing rows with NA 

dep_07 <- dep_07 %>% rename(DEP = TA070704, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_07 <- dep_07 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_07$DEP <- as.numeric(dep_07$DEP) # integer to numeric

dep_07 <- dep_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_07$Sex <- as.integer(dep_07$Sex) # character to integer

dep_07 <- dep_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_07$FTL <- as.integer(dep_07$FTL) # character to integer

dep_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090760 = 9)) 

dep_09 <- dplyr::select(TIAS, TA090760, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_09 <- na.omit(dep_09) # removing rows with NA 

dep_09 <- dep_09 %>% rename(DEP = TA090760, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_09 <- dep_09 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_09$DEP <- as.numeric(dep_09$DEP) # integer to numeric

dep_09 <- dep_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_09$Sex <- as.integer(dep_09$Sex) # character to integer

dep_09 <- dep_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_09$FTL <- as.integer(dep_09$FTL) # character to integer

dep_09$Year <- c(rep(3, 1552)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110853 = 8)) 

dep_11 <- dplyr::select(TIAS, TA110853, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_11 <- na.omit(dep_11) # removing rows with NA 

dep_11 <- dep_11 %>% rename(DEP = TA110853, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_11 <- dep_11 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_11$DEP <- as.numeric(dep_11$DEP) # integer to numeric

dep_11 <- dep_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_11$Sex <- as.integer(dep_11$Sex) # character to integer

dep_11 <- dep_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_11$FTL <- as.integer(dep_11$FTL) # character to integer

dep_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130877 = 8)) 

dep_13 <- dplyr::select(TIAS, TA130877, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_13 <- na.omit(dep_13) # removing rows with NA 

dep_13 <- dep_13 %>% rename(DEP = TA130877, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_13 <- dep_13 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_13$DEP <- as.numeric(dep_13$DEP) # integer to numeric

dep_13 <- dep_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_13$Sex <- as.integer(dep_13$Sex) # character to integer

dep_13 <- dep_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_13$FTL <- as.integer(dep_13$FTL) # character to integer

dep_13$Year <- c(rep(5, 1803)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150892 = 9)) 

dep_15 <- dplyr::select(TIAS, TA150892, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_15 <- na.omit(dep_15) # removing rows with NA 

dep_15 <- dep_15 %>% rename(DEP = TA150892, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_15 <- dep_15 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_15$DEP <- as.numeric(dep_15$DEP) # integer to numeric

dep_15 <- dep_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_15$Sex <- as.integer(dep_15$Sex) # character to integer

dep_15 <- dep_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_15$FTL <- as.integer(dep_15$FTL) # character to integer

dep_15$Year <- c(rep(6, 1638)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171806 = 8)) 

dep_17 <- dplyr::select(TIAS, TA171806, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dep_17 <- na.omit(dep_17) # removing rows with NA 

dep_17 <- dep_17 %>% rename(DEP = TA171806, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dep_17 <- dep_17 %>% mutate(DEP = dplyr::recode(DEP, `1` = "1", `5` = "0")) # recoding values 

dep_17$DEP <- as.numeric(dep_17$DEP) # integer to numeric

dep_17 <- dep_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dep_17$Sex <- as.integer(dep_17$Sex) # character to integer

dep_17 <- dep_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dep_17$FTL <- as.integer(dep_17$FTL) # character to integer

dep_17$Year <- c(rep(7, 2518)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

dep_df <- rbind(dep_05, dep_07, dep_09, dep_11, dep_13, dep_15, dep_17)

dep_m1 <- glm(DEP ~ FTL, family = binomial, data = dep_df)

dep_m2 <- glm(DEP ~ FTL + Age + Sex + Year, family = binomial, data = dep_df)

dep_m3 <- glm(DEP ~ FTL + Age + FTL*Age, family = binomial, data = dep_df)

dep_m4 <- glm(DEP ~ FTL + Sex + FTL*Sex, family = binomial, data = dep_df)

dep_m5 <- glm(DEP ~ FTL + Year + FTL*Year, family = binomial, data = dep_df)

dep_m6 <- glm(DEP ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = dep_df)

tab_model(dep_m1, dep_m2, dep_m3, dep_m4, dep_m5, dep_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Depression - Anhedonia 

```{r}
# =================== 2005 ===================  

anh_05 <- dplyr::select(TIAS, TA050734, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_05 <- na.omit(anh_05) # removing rows with NA 

anh_05 <- anh_05 %>% rename(ANH = TA050734, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_05 <- anh_05 %>% mutate(ANH = dplyr::recode(ANH, `1` = "1", `5` = "0")) # recoding values

anh_05$ANH <- as.numeric(anh_05$ANH) # integer to numeric

anh_05 <- anh_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_05$Sex <- as.integer(anh_05$Sex) # character to integer

anh_05 <- anh_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_05$FTL <- as.integer(anh_05$FTL) # character to integer

anh_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070705 = 9)) 

anh_07 <- dplyr::select(TIAS, TA070705, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_07 <- na.omit(anh_07) # removing rows with NA 

anh_07 <- anh_07 %>% rename(ANH = TA070705, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_07 <- anh_07 %>% mutate(ANH = dplyr::recode(ANH, `1` = "1", `5` = "0")) # recoding values 

anh_07$ANH <- as.numeric(anh_07$ANH) # integer to numeric

anh_07 <- anh_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_07$Sex <- as.integer(anh_07$Sex) # character to integer

anh_07 <- anh_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_07$FTL <- as.integer(anh_07$FTL) # character to integer

anh_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090761 = c(8, 9)))

anh_09 <- dplyr::select(TIAS, TA090761, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_09 <- na.omit(anh_09) # removing rows with NA 

anh_09 <- anh_09 %>% rename(ANH = TA090761, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_09 <- anh_09 %>% mutate(ANH = dplyr::recode(ANH, `1` = "1", `5` = "0")) # recoding values 

anh_09$ANH <- as.numeric(anh_09$ANH) # integer to numeric

anh_09 <- anh_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_09$Sex <- as.integer(anh_09$Sex) # character to integer

anh_09 <- anh_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_09$FTL <- as.integer(anh_09$FTL) # character to integer

anh_09$Year <- c(rep(3, 1552)) # adding year 

# =================== 2011 =================== 

anh_11 <- dplyr::select(TIAS, TA110854, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_11 <- na.omit(anh_11) # removing rows with NA 

anh_11 <- anh_11 %>% rename(ANH = TA110854, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_11 <- anh_11 %>% mutate(ANH = dplyr::recode(ANH, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

anh_11$ANH <- as.numeric(anh_11$ANH) # integer to numeric

anh_11 <- anh_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_11$Sex <- as.integer(anh_11$Sex) # character to integer

anh_11 <- anh_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_11$FTL <- as.integer(anh_11$FTL) # character to integer

anh_11$Year <- c(rep(4, 1907)) # adding year

# =================== 2013 =================== 

anh_13 <- dplyr::select(TIAS, TA130878, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_13 <- na.omit(anh_13) # removing rows with NA 

anh_13 <- anh_13 %>% rename(ANH = TA130878, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_13 <- anh_13 %>% mutate(ANH = dplyr::recode(ANH, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

anh_13$ANH <- as.numeric(anh_13$ANH) # integer to numeric

anh_13 <- anh_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_13$Sex <- as.integer(anh_13$Sex) # character to integer

anh_13 <- anh_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_13$FTL <- as.integer(anh_13$FTL) # character to integer

anh_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150893 = c(8, 9)))

anh_15 <- dplyr::select(TIAS, TA150893, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_15 <- na.omit(anh_15) # removing rows with NA 

anh_15 <- anh_15 %>% rename(ANH = TA150893, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_15 <- anh_15 %>% mutate(ANH = dplyr::recode(ANH, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

anh_15$ANH <- as.numeric(anh_15$ANH) # integer to numeric

anh_15 <- anh_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_15$Sex <- as.integer(anh_15$Sex) # character to integer

anh_15 <- anh_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_15$FTL <- as.integer(anh_15$FTL) # character to integer

anh_15$Year <- c(rep(6, 1637)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171807 = c(8, 9)))

anh_17 <- dplyr::select(TIAS, TA171807, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anh_17 <- na.omit(anh_17) # removing rows with NA 

anh_17 <- anh_17 %>% rename(ANH = TA171807, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anh_17 <- anh_17 %>% mutate(ANH = dplyr::recode(ANH, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

anh_17$ANH <- as.numeric(anh_17$ANH) # integer to numeric

anh_17 <- anh_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anh_17$Sex <- as.integer(anh_17$Sex) # character to integer

anh_17 <- anh_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anh_17$FTL <- as.integer(anh_17$FTL) # character to integer

anh_17$Year <- c(rep(7, 2517)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

anh_df <- rbind(anh_05, anh_07, anh_09, anh_11, anh_13, anh_15, anh_17)

anh_m1 <- glm(ANH ~ FTL, family = binomial, data = anh_df)

anh_m2 <- glm(ANH ~ FTL + Age + Sex + Year, family = binomial, data = anh_df)

anh_m3 <- glm(ANH ~ FTL + Age + FTL*Age, family = binomial, data = anh_df)

anh_m4 <- glm(ANH ~ FTL + Sex + FTL*Sex, family = binomial, data = anh_df)

anh_m5 <- glm(ANH ~ FTL + Year + FTL*Year, family = binomial, data = anh_df)

anh_m6 <- glm(ANH ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = anh_df)

tab_model(anh_m1, anh_m2, anh_m3, anh_m4, anh_m5, anh_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Depression Diagnosis 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050710 = c(8, 9))) 

dpd_05 <- dplyr::select(TIAS, TA050710, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_05 <- na.omit(dpd_05) # removing rows with NA 

dpd_05 <- dpd_05 %>% rename(DPD = TA050710, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_05$DPD <- as.integer(dpd_05$DPD) # integer to numeric

dpd_05 <- dpd_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_05$Sex <- as.integer(dpd_05$Sex) # character to integer

dpd_05 <- dpd_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_05$FTL <- as.integer(dpd_05$FTL) # character to integer

dpd_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

dpd_07 <- dplyr::select(TIAS, TA070681, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_07 <- na.omit(dpd_07) # removing rows with NA 

dpd_07 <- dpd_07 %>% rename(DPD = TA070681, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_07$DPD <- as.integer(dpd_07$DPD) # integer to numeric

dpd_07 <- dpd_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_07$Sex <- as.integer(dpd_07$Sex) # character to integer

dpd_07 <- dpd_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_07$FTL <- as.integer(dpd_07$FTL) # character to integer

dpd_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090737 = 8)) 

dpd_09 <- dplyr::select(TIAS, TA090737, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_09 <- na.omit(dpd_09) # removing rows with NA 

dpd_09 <- dpd_09 %>% rename(DPD = TA090737, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_09$DPD <- as.integer(dpd_09$DPD) # integer to numeric

dpd_09 <- dpd_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_09$Sex <- as.integer(dpd_09$Sex) # character to integer

dpd_09 <- dpd_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_09$FTL <- as.integer(dpd_09$FTL) # character to integer

dpd_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110827 = 8)) 

dpd_11 <- dplyr::select(TIAS, TA110827, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_11 <- na.omit(dpd_11) # removing rows with NA 

dpd_11 <- dpd_11 %>% rename(DPD = TA110827, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_11 <- dpd_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_11$DPD <- as.integer(dpd_11$DPD)

dpd_11$Sex <- as.integer(dpd_11$Sex) # character to integer

dpd_11 <- dpd_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_11$FTL <- as.integer(dpd_11$FTL) # character to integer

dpd_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130850 = 9)) 

dpd_13 <- dplyr::select(TIAS, TA130850, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_13 <- na.omit(dpd_13) # removing rows with NA 

dpd_13 <- dpd_13 %>% rename(DPD = TA130850, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_13$DPD <- as.integer(dpd_13$DPD) # integer to numeric

dpd_13 <- dpd_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_13$Sex <- as.integer(dpd_13$Sex) # character to integer

dpd_13 <- dpd_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_13$FTL <- as.integer(dpd_13$FTL) # character to integer

dpd_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150867 = c(8, 9))) 

dpd_15 <- dplyr::select(TIAS, TA150867, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_15 <- na.omit(dpd_15) # removing rows with NA 

dpd_15 <- dpd_15 %>% rename(DPD = TA150867, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_15$DPD <- as.integer(dpd_15$DPD) # integer to numeric

dpd_15 <- dpd_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_15$Sex <- as.integer(dpd_15$Sex) # character to integer

dpd_15 <- dpd_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_15$FTL <- as.integer(dpd_15$FTL) # character to integer

dpd_15$Year <- c(rep(6, 1641)) # adding year  

# =================== 2017 =================== 

dpd_17 <- dplyr::select(TIAS, TA170907, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

dpd_17 <- na.omit(dpd_17) # removing rows with NA 

dpd_17 <- dpd_17 %>% rename(DPD = TA170907, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

dpd_17 <- dpd_17 %>% mutate(DPD = dplyr::recode(DPD, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

dpd_17$DPD <- as.integer(dpd_17$DPD) # integer to numeric

dpd_17 <- dpd_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

dpd_17$Sex <- as.integer(dpd_17$Sex) # character to integer

dpd_17 <- dpd_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

dpd_17$FTL <- as.integer(dpd_17$FTL) # character to integer

dpd_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

dpd_df <- rbind(dpd_05, dpd_07, dpd_09, dpd_11, dpd_13, dpd_15, dpd_17)

dpd_m1 <- glm(DPD ~ FTL, family = binomial, data = dpd_df)

dpd_m2 <- glm(DPD ~ FTL + Age + Sex + Year, family = binomial, data = dpd_df)

dpd_m3 <- glm(DPD ~ FTL + Age + FTL*Age, family = binomial, data = dpd_df)

dpd_m4 <- glm(DPD ~ FTL + Sex + FTL*Sex, family = binomial, data = dpd_df)

dpd_m5 <- glm(DPD ~ FTL + Year + FTL*Year, family = binomial, data = dpd_df)

dpd_m6 <- glm(DPD ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = dpd_df)

tab_model(dpd_m1, dpd_m2, dpd_m3, dpd_m4, dpd_m5, dpd_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Bipolar Disorder Diagnosis 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050711 = c(8, 9))) 

bip_05 <- dplyr::select(TIAS, TA050711, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_05 <- na.omit(bip_05) # removing rows with NA 

bip_05 <- bip_05 %>% rename(BIP = TA050711, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_05$BIP <- as.integer(bip_05$BIP) # integer to numeric

bip_05 <- bip_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_05$Sex <- as.integer(bip_05$Sex) # character to integer

bip_05 <- bip_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_05$FTL <- as.integer(bip_05$FTL) # character to integer

bip_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

bip_07 <- dplyr::select(TIAS, TA070682, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_07 <- na.omit(bip_07) # removing rows with NA 

bip_07 <- bip_07 %>% rename(BIP = TA070682, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_07$BIP <- as.integer(bip_07$BIP) # integer to numeric

bip_07 <- bip_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_07$Sex <- as.integer(bip_07$Sex) # character to integer

bip_07 <- bip_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_07$FTL <- as.integer(bip_07$FTL) # character to integer

bip_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090738 = 8)) 

bip_09 <- dplyr::select(TIAS, TA090738, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_09 <- na.omit(bip_09) # removing rows with NA 

bip_09 <- bip_09 %>% rename(BIP = TA090738, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_09$BIP <- as.integer(bip_09$BIP) # integer to numeric

bip_09 <- bip_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_09$Sex <- as.integer(bip_09$Sex) # character to integer

bip_09 <- bip_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_09$FTL <- as.integer(bip_09$FTL) # character to integer

bip_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110828 = 8)) 

bip_11 <- dplyr::select(TIAS, TA110828, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_11 <- na.omit(bip_11) # removing rows with NA 

bip_11 <- bip_11 %>% rename(BIP = TA110828, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_11 <- bip_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_11$BIP <- as.integer(bip_11$BIP)

bip_11$Sex <- as.integer(bip_11$Sex) # character to integer

bip_11 <- bip_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_11$FTL <- as.integer(bip_11$FTL) # character to integer

bip_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130851 = 9)) 

bip_13 <- dplyr::select(TIAS, TA130851, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_13 <- na.omit(bip_13) # removing rows with NA 

bip_13 <- bip_13 %>% rename(BIP = TA130851, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_13$BIP <- as.integer(bip_13$BIP) # integer to numeric

bip_13 <- bip_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_13$Sex <- as.integer(bip_13$Sex) # character to integer

bip_13 <- bip_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_13$FTL <- as.integer(bip_13$FTL) # character to integer

bip_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

bip_15 <- dplyr::select(TIAS, TA150868, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_15 <- na.omit(bip_15) # removing rows with NA 

bip_15 <- bip_15 %>% rename(BIP = TA150868, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_15$BIP <- as.integer(bip_15$BIP) # integer to numeric

bip_15 <- bip_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_15$Sex <- as.integer(bip_15$Sex) # character to integer

bip_15 <- bip_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_15$FTL <- as.integer(bip_15$FTL) # character to integer

bip_15$Year <- c(rep(6, 1641)) # adding year  

# =================== 2017 =================== 

bip_17 <- dplyr::select(TIAS, TA170908, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

bip_17 <- na.omit(bip_17) # removing rows with NA 

bip_17 <- bip_17 %>% rename(BIP = TA170908, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

bip_17 <- bip_17 %>% mutate(BIP = dplyr::recode(BIP, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

bip_17$BIP <- as.integer(bip_17$BIP) # integer to numeric

bip_17 <- bip_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

bip_17$Sex <- as.integer(bip_17$Sex) # character to integer

bip_17 <- bip_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

bip_17$FTL <- as.integer(bip_17$FTL) # character to integer

bip_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

bip_df <- rbind(bip_05, bip_07, bip_09, bip_11, bip_13, bip_15, bip_17)

bip_m1 <- glm(BIP ~ FTL, family = binomial, data = bip_df)

bip_m2 <- glm(BIP ~ FTL + Age + Sex + Year, family = binomial, data = bip_df)

bip_m3 <- glm(BIP ~ FTL + Age + FTL*Age, family = binomial, data = bip_df)

bip_m4 <- glm(BIP ~ FTL + Sex + FTL*Sex, family = binomial, data = bip_df)

bip_m5 <- glm(BIP ~ FTL + Year + FTL*Year, family = binomial, data = bip_df)

bip_m6 <- glm(BIP ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = bip_df)

tab_model(bip_m1, bip_m2, bip_m3, bip_m4, bip_m5, bip_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Phobia Diagnosis 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050714 = c(8, 9))) 

phb_05 <- dplyr::select(TIAS, TA050714, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_05 <- na.omit(phb_05) # removing rows with NA 

phb_05 <- phb_05 %>% rename(PHB = TA050714, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_05$PHB <- as.integer(phb_05$PHB) # integer to numeric

phb_05 <- phb_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_05$Sex <- as.integer(phb_05$Sex) # character to integer

phb_05 <- phb_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_05$FTL <- as.integer(phb_05$FTL) # character to integer

phb_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

phb_07 <- dplyr::select(TIAS, TA070685, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_07 <- na.omit(phb_07) # removing rows with NA 

phb_07 <- phb_07 %>% rename(PHB = TA070685, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_07$PHB <- as.integer(phb_07$PHB) # integer to numeric

phb_07 <- phb_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_07$Sex <- as.integer(phb_07$Sex) # character to integer

phb_07 <- phb_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_07$FTL <- as.integer(phb_07$FTL) # character to integer

phb_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090741 = 8)) 

phb_09 <- dplyr::select(TIAS, TA090741, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_09 <- na.omit(phb_09) # removing rows with NA 

phb_09 <- phb_09 %>% rename(PHB = TA090741, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_09$PHB <- as.integer(phb_09$PHB) # integer to numeric

phb_09 <- phb_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_09$Sex <- as.integer(phb_09$Sex) # character to integer

phb_09 <- phb_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_09$FTL <- as.integer(phb_09$FTL) # character to integer

phb_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110831 = 8)) 

phb_11 <- dplyr::select(TIAS, TA110831, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_11 <- na.omit(phb_11) # removing rows with NA 

phb_11 <- phb_11 %>% rename(PHB = TA110831, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_11 <- phb_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_11$PHB <- as.integer(phb_11$PHB)

phb_11$Sex <- as.integer(phb_11$Sex) # character to integer

phb_11 <- phb_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_11$FTL <- as.integer(phb_11$FTL) # character to integer

phb_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130854 = 9)) 

phb_13 <- dplyr::select(TIAS, TA130854, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_13 <- na.omit(phb_13) # removing rows with NA 

phb_13 <- phb_13 %>% rename(PHB = TA130854, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_13$PHB <- as.integer(phb_13$PHB) # integer to numeric

phb_13 <- phb_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_13$Sex <- as.integer(phb_13$Sex) # character to integer

phb_13 <- phb_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_13$FTL <- as.integer(phb_13$FTL) # character to integer

phb_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

phb_15 <- dplyr::select(TIAS, TA150871, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_15 <- na.omit(phb_15) # removing rows with NA 

phb_15 <- phb_15 %>% rename(PHB = TA150871, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_15$PHB <- as.integer(phb_15$PHB) # integer to numeric

phb_15 <- phb_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_15$Sex <- as.integer(phb_15$Sex) # character to integer

phb_15 <- phb_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_15$FTL <- as.integer(phb_15$FTL) # character to integer

phb_15$Year <- c(rep(6, 1641)) # adding year  

# =================== 2017 =================== 

phb_17 <- dplyr::select(TIAS, TA170911, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

phb_17 <- na.omit(phb_17) # removing rows with NA 

phb_17 <- phb_17 %>% rename(PHB = TA170911, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

phb_17 <- phb_17 %>% mutate(PHB = dplyr::recode(PHB, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

phb_17$PHB <- as.integer(phb_17$PHB) # integer to numeric

phb_17 <- phb_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

phb_17$Sex <- as.integer(phb_17$Sex) # character to integer

phb_17 <- phb_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

phb_17$FTL <- as.integer(phb_17$FTL) # character to integer

phb_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

phb_df <- rbind(phb_05, phb_07, phb_09, phb_11, phb_13, phb_15, phb_17)

phb_m1 <- glm(PHB ~ FTL, family = binomial, data = phb_df)

phb_m2 <- glm(PHB ~ FTL + Age + Sex + Year, family = binomial, data = phb_df)

phb_m3 <- glm(PHB ~ FTL + Age + FTL*Age, family = binomial, data = phb_df)

phb_m4 <- glm(PHB ~ FTL + Sex + FTL*Sex, family = binomial, data = phb_df)

phb_m5 <- glm(PHB ~ FTL + Year + FTL*Year, family = binomial, data = phb_df)

phb_m6 <- glm(PHB ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = phb_df)

tab_model(phb_m1, phb_m2, phb_m3, phb_m4, phb_m5, phb_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Anxiety Disorders Diagnosis 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050713 = c(8, 9))) 

anx_05 <- dplyr::select(TIAS, TA050713, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_05 <- na.omit(anx_05) # removing rows with NA 

anx_05 <- anx_05 %>% rename(ANX = TA050713, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_05$ANX <- as.integer(anx_05$ANX) # integer to numeric

anx_05 <- anx_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_05$Sex <- as.integer(anx_05$Sex) # character to integer

anx_05 <- anx_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_05$FTL <- as.integer(anx_05$FTL) # character to integer

anx_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

anx_07 <- dplyr::select(TIAS, TA070684, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_07 <- na.omit(anx_07) # removing rows with NA 

anx_07 <- anx_07 %>% rename(ANX = TA070684, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_07$ANX <- as.integer(anx_07$ANX) # integer to numeric

anx_07 <- anx_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_07$Sex <- as.integer(anx_07$Sex) # character to integer

anx_07 <- anx_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_07$FTL <- as.integer(anx_07$FTL) # character to integer

anx_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090740 = 8)) 

anx_09 <- dplyr::select(TIAS, TA090740, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_09 <- na.omit(anx_09) # removing rows with NA 

anx_09 <- anx_09 %>% rename(ANX = TA090740, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_09$ANX <- as.integer(anx_09$ANX) # integer to numeric

anx_09 <- anx_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_09$Sex <- as.integer(anx_09$Sex) # character to integer

anx_09 <- anx_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_09$FTL <- as.integer(anx_09$FTL) # character to integer

anx_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110830 = 8)) 

anx_11 <- dplyr::select(TIAS, TA110830, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_11 <- na.omit(anx_11) # removing rows with NA 

anx_11 <- anx_11 %>% rename(ANX = TA110830, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_11 <- anx_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_11$ANX <- as.integer(anx_11$ANX)

anx_11$Sex <- as.integer(anx_11$Sex) # character to integer

anx_11 <- anx_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_11$FTL <- as.integer(anx_11$FTL) # character to integer

anx_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130853 = 9)) 

anx_13 <- dplyr::select(TIAS, TA130853, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_13 <- na.omit(anx_13) # removing rows with NA 

anx_13 <- anx_13 %>% rename(ANX = TA130853, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_13$ANX <- as.integer(anx_13$ANX) # integer to numeric

anx_13 <- anx_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_13$Sex <- as.integer(anx_13$Sex) # character to integer

anx_13 <- anx_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_13$FTL <- as.integer(anx_13$FTL) # character to integer

anx_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

anx_15 <- dplyr::select(TIAS, TA150870, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_15 <- na.omit(anx_15) # removing rows with NA 

anx_15 <- anx_15 %>% rename(ANX = TA150870, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_15$ANX <- as.integer(anx_15$ANX) # integer to numeric

anx_15 <- anx_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_15$Sex <- as.integer(anx_15$Sex) # character to integer

anx_15 <- anx_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_15$FTL <- as.integer(anx_15$FTL) # character to integer

anx_15$Year <- c(rep(6, 1641)) # adding year  

# =================== 2017 =================== 

anx_17 <- dplyr::select(TIAS, TA170910, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

anx_17 <- na.omit(anx_17) # removing rows with NA 

anx_17 <- anx_17 %>% rename(ANX = TA170910, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

anx_17 <- anx_17 %>% mutate(ANX = dplyr::recode(ANX, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

anx_17$ANX <- as.integer(anx_17$ANX) # integer to numeric

anx_17 <- anx_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

anx_17$Sex <- as.integer(anx_17$Sex) # character to integer

anx_17 <- anx_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

anx_17$FTL <- as.integer(anx_17$FTL) # character to integer

anx_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

anx_df <- rbind(anx_05, anx_07, anx_09, anx_11, anx_13, anx_15, anx_17)

anx_m1 <- glm(ANX ~ FTL, family = binomial, data = anx_df)

anx_m2 <- glm(ANX ~ FTL + Age + Sex + Year, family = binomial, data = anx_df)

anx_m3 <- glm(ANX ~ FTL + Age + FTL*Age, family = binomial, data = anx_df)

anx_m4 <- glm(ANX ~ FTL + Sex + FTL*Sex, family = binomial, data = anx_df)

anx_m5 <- glm(ANX ~ FTL + Year + FTL*Year, family = binomial, data = anx_df)

anx_m6 <- glm(ANX ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = anx_df)

tab_model(anx_m1, anx_m2, anx_m3, anx_m4, anx_m5, anx_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## OCD Diagnosis 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050717 = c(8, 9))) 

ocd_05 <- dplyr::select(TIAS, TA050717, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_05 <- na.omit(ocd_05) # removing rows with NA 

ocd_05 <- ocd_05 %>% rename(OCD = TA050717, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_05$OCD <- as.integer(ocd_05$OCD) # integer to numeric

ocd_05 <- ocd_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_05$Sex <- as.integer(ocd_05$Sex) # character to integer

ocd_05 <- ocd_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_05$FTL <- as.integer(ocd_05$FTL) # character to integer

ocd_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

ocd_07 <- dplyr::select(TIAS, TA070688, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_07 <- na.omit(ocd_07) # removing rows with NA 

ocd_07 <- ocd_07 %>% rename(OCD = TA070688, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_07$OCD <- as.integer(ocd_07$OCD) # integer to numeric

ocd_07 <- ocd_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_07$Sex <- as.integer(ocd_07$Sex) # character to integer

ocd_07 <- ocd_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_07$FTL <- as.integer(ocd_07$FTL) # character to integer

ocd_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090744 = 8)) 

ocd_09 <- dplyr::select(TIAS, TA090744, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_09 <- na.omit(ocd_09) # removing rows with NA 

ocd_09 <- ocd_09 %>% rename(OCD = TA090744, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_09$OCD <- as.integer(ocd_09$OCD) # integer to numeric

ocd_09 <- ocd_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_09$Sex <- as.integer(ocd_09$Sex) # character to integer

ocd_09 <- ocd_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_09$FTL <- as.integer(ocd_09$FTL) # character to integer

ocd_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110834 = 8)) 

ocd_11 <- dplyr::select(TIAS, TA110834, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_11 <- na.omit(ocd_11) # removing rows with NA 

ocd_11 <- ocd_11 %>% rename(OCD = TA110834, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_11 <- ocd_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_11$OCD <- as.integer(ocd_11$OCD)

ocd_11$Sex <- as.integer(ocd_11$Sex) # character to integer

ocd_11 <- ocd_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_11$FTL <- as.integer(ocd_11$FTL) # character to integer

ocd_11$Year <- c(rep(4, 1905)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130857 = 9)) 

ocd_13 <- dplyr::select(TIAS, TA130857, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_13 <- na.omit(ocd_13) # removing rows with NA 

ocd_13 <- ocd_13 %>% rename(OCD = TA130857, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_13$OCD <- as.integer(ocd_13$OCD) # integer to numeric

ocd_13 <- ocd_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_13$Sex <- as.integer(ocd_13$Sex) # character to integer

ocd_13 <- ocd_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_13$FTL <- as.integer(ocd_13$FTL) # character to integer

ocd_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

ocd_15 <- dplyr::select(TIAS, TA150874, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_15 <- na.omit(ocd_15) # removing rows with NA 

ocd_15 <- ocd_15 %>% rename(OCD = TA150874, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_15$OCD <- as.integer(ocd_15$OCD) # integer to numeric

ocd_15 <- ocd_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_15$Sex <- as.integer(ocd_15$Sex) # character to integer

ocd_15 <- ocd_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_15$FTL <- as.integer(ocd_15$FTL) # character to integer

ocd_15$Year <- c(rep(6, 1641)) # adding year  

# =================== 2017 =================== 

ocd_17 <- dplyr::select(TIAS, TA170914, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

ocd_17 <- na.omit(ocd_17) # removing rows with NA 

ocd_17 <- ocd_17 %>% rename(OCD = TA170914, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

ocd_17 <- ocd_17 %>% mutate(OCD = dplyr::recode(OCD, `0` = "0", `1` = "1", `5` = "0")) # recoding values 

ocd_17$OCD <- as.integer(ocd_17$OCD) # integer to numeric

ocd_17 <- ocd_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

ocd_17$Sex <- as.integer(ocd_17$Sex) # character to integer

ocd_17 <- ocd_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

ocd_17$FTL <- as.integer(ocd_17$FTL) # character to integer

ocd_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

ocd_df <- rbind(ocd_05, ocd_07, ocd_09, ocd_11, ocd_13, ocd_15, ocd_17)

ocd_m1 <- glm(OCD ~ FTL, family = binomial, data = ocd_df)

ocd_m2 <- glm(OCD ~ FTL + Age + Sex + Year, family = binomial, data = ocd_df)

ocd_m3 <- glm(OCD ~ FTL + Age + FTL*Age, family = binomial, data = ocd_df)

ocd_m4 <- glm(OCD ~ FTL + Sex + FTL*Sex, family = binomial, data = ocd_df)

ocd_m5 <- glm(OCD ~ FTL + Year + FTL*Year, family = binomial, data = ocd_df)

ocd_m6 <- glm(OCD ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = ocd_df)

tab_model(ocd_m1, ocd_m2, ocd_m3, ocd_m4, ocd_m5, ocd_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Non-Specific Psychological Distress

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050938 = 99)) # removing NA value for NPD scale 

npd_05 <- dplyr::select(TIAS, TA050938, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_05 <- na.omit(npd_05) # removing rows with NA 

npd_05 <- npd_05 %>% rename(NPD = TA050938, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_05 <- npd_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 
                          
npd_05$Sex <- as.integer(npd_05$Sex) # character to integer

npd_05 <- npd_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_05$FTL <- as.integer(npd_05$FTL) # character to integer

npd_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070919 = 99)) # removing NA value for NPD scale 

npd_07 <- dplyr::select(TIAS, TA070919, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_07 <- na.omit(npd_07) # removing rows with NA 

npd_07 <- npd_07 %>% rename(NPD = TA070919, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_07 <- npd_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_07$Sex <- as.integer(npd_07$Sex) # character to integer

npd_07 <- npd_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_07$FTL <- as.integer(npd_07$FTL) # character to integer

npd_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090983 = 99)) # removing NA value for NPD scale 

npd_09 <- dplyr::select(TIAS, TA090983, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_09 <- na.omit(npd_09) # removing rows with NA 

npd_09 <- npd_09 %>% rename(NPD = TA090983, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_09 <- npd_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_09$Sex <- as.integer(npd_09$Sex) # character to integer

npd_09 <- npd_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_09$FTL <- as.integer(npd_09$FTL) # character to integer

npd_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

npd_11 <- dplyr::select(TIAS, TA111125, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_11 <- na.omit(npd_11) # removing rows with NA 

npd_11 <- npd_11 %>% rename(NPD = TA111125, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_11 <- npd_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_11$Sex <- as.integer(npd_11$Sex) # character to integer

npd_11 <- npd_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_11$FTL <- as.integer(npd_11$FTL) # character to integer

npd_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131217 = 99)) # removing NA value for NPD scale 

npd_13 <- dplyr::select(TIAS, TA131217, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_13 <- na.omit(npd_13) # removing rows with NA 

npd_13 <- npd_13 %>% rename(NPD = TA131217, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_13 <- npd_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_13$Sex <- as.integer(npd_13$Sex) # character to integer

npd_13 <- npd_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_13$FTL <- as.integer(npd_13$FTL) # character to integer

npd_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151277 = 99)) # removing NA value for NPD scale 

npd_15 <- dplyr::select(TIAS, TA151277, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_15 <- na.omit(npd_15) # removing rows with NA 

npd_15 <- npd_15 %>% rename(NPD = TA151277, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_15 <- npd_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_15$Sex <- as.integer(npd_15$Sex) # character to integer

npd_15 <- npd_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_15$FTL <- as.integer(npd_15$FTL) # character to integer

npd_15$Year <- c(rep(6, 1636)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171975 = 99)) # removing NA value for NPD scale 

npd_17 <- dplyr::select(TIAS, TA171975, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_17 <- na.omit(npd_17) # removing rows with NA 

npd_17 <- npd_17 %>% rename(NPD = TA171975, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_17 <- npd_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_17$Sex <- as.integer(npd_17$Sex) # character to integer

npd_17 <- npd_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_17$FTL <- as.integer(npd_17$FTL) # character to integer

npd_17$Year <- c(rep(7, 2512)) # adding year 
```

### Regression Results 

```{r, warning=FALSE, message = FALSE}

# multivariate linear regression 

npd_df <- rbind(npd_05, npd_07, npd_09, npd_11, npd_13, npd_15, npd_17)

npd_m1 <- lm(NPD ~ FTL, data = npd_df)

npd_m2 <- lm(NPD ~ FTL + Age + Sex + Year, data = npd_df)

npd_m3 <- lm(NPD ~ FTL + Age + FTL*Age, data = npd_df)

npd_m4 <- lm(NPD ~ FTL + Sex + FTL*Sex, data = npd_df)

npd_m5 <- lm(NPD ~ FTL + Year + FTL*Year, data = npd_df)

npd_m6 <- lm(NPD ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = npd_df)

tab_model(npd_m1, npd_m2, npd_m3, npd_m4, npd_m5, npd_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")

```

## Mental Health: Social Anxiety 

```{r}
# =================== 2005 ===================  

soa_05 <- dplyr::select(TIAS, TA050933, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_05 <- na.omit(soa_05) # removing rows with NA 

soa_05 <- soa_05 %>% rename(SOA = TA050933, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_05 <- soa_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_05$Sex <- as.integer(soa_05$Sex) # character to integer

soa_05 <- soa_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_05$FTL <- as.integer(soa_05$FTL) # character to integer

soa_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

soa_07 <- dplyr::select(TIAS, TA070914, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_07 <- na.omit(soa_07) # removing rows with NA 

soa_07 <- soa_07 %>% rename(SOA = TA070914, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_07 <- soa_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_07$Sex <- as.integer(soa_07$Sex) # character to integer

soa_07 <- soa_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_07$FTL <- as.integer(soa_07$FTL) # character to integer

soa_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

soa_09 <- dplyr::select(TIAS, TA090978, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_09 <- na.omit(soa_09) # removing rows with NA 

soa_09 <- soa_09 %>% rename(SOA = TA090978, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_09 <- soa_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_09$Sex <- as.integer(soa_09$Sex) # character to integer

soa_09 <- soa_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_09$FTL <- as.integer(soa_09$FTL) # character to integer

soa_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

soa_11 <- dplyr::select(TIAS, TA111120, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_11 <- na.omit(soa_11) # removing rows with NA 

soa_11 <- soa_11 %>% rename(SOA = TA111120, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_11 <- soa_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_11$Sex <- as.integer(soa_11$Sex) # character to integer

soa_11 <- soa_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_11$FTL <- as.integer(soa_11$FTL) # character to integer

soa_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

soa_13 <- dplyr::select(TIAS, TA131212, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_13 <- na.omit(soa_13) # removing rows with NA 

soa_13 <- soa_13 %>% rename(SOA = TA131212, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_13 <- soa_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_13$Sex <- as.integer(soa_13$Sex) # character to integer

soa_13 <- soa_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_13$FTL <- as.integer(soa_13$FTL) # character to integer

soa_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

soa_15 <- dplyr::select(TIAS, TA151272, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_15 <- na.omit(soa_15) # removing rows with NA 

soa_15 <- soa_15 %>% rename(SOA = TA151272, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_15 <- soa_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_15$Sex <- as.integer(soa_15$Sex) # character to integer

soa_15 <- soa_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_15$FTL <- as.integer(soa_15$FTL) # character to integer

soa_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

soa_17 <- dplyr::select(TIAS, TA171971, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

soa_17 <- na.omit(soa_17) # removing rows with NA 

soa_17 <- soa_17 %>% rename(SOA = TA171971, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

soa_17 <- soa_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

soa_17$Sex <- as.integer(soa_17$Sex) # character to integer

soa_17 <- soa_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

soa_17$FTL <- as.integer(soa_17$FTL) # character to integer

soa_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# multivariate linear regression 

soa_df <- rbind(soa_05, soa_07, soa_09, soa_11, soa_13, soa_15, soa_17)

soa_m1 <- lm(SOA ~ FTL, data = soa_df)

soa_m2 <- lm(SOA ~ FTL + Age + Sex + Year, data = soa_df)

soa_m3 <- lm(SOA ~ FTL + Age + FTL*Age, data = soa_df)

soa_m4 <- lm(SOA ~ FTL + Sex + FTL*Sex, data = soa_df)

soa_m5 <- lm(SOA ~ FTL + Year + FTL*Year, data = soa_df)

soa_m6 <- lm(SOA ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = soa_df)

tab_model(soa_m1, soa_m2, soa_m3, soa_m4, soa_m5, soa_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Paid Employment Since Jan 1 of Prior Year 

```{r}
# =================== 2005 ===================  

epj_05 <- dplyr::select(TIAS, TA050131, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_05 <- na.omit(epj_05) # removing rows with NA 

epj_05 <- epj_05 %>% rename(EPJ = TA050131, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_05 <- epj_05 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_05$EPJ <- as.integer(epj_05$EPJ) # integer to numeric

epj_05 <- epj_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_05$Sex <- as.integer(epj_05$Sex) # character to integer

epj_05 <- epj_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_05$FTL <- as.integer(epj_05$FTL) # character to integer

epj_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

epj_07 <- dplyr::select(TIAS, TA070131, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_07 <- na.omit(epj_07) # removing rows with NA 

epj_07 <- epj_07 %>% rename(EPJ = TA070131, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_07 <- epj_07 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_07$EPJ <- as.integer(epj_07$EPJ) # integer to numeric

epj_07 <- epj_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_07$Sex <- as.integer(epj_07$Sex) # character to integer

epj_07 <- epj_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_07$FTL <- as.integer(epj_07$FTL) # character to integer

epj_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

epj_09 <- dplyr::select(TIAS, TA090140, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_09 <- na.omit(epj_09) # removing rows with NA 

epj_09 <- epj_09 %>% rename(EPJ = TA090140, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_09 <- epj_09 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_09$EPJ <- as.integer(epj_09$EPJ) # integer to numeric

epj_09 <- epj_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_09$Sex <- as.integer(epj_09$Sex) # character to integer

epj_09 <- epj_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_09$FTL <- as.integer(epj_09$FTL) # character to integer

epj_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110141 = 8)) 

epj_11 <- dplyr::select(TIAS, TA110141, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_11 <- na.omit(epj_11) # removing rows with NA 

epj_11 <- epj_11 %>% rename(EPJ = TA110141, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_11 <- epj_11 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_11 <- epj_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_11$EPJ <- as.integer(epj_11$EPJ)

epj_11$Sex <- as.integer(epj_11$Sex) # character to integer

epj_11 <- epj_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_11$FTL <- as.integer(epj_11$FTL) # character to integer

epj_11$Year <- c(rep(4, 1906)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130140 = c(8, 9))) 

epj_13 <- dplyr::select(TIAS, TA130140, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_13 <- na.omit(epj_13) # removing rows with NA 

epj_13 <- epj_13 %>% rename(EPJ = TA130140, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_13 <- epj_13 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_13$EPJ <- as.integer(epj_13$EPJ) # integer to numeric

epj_13 <- epj_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_13$Sex <- as.integer(epj_13$Sex) # character to integer

epj_13 <- epj_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_13$FTL <- as.integer(epj_13$FTL) # character to integer

epj_13$Year <- c(rep(5, 1801)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150132 = c(8, 9))) 

epj_15 <- dplyr::select(TIAS, TA150132, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_15 <- na.omit(epj_15) # removing rows with NA 

epj_15 <- epj_15 %>% rename(EPJ = TA150132, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_15 <- epj_15 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_15$EPJ <- as.integer(epj_15$EPJ) # integer to numeric

epj_15 <- epj_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_15$Sex <- as.integer(epj_15$Sex) # character to integer

epj_15 <- epj_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_15$FTL <- as.integer(epj_15$FTL) # character to integer

epj_15$Year <- c(rep(6, 1639)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170187 = 9)) 

epj_17 <- dplyr::select(TIAS, TA170187, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

epj_17 <- na.omit(epj_17) # removing rows with NA 

epj_17 <- epj_17 %>% rename(EPJ = TA170187, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

epj_17 <- epj_17 %>% mutate(EPJ = dplyr::recode(EPJ, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

epj_17$EPJ <- as.integer(epj_17$EPJ) # integer to numeric

epj_17 <- epj_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

epj_17$Sex <- as.integer(epj_17$Sex) # character to integer

epj_17 <- epj_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

epj_17$FTL <- as.integer(epj_17$FTL) # character to integer

epj_17$Year <- c(rep(7, 2524)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

epj_df <- rbind(epj_05, epj_07, epj_09, epj_11, epj_13, epj_15, epj_17)

epj_m1 <- glm(EPJ ~ FTL, family = binomial, data = epj_df)

epj_m2 <- glm(EPJ ~ FTL + Age + Sex + Year, family = binomial, data = epj_df)

epj_m3 <- glm(EPJ ~ FTL + Age + FTL*Age, family = binomial, data = epj_df)

epj_m4 <- glm(EPJ ~ FTL + Sex + FTL*Sex, family = binomial, data = epj_df)

epj_m5 <- glm(EPJ ~ FTL + Year + FTL*Year, family = binomial, data = epj_df)

epj_m6 <- glm(EPJ ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = epj_df)

tab_model(epj_m1, epj_m2, epj_m3, epj_m4, epj_m5, epj_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Paid Employment History 

```{r}
# =================== 2005 ===================  

eph_05 <- dplyr::select(TIAS, TA050368, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_05 <- na.omit(eph_05) # removing rows with NA 

eph_05 <- eph_05 %>% rename(EPH = TA050368, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_05 <- eph_05 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_05$EPH <- as.integer(eph_05$EPH) # integer to numeric

eph_05 <- eph_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_05$Sex <- as.integer(eph_05$Sex) # character to integer

eph_05 <- eph_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_05$FTL <- as.integer(eph_05$FTL) # character to integer

eph_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

eph_07 <- dplyr::select(TIAS, TA070341, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_07 <- na.omit(eph_07) # removing rows with NA 

eph_07 <- eph_07 %>% rename(EPH = TA070341, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_07 <- eph_07 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_07$EPH <- as.integer(eph_07$EPH) # integer to numeric

eph_07 <- eph_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_07$Sex <- as.integer(eph_07$Sex) # character to integer

eph_07 <- eph_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_07$FTL <- as.integer(eph_07$FTL) # character to integer

eph_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090358 = 9)) 

eph_09 <- dplyr::select(TIAS, TA090358, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_09 <- na.omit(eph_09) # removing rows with NA 

eph_09 <- eph_09 %>% rename(EPH = TA090358, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_09 <- eph_09 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_09$EPH <- as.integer(eph_09$EPH) # integer to numeric

eph_09 <- eph_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_09$Sex <- as.integer(eph_09$Sex) # character to integer

eph_09 <- eph_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_09$FTL <- as.integer(eph_09$FTL) # character to integer

eph_09$Year <- c(rep(3, 1552)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110348 = 9)) 

eph_11 <- dplyr::select(TIAS, TA110348, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_11 <- na.omit(eph_11) # removing rows with NA 

eph_11 <- eph_11 %>% rename(EPH = TA110348, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_11 <- eph_11 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_11 <- eph_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_11$EPH <- as.integer(eph_11$EPH)

eph_11$Sex <- as.integer(eph_11$Sex) # character to integer

eph_11 <- eph_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_11$FTL <- as.integer(eph_11$FTL) # character to integer

eph_11$Year <- c(rep(4, 1906)) # adding year

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130347 = 9)) 

eph_13 <- dplyr::select(TIAS, TA130347, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_13 <- na.omit(eph_13) # removing rows with NA 

eph_13 <- eph_13 %>% rename(EPH = TA130347, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_13 <- eph_13 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_13$EPH <- as.integer(eph_13$EPH) # integer to numeric

eph_13 <- eph_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_13$Sex <- as.integer(eph_13$Sex) # character to integer

eph_13 <- eph_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_13$FTL <- as.integer(eph_13$FTL) # character to integer

eph_13$Year <- c(rep(5, 1801)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150349 = 9)) 

eph_15 <- dplyr::select(TIAS, TA150349, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_15 <- na.omit(eph_15) # removing rows with NA 

eph_15 <- eph_15 %>% rename(EPH = TA150349, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_15 <- eph_15 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_15$EPH <- as.integer(eph_15$EPH) # integer to numeric

eph_15 <- eph_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_15$Sex <- as.integer(eph_15$Sex) # character to integer

eph_15 <- eph_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_15$FTL <- as.integer(eph_15$FTL) # character to integer

eph_15$Year <- c(rep(6, 1639)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170386 = 9)) 

eph_17 <- dplyr::select(TIAS, TA170386, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

eph_17 <- na.omit(eph_17) # removing rows with NA 

eph_17 <- eph_17 %>% rename(EPH = TA170386, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

eph_17 <- eph_17 %>% mutate(EPH = dplyr::recode(EPH, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

eph_17$EPH <- as.integer(eph_17$EPH) # integer to numeric

eph_17 <- eph_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

eph_17$Sex <- as.integer(eph_17$Sex) # character to integer

eph_17 <- eph_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

eph_17$FTL <- as.integer(eph_17$FTL) # character to integer

eph_17$Year <- c(rep(7, 2522)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

eph_df <- rbind(eph_05, eph_07, eph_09, eph_11, eph_13, eph_15, eph_17)

eph_m1 <- glm(EPH ~ FTL, family = binomial, data = eph_df)

eph_m2 <- glm(EPH ~ FTL + Age + Sex + Year, family = binomial, data = eph_df)

eph_m3 <- glm(EPH ~ FTL + Age + FTL*Age, family = binomial, data = eph_df)

eph_m4 <- glm(EPH ~ FTL + Sex + FTL*Sex, family = binomial, data = eph_df)

eph_m5 <- glm(EPH ~ FTL + Year + FTL*Year, family = binomial, data = eph_df)

eph_m6 <- glm(EPH ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = eph_df)

tab_model(eph_m1, eph_m2, eph_m3, eph_m4, eph_m5, eph_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Current Marital Status 

```{r}
# =================== 2005 ===================  

cms_05 <- dplyr::select(TIAS, TA050069, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_05 <- na.omit(cms_05) # removing rows with NA 

cms_05 <- cms_05 %>% rename(CMS = TA050069, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_05 <- cms_05 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_05$CMS <- as.factor(cms_05$CMS)

cms_05 <- cms_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_05$Sex <- as.integer(cms_05$Sex) # character to integer

cms_05 <- cms_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_05$FTL <- as.integer(cms_05$FTL) # character to integer

cms_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

cms_07 <- dplyr::select(TIAS, TA070069, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_07 <- na.omit(cms_07) # removing rows with NA 

cms_07 <- cms_07 %>% rename(CMS = TA070069, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_07 <- cms_07 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_07$CMS <- as.factor(cms_07$CMS)

cms_07 <- cms_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_07$Sex <- as.integer(cms_07$Sex) # character to integer

cms_07 <- cms_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_07$FTL <- as.integer(cms_07$FTL) # character to integer

cms_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

cms_09 <- dplyr::select(TIAS, TA090078, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_09 <- na.omit(cms_09) # removing rows with NA 

cms_09 <- cms_09 %>% rename(CMS = TA090078, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_09 <- cms_09 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_09$CMS <- as.factor(cms_09$CMS)

cms_09 <- cms_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_09$Sex <- as.integer(cms_09$Sex) # character to integer

cms_09 <- cms_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_09$FTL <- as.integer(cms_09$FTL) # character to integer

cms_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

cms_11 <- dplyr::select(TIAS, TA110079, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_11 <- na.omit(cms_11) # removing rows with NA 

cms_11 <- cms_11 %>% rename(CMS = TA110079, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_11 <- cms_11 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_11$CMS <- as.factor(cms_11$CMS)

cms_11 <- cms_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_11$Sex <- as.integer(cms_11$Sex) # character to integer

cms_11 <- cms_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_11$FTL <- as.integer(cms_11$FTL) # character to integer

cms_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130078 = 9))  

cms_13 <- dplyr::select(TIAS, TA130078, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_13 <- na.omit(cms_13) # removing rows with NA 

cms_13 <- cms_13 %>% rename(CMS = TA130078, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_13 <- cms_13 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_13$CMS <- as.factor(cms_13$CMS)

cms_13 <- cms_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_13$Sex <- as.integer(cms_13$Sex) # character to integer

cms_13 <- cms_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_13$FTL <- as.integer(cms_13$FTL) # character to integer

cms_13$Year <- c(rep(5, 1799)) # adding year 

# =================== 2015 =================== 

cms_15 <- dplyr::select(TIAS, TA150070, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_15 <- na.omit(cms_15) # removing rows with NA 

cms_15 <- cms_15 %>% rename(CMS = TA150070, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_15 <- cms_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_15 <- cms_15 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_15$CMS <- as.factor(cms_15$CMS)

cms_15$Sex <- as.integer(cms_15$Sex) # character to integer

cms_15 <- cms_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_15$FTL <- as.integer(cms_15$FTL) # character to integer

cms_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170093 = 9))

cms_17 <- dplyr::select(TIAS, TA170093, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

cms_17 <- na.omit(cms_17) # removing rows with NA 

cms_17 <- cms_17 %>% rename(CMS = TA170093, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

cms_17 <- cms_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

cms_17 <- cms_17 %>% mutate(CMS = dplyr::recode(CMS, `1` = "Married", `2` = "Never Married", `3` = "Widowed", `4` = "Divorced", `5` = "Separated")) # recoding values 

cms_17$CMS <- as.factor(cms_17$CMS)

cms_17$Sex <- as.integer(cms_17$Sex) # character to integer

cms_17 <- cms_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

cms_17$FTL <- as.integer(cms_17$FTL) # character to integer

cms_17$Year <- c(rep(7, 2525)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

cms_df <- rbind(cms_05, cms_07, cms_09, cms_11, cms_13, cms_15, cms_17)

cms_m1 <- polr(CMS ~ FTL, data = cms_df, Hess = TRUE)

cms_m2 <- polr(CMS ~ FTL + Age + Sex + Year, data = cms_df, Hess = TRUE)

cms_m3 <- polr(CMS ~ FTL + Age + FTL*Age, data = cms_df, Hess = TRUE)

cms_m4 <- polr(CMS ~ FTL + Sex + FTL*Sex, data = cms_df, Hess = TRUE)

cms_m5 <- polr(CMS ~ FTL + Year + FTL*Year, data = cms_df, Hess = TRUE)

cms_m6 <- polr(CMS ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = cms_df, Hess = TRUE)

tab_model(cms_m1, cms_m2, cms_m3, cms_m4, cms_m5, cms_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Romantic Relationships

```{r}
# =================== 2005 ===================  

rrn_05 <- dplyr::select(TIAS, TA050078, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_05 <- na.omit(rrn_05) # removing rows with NA 

rrn_05 <- rrn_05 %>% rename(RRN = TA050078, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_05 <- rrn_05 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_05$RRN <- as.integer(rrn_05$RRN) # integer to numeric

rrn_05 <- rrn_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_05$Sex <- as.integer(rrn_05$Sex) # character to integer

rrn_05 <- rrn_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_05$FTL <- as.integer(rrn_05$FTL) # character to integer

rrn_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

rrn_07 <- dplyr::select(TIAS, TA070078, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_07 <- na.omit(rrn_07) # removing rows with NA 

rrn_07 <- rrn_07 %>% rename(RRN = TA070078, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_07 <- rrn_07 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_07$RRN <- as.integer(rrn_07$RRN) # integer to numeric

rrn_07 <- rrn_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_07$Sex <- as.integer(rrn_07$Sex) # character to integer

rrn_07 <- rrn_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_07$FTL <- as.integer(rrn_07$FTL) # character to integer

rrn_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

rrn_09 <- dplyr::select(TIAS, TA090087, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_09 <- na.omit(rrn_09) # removing rows with NA 

rrn_09 <- rrn_09 %>% rename(RRN = TA090087, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_09 <- rrn_09 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_09$RRN <- as.integer(rrn_09$RRN) # integer to numeric

rrn_09 <- rrn_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_09$Sex <- as.integer(rrn_09$Sex) # character to integer

rrn_09 <- rrn_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_09$FTL <- as.integer(rrn_09$FTL) # character to integer

rrn_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110088 = 9)) 

rrn_11 <- dplyr::select(TIAS, TA110088, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_11 <- na.omit(rrn_11) # removing rows with NA 

rrn_11 <- rrn_11 %>% rename(RRN = TA110088, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_11 <- rrn_11 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_11 <- rrn_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_11$RRN <- as.integer(rrn_11$RRN)

rrn_11$Sex <- as.integer(rrn_11$Sex) # character to integer

rrn_11 <- rrn_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_11$FTL <- as.integer(rrn_11$FTL) # character to integer

rrn_11$Year <- c(rep(4, 1906)) # adding year

# =================== 2013 =================== 

rrn_13 <- dplyr::select(TIAS, TA130087, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_13 <- na.omit(rrn_13) # removing rows with NA 

rrn_13 <- rrn_13 %>% rename(RRN = TA130087, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_13 <- rrn_13 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_13$RRN <- as.integer(rrn_13$RRN) # integer to numeric

rrn_13 <- rrn_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_13$Sex <- as.integer(rrn_13$Sex) # character to integer

rrn_13 <- rrn_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_13$FTL <- as.integer(rrn_13$FTL) # character to integer

rrn_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9))) 

rrn_15 <- dplyr::select(TIAS, TA150079, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_15 <- na.omit(rrn_15) # removing rows with NA 

rrn_15 <- rrn_15 %>% rename(RRN = TA150079, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_15 <- rrn_15 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_15$RRN <- as.integer(rrn_15$RRN) # integer to numeric

rrn_15 <- rrn_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_15$Sex <- as.integer(rrn_15$Sex) # character to integer

rrn_15 <- rrn_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_15$FTL <- as.integer(rrn_15$FTL) # character to integer

rrn_15$Year <- c(rep(6, 1639)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9))) 

rrn_17 <- dplyr::select(TIAS, TA170116, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

rrn_17 <- na.omit(rrn_17) # removing rows with NA 

rrn_17 <- rrn_17 %>% rename(RRN = TA170116, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

rrn_17 <- rrn_17 %>% mutate(RRN = dplyr::recode(RRN, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

rrn_17$RRN <- as.integer(rrn_17$RRN) # integer to numeric

rrn_17 <- rrn_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

rrn_17$Sex <- as.integer(rrn_17$Sex) # character to integer

rrn_17 <- rrn_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

rrn_17$FTL <- as.integer(rrn_17$FTL) # character to integer

rrn_17$Year <- c(rep(7, 2520)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

rrn_df <- rbind(rrn_05, rrn_07, rrn_09, rrn_11, rrn_13, rrn_15, rrn_17)

rrn_m1 <- glm(RRN ~ FTL, family = binomial, data = rrn_df)

rrn_m2 <- glm(RRN ~ FTL + Age + Sex + Year, family = binomial, data = rrn_df)

rrn_m3 <- glm(RRN ~ FTL + Age + FTL*Age, family = binomial, data = rrn_df)

rrn_m4 <- glm(RRN ~ FTL + Sex + FTL*Sex, family = binomial, data = rrn_df)

rrn_m5 <- glm(RRN ~ FTL + Year + FTL*Year, family = binomial, data = rrn_df)

rrn_m6 <- glm(RRN ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = rrn_df)

tab_model(rrn_m1, rrn_m2, rrn_m3, rrn_m4, rrn_m5, rrn_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## Number of Children 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050091 = 99)) 

chl_05 <- dplyr::select(TIAS, TA050091, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_05 <- na.omit(chl_05) # removing rows with NA 

chl_05 <- chl_05 %>% rename(CHL = TA050091, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_05 <- chl_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_05$Sex <- as.integer(chl_05$Sex) # character to integer

chl_05 <- chl_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_05$FTL <- as.integer(chl_05$FTL) # character to integer

chl_05$Year <- c(rep(1, 744)) # adding year 

# =================== 2007 ===================  

chl_07 <- dplyr::select(TIAS, TA070091, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_07 <- na.omit(chl_07) # removing rows with NA 

chl_07 <- chl_07 %>% rename(CHL = TA070091, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_07 <- chl_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_07$Sex <- as.integer(chl_07$Sex) # character to integer

chl_07 <- chl_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_07$FTL <- as.integer(chl_07$FTL) # character to integer

chl_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

chl_09 <- dplyr::select(TIAS, TA090100, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_09 <- na.omit(chl_09) # removing rows with NA 

chl_09 <- chl_09 %>% rename(CHL = TA090100, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_09 <- chl_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_09$Sex <- as.integer(chl_09$Sex) # character to integer

chl_09 <- chl_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_09$FTL <- as.integer(chl_09$FTL) # character to integer

chl_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

chl_11 <- dplyr::select(TIAS, TA110101, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_11 <- na.omit(chl_11) # removing rows with NA 

chl_11 <- chl_11 %>% rename(CHL = TA110101, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_11 <- chl_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_11$Sex <- as.integer(chl_11$Sex) # character to integer

chl_11 <- chl_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_11$FTL <- as.integer(chl_11$FTL) # character to integer

chl_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130100 = 99)) 

chl_13 <- dplyr::select(TIAS, TA130100, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_13 <- na.omit(chl_13) # removing rows with NA 

chl_13 <- chl_13 %>% rename(CHL = TA130100, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_13 <- chl_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_13$Sex <- as.integer(chl_13$Sex) # character to integer

chl_13 <- chl_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_13$FTL <- as.integer(chl_13$FTL) # character to integer

chl_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

chl_15 <- dplyr::select(TIAS, TA150092, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_15 <- na.omit(chl_15) # removing rows with NA 

chl_15 <- chl_15 %>% rename(CHL = TA150092, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_15 <- chl_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_15$Sex <- as.integer(chl_15$Sex) # character to integer

chl_15 <- chl_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_15$FTL <- as.integer(chl_15$FTL) # character to integer

chl_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170176 = 99)) 

chl_17 <- dplyr::select(TIAS, TA170176, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

chl_17 <- na.omit(chl_17) # removing rows with NA 

chl_17 <- chl_17 %>% rename(CHL = TA170176, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

chl_17 <- chl_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

chl_17$Sex <- as.integer(chl_17$Sex) # character to integer

chl_17 <- chl_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

chl_17$FTL <- as.integer(chl_17$FTL) # character to integer

chl_17$Year <- c(rep(7, 2524)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# multivariate linear regression 

chl_df <- rbind(chl_05, chl_07, chl_09, chl_11, chl_13, chl_15, chl_17)

chl_m1 <- lm(CHL ~ FTL, data = chl_df)

chl_m2 <- lm(CHL ~ FTL + Age + Sex + Year, data = chl_df)

chl_m3 <- lm(CHL ~ FTL + Age + FTL*Age, data = chl_df)

chl_m4 <- lm(CHL ~ FTL + Sex + FTL*Sex, data = chl_df)

chl_m5 <- lm(CHL ~ FTL + Year + FTL*Year, data = chl_df)

chl_m6 <- lm(CHL ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = chl_df)

tab_model(chl_m1, chl_m2, chl_m3, chl_m4, chl_m5, chl_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## High School Education 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050573 = 9)) 

hsg_05 <- dplyr::select(TIAS, TA050573, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_05 <- na.omit(hsg_05) # removing rows with NA 

hsg_05 <- hsg_05 %>% rename(HSG = TA050573, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_05$HSG <- as.factor(hsg_05$HSG)

hsg_05 <- hsg_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_05$Sex <- as.integer(hsg_05$Sex) # character to integer

hsg_05 <- hsg_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_05$FTL <- as.integer(hsg_05$FTL) # character to integer

hsg_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

hsg_07 <- dplyr::select(TIAS, TA070548, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_07 <- na.omit(hsg_07) # removing rows with NA 

hsg_07 <- hsg_07 %>% rename(HSG = TA070548, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_07 <- hsg_07 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_07$HSG <- as.factor(hsg_07$HSG)

hsg_07 <- hsg_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_07$Sex <- as.integer(hsg_07$Sex) # character to integer

hsg_07 <- hsg_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_07$FTL <- as.integer(hsg_07$FTL) # character to integer

hsg_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090590 = 9)) 

hsg_09 <- dplyr::select(TIAS, TA090590, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_09 <- na.omit(hsg_09) # removing rows with NA 

hsg_09 <- hsg_09 %>% rename(HSG = TA090590, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_09$HSG <- as.factor(hsg_09$HSG)

hsg_09 <- hsg_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_09$Sex <- as.integer(hsg_09$Sex) # character to integer

hsg_09 <- hsg_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_09$FTL <- as.integer(hsg_09$FTL) # character to integer

hsg_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110671 = 0))

hsg_11 <- dplyr::select(TIAS, TA110671, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_11 <- na.omit(hsg_11) # removing rows with NA 

hsg_11 <- hsg_11 %>% rename(HSG = TA110671, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_11$HSG <- as.factor(hsg_11$HSG)

hsg_11 <- hsg_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_11$Sex <- as.integer(hsg_11$Sex) # character to integer

hsg_11 <- hsg_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_11$FTL <- as.integer(hsg_11$FTL) # character to integer

hsg_11$Year <- c(rep(4, 1264)) # adding year 

# =================== 2013 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130691 = c(8, 9))) 

hsg_13 <- dplyr::select(TIAS, TA130691, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_13 <- na.omit(hsg_13) # removing rows with NA 

hsg_13 <- hsg_13 %>% rename(HSG = TA130691, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_13$HSG <- as.factor(hsg_13$HSG)

hsg_13 <- hsg_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_13$Sex <- as.integer(hsg_13$Sex) # character to integer

hsg_13 <- hsg_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_13$FTL <- as.integer(hsg_13$FTL) # character to integer

hsg_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150701 = c(0, 9))) 

hsg_15 <- dplyr::select(TIAS, TA150701, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_15 <- na.omit(hsg_15) # removing rows with NA 

hsg_15 <- hsg_15 %>% rename(HSG = TA150701, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_15 <- hsg_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_15$HSG <- as.factor(hsg_15$HSG)

hsg_15$Sex <- as.integer(hsg_15$Sex) # character to integer

hsg_15 <- hsg_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_15$FTL <- as.integer(hsg_15$FTL) # character to integer

hsg_15$Year <- c(rep(6, 930)) # adding year 

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170781 = 0))

hsg_17 <- dplyr::select(TIAS, TA170781, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

hsg_17 <- na.omit(hsg_17) # removing rows with NA 

hsg_17 <- hsg_17 %>% rename(HSG = TA170781, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

hsg_17 <- hsg_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

hsg_05 <- hsg_05 %>% mutate(HSG = dplyr::recode(HSG, `1` = "Graduated from high school", `2` = "Got a GED", `3` = "Neither")) # recoding values 

hsg_17$HSG <- as.factor(hsg_17$HSG)

hsg_17$Sex <- as.integer(hsg_17$Sex) # character to integer

hsg_17 <- hsg_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

hsg_17$FTL <- as.integer(hsg_17$FTL) # character to integer

hsg_17$Year <- c(rep(7, 71)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

hsg_df <- rbind(hsg_05, hsg_07, hsg_09, hsg_11, hsg_13, hsg_15, hsg_17)

hsg_m1 <- polr(HSG ~ FTL, data = hsg_df, Hess = TRUE)

hsg_m2 <- polr(HSG ~ FTL + Age + Sex + Year, data = hsg_df, Hess = TRUE)

hsg_m3 <- polr(HSG ~ FTL + Age + FTL*Age, data = hsg_df, Hess = TRUE)

hsg_m4 <- polr(HSG ~ FTL + Sex + FTL*Sex, data = hsg_df, Hess = TRUE)

hsg_m5 <- polr(HSG ~ FTL + Year + FTL*Year, data = hsg_df, Hess = TRUE)

hsg_m6 <- polr(HSG ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = hsg_df, Hess = TRUE)

tab_model(hsg_m1, hsg_m2, hsg_m3, hsg_m4, hsg_m5, hsg_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## College Education 

```{r}
# =================== 2005 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050594 = 9)) 

clg_05 <- dplyr::select(TIAS, TA050594, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_05 <- na.omit(clg_05) # removing rows with NA 

clg_05 <- clg_05 %>% rename(CLG = TA050594, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_05 <- clg_05 %>% mutate(CLG = dplyr::recode(CLG, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_05$CLG <- as.integer(clg_05$CLG) # integer to numeric

clg_05 <- clg_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_05$Sex <- as.integer(clg_05$Sex) # character to integer

clg_05 <- clg_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_05$FTL <- as.integer(clg_05$FTL) # character to integer

clg_05$Year <- c(rep(1, 744)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070569 = c(8, 9)))

clg_07 <- dplyr::select(TIAS, TA070569, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_07 <- na.omit(clg_07) # removing rows with NA 

clg_07 <- clg_07 %>% rename(CLG = TA070569, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_07 <- clg_07 %>% mutate(CLG = dplyr::recode(CLG, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_07$CLG <- as.integer(clg_07$CLG) # integer to numeric

clg_07 <- clg_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_07$Sex <- as.integer(clg_07$Sex) # character to integer

clg_07 <- clg_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_07$FTL <- as.integer(clg_07$FTL) # character to integer

clg_07$Year <- c(rep(2, 1113)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090611 = 9)) 

clg_09 <- dplyr::select(TIAS, TA090611, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_09 <- na.omit(clg_09) # removing rows with NA 

clg_09 <- clg_09 %>% rename(CLG = TA090611, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_09 <- clg_09 %>% mutate(CLG = dplyr::recode(CLG, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_09$CLG <- as.integer(clg_09$CLG) # integer to numeric

clg_09 <- clg_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_09$Sex <- as.integer(clg_09$Sex) # character to integer

clg_09 <- clg_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_09$FTL <- as.integer(clg_09$FTL) # character to integer

clg_09$Year <- c(rep(3, 1549)) # adding year 

# =================== 2011 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110698 = 9)) 

clg_11 <- dplyr::select(TIAS, TA110698, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_11 <- na.omit(clg_11) # removing rows with NA 

clg_11 <- clg_11 %>% rename(CLG = TA110698, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_11 <- clg_11 %>% mutate(CLG = dplyr::recode(CLG, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_11 <- clg_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_11$CLG <- as.integer(clg_11$CLG)

clg_11$Sex <- as.integer(clg_11$Sex) # character to integer

clg_11 <- clg_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_11$FTL <- as.integer(clg_11$FTL) # character to integer

clg_11$Year <- c(rep(4, 1906)) # adding year

# =================== 2013 =================== 

clg_13 <- dplyr::select(TIAS, TA130718, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_13 <- na.omit(clg_13) # removing rows with NA 

clg_13 <- clg_13 %>% rename(CLG = TA130718, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_13 <- clg_13 %>% mutate(CLG = dplyr::recode(CLG, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_13$CLG <- as.integer(clg_13$CLG) # integer to numeric

clg_13 <- clg_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_13$Sex <- as.integer(clg_13$Sex) # character to integer

clg_13 <- clg_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_13$FTL <- as.integer(clg_13$FTL) # character to integer

clg_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9))) 

clg_15 <- dplyr::select(TIAS, TA150079, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_15 <- na.omit(clg_15) # removing rows with NA 

clg_15 <- clg_15 %>% rename(clg = TA150079, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_15 <- clg_15 %>% mutate(clg = dplyr::recode(clg, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_15$clg <- as.integer(clg_15$clg) # integer to numeric

clg_15 <- clg_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_15$Sex <- as.integer(clg_15$Sex) # character to integer

clg_15 <- clg_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_15$FTL <- as.integer(clg_15$FTL) # character to integer

clg_15$Year <- c(rep(6, 1639)) # adding year  

# =================== 2017 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9))) 

clg_17 <- dplyr::select(TIAS, TA170116, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

clg_17 <- na.omit(clg_17) # removing rows with NA 

clg_17 <- clg_17 %>% rename(clg = TA170116, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

clg_17 <- clg_17 %>% mutate(clg = dplyr::recode(clg, `0` = "1", `1` = "1", `5` = "0")) # recoding values 

clg_17$clg <- as.integer(clg_17$clg) # integer to numeric

clg_17 <- clg_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

clg_17$Sex <- as.integer(clg_17$Sex) # character to integer

clg_17 <- clg_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

clg_17$FTL <- as.integer(clg_17$FTL) # character to integer

clg_17$Year <- c(rep(7, 2520)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# binary logistic regression 

clg_df <- rbind(clg_05, clg_07, clg_09, clg_11, clg_13, clg_15, clg_17)

clg_m1 <- glm(clg ~ FTL, family = binomial, data = clg_df)

clg_m2 <- glm(clg ~ FTL + Age + Sex + Year, family = binomial, data = clg_df)

clg_m3 <- glm(clg ~ FTL + Age + FTL*Age, family = binomial, data = clg_df)

clg_m4 <- glm(clg ~ FTL + Sex + FTL*Sex, family = binomial, data = clg_df)

clg_m5 <- glm(clg ~ FTL + Year + FTL*Year, family = binomial, data = clg_df)

clg_m6 <- glm(clg ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, family = binomial, data = clg_df)

tab_model(clg_m1, clg_m2, clg_m3, clg_m4, clg_m5, clg_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```

## MIDUS M1 - Happiness 

```{r}
# =================== 2005 ===================  

M01_05 <- dplyr::select(TIAS, TA050888, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_05 <- na.omit(M01_05) # removing rows with NA 

M01_05 <- M01_05 %>% rename(M01 = TA050888, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_05 <- M01_05 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_05$M01 <- as.factor(M01_05$M01)  

M01_05 <- M01_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_05$Sex <- as.integer(M01_05$Sex) # character to integer

M01_05 <- M01_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_05$FTL <- as.integer(M01_05$FTL) # character to integer

M01_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070869 = 9)) 

M01_07 <- dplyr::select(TIAS, TA070869, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_07 <- na.omit(M01_07) # removing rows with NA 

M01_07 <- M01_07 %>% rename(M01 = TA070869, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_07 <- M01_07 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_07$M01 <- as.factor(M01_07$M01)  

M01_07 <- M01_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_07$Sex <- as.integer(M01_07$Sex) # character to integer

M01_07 <- M01_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_07$FTL <- as.integer(M01_07$FTL) # character to integer

M01_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090929 = 9))

M01_09 <- dplyr::select(TIAS, TA090929, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_09 <- na.omit(M01_09) # removing rows with NA 

M01_09 <- M01_09 %>% rename(M01 = TA090929, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_09 <- M01_09 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_09$M01 <- as.factor(M01_09$M01)  

M01_09 <- M01_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_09$Sex <- as.integer(M01_09$Sex) # character to integer

M01_09 <- M01_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_09$FTL <- as.integer(M01_09$FTL) # character to integer

M01_09$Year <- c(rep(3, 1552)) # adding year 

# =================== 2011 =================== 

M01_11 <- dplyr::select(TIAS, TA111061, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_11 <- na.omit(M01_11) # removing rows with NA 

M01_11 <- M01_11 %>% rename(M01 = TA111061, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_11 <- M01_11 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_11$M01 <- as.factor(M01_11$M01)  

M01_11 <- M01_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_11$Sex <- as.integer(M01_11$Sex) # character to integer

M01_11 <- M01_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_11$FTL <- as.integer(M01_11$FTL) # character to integer

M01_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

M01_13 <- dplyr::select(TIAS, TA131097, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_13 <- na.omit(M01_13) # removing rows with NA 

M01_13 <- M01_13 %>% rename(M01 = TA131097, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_13 <- M01_13 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_13$M01 <- as.factor(M01_13$M01)  

M01_13 <- M01_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_13$Sex <- as.integer(M01_13$Sex) # character to integer

M01_13 <- M01_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_13$FTL <- as.integer(M01_13$FTL) # character to integer

M01_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151137 = c(8, 9))) 

M01_15 <- dplyr::select(TIAS, TA151137, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_15 <- na.omit(M01_15) # removing rows with NA 

M01_15 <- M01_15 %>% rename(M01 = TA151137, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_15 <- M01_15 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_15$M01 <- as.factor(M01_15$M01)  

M01_15 <- M01_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_15$Sex <- as.integer(M01_15$Sex) # character to integer

M01_15 <- M01_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_15$FTL <- as.integer(M01_15$FTL) # character to integer

M01_15$Year <- c(rep(6, 1639)) # adding year 

# =================== 2017 =================== 

M01_17 <- dplyr::select(TIAS, TA170065, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

M01_17 <- na.omit(M01_17) # removing rows with NA 

M01_17 <- M01_17 %>% rename(M01 = TA170065, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

M01_17 <- M01_17 %>% mutate(M01 = dplyr::recode(M01, `1` = "Never", `2` = "Once or twice", `3` = "About once a week", `4` = "Two or three times a week", `5` = "Almost every day", `6` = "Every day")) # recoding values 

M01_17$M01 <- as.factor(M01_17$M01) 

M01_17 <- M01_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

M01_17$Sex <- as.integer(M01_17$Sex) # character to integer

M01_17 <- M01_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

M01_17$FTL <- as.integer(M01_17$FTL) # character to integer

M01_17$Year <- c(rep(7, 2526)) # adding year 
```

### Regression Results

```{r, warning = FALSE, message = FALSE}

# ordinal logistic regression 

M01_df <- rbind(M01_05, M01_07, M01_09, M01_11, M01_13, M01_15, M01_17)

M01_m1 <- polr(M01 ~ FTL, data = M01_df, Hess=TRUE)

M01_m2 <- polr(M01 ~ FTL + Age + Sex + Year, data = M01_df, Hess=TRUE)

M01_m3 <- polr(M01 ~ FTL + Age + FTL*Age, data = M01_df, Hess=TRUE)

M01_m4 <- polr(M01 ~ FTL + Sex + FTL*Sex, data = M01_df, Hess=TRUE)

M01_m5 <- polr(M01 ~ FTL + Year + FTL*Year, data = M01_df, Hess=TRUE)

M01_m6 <- polr(M01 ~ FTL + Age + FTL*Age + FTL*Sex + FTL*Year + Age*Sex + Age*Year + Sex*Year, data = M01_df, Hess=TRUE)

tab_model(M01_m1, M01_m2, M01_m3, M01_m4, M01_m5, M01_m6, 
          dv.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6"), 
          show.ci = FALSE, 
          show.p = TRUE, 
          p.style = "stars")
```













