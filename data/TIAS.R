# There are three ways to collapse/expand sections: 
# (1) Go to the 'Edit' tab, and select 'Folding' to collapse/expand certain sections or collapse/expand all sections 
# (2) Shortcuts: collapse (option + command + L); expand (option + shift + command + L); collapse all (option + command + O); expand all (option + shift + command + O)
# (3) Click on the small upside down triangles to the left of each section marker to collapse/expand each section 

######################## Setup Section ######################## 

# This section downloads the necessary R packages and functions we need to run the analysis and create visuals. 

# clear global environment

rm(list=ls())

# detach all libraries

detachAllPackages <- function() {
  basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
  package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
  package.list <- setdiff(package.list, basic.packages)
  if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()

# function to load libraries

pkgTest <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
  if (length(new.pkg)) 
    install.packages(new.pkg,  dependencies = TRUE)
  sapply(pkg,  require,  character.only = TRUE)
}

# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)

lapply(c("tidyverse"),pkgTest)
lapply(c("ggplot2"), pkgTest)
lapply(c("ggthemes"), pkgTest)
lapply(c("ggpubr"), pkgTest)
lapply(c("naniar"), pkgTest)
lapply(c("DescTools"), pkgTest)
lapply(c("corrplot"), pkgTest)
lapply(c("ResourceSelection"), pkgTest)
lapply(c("lmtest"), pkgTest)
lapply(c("lattice"), pkgTest)
lapply(c("data.table"), pkgTest)
lapply(c("sjPlot"), pkgTest)
lapply(c("sjmisc"), pkgTest)
lapply(c("sjlabelled"), pkgTest)
lapply(c("plyr"), pkgTest)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggpubr)
library(naniar)
library(DescTools)
library(ResourceSelection)
library(lmtest)
library(lattice)
library(data.table)
library(RColorBrewer)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(plyr)

# set working directory 

setwd("/Users/carolinelee/Desktop/Lebowitz_Lab/FTL/data")

######################## Isolating TIAS FTL Participants In Waves 2005-2017 ######################## 

# The below code clears your R environment (found on the right side of the console and includes data tables and values). 
# Clearing the environment after you make heatmaps for each wave is important because otherwise the environment gets crowded – it would be hard to find data and values you need from each wave). 

rm(list=ls())

# Import the TIAS data. This dataset was downloaded from the PSID website and includes values for all waves. The raw csv file can be found on github. 

TIAS <- fread("https://raw.githubusercontent.com/carolinelee78/FTL/main/data/raw/PSID/TIAS/TIAS.csv")

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS$PSID_ID <- (TIAS$ER30001 * 1000) + TIAS$ER30002

ALL_PSID_ID <- TIAS$PSID_ID

### TIAS 2005 IAC vs. FTL ============================================================================================================ 

# This selects the data only from the wave of interest, which in this case is 2005.    

TIAS2005 <- TIAS[!is.na(TIAS$TAS05),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2005$CAT <- with(TIAS2005, ifelse(
  TA050042 == 1 & TA050043 %in% c("1", "96") & TA050595 %in% c("5", "0") & TA050946 %in% c("1", "2", "3", "4", "5", "6", "7") & TA050631 %in% c("5", "0") & TA050127 == 3 & TA050769 < 60 & 
    TA050712 == 0 & TA050715 == 0 & TA050711 == 0 & TA050716 == 0 & TA050678 %in% c("3", "5", "7", "0") & TA050785 == 0 & TA050809 == 0 & TA050793 %in% c("0", "1", "2", "3") & TA050777 == 0 & TA050825 == 0 & 
    TA050817 == 0 & TA050798 == 0 & TA050394 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA050091 == 0, "FTL_05", ifelse(
      TA050042 == 1 & TA050043 %in% c("1", "96") & TA050595 %in% c("5", "0") & TA050946 %in% c("1", "2", "3", "4", "5", "6", "7") & TA050631 %in% c("5", "0") & TA050127 == 3 & TA050769 < 60 & 
        TA050712 == 0 & TA050715 == 0 & TA050711 == 0 & TA050716 == 0 & TA050678 %in% c("3", "5", "7", "0") & TA050785 == 0 & TA050809 == 0 & TA050793 %in% c("0", "1", "2", "3") & TA050777 == 0 & TA050825 == 0 & 
        TA050817 == 0 & TA050798 == 0 & TA050394 == 0 & TA050371 == 1 & TA050091 == 0, "FTL_05", "IAC_05")))

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2005$PSID_ID <- (TIAS2005$ER30001 * 1000) + TIAS2005$ER30002

# Before subsetting the data to only include data for the wave of interest, we are adding PSID IDs for each participant

T05_ID <- TIAS2005$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2005 wave 

FTL05_ID <- TIAS2005[TIAS2005$CAT == "FTL_05", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2005 wave 

nrow(FTL05_ID)

# View the number of FTL vs. IAC participants for the 2005 wave 

table(TIAS2005$CAT)

FTL05_ID_VEC <- unname(unlist(FTL05_ID))

# Create a new variable ('CAT_05') for FTL vs. IAC vs. NA (no data) categorization in the 2005 wave 

TIAS$CAT_05 <- with(TIAS, ifelse(
  PSID_ID %in% FTL05_ID_VEC, "FTL_05", ifelse(
    PSID_ID %in% T05_ID, "IAC_05", "NA_05")))

# View the distribution for CAT_05

table(TIAS$CAT_05)

# View the IDs of participants who have been identified as FTL for the 2005 wave 

print(FTL05_ID_VEC)

### TIAS 2007 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2007.    

TIAS2007 <- TIAS[!is.na(TIAS$TAS07),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2007$CAT <- with(TIAS2007, ifelse(
  TA070042 == 1 & TA070043 %in% c("1", "96") & TA070570 %in% c("5", "0") & TA070927 %in% c("1", "2", "3", "4", "5", "6", "7") & TA070602 %in% c("5", "0") & TA070127 == 3 & TA070740 < 60 & 
  TA070683 == 0 & TA070686 == 0 & TA070682 == 0 & TA070687 == 0 & TA070649 %in% c("3", "5", "7", "0") & TA070756 == 0 & TA070777 == 0 & TA070764 %in% c("0", "1", "2", "3") & TA070748 == 0 & TA070793 == 0 & 
  TA070785 == 0 & TA070769 == 0 & TA070368 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA070091 == 0, "FTL_07", ifelse(
      TA070042 == 1 & TA070043 %in% c("1", "96") & TA070570 %in% c("5", "0") & TA070927 %in% c("1", "2", "3", "4", "5", "6", "7") & TA070602 %in% c("5", "0") & TA070127 == 3 & TA070740 < 60 & 
      TA070683 == 0 & TA070686 == 0 & TA070682 == 0 & TA070687 == 0 & TA070649 %in% c("3", "5", "7", "0") & TA070756 == 0 & TA070777 == 0 & TA070764 %in% c("0", "1", "2", "3") & TA070748 == 0 & TA070793 == 0 & 
      TA070785 == 0 & TA070769 == 0 & TA070368 == 0 & TA050371 == 1 & TA070091 == 0, "FTL_07", "IAC_07")))

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2007$PSID_ID <- (TIAS2007$ER30001 * 1000) + TIAS2007$ER30002

# Before subsetting the data to only include data for the wave of interest, we are adding PSID IDs for each participant

T07_ID <- TIAS2007$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2007 wave 

FTL07_ID <- TIAS2007[TIAS2007$CAT == "FTL_07", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2007 wave 

nrow(FTL07_ID)

# View the number of FTL vs. IAC participants for the 2007 wave 

table(TIAS2007$CAT)

FTL07_ID_VEC <- unname(unlist(FTL07_ID))

# Create a new variable ('CAT_07') for FTL vs. IAC vs. NA (no data) categorization in the 2007 wave 

TIAS$CAT_07 <- with(TIAS, ifelse(
  PSID_ID %in% FTL07_ID_VEC, "FTL_07", ifelse(
    PSID_ID %in% T07_ID, "IAC_07", "NA_07")))

# View the distribution for CAT_07

table(TIAS$CAT_07)

# View the IDs of participants who have been identified as FTL for the 2007 wave 

print(FTL07_ID_VEC)

### TIAS 2009 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2009.    

TIAS2009 <- TIAS[!is.na(TIAS$TAS09),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.   

TIAS2009$CAT <- with(TIAS2009, ifelse(
  TA090043 == 1 & TA090044 %in% c("1", "96") & TA090612 %in% c("5", "0") & TA090991 %in% c("1", "2", "3", "4", "5", "6", "7") & TA090655 %in% c("5", "0") & TA090136 == 3 & TA090799 < 60 & 
  TA090739 == 0 & TA090742 == 0 & TA090738 == 0 & TA090743 == 0 & TA090705 %in% c("3", "5", "7", "0") & TA090815 == 0 & TA090836 == 0 & TA090823 %in% c("0", "1", "2", "3") & TA090807 == 0 & TA090852 == 0 & 
  TA090844 == 0 & TA090828 == 0 & TA090385 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA090100 == 0, "FTL_09", ifelse(
      TA090043 == 1 & TA090044 %in% c("1", "96") & TA090612 %in% c("5", "0") & TA090991 %in% c("1", "2", "3", "4", "5", "6", "7") & TA090655 %in% c("5", "0") & TA090136 == 3 & TA090799 < 60 & 
      TA090739 == 0 & TA090742 == 0 & TA090738 == 0 & TA090743 == 0 & TA090705 %in% c("3", "5", "7", "0") & TA090815 == 0 & TA090836 == 0 & TA090823 %in% c("0", "1", "2", "3") & TA090807 == 0 & TA090852 == 0 & 
      TA090844 == 0 & TA090828 == 0 & TA090385 == 0 & TA090361 == 1 & TA090100 == 0, "FTL_09", "IAC_09")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T09_ID <- TIAS2009$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2009$PSID_ID <- (TIAS2009$ER30001 * 1000) + TIAS2009$ER30002

# Extract IDs of participants who have been identified as FTL for the 2009 wave 

FTL09_ID <- TIAS2009[TIAS2009$CAT == "FTL_09", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2009 wave 

length(FTL09_ID)

# View the number of FTL vs. IAC participants for the 2009 wave 

table(TIAS2009$CAT)

FTL09_ID_VEC <- unname(unlist(FTL09_ID))

# Create a new variable ('CAT_09') for FTL vs. IAC vs. NA (no data) categorization in the 2009 wave 

TIAS$CAT_09 <- with(TIAS, ifelse(
  PSID_ID %in% FTL09_ID_VEC, "FTL_09", ifelse(
    PSID_ID %in% T09_ID, "IAC_09", "NA_09")))

# View the distribution for CAT_09

table(TIAS$CAT_09)

# View the IDs of participants who have been identified as FTL for the 2009 wave 

print(FTL09_ID_VEC)

### TIAS 2011 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2011.   

TIAS2011 <- TIAS[!is.na(TIAS$TAS11),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2011$CAT <- with(TIAS2011, ifelse(
  TA110044 == 1 & TA110045 %in% c("1", "96") & TA110699 %in% c("5", "0") & TA111133 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA110743 %in% c("5", "0") & TA110137 == 3 & TA110915 < 60 & 
  TA110829 == 0 & TA110832 == 0 & TA110828 == 0 & TA110833 == 0 & TA110793 %in% c("3", "5", "7", "0") & TA110931 == 0 & TA110952 == 0 & TA110939 %in% c("0", "1", "2", "3") & TA110923 == 0 & TA110968 == 0 & 
  TA110960 == 0 & TA110944 == 0 & TA110462 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA110101 == 0, "FTL_11", ifelse( 
      TA110044 == 1 & TA110045 %in% c("1", "96") & TA110699 %in% c("5", "0") & TA111133 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA110743 %in% c("5", "0") & TA110137 == 3 & TA110915 < 60 & 
      TA110829 == 0 & TA110832 == 0 & TA110828 == 0 & TA110833 == 0 & TA110793 %in% c("3", "5", "7", "0") & TA110931 == 0 & TA110952 == 0 & TA110939 %in% c("0", "1", "2", "3") & TA110923 == 0 & TA110968 == 0 & 
      TA110960 == 0 & TA110944 == 0 & TA110462 == 0 & TA110351 == 1 & TA110101 == 0,  "FTL_11", "IAC_11")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T11_ID <- TIAS2011$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2011 wave 

FTL11_ID <- TIAS2011[TIAS2011$CAT == "FTL_11", "PSID_ID"]

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2011$PSID_ID <- (TIAS2011$ER30001 * 1000) + TIAS2011$ER30002

# Count the number of participants who have been identified as FTL for the 2011 wave 

nrow(FTL11_ID)

# View the number of FTL vs. IAC participants for the 2011 wave 

table(TIAS2011$CAT)

FTL11_ID_VEC <- unname(unlist(FTL11_ID))

# Create a new variable ('CAT_11') for FTL vs. IAC vs. NA (no data) categorization in the 2011 wave 

TIAS$CAT_11 <- with(TIAS, ifelse(
  PSID_ID %in% FTL11_ID_VEC, "FTL_11", ifelse(
    PSID_ID %in% T11_ID, "IAC_11", "NA_11")))

# View the distribution for CAT_11

table(TIAS$CAT_11)

# View the IDs of participants who have been identified as FTL for the 2011 wave 

print(FTL11_ID)

print(FTL11_ID_VEC)

### TIAS 2013 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2013.   

TIAS2013 <- TIAS[!is.na(TIAS$TAS13),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.   

TIAS2013$CAT <- with(TIAS2013, ifelse(
  TA130043 == 1 & TA130044 %in% c("1", "96") & TA130719 %in% c("5", "0") & TA131225 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA130763 %in% c("5", "0") & TA130136 == 3 & TA130948 < 60 & 
    TA130852 == 0 & TA130855 == 0 & TA130851 == 0 & TA130856 == 0 & TA130813 %in% c("3", "5", "7", "0") & TA130964 == 0 & TA130982 == 0 & TA130972 %in% c("0", "1", "2", "3") & TA130956 == 0 & TA131001 == 0 & 
    TA130993 == 0 & TA130977 == 0 & TA130482 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA130100 == 0, "FTL_13", ifelse(
      TA130043 == 1 & TA130044 %in% c("1", "96") & TA130719 %in% c("5", "0") & TA131225 %in% c("1", "2", "3", "4", "5", "6", "7") & TA130763 %in% c("5", "0") & TA130136 == 3 & TA130948 < 60 & 
        TA130852 == 0 & TA130855 == 0 & TA130851 == 0 & TA130856 == 0 & TA130813 %in% c("3", "5", "7", "0") & TA130964 == 0 & TA130982 == 0 & TA130972 %in% c("0", "1", "2", "3") & TA130956 == 0 & TA131001 == 0 & 
        TA130993 == 0 & TA130977 == 0 & TA130482 == 0 & TA130350 == 1 & TA130100 == 0, "FTL_13", "IAC_13")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T13_ID <- TIAS2013$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2013$PSID_ID <- (TIAS2013$ER30001 * 1000) + TIAS2013$ER30002

# Extract IDs of participants who have been identified as FTL for the 2013 wave 

FTL13_ID <- TIAS2013[TIAS2013$CAT == "FTL_13", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2013 wave 

nrow(FTL13_ID)

# View the number of FTL vs. IAC participants for the 2013 wave 

table(TIAS2013$CAT)

FTL13_ID_VEC <- unname(unlist(FTL13_ID))

# Create a new variable ('CAT_13') for FTL vs. IAC vs. NA (no data) categorization in the 2013 wave 

TIAS$CAT_13 <- with(TIAS, ifelse(
  PSID_ID %in% FTL13_ID_VEC, "FTL_13", ifelse(
    PSID_ID %in% T13_ID, "IAC_13", "NA_13")))

# View the distribution for CAT_13

table(TIAS$CAT_13)

# View the IDs of participants who have been identified as FTL for the 2013 wave 

print(FTL13_ID_VEC)

### TIAS 2015 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2015.    

TIAS2015 <- TIAS[!is.na(TIAS$TAS15),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables.  

TIAS2015$CAT <- with(TIAS2015, ifelse(
  TA150043 == 1 & TA150044 %in% c("1", "96") & TA150731 %in% c("5", "0") & TA151285 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA150776 %in% c("5", "0") & TA150128 == 3 & TA150970 < 60 & 
  TA150869 == 0 & TA150872 == 0 & TA150868 == 0 & TA150873 == 0 & TA150826 %in% c("3", "5", "7", "0") & TA150986 == 0 & TA151007 == 0 & TA150994 %in% c("0", "1", "2", "3") & TA150978 == 0 & TA151023 == 0 & 
  TA151015 == 0 & TA150999 == 0 & TA150491 %in% c("1", "2", "3", "4", "7", "8", "97", "99") & TA150092 == 0, "FTL_15", ifelse( 
      TA150043 == 1 & TA150044 %in% c("1", "96") & TA150731 %in% c("5", "0") & TA151285 %in% c("1", "2", "3", "4", "5", "6", "7", "96") & TA150776 %in% c("5", "0") & TA150128 == 3 & TA150970 < 60 & 
      TA150869 == 0 & TA150872 == 0 & TA150868 == 0 & TA150873 == 0 & TA150826 %in% c("3", "5", "7", "0") & TA150986 == 0 & TA151007 == 0 & TA150994 %in% c("0", "1", "2", "3") & TA150978 == 0 & TA151023 == 0 & 
      TA151015 == 0 & TA150999 == 0 & TA150491 == 0 & TA150352 == 1 & TA150092 == 0, "FTL_15", "IAC_15")))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T15_ID <- TIAS2015$PSID_ID

# Extract IDs of participants who have been identified as FTL for the 2015 wave 

FTL15_ID <- TIAS2015[TIAS2015$CAT == "FTL_15", "PSID_ID"]

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2015$PSID_ID <- (TIAS2015$ER30001 * 1000) + TIAS2015$ER30002

# Count the number of participants who have been identified as FTL for the 2015 wave 

nrow(FTL15_ID)

# View the number of FTL vs. IAC participants for the 2015 wave 

table(TIAS2015$CAT)

FTL15_ID_VEC <- unname(unlist(FTL15_ID))

# Create a new variable ('CAT_15') for FTL vs. IAC vs. NA (no data) categorization in the 2015 wave 

TIAS$CAT_15 <- with(TIAS, ifelse(
  PSID_ID %in% FTL15_ID_VEC, "FTL_15", ifelse(
    PSID_ID %in% T15_ID, "IAC_15", "NA_15")))

# View the distribution for CAT_15

table(TIAS$CAT_15)

# View the IDs of participants who have been identified as FTL for the 2015 wave 

print(FTL15_ID_VEC)

### TIAS 2017 IAC vs. FTL ============================================================================================================

# This selects the data only from the wave of interest, which in this case is 2017. 

TIAS2017 <- TIAS[!is.na(TIAS$TAS17),]

# Now, we select the variables of interest that filter for participants who meet FTL criteria. See TIAS-C variable table for the names and details of these variables. 

TIAS2017$CAT <- with(TIAS2017, ifelse(
  TA170058 == 1 & TA170059 %in% c("1", "96") & TA170790 %in% c("3", "5") & TA171980 %in% c("1", "2", "3", "4", "5", "6", "7", "95") & TA170416 %in% c("5", "0") & TA170183 == 3 & TA171827 < 60 & 
  TA170909 == 0 & TA170912 == 0 & TA170913 == 0 & TA170866 %in% c("3", "5", "7", "0") & TA171869 == 0 & TA171885 == 0 & TA171835 %in% c("0", "1", "2", "3") & 
  TA171861 == 0 & TA171877 == 0 & TA171893 == 0 & TA171840 == 0 & TA170176 == 0,"FTL_17", "IAC_17"))

# Before subsetting the data to only include data for the wave of interest, we are adding IDs for each row in a new column ('ID') to consistently identify each row (participant).

T17_ID <- TIAS2017$PSID_ID

# We will also add the unique individual identifier ID calculated using the method recommended by PSID researchers 

TIAS2017$PSID_ID <- (TIAS2017$ER30001 * 1000) + TIAS2017$ER30002

# Extract IDs of participants who have been identified as FTL for the 2017 wave 

FTL17_ID <- TIAS2017[TIAS2017$CAT == "FTL_17", "PSID_ID"]

# Count the number of participants who have been identified as FTL for the 2017 wave 

nrow(FTL17_ID)

# View the number of FTL vs. IAC participants for the 2017 wave 

table(TIAS2017$CAT)

FTL17_ID_VEC <- unname(unlist(FTL17_ID))

# Create a new variable ('CAT_17') for FTL vs. IAC vs. NA (no data) categorization in the 2017 wave 

TIAS$CAT_17 <- with(TIAS, ifelse(
  PSID_ID %in% FTL17_ID_VEC, "FTL_17", ifelse(
    PSID_ID %in% T17_ID, "IAC_17", "NA_17")))

# View the distribution for CAT_17

table(TIAS$CAT_17)

# View the IDs of participants who have been identified as FTL for the 2017 wave 

print(FTL17_ID_VEC)

### TIAS FTL Wave Count =========================================================================================================

count.ftlwave <- function(x){
  as.integer(as.logical(x %in% FTL05_ID_VEC)) + as.integer(as.logical(x %in% FTL07_ID_VEC)) + as.integer(as.logical(x %in% FTL09_ID_VEC)) +
    as.integer(as.logical(x %in% FTL11_ID_VEC)) + as.integer(as.logical(x %in% FTL13_ID_VEC)) + as.integer(as.logical(x %in% FTL15_ID_VEC)) + as.integer(as.logical(x %in% FTL17_ID_VEC))
}

PSID_LIST <- lapply(ALL_PSID_ID, count.ftlwave)

TIAS$FTL_COUNT <- unlist(PSID_LIST)

table(TIAS$FTL_COUNT)

TIAS2005 <- TIAS[!is.na(TIAS$TAS05),]

table(TIAS2005$FTL_COUNT)

TIAS2007 <- TIAS[!is.na(TIAS$TAS07),]

table(TIAS2007$FTL_COUNT)

TIAS2009 <- TIAS[!is.na(TIAS$TAS09),]

table(TIAS2009$FTL_COUNT)

TIAS2011 <- TIAS[!is.na(TIAS$TAS11),]

table(TIAS2011$FTL_COUNT)

TIAS2013 <- TIAS[!is.na(TIAS$TAS13),]

table(TIAS2013$FTL_COUNT)

TIAS2015 <- TIAS[!is.na(TIAS$TAS15),]

table(TIAS2015$FTL_COUNT)

TIAS2017 <- TIAS[!is.na(TIAS$TAS17),]

table(TIAS2017$FTL_COUNT)

# Creating a subsetted dataframe including only FTL participants for the 2005 wave 

TIAS2005_FTL <- subset(TIAS, CAT_05 == "FTL_05")

# Creating a subsetted dataframe including only IAC participants for the 2005 wave 

TIAS2005_IAC <- subset(TIAS, CAT_05 == "IAC_05")

# Creating a subsetted dataframe including only FTL participants for the 2007 wave 

TIAS2007_FTL <- subset(TIAS, CAT_07 == "FTL_07")

# Creating a subsetted dataframe including only IAC participants for the 2007 wave 

TIAS2007_IAC <- subset(TIAS, CAT_07 == "IAC_07")

# Creating a subsetted dataframe including only FTL participants for the 2009 wave 

TIAS2009_FTL <- subset(TIAS, CAT_09 == "FTL_09")

# Creating a subsetted dataframe including only IAC participants for the 2009 wave 

TIAS2009_IAC <- subset(TIAS, CAT_09 == "IAC_09")

# Creating a subsetted dataframe including only FTL participants for the 2011 wave 

TIAS2011_FTL <- subset(TIAS, CAT_11 == "FTL_11")

# Creating a subsetted dataframe including only IAC participants for the 2011 wave 

TIAS2011_IAC <- subset(TIAS, CAT_11 == "IAC_11")

# Creating a subsetted dataframe including only FTL participants for the 2013 wave 

TIAS2013_FTL <- subset(TIAS, CAT_13 == "FTL_13")

# Creating a subsetted dataframe including only IAC participants for the 2013 wave 

TIAS2013_IAC <- subset(TIAS, CAT_13 == "IAC_13")

# Creating a subsetted dataframe including only FTL participants for the 2015 wave 

TIAS2015_FTL <- subset(TIAS, CAT_15 == "FTL_15")

# Creating a subsetted dataframe including only IAC participants for the 2015 wave 

TIAS2015_IAC <- subset(TIAS, CAT_15 == "IAC_15")

# Creating a subsetted dataframe including only FTL participants for the 2017 wave 

TIAS2017_FTL <- subset(TIAS, CAT_17 == "FTL_17")

# Creating a subsetted dataframe including only IAC participants for the 2017 wave 

TIAS2017_IAC <- subset(TIAS, CAT_17 == "IAC_17")

ALL_FTL_ID <- c(FTL05_ID_VEC, FTL07_ID_VEC, FTL09_ID_VEC, FTL11_ID_VEC, FTL13_ID_VEC, FTL15_ID_VEC, FTL17_ID_VEC)

length(ALL_FTL_ID)

FTL_ID <- unique(ALL_FTL_ID)

# Creating a variable distinguishing participants who identified as FTL for at least one wave (greater than or equal to 1; GREQ1) vs. who never identified as FTL

TIAS$GREQ1_FTL <- with(TIAS, ifelse(PSID_ID %in% FTL_ID, "FTL", "IAC"))      

TIAS_FTL <- subset(TIAS, GREQ1_FTL == "FTL")

TIAS_IAC <- subset(TIAS, GREQ1_FTL == "IAC")

######################## TIAS-D Analysis - TIAS 2005 ######################## 

### Amphetamine Usage =========================================================================================================== 

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050784)

T05_AMP_FTLW <- TIAS2005[, c("TA050784", "FTL_COUNT")] %>% group_by(TA050784, FTL_COUNT) %>% summarise(Count = n())

T05_AMP_CAT <- TIAS2005[, c("TA050784", "CAT_05")] %>% group_by(TA050784, CAT_05) %>% summarise(Count = n())

head(T05_AMP_CAT, 7)

ggplot(T05_AMP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050784)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))

head(T05_AMP_FTLW, 8)

ggplot(T05_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050784)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050808)

T05_BRB_FTLW <- TIAS2005[, c("TA050808", "FTL_COUNT")] %>% group_by(TA050808, FTL_COUNT) %>% summarise(Count = n())

T05_BRB_CAT <- TIAS2005[, c("TA050808", "CAT_05")] %>% group_by(TA050808, CAT_05) %>% summarise(Count = n())

head(T05_BRB_CAT, 5)

ggplot(T05_BRB_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050808)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "3-5 times", "10-19 times", "40 or more times"))

head(T05_BRB_FTLW, 6)

ggplot(T05_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050808)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "3-5 times", "10-19 times", "40 or more times"))

### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050792)

T05_MAR_FTLW <- TIAS2005[, c("TA050792", "FTL_COUNT")] %>% group_by(TA050792, FTL_COUNT) %>% summarise(Count = n())

T05_MAR_CAT <- TIAS2005[, c("TA050792", "CAT_05")] %>% group_by(TA050792, CAT_05) %>% summarise(Count = n())

head(T05_MAR_CAT, 3)

ggplot(T05_MAR_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050792)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "40 or more times"))

head(T05_MAR_FTLW, 4)

ggplot(T05_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050792)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "40 or more times"))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050776)

T05_DIP_FTLW <- TIAS2005[, c("TA050776", "FTL_COUNT")] %>% group_by(TA050776, FTL_COUNT) %>% summarise(Count = n())

T05_DIP_CAT <- TIAS2005[, c("TA050776", "CAT_05")] %>% group_by(TA050776, CAT_05) %>% summarise(Count = n())

head(T05_DIP_CAT, 3)

ggplot(T05_DIP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050776)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "1-2 times")) 

head(T05_DIP_FTLW, 4)

ggplot(T05_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050776)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "1-2 times")) 
  
### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050824)

T05_STR_FTLW <- TIAS2005[, c("TA050824", "FTL_COUNT")] %>% group_by(TA050824, FTL_COUNT) %>% summarise(Count = n())

T05_STR_CAT <- TIAS2005[, c("TA050824", "CAT_05")] %>% group_by(TA050824, CAT_05) %>% summarise(Count = n())

head(T05_STR_CAT, 3)

ggplot(T05_STR_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050824)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "20-39 times")) 

head(T05_STR_FTLW, 4)

ggplot(T05_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050824)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "20-39 times")) +
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") 

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050816)

T05_TRQ_FTLW <- TIAS2005[, c("TA050816", "FTL_COUNT")] %>% group_by(TA050816, FTL_COUNT) %>% summarise(Count = n())

T05_TRQ_CAT <- TIAS2005[, c("TA050816", "CAT_05")] %>% group_by(TA050816, CAT_05) %>% summarise(Count = n())

head(T05_TRQ_CAT, 6)

ggplot(T05_TRQ_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050816)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

head(T05_TRQ_FTLW, 7)

ggplot(T05_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050816)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA050797)

T05_CCN_FTLW <- TIAS2005[, c("TA050797", "FTL_COUNT")] %>% group_by(TA050797, FTL_COUNT) %>% summarise(Count = n())

T05_CCN_CAT <- TIAS2005[, c("TA050797", "CAT_05")] %>% group_by(TA050797, CAT_05) %>% summarise(Count = n())

head(T05_CCN_CAT, 8)

ggplot(T05_CCN_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050797))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T05_CCN_FTLW, 9)

ggplot(T05_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050797)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA050767)

T05_AAC_FTLW <- TIAS2005[, c("TA050767", "FTL_COUNT")] %>% group_by(TA050767, FTL_COUNT) %>% summarise(Count = n())

T05_AAC_CAT <- TIAS2005[, c("TA050767", "CAT_05")] %>% group_by(TA050767, CAT_05) %>% summarise(Count = n())

head(T05_AAC_CAT, 8)

ggplot(T05_AAC_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050767))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T05_AAC_FTLW, 11)

ggplot(T05_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050767)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA050768)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050768 = 98)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050768 = 98)) 

T05_DAC_FTLW <- TIAS2005[, c("TA050768", "FTL_COUNT")] %>% group_by(TA050768, FTL_COUNT) %>% summarise(Count = n())

T05_DAC_FTLW <- T05_DAC_FTLW[1:18, ]

T05_DAC_CAT <- TIAS2005[, c("TA050768", "CAT_05")] %>% group_by(TA050768, CAT_05) %>% summarise(Count = n())

T05_DAC_CAT <- T05_DAC_CAT[1:16, ]

head(T05_DAC_CAT, 16)

ggplot(T05_DAC_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050768))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
  "9 drinks", "10 drinks", "11 drinks", "12 drinks", "15 drinks", "20 drinks"))

head(T05_DAC_FTLW, 18)

ggplot(T05_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050768)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
  "9 drinks", "10 drinks", "11 drinks", "12 drinks", "15 drinks", "20 drinks"))

### Degree to Which Condition Limits Normal Daily Activities ==================================================================== 

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA050723)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050723 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050723 = 9)) 

T05_DCN_FTLW <- TIAS2005[, c("TA050723", "FTL_COUNT")] %>% group_by(TA050723, FTL_COUNT) %>% summarise(Count = n())

T05_DCN_FTLW <- T05_DCN_FTLW[1:7, ]

T05_DCN_CAT <- TIAS2005[, c("TA050723", "CAT_05")] %>% group_by(TA050723, CAT_05) %>% summarise(Count = n())

T05_DCN_CAT <- T05_DCN_CAT[1:6, ]

head(T05_DCN_CAT, 6)

ggplot(T05_DCN_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050723)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T05_DCN_FTLW, 7)

ggplot(T05_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050723)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050733)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050733 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050733 = 9)) 

T05_DEP_FTLW <- TIAS2005[, c("TA050733", "FTL_COUNT")] %>% group_by(TA050733, FTL_COUNT) %>% summarise(Count = n())

T05_DEP_FTLW <- T05_DEP_FTLW[1:4, ]

T05_DEP_CAT <- TIAS2005[, c("TA050733", "CAT_05")] %>% group_by(TA050733, CAT_05) %>% summarise(Count = n())

T05_DEP_CAT <- T05_DEP_CAT[1:3, ]

head(T05_DEP_CAT, 3)

ggplot(T05_DEP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050733)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

head(T05_DEP_FTLW, 4)

ggplot(T05_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050733)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)

table(TIAS$TA050734)

T05_ANH_FTLW <- TIAS2005[, c("TA050734", "FTL_COUNT")] %>% group_by(TA050734, FTL_COUNT) %>% summarise(Count = n())

T05_ANH_CAT <- TIAS2005[, c("TA050734", "CAT_05")] %>% group_by(TA050734, CAT_05) %>% summarise(Count = n())

head(T05_DEP_CAT, 3)

ggplot(T05_ANH_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050734)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

head(T05_ANH_FTLW, 5)

ggplot(T05_ANH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050734)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA050710)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050710 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050710 = c(8, 9))) 

T05_DPD_FTLW <- TIAS2005[, c("TA050710", "FTL_COUNT")] %>% group_by(TA050710, FTL_COUNT) %>% summarise(Count = n())

T05_DPD_FTLW <- T05_DPD_FTLW[1:4, ]

T05_DPD_CAT <- TIAS2005[, c("TA050710", "CAT_05")] %>% group_by(TA050710, CAT_05) %>% summarise(Count = n())

T05_DPD_CAT <- T05_DPD_CAT[1:3, ]
  
head(T05_DPD_CAT, 3)

ggplot(T05_DPD_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050710)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T05_DPD_FTLW, 4)

ggplot(T05_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050710)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA050711)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050711 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050711 = c(8, 9))) 

T05_BIP_FTLW <- TIAS2005[, c("TA050711", "FTL_COUNT")] %>% group_by(TA050711, FTL_COUNT) %>% summarise(Count = n())

T05_BIP_FTLW <- T05_BIP_FTLW[1:4, ]

T05_BIP_CAT <- TIAS2005[, c("TA050711", "CAT_05")] %>% group_by(TA050711, CAT_05) %>% summarise(Count = n())

T05_BIP_CAT <- T05_BIP_CAT[1:3, ]

head(T05_BIP_CAT, 3)

ggplot(T05_BIP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050711)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T05_BIP_FTLW, 4)

ggplot(T05_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050711)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))



### Phobia Diagnosis ============================================================================================================= 

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA050714)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050714 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050714 = c(8, 9))) 

T05_PHB_FTLW <- TIAS2005[, c("TA050714", "FTL_COUNT")] %>% group_by(TA050714, FTL_COUNT) %>% summarise(Count = n())

T05_PHB_FTLW <- T05_PHB_FTLW[1:4, ]

T05_PHB_CAT <- TIAS2005[, c("TA050714", "CAT_05")] %>% group_by(TA050714, CAT_05) %>% summarise(Count = n())

T05_PHB_CAT <- T05_PHB_CAT[1:3, ]

head(T05_PHB_CAT, 3)

ggplot(T05_PHB_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050714)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T05_PHB_FTLW, 4)

ggplot(T05_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050714)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Anxiety Disorders Diagnosis ================================================================================================== 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA050713)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050713 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050713 = c(8, 9))) 

T05_ANX_FTLW <- TIAS2005[, c("TA050713", "FTL_COUNT")] %>% group_by(TA050713, FTL_COUNT) %>% summarise(Count = n())

T05_ANX_FTLW <- T05_ANX_FTLW[1:4, ]

T05_ANX_CAT <- TIAS2005[, c("TA050713", "CAT_05")] %>% group_by(TA050713, CAT_05) %>% summarise(Count = n())

T05_ANX_CAT <- T05_ANX_CAT[1:3, ]

head(T05_ANX_CAT, 3)

ggplot(T05_ANX_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050713)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T05_ANX_FTLW, 4)

ggplot(T05_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050713)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### OCD Diagnosis ================================================================================================================ 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA050717)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050717 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050717 = c(8, 9))) 

T05_OCD_FTLW <- TIAS2005[, c("TA050717", "FTL_COUNT")] %>% group_by(TA050717, FTL_COUNT) %>% summarise(Count = n())

T05_OCD_FTLW <- T05_OCD_FTLW[1:4, ]

T05_OCD_CAT <- TIAS2005[, c("TA050717", "CAT_05")] %>% group_by(TA050717, CAT_05) %>% summarise(Count = n())

T05_OCD_CAT <- T05_OCD_CAT[1:3, ]

head(T05_OCD_CAT, 3)

ggplot(T05_OCD_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050717)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T05_OCD_FTLW, 4)

ggplot(T05_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050717)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Emotional/Nervous/Psychiatric Problems ======================================================================================= 

###
# H12. WTR Ever Had Emotional/Psych Problems: "Has a doctor or other health professional ever told you that you have or had any emotional, nervous, or psychiatric problems?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
###

table(TIAS$TA050708)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050708 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050708 = 9)) 

T05_ENP_FTLW <- TIAS2005[, c("TA050708", "FTL_COUNT")] %>% group_by(TA050708, FTL_COUNT) %>% summarise(Count = n())

T05_ENP_FTLW <- T05_ENP_FTLW[1:4, ]

T05_ENP_CAT <- TIAS2005[, c("TA050708", "CAT_05")] %>% group_by(TA050708, CAT_05) %>% summarise(Count = n())

T05_ENP_CAT <- T05_ENP_CAT[1:3, ]

head(T05_ENP_CAT, 3)

ggplot(T05_ENP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050708)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

head(T05_ENP_FTLW, 4)

ggplot(T05_ENP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050708)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA050938)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050938 = 99)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050938 = 99)) 

T05_NPD_FTLW <- TIAS2005[, c("TA050938", "FTL_COUNT")] %>% group_by(TA050938, FTL_COUNT) %>% summarise(Count = n())

T05_NPD_FTLW <- T05_NPD_FTLW[1:27, ]

T05_NPD_CAT <- TIAS2005[, c("TA050938", "CAT_05")] %>% group_by(TA050938, CAT_05) %>% summarise(Count = n())

T05_NPD_CAT <- T05_NPD_CAT[1:24, ]

ggplot(T05_NPD_FTLW, aes(x = FTL_COUNT, y = TA050938, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_NPD_CAT, aes(x = CAT_05, y = TA050938, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Mental Health: Social Anxiety ================================================================================================  

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA050933)

T05_SOA_FTLW <- TIAS2005[, c("TA050933", "FTL_COUNT")] %>% group_by(TA050933, FTL_COUNT) %>% summarise(Count = n())

T05_SOA_CAT <- TIAS2005[, c("TA050933", "CAT_05")] %>% group_by(TA050933, CAT_05) %>% summarise(Count = n())

ggplot(T05_SOA_FTLW, aes(x = FTL_COUNT, y = TA050933, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves")) 

ggplot(T05_SOA_CAT, aes(x = CAT_05, y = TA050933, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))  

### Mental Health: Worry ========================================================================================================= 

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA050932)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050932 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050932 = 9)) 

T05_WRY_FTLW <- TIAS2005[, c("TA050932", "FTL_COUNT")] %>% group_by(TA050932, FTL_COUNT) %>% summarise(Count = n())

T05_WRY_FTLW <- T05_WRY_FTLW[1:11, ]

T05_WRY_CAT <- TIAS2005[, c("TA050932", "CAT_05")] %>% group_by(TA050932, CAT_05) %>% summarise(Count = n())

T05_WRY_CAT <- T05_WRY_CAT[1:8, ]

ggplot(T05_WRY_FTLW, aes(x = FTL_COUNT, y = TA050932, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_WRY_CAT, aes(x = CAT_05, y = TA050932, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Paid Employment Since Jan 1 of Prior Year ==================================================================================== 

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA050131)

T05_EPJ_FTLW <- TIAS2005[, c("TA050131", "FTL_COUNT")] %>% group_by(TA050131, FTL_COUNT) %>% summarise(Count = n())

T05_EPJ_CAT <- TIAS2005[, c("TA050131", "CAT_05")] %>% group_by(TA050131, CAT_05) %>% summarise(Count = n())

T05_EPJ_FTLCAT <- TIAS2005_FTL[, c("TA050131", "CAT_05")] %>% group_by(TA050131, CAT_05) %>% summarise(Count = n())

T05_EPJ_IACCAT <- TIAS2005_IAC[, c("TA050131", "CAT_05")] %>% group_by(TA050131, CAT_05) %>% summarise(Count = n())

head(T05_EPJ_CAT, 5)

ggplot(T05_EPJ_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050131)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T05_EPJ_FTLW, 6)

ggplot(T05_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050131)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2005_FTL$TA050131))

epj.pie.ftl.05 <- ggplot(data = T05_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightgoldenrod1", "lightpink"), labels = c("Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050131))

epj.pie.iac.05 <- ggplot(data = T05_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.05, epj.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA050368)

T05_EPH_FTLW <- TIAS2005[, c("TA050368", "FTL_COUNT")] %>% group_by(TA050368, FTL_COUNT) %>% summarise(Count = n())

T05_EPH_CAT <- TIAS2005[, c("TA050368", "CAT_05")] %>% group_by(TA050368, CAT_05) %>% summarise(Count = n())

T05_EPH_FTLCAT <- TIAS2005_FTL[, c("TA050368", "CAT_05")] %>% group_by(TA050368, CAT_05) %>% summarise(Count = n())

T05_EPH_IACCAT <- TIAS2005_IAC[, c("TA050368", "CAT_05")] %>% group_by(TA050368, CAT_05) %>% summarise(Count = n())

head(T05_EPH_CAT, 5)

ggplot(T05_EPH_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050368)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

head(T05_EPH_FTLW, 7)

ggplot(T05_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050368)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2005_FTL$TA050368))

eph.pie.ftl.05 <- ggplot(data = T05_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050368))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050368))

eph.pie.iac.05 <- ggplot(data = T05_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050368))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggpubr::ggarrange(eph.pie.ftl.05, eph.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Current Marital Status ======================================================================================================= 

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050069) 

T05_CMS_FTLW <- TIAS2005[, c("TA050069", "FTL_COUNT")] %>% group_by(TA050069, FTL_COUNT) %>% summarise(Count = n())

T05_CMS_CAT <- TIAS2005[, c("TA050069", "CAT_05")] %>% group_by(TA050069, CAT_05) %>% summarise(Count = n())

head(T05_CMS_CAT, 5)

ggplot(T05_CMS_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue"), labels = c("Married", "Never Married", "Divorced", "Separated"))

head(T05_CMS_FTLW, 6)

ggplot(T05_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue"), labels = c("Married", "Never Married", "Divorced", "Separated"))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA050078)

T05_RRN_FTLW <- TIAS2005[, c("TA050078", "FTL_COUNT")] %>% group_by(TA050078, FTL_COUNT) %>% summarise(Count = n())

T05_RRN_CAT <- TIAS2005[, c("TA050078", "CAT_05")] %>% group_by(TA050078, CAT_05) %>% summarise(Count = n())

T05_RRN_FTLCAT <- TIAS2005_FTL[, c("TA050078", "CAT_05")] %>% group_by(TA050078, CAT_05) %>% summarise(Count = n())

T05_RRN_IACCAT <- TIAS2005_IAC[, c("TA050078", "CAT_05")] %>% group_by(TA050078, CAT_05) %>% summarise(Count = n())

head(T05_RRN_CAT, 5)

ggplot(T05_RRN_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

head(T05_RRN_FTLW, 6)

ggplot(T05_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2005_FTL$TA050078))

rrn.pie.ftl.05 <- ggplot(data = T05_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050078))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkviolet", "deeppink"), labels = c("Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050078))

rrn.pie.iac.05 <- ggplot(data = T05_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050078))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.05, rrn.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Number of Children =========================================================================================================== 

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA050091)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050091 = 99)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050091 = 99)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050091 = 99)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050091 = 99)) 

T05_CHL_FTLW <- TIAS2005[, c("TA050091", "FTL_COUNT")] %>% group_by(TA050091, FTL_COUNT) %>% summarise(Count = n())

T05_CHL_FTLW <- T05_CHL_FTLW[1:7, ]

T05_CHL_CAT <- TIAS2005[, c("TA050091", "CAT_05")] %>% group_by(TA050091, CAT_05) %>% summarise(Count = n())

T05_CHL_CAT <- T05_CHL_CAT[1:6, ]

ggplot(T05_CHL_FTLW, aes(x = FTL_COUNT, y = TA050091, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_CHL_CAT, aes(x = CAT_05, y = TA050091, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050573)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050573 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050573 = 9)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050573 = 9)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050573 = 9)) 

T05_HSG_FTLW <- TIAS2005[, c("TA050573", "FTL_COUNT")] %>% group_by(TA050573, FTL_COUNT) %>% summarise(Count = n())

T05_HSG_FTLW <- T05_HSG_FTLW[1:7, ]

T05_HSG_CAT <- TIAS2005[, c("TA050573", "CAT_05")] %>% group_by(TA050573, CAT_05) %>% summarise(Count = n())

T05_HSG_CAT <- T05_HSG_CAT[1:4, ]

head(T05_HSG_CAT, 4)

ggplot(T05_HSG_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050573)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

head(T05_HSG_FTLW, 7)

ggplot(T05_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050573)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

### College Education ============================================================================================================ 

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA050594)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050594 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050594 = 9)) 

T05_CLG_FTLW <- TIAS2005[, c("TA050594", "FTL_COUNT")] %>% group_by(TA050594, FTL_COUNT) %>% summarise(Count = n())

T05_CLG_FTLW <- T05_CLG_FTLW[1:8, ]

T05_CLG_CAT <- TIAS2005[, c("TA050594", "CAT_05")] %>% group_by(TA050594, CAT_05) %>% summarise(Count = n())

T05_CLG_CAT <- T05_CLG_CAT[1:4, ]

head(T05_CLG_CAT, 4)

ggplot(T05_CLG_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050594)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") +
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

head(T05_CLG_FTLW, 8)

ggplot(T05_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050594)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 99 (NA/DK)
####

table(TIAS$TA050946)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050946 = 99)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050946 = 99)) 

T05_HEL_FTLW <- TIAS2005[, c("TA050946", "FTL_COUNT")] %>% group_by(TA050946, FTL_COUNT) %>% summarise(Count = n())

T05_HEL_FTLW <- T05_HEL_FTLW[1:13, ]

T05_HEL_CAT <- TIAS2005[, c("TA050946", "CAT_05")] %>% group_by(TA050946, CAT_05) %>% summarise(Count = n())

T05_HEL_CAT <- T05_HEL_CAT[1:9, ]

head(T05_HEL_CAT, 9)

ggplot(T05_HEL_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050946))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Enrolled in College, No Prior Degree", 
             "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

head(T05_HEL_FTLW, 13)

ggplot(T05_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050946)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Enrolled in College, No Prior Degree", 
            "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

### Responsibility - Earning Own Living ========================================================================================== 

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050044)

T05_REO_FTLW <- TIAS2005[, c("TA050044", "FTL_COUNT")] %>% group_by(TA050044, FTL_COUNT) %>% summarise(Count = n())

T05_REO_CAT <- TIAS2005[, c("TA050044", "CAT_05")] %>% group_by(TA050044, CAT_05) %>% summarise(Count = n())

T05_REO_FTLCAT <- TIAS2005_FTL[, c("TA050044", "CAT_05")] %>% group_by(TA050044, CAT_05) %>% summarise(Count = n())

T05_REO_IACCAT <- TIAS2005_IAC[, c("TA050044", "CAT_05")] %>% group_by(TA050044, CAT_05) %>% summarise(Count = n())

head(T05_REO_CAT, 7)

ggplot(T05_REO_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050044)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T05_REO_FTLW, 9)

ggplot(T05_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050044)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2005_FTL$TA050044))

reo.pie.ftl.05 <- ggplot(data = T05_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050044))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("deepskyblue", "green3"),
  labels = c("Half of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2005_IAC$TA050044))

reo.pie.iac.05 <- ggplot(data = T05_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050044))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(reo.pie.ftl.05, reo.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Responsibility - Paying Own Rent ============================================================================================= 

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050045)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050045 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050045 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050045 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050045 = 8)) 

T05_POR_FTLW <- TIAS2005[, c("TA050045", "FTL_COUNT")] %>% group_by(TA050045, FTL_COUNT) %>% summarise(Count = n())

T05_POR_FTLW <- T05_POR_FTLW[1:11, ]

T05_POR_CAT <- TIAS2005[, c("TA050045", "CAT_05")] %>% group_by(TA050045, CAT_05) %>% summarise(Count = n())

T05_POR_CAT <- T05_POR_CAT[1:8, ]

T05_POR_FTLCAT <- TIAS2005_FTL[, c("TA050045", "CAT_05")] %>% group_by(TA050045, CAT_05) %>% summarise(Count = n())

T05_POR_IACCAT <- TIAS2005_IAC[, c("TA050045", "CAT_05")] %>% group_by(TA050045, CAT_05) %>% summarise(Count = n())

T05_POR_IACCAT <- T05_POR_IACCAT[1:6, ]

head(T05_POR_CAT, 8)

ggplot(T05_POR_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T05_POR_FTLW, 11)

ggplot(T05_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2005_FTL$TA050045))

por.pie.ftl.05 <- ggplot(data = T05_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

prop.table(table(TIAS2005_IAC$TA050045))

por.pie.iac.05 <- ggplot(data = T05_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.05, por.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Responsibility - Paying Own Bills ============================================================================================ 

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050046)

T05_POB_FTLW <- TIAS2005[, c("TA050046", "FTL_COUNT")] %>% group_by(TA050046, FTL_COUNT) %>% summarise(Count = n())

T05_POB_FTLW <- T05_POB_FTLW[1:11, ]

T05_POB_CAT <- TIAS2005[, c("TA050046", "CAT_05")] %>% group_by(TA050046, CAT_05) %>% summarise(Count = n())

T05_POB_CAT <- T05_POB_CAT[1:8, ]

T05_POB_FTLCAT <- TIAS2005_FTL[, c("TA050046", "CAT_05")] %>% group_by(TA050046, CAT_05) %>% summarise(Count = n())

T05_POB_IACCAT <- TIAS2005_IAC[, c("TA050046", "CAT_05")] %>% group_by(TA050046, CAT_05) %>% summarise(Count = n())

T05_POB_IACCAT <- T05_POB_IACCAT[1:6, ]

head(T05_POB_CAT, 8)

ggplot(T05_POB_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

head(T05_POB_FTLW, 11)

ggplot(T05_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2005_FTL$TA050046))

pob.pie.ftl.05 <- ggplot(data = T05_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

prop.table(table(TIAS2005_IAC$TA050046))

pob.pie.iac.05 <- ggplot(data = T05_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.05, pob.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050047)

T05_RMM_FTLW <- TIAS2005[, c("TA050047", "FTL_COUNT")] %>% group_by(TA050047, FTL_COUNT) %>% summarise(Count = n())

T05_RMM_FTLW <- T05_RMM_FTLW[1:9, ]

T05_RMM_CAT <- TIAS2005[, c("TA050047", "CAT_05")] %>% group_by(TA050047, CAT_05) %>% summarise(Count = n())

T05_RMM_CAT <- T05_RMM_CAT[1:7, ]

T05_RMM_FTLCAT <- TIAS2005_FTL[, c("TA050047", "CAT_05")] %>% group_by(TA050047, CAT_05) %>% summarise(Count = n())

T05_RMM_IACCAT <- TIAS2005_IAC[, c("TA050047", "CAT_05")] %>% group_by(TA050047, CAT_05) %>% summarise(Count = n())

T05_RMM_IACCAT <- T05_RMM_IACCAT[1:5, ]

head(T05_RMM_CAT, 7) 

ggplot(T05_RMM_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T05_RMM_FTLW, 9)

ggplot(T05_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2005_FTL$TA050047))

rmm.pie.ftl.05 <- ggplot(data = T05_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050047))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("mediumturquoise", "deepskyblue"),
  labels = c("Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2005_IAC$TA050047))

rmm.pie.iac.05 <- ggplot(data = T05_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050047))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(rmm.pie.ftl.05, rmm.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### How Good at Taking Responsibility for Actions ================================================================================ 

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050048)

T05_ROA_FTLW <- TIAS2005[, c("TA050048", "FTL_COUNT")] %>% group_by(TA050048, FTL_COUNT) %>% summarise(Count = n())

T05_ROA_FTLW <- T05_ROA_FTLW[1:11, ]

T05_ROA_CAT <- TIAS2005[, c("TA050048", "CAT_05")] %>% group_by(TA050048, CAT_05) %>% summarise(Count = n())

T05_ROA_CAT <- T05_ROA_CAT[1:9, ]

ggplot(T05_ROA_FTLW, aes(x = FTL_COUNT, y = TA050048, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_ROA_CAT, aes(x = CAT_05, y = TA050048, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Money Management ================================================================================================= 

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050050)

T05_GMM_FTLW <- TIAS2005[, c("TA050050", "FTL_COUNT")] %>% group_by(TA050050, FTL_COUNT) %>% summarise(Count = n())

T05_GMM_FTLW <- T05_GMM_FTLW[1:12, ]

T05_GMM_CAT <- TIAS2005[, c("TA050050", "CAT_05")] %>% group_by(TA050050, CAT_05) %>% summarise(Count = n())

T05_GMM_CAT <- T05_GMM_CAT[1:9, ]

ggplot(T05_GMM_FTLW, aes(x = FTL_COUNT, y = TA050050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_GMM_CAT, aes(x = CAT_05, y = TA050050, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ================================================================================== 

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA050051)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050051 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050051 = 8)) 

T05_CCB_FTLW <- TIAS2005[, c("TA050051", "FTL_COUNT")] %>% group_by(TA050051, FTL_COUNT) %>% summarise(Count = n())

T05_CCB_FTLW <- T05_CCB_FTLW[1:12, ]

T05_CCB_CAT <- TIAS2005[, c("TA050051", "CAT_05")] %>% group_by(TA050051, CAT_05) %>% summarise(Count = n())

T05_CCB_CAT <- T05_CCB_CAT[1:9, ]

ggplot(T05_CCB_FTLW, aes(x = FTL_COUNT, y = TA050051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_CCB_CAT, aes(x = CAT_05, y = TA050051, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### MIDUS M1 - Happiness ========================================================================================================= 

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050888)

T05_M01_FTLW <- TIAS2005[, c("TA050888", "FTL_COUNT")] %>% group_by(TA050888, FTL_COUNT) %>% summarise(Count = n())

T05_M01_CAT <- TIAS2005[, c("TA050888", "CAT_05")] %>% group_by(TA050888, CAT_05) %>% summarise(Count = n())

T05_M01_FTLCAT <- TIAS2005_FTL[, c("TA050888", "CAT_05")] %>% group_by(TA050888, CAT_05) %>% summarise(Count = n())

T05_M01_IACCAT <- TIAS2005_IAC[, c("TA050888", "CAT_05")] %>% group_by(TA050888, CAT_05) %>% summarise(Count = n())

head(T05_M01_CAT, 8)

ggplot(T05_M01_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050888)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M01_FTLW, 10)

ggplot(T05_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050888)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050888))

m01.pie.ftl.05 <- ggplot(data = T05_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050888))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("green3", "deepskyblue"), 
  labels = c("About once a week", "Almost every day")) +
  theme_void()

prop.table(table(TIAS2005_IAC$TA050888))

m01.pie.iac.05 <- ggplot(data = T05_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050888))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.05, m01.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M2 - Interest in Life ================================================================================================== 

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050889)

T05_M02_FTLW <- TIAS2005[, c("TA050889", "FTL_COUNT")] %>% group_by(TA050889, FTL_COUNT) %>% summarise(Count = n())

T05_M02_CAT <- TIAS2005[, c("TA050889", "CAT_05")] %>% group_by(TA050889, CAT_05) %>% summarise(Count = n())

head(T05_M02_CAT, 7)

ggplot(T05_M02_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050889)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M02_FTLW, 9)

ggplot(T05_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050889)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))


### MIDUS M3 - Satisfaction ====================================================================================================== 

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050890)

T05_M03_FTLW <- TIAS2005[, c("TA050890", "FTL_COUNT")] %>% group_by(TA050890, FTL_COUNT) %>% summarise(Count = n())

T05_M03_CAT <- TIAS2005[, c("TA050890", "CAT_05")] %>% group_by(TA050890, CAT_05) %>% summarise(Count = n())

T05_M03_FTLCAT <- TIAS2005_FTL[, c("TA050890", "CAT_05")] %>% group_by(TA050890, CAT_05) %>% summarise(Count = n())

T05_M03_IACCAT <- TIAS2005_IAC[, c("TA050890", "CAT_05")] %>% group_by(TA050890, CAT_05) %>% summarise(Count = n())

head(T05_M03_CAT, 8)

ggplot(T05_M03_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050890)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M03_FTLW, 11)

ggplot(T05_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050890)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050890))

m03.pie.ftl.05 <- ggplot(data = T05_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050890))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050890))

m03.pie.iac.05 <- ggplot(data = T05_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050890))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.05, m03.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M4 - Contribution of Something Important to Society ==================================================================== 

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050891)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050891 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050891 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050891 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050891 = 8)) 

T05_M04_FTLW <- TIAS2005[, c("TA050891", "FTL_COUNT")] %>% group_by(TA050891, FTL_COUNT) %>% summarise(Count = n())

T05_M04_FTLW <- T05_M04_FTLW[1:12, ]

T05_M04_CAT <- TIAS2005[, c("TA050891", "CAT_05")] %>% group_by(TA050891, CAT_05) %>% summarise(Count = n())

T05_M04_CAT <- T05_M04_CAT[1:8, ]

T05_M04_FTLCAT <- TIAS2005_FTL[, c("TA050891", "CAT_05")] %>% group_by(TA050891, CAT_05) %>% summarise(Count = n())

T05_M04_IACCAT <- TIAS2005_IAC[, c("TA050891", "CAT_05")] %>% group_by(TA050891, CAT_05) %>% summarise(Count = n())

T05_M04_IACCAT <- T05_M04_IACCAT[1:6, ]

head(T05_M04_CAT, 12)

ggplot(T05_M04_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050891)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M04_FTLW, 8)

ggplot(T05_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050891)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050891))

m04.pie.ftl.05 <- ggplot(data = T05_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050891))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050891))

m04.pie.iac.05 <- ggplot(data = T05_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050891))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.05, m04.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M5 - Belonging to Community ============================================================================================ 

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050892)

T05_M05_FTLW <- TIAS2005[, c("TA050892", "FTL_COUNT")] %>% group_by(TA050892, FTL_COUNT) %>% summarise(Count = n())

T05_M05_CAT <- TIAS2005[, c("TA050892", "CAT_05")] %>% group_by(TA050892, CAT_05) %>% summarise(Count = n())

T05_M05_FTLCAT <- TIAS2005_FTL[, c("TA050892", "CAT_05")] %>% group_by(TA050892, CAT_05) %>% summarise(Count = n())

T05_M05_IACCAT <- TIAS2005_IAC[, c("TA050892", "CAT_05")] %>% group_by(TA050892, CAT_05) %>% summarise(Count = n())

head(T05_M05_CAT, 8)

ggplot(T05_M05_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050892)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M05_FTLW, 11)

ggplot(T05_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050892)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050892))

m05.pie.ftl.05 <- ggplot(data = T05_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050892))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050892))

m05.pie.iac.05 <- ggplot(data = T05_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050892))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.05, m05.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M6 - Society Getting Better ============================================================================================ 

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050893)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050893 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050893 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050893 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050893 = 8)) 

T05_M06_FTLW <- TIAS2005[, c("TA050893", "FTL_COUNT")] %>% group_by(TA050893, FTL_COUNT) %>% summarise(Count = n())

T05_M06_FTLW <- T05_M06_FTLW[1:10, ]

T05_M06_CAT <- TIAS2005[, c("TA050893", "CAT_05")] %>% group_by(TA050893, CAT_05) %>% summarise(Count = n())

T05_M06_CAT <- T05_M06_CAT[1:8, ]

T05_M06_FTLCAT <- TIAS2005_FTL[, c("TA050893", "CAT_05")] %>% group_by(TA050893, CAT_05) %>% summarise(Count = n())

T05_M06_IACCAT <- TIAS2005_IAC[, c("TA050893", "CAT_05")] %>% group_by(TA050893, CAT_05) %>% summarise(Count = n())

T05_M06_IACCAT <- T05_M06_IACCAT[1:6, ]

head(T05_M06_CAT, 8)

ggplot(T05_M06_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050893)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M06_FTLW, 10)

ggplot(T05_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050893)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050893))

m06.pie.ftl.05 <- ggplot(data = T05_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050893))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("gold", "deepskyblue"), 
  labels = c("Once or twice", "Almost every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050893))

m06.pie.iac.05 <- ggplot(data = T05_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050893))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.05, m06.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M7 - People Basically Good ============================================================================================= 

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050894)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050894 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050894 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050894 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050894 = 8)) 

T05_M07_FTLW <- TIAS2005[, c("TA050894", "FTL_COUNT")] %>% group_by(TA050894, FTL_COUNT) %>% summarise(Count = n())

T05_M07_FTLW <- T05_M07_FTLW[1:9, ]

T05_M07_CAT <- TIAS2005[, c("TA050894", "CAT_05")] %>% group_by(TA050894, CAT_05) %>% summarise(Count = n())

T05_M07_CAT <- T05_M07_CAT[1:8, ]

T05_M07_FTLCAT <- TIAS2005_FTL[, c("TA050894", "CAT_05")] %>% group_by(TA050894, CAT_05) %>% summarise(Count = n())

T05_M07_IACCAT <- TIAS2005_IAC[, c("TA050894", "CAT_05")] %>% group_by(TA050894, CAT_05) %>% summarise(Count = n())

T05_M07_IACCAT <- T05_M07_IACCAT[1:6, ]

head(T05_M07_CAT, 8)

ggplot(T05_M07_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050894)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M07_FTLW, 9)

ggplot(T05_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050894)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050894))

m07.pie.ftl.05 <- ggplot(data = T05_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050894))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("green3", "deepskyblue"), 
  labels = c("About once a week", "Almost every day")) + 
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050894))

m07.pie.iac.05 <- ggplot(data = T05_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050894))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.05, m07.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M8 - Way Society Makes Sense =========================================================================================== 

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050895)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050895 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050895 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050895 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050895 = 8)) 

T05_M08_FTLW <- TIAS2005[, c("TA050895", "FTL_COUNT")] %>% group_by(TA050895, FTL_COUNT) %>% summarise(Count = n())

T05_M08_FTLW <- T05_M08_FTLW[1:11, ]

T05_M08_CAT <- TIAS2005[, c("TA050895", "CAT_05")] %>% group_by(TA050895, CAT_05) %>% summarise(Count = n())

T05_M08_CAT <- T05_M08_CAT[1:8, ]

T05_M08_FTLCAT <- TIAS2005_FTL[, c("TA050895", "CAT_05")] %>% group_by(TA050895, CAT_05) %>% summarise(Count = n())

T05_M08_IACCAT <- TIAS2005_IAC[, c("TA050895", "CAT_05")] %>% group_by(TA050895, CAT_05) %>% summarise(Count = n())

T05_M08_IACCAT <- T05_M08_IACCAT[1:6, ]

head(T05_M08_CAT, 8)

ggplot(T05_M08_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050895)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M08_FTLW, 11)

ggplot(T05_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050895)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050895))

m08.pie.ftl.05 <- ggplot(data = T05_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050895))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "deepskyblue"), 
  labels = c("Never", "Almost every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050895))

m08.pie.iac.05 <- ggplot(data = T05_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050895))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.05, m08.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M9 - Managing Daily Responsibility ===================================================================================== 

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050896)

T05_M09_FTLW <- TIAS2005[, c("TA050896", "FTL_COUNT")] %>% group_by(TA050896, FTL_COUNT) %>% summarise(Count = n())

T05_M09_CAT <- TIAS2005[, c("TA050896", "CAT_05")] %>% group_by(TA050896, CAT_05) %>% summarise(Count = n())

T05_M09_FTLCAT <- TIAS2005_FTL[, c("TA050896", "CAT_05")] %>% group_by(TA050896, CAT_05) %>% summarise(Count = n())

T05_M09_IACCAT <- TIAS2005_IAC[, c("TA050896", "CAT_05")] %>% group_by(TA050896, CAT_05) %>% summarise(Count = n())

head(T05_M09_CAT, 8)

ggplot(T05_M09_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050896)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M09_FTLW, 11)

ggplot(T05_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050896)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050896))

m09.pie.ftl.05 <- ggplot(data = T05_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050896))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("gold", "mediumpurple1"), 
  labels = c("Once or twice", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050896))

m09.pie.iac.05 <- ggplot(data = T05_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050896))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.05, m09.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M10 - Trusting Relationships w/ Others =================================================================================  

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050897)

T05_M10_FTLW <- TIAS2005[, c("TA050897", "FTL_COUNT")] %>% group_by(TA050897, FTL_COUNT) %>% summarise(Count = n())

T05_M10_CAT <- TIAS2005[, c("TA050897", "CAT_05")] %>% group_by(TA050897, CAT_05) %>% summarise(Count = n())

T05_M10_FTLCAT <- TIAS2005_FTL[, c("TA050897", "CAT_05")] %>% group_by(TA050897, CAT_05) %>% summarise(Count = n())

T05_M10_IACCAT <- TIAS2005_IAC[, c("TA050897", "CAT_05")] %>% group_by(TA050897, CAT_05) %>% summarise(Count = n())

head(T05_M10_CAT, 8)

ggplot(T05_M10_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050897)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M10_FTLW, 11)

ggplot(T05_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050897)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050897))

m10.pie.ftl.05 <- ggplot(data = T05_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050897))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("mediumturquoise", "deepskyblue"), 
  labels = c("Two or three times a week", "Almost every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050897))

m10.pie.iac.05 <- ggplot(data = T05_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050897))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.05, m10.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M11 - Challenged to Grow =============================================================================================== 

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050898)

T05_M11_FTLW <- TIAS2005[, c("TA050898", "FTL_COUNT")] %>% group_by(TA050898, FTL_COUNT) %>% summarise(Count = n())

T05_M11_CAT <- TIAS2005[, c("TA050898", "CAT_05")] %>% group_by(TA050898, CAT_05) %>% summarise(Count = n())

head(T05_M11_CAT, 7)

ggplot(T05_M11_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050898)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M11_FTLW, 12)

ggplot(T05_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050898)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

### MIDUS M12 - Confident of Own Ideas =========================================================================================== 

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050899)

T05_M12_FTLW <- TIAS2005[, c("TA050899", "FTL_COUNT")] %>% group_by(TA050899, FTL_COUNT) %>% summarise(Count = n())

T05_M12_CAT <- TIAS2005[, c("TA050899", "CAT_05")] %>% group_by(TA050899, CAT_05) %>% summarise(Count = n())

T05_M12_FTLCAT <- TIAS2005_FTL[, c("TA050899", "CAT_05")] %>% group_by(TA050899, CAT_05) %>% summarise(Count = n())

T05_M12_IACCAT <- TIAS2005_IAC[, c("TA050899", "CAT_05")] %>% group_by(TA050899, CAT_05) %>% summarise(Count = n())

head(T05_M12_CAT, 8)

ggplot(T05_M12_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050899)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M12_FTLW, 10)

ggplot(T05_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050899)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050899))

m12.pie.ftl.05 <- ggplot(data = T05_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050899))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050899))

m12.pie.iac.05 <- ggplot(data = T05_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050899))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.05, m12.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M13 - Liked Personality ================================================================================================ 

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050900)

T05_M13_FTLW <- TIAS2005[, c("TA050900", "FTL_COUNT")] %>% group_by(TA050900, FTL_COUNT) %>% summarise(Count = n())

T05_M13_CAT <- TIAS2005[, c("TA050900", "CAT_05")] %>% group_by(TA050900, CAT_05) %>% summarise(Count = n())

T05_M13_FTLCAT <- TIAS2005_FTL[, c("TA050900", "CAT_05")] %>% group_by(TA050900, CAT_05) %>% summarise(Count = n())

T05_M13_IACCAT <- TIAS2005_IAC[, c("TA050900", "CAT_05")] %>% group_by(TA050900, CAT_05) %>% summarise(Count = n())

head(T05_M13_CAT, 8)

ggplot(T05_M13_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050900)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M13_FTLW, 10)

ggplot(T05_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050900)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050900))

m13.pie.ftl.05 <- ggplot(data = T05_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050900))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2005_IAC$TA050900))

m13.pie.iac.05 <- ggplot(data = T05_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050900))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.05, m13.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### MIDUS M14 - Life Had Direction =============================================================================================== 

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050901)

T05_M14_FTLW <- TIAS2005[, c("TA050901", "FTL_COUNT")] %>% group_by(TA050901, FTL_COUNT) %>% summarise(Count = n())

T05_M14_CAT <- TIAS2005[, c("TA050901", "CAT_05")] %>% group_by(TA050901, CAT_05) %>% summarise(Count = n())

head(T05_M14_CAT, 7)

ggplot(T05_M14_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050901)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M14_FTLW, 10)

ggplot(T05_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050901)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

### MIDUS Subscale - Emotional =================================================================================================== 

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA050935)

T05_MSE_FTLW <- TIAS2005[, c("TA050935", "FTL_COUNT")] %>% group_by(TA050935, FTL_COUNT) %>% summarise(Count = n())

T05_MSE_CAT <- TIAS2005[, c("TA050935", "CAT_05")] %>% group_by(TA050935, CAT_05) %>% summarise(Count = n())

ggplot(T05_MSE_FTLW, aes(x = FTL_COUNT, y = TA050935, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_MSE_CAT, aes(x = CAT_05, y = TA050935, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological ===============================================================================================  

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA050937)

T05_MSP_FTLW <- TIAS2005[, c("TA050937", "FTL_COUNT")] %>% group_by(TA050937, FTL_COUNT) %>% summarise(Count = n())

T05_MSP_CAT <- TIAS2005[, c("TA050937", "CAT_05")] %>% group_by(TA050937, CAT_05) %>% summarise(Count = n())

ggplot(T05_MSP_FTLW, aes(x = FTL_COUNT, y = TA050937, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_MSP_CAT, aes(x = CAT_05, y = TA050937, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ================================================================================================== 

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050015)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050015 = 9)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050015 = 9)) 

T05_TIA_FTLW <- TIAS2005[, c("TA050015", "FTL_COUNT")] %>% group_by(TA050015, FTL_COUNT) %>% summarise(Count = n())

T05_TIA_FTLW <- T05_TIA_FTLW[1:4, ]

T05_TIA_CAT <- TIAS2005[, c("TA050015", "CAT_05")] %>% group_by(TA050015, CAT_05) %>% summarise(Count = n())

T05_TIA_CAT <- T05_TIA_CAT[1:3, ]

head(T05_TIA_CAT, 3)

ggplot(T05_TIA_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050015))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T05_TIA_FTLW, 4)

ggplot(T05_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050015)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

### Time Use - Type of Art (Involvement) ========================================================================================= 

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 88,871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA050016)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050016 = 9999)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050016 = 9999)) 

T05_IIA_FTLW <- TIAS2005[, c("TA050016", "FTL_COUNT")] %>% group_by(TA050016, FTL_COUNT) %>% summarise(Count = n())

T05_IIA_FTLW <- T05_IIA_FTLW[1:21, ]

T05_IIA_CAT <- TIAS2005[, c("TA050016", "CAT_05")] %>% group_by(TA050016, CAT_05) %>% summarise(Count = n())

T05_IIA_CAT <- T05_IIA_CAT[1:20, ]

head(T05_IIA_CAT, 20)

ggplot(T05_IIA_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

head(T05_IIA_FTLW, 21)

ggplot(T05_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

### Time Use - Art Involvement Frequency (Over 12 Mos) =========================================================================== 

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA050017)

T05_AIF_FTLW <- TIAS2005[, c("TA050017", "FTL_COUNT")] %>% group_by(TA050017, FTL_COUNT) %>% summarise(Count = n())

T05_AIF_CAT <- TIAS2005[, c("TA050017", "CAT_05")] %>% group_by(TA050017, CAT_05) %>% summarise(Count = n())

head(T05_AIF_CAT, 8)

ggplot(T05_AIF_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T05_AIF_FTLW, 9)

ggplot(T05_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### WTR Member of Sports Team (Over 12 Mos) ====================================================================================== 

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050018)

T05_SPO_FTLW <- TIAS2005[, c("TA050018", "FTL_COUNT")] %>% group_by(TA050018, FTL_COUNT) %>% summarise(Count = n())

T05_SPO_CAT <- TIAS2005[, c("TA050018", "CAT_05")] %>% group_by(TA050018, CAT_05) %>% summarise(Count = n())

T05_SPO_FTLCAT <- TIAS2005_FTL[, c("TA050018", "CAT_05")] %>% group_by(TA050018, CAT_05) %>% summarise(Count = n())

T05_SPO_IACCAT <- TIAS2005_IAC[, c("TA050018", "CAT_05")] %>% group_by(TA050018, CAT_05) %>% summarise(Count = n())

head(T05_SPO_CAT, 4)

ggplot(T05_SPO_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T05_SPO_FTLW, 4)

ggplot(T05_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2005_FTL$TA050018))

spo.pie.ftl.05 <- ggplot(data = T05_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2005_IAC$TA050018)) 

spo.pie.iac.05 <- ggplot(data = T05_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.05, spo.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Involved in Sports Frequency  ===================================================================================== 

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA050019)

T05_IIS_FTLW <- TIAS2005[, c("TA050019", "FTL_COUNT")] %>% group_by(TA050019, FTL_COUNT) %>% summarise(Count = n())

T05_IIS_CAT <- TIAS2005[, c("TA050019", "CAT_05")] %>% group_by(TA050019, CAT_05) %>% summarise(Count = n())

T05_IIS_FTLCAT <- TIAS2005_FTL[, c("TA050019", "CAT_05")] %>% group_by(TA050019, CAT_05) %>% summarise(Count = n())

T05_IIS_IACCAT <- TIAS2005_IAC[, c("TA050019", "CAT_05")] %>% group_by(TA050019, CAT_05) %>% summarise(Count = n())

head(T05_IIS_CAT, 9)

ggplot(T05_IIS_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T05_IIS_FTLW, 10)

ggplot(T05_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2005_FTL$TA050019))

iis.pie.ftl.05 <- ggplot(data = T05_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "turquoise"), 
                    labels = c("Not Involved in Sports", "Every day"))

prop.table(table(TIAS2005_IAC$TA050019)) 

iis.pie.iac.05 <- ggplot(data = T05_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.05, iis.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Watching/Reading News (Over 12 Mos) =============================================================================== 

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050020)

T05_WRN_FTLW <- TIAS2005[, c("TA050020", "FTL_COUNT")] %>% group_by(TA050020, FTL_COUNT) %>% summarise(Count = n())

T05_WRN_CAT <- TIAS2005[, c("TA050020", "CAT_05")] %>% group_by(TA050020, CAT_05) %>% summarise(Count = n())

T05_WRN_FTLCAT <- TIAS2005_FTL[, c("TA050020", "CAT_05")] %>% group_by(TA050020, CAT_05) %>% summarise(Count = n())

T05_WRN_IACCAT <- TIAS2005_IAC[, c("TA050020", "CAT_05")] %>% group_by(TA050020, CAT_05) %>% summarise(Count = n())

head(T05_WRN_CAT, 9)

ggplot(T05_WRN_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T05_WRN_FTLW, 10)

ggplot(T05_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2005_FTL$TA050020))

wrn.pie.ftl.05 <- ggplot(data = T05_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("lightskyblue", "gold"), 
                    labels = c("Once a week", "Almost every day"))

prop.table(table(TIAS2005_IAC$TA050020)) 

wrn.pie.iac.05 <- ggplot(data = T05_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.05, wrn.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================ 

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050021)

T05_RFP_FTLW <- TIAS2005[, c("TA050021", "FTL_COUNT")] %>% group_by(TA050021, FTL_COUNT) %>% summarise(Count = n())

T05_RFP_CAT <- TIAS2005[, c("TA050021", "CAT_05")] %>% group_by(TA050021, CAT_05) %>% summarise(Count = n())

T05_RFP_FTLCAT <- TIAS2005_FTL[, c("TA050021", "CAT_05")] %>% group_by(TA050021, CAT_05) %>% summarise(Count = n())

T05_RFP_IACCAT <- TIAS2005_IAC[, c("TA050021", "CAT_05")] %>% group_by(TA050021, CAT_05) %>% summarise(Count = n())

head(T05_RFP_CAT, 9)

ggplot(T05_RFP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T05_RFP_FTLW, 12)

ggplot(T05_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2005_FTL$TA050021))

rfp.pie.ftl.05 <- ggplot(data = T05_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightskyblue"), 
                    labels = c("Less than once a month", "Once a week"))

prop.table(table(TIAS2005_IAC$TA050021)) 

rfp.pie.iac.05 <- ggplot(data = T05_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.05, rfp.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ========================================================================== 

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050022)

T05_NNT_FTLW <- TIAS2005[, c("TA050022", "FTL_COUNT")] %>% group_by(TA050022, FTL_COUNT) %>% summarise(Count = n())

T05_NNT_CAT <- TIAS2005[, c("TA050022", "CAT_05")] %>% group_by(TA050022, CAT_05) %>% summarise(Count = n())

head(T05_NNT_CAT, 8)

ggplot(T05_NNT_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T05_NNT_FTLW, 11)

ggplot(T05_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

### Time Use - Internet Usage ==================================================================================================== 

#### 
# A9. WTR Ever Used Internet: “Have you ever used the internet?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050023)

T05_ITU_FTLW <- TIAS2005[, c("TA050023", "FTL_COUNT")] %>% group_by(TA050023, FTL_COUNT) %>% summarise(Count = n())

T05_ITU_CAT <- TIAS2005[, c("TA050023", "CAT_05")] %>% group_by(TA050023, CAT_05) %>% summarise(Count = n())

T05_ITU_FTLCAT <- TIAS2005_FTL[, c("TA050023", "CAT_05")] %>% group_by(TA050023, CAT_05) %>% summarise(Count = n())

T05_ITU_IACCAT <- TIAS2005_IAC[, c("TA050023", "CAT_05")] %>% group_by(TA050023, CAT_05) %>% summarise(Count = n())

head(T05_ITU_CAT, 4)

ggplot(T05_ITU_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T05_ITU_FTLW, 5)

ggplot(T05_ITU_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2005_FTL$TA050023))

itu.pie.ftl.05 <- ggplot(data = T05_ITU_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2005_IAC$TA050023)) 

itu.pie.iac.05 <- ggplot(data = T05_ITU_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(itu.pie.ftl.05, itu.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ========================================================== 

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA050024)

T05_IPE_FTLW <- TIAS2005[, c("TA050024", "FTL_COUNT")] %>% group_by(TA050024, FTL_COUNT) %>% summarise(Count = n())

T05_IPE_CAT <- TIAS2005[, c("TA050024", "CAT_05")] %>% group_by(TA050024, CAT_05) %>% summarise(Count = n())

T05_IPE_FTLCAT <- TIAS2005_FTL[, c("TA050024", "CAT_05")] %>% group_by(TA050024, CAT_05) %>% summarise(Count = n())

T05_IPE_IACCAT <- TIAS2005_IAC[, c("TA050024", "CAT_05")] %>% group_by(TA050024, CAT_05) %>% summarise(Count = n())

head(T05_IPE_CAT, 10)

ggplot(T05_IPE_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T05_IPE_FTLW, 12)

ggplot(T05_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2005_FTL$TA050024))

ipe.pie.ftl.05 <- ggplot(data = T05_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "#009E73"), 
                    labels = c("Never used the internet", "Once a week"))

prop.table(table(TIAS2005_IAC$TA050024)) 

ipe.pie.iac.05 <- ggplot(data = T05_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.05, ipe.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ================================================================== 

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA050025)

T05_IPR_FTLW <- TIAS2005[, c("TA050025", "FTL_COUNT")] %>% group_by(TA050025, FTL_COUNT) %>% summarise(Count = n())

T05_IPR_CAT <- TIAS2005[, c("TA050025", "CAT_05")] %>% group_by(TA050025, CAT_05) %>% summarise(Count = n())

T05_IPR_FTLCAT <- TIAS2005_FTL[, c("TA050025", "CAT_05")] %>% group_by(TA050025, CAT_05) %>% summarise(Count = n())

T05_IPR_IACCAT <- TIAS2005_IAC[, c("TA050025", "CAT_05")] %>% group_by(TA050025, CAT_05) %>% summarise(Count = n())

head(T05_IPR_CAT, 10)

ggplot(T05_IPR_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T05_IPR_FTLW, 13)

ggplot(T05_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2005_FTL$TA050025))

ipr.pie.ftl.05 <- ggplot(data = T05_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "#0072B2"), 
                    labels = c("Never used the internet", "Almost every day"))

prop.table(table(TIAS2005_IAC$TA050025))

ipr.pie.iac.05 <- ggplot(data = T05_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.05, ipr.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) ========================================================================= 

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA050026)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050026 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050026 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050026 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050026 = 8)) 

T05_IPS_FTLW <- TIAS2005[, c("TA050026", "FTL_COUNT")] %>% group_by(TA050026, FTL_COUNT) %>% summarise(Count = n())

T05_IPS_FTLW <- T05_IPS_FTLW[1:13, ]

T05_IPS_CAT <- TIAS2005[, c("TA050026", "CAT_05")] %>% group_by(TA050026, CAT_05) %>% summarise(Count = n())

T05_IPS_CAT <- T05_IPS_CAT[1:10, ]

T05_IPS_FTLCAT <- TIAS2005_FTL[, c("TA050026", "CAT_05")] %>% group_by(TA050026, CAT_05) %>% summarise(Count = n())

T05_IPS_IACCAT <- TIAS2005_IAC[, c("TA050026", "CAT_05")] %>% group_by(TA050026, CAT_05) %>% summarise(Count = n())

T05_IPS_IACCAT <- T05_IPS_IACCAT[1:8, ]

head(T05_IPS_CAT, 10)

ggplot(T05_IPS_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T05_IPS_FTLW, 13)

ggplot(T05_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2005_FTL$TA050026))

ips.pie.ftl.05 <- ggplot(data = T05_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "turquoise"), 
                    labels = c("Never used the internet", "Every day"))

prop.table(table(TIAS2005_IAC$TA050026))

ips.pie.iac.05 <- ggplot(data = T05_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.05, ips.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ==================================================================== 

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA050027)

T05_IPG_FTLW <- TIAS2005[, c("TA050027", "FTL_COUNT")] %>% group_by(TA050027, FTL_COUNT) %>% summarise(Count = n())

T05_IPG_CAT <- TIAS2005[, c("TA050027", "CAT_05")] %>% group_by(TA050027, CAT_05) %>% summarise(Count = n())

T05_IPG_FTLCAT <- TIAS2005_FTL[, c("TA050027", "CAT_05")] %>% group_by(TA050027, CAT_05) %>% summarise(Count = n())

T05_IPG_IACCAT <- TIAS2005_IAC[, c("TA050027", "CAT_05")] %>% group_by(TA050027, CAT_05) %>% summarise(Count = n())

head(T05_IPG_CAT, 10)

ggplot(T05_IPG_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T05_IPG_FTLW, 13)

ggplot(T05_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2005_FTL$TA050027))

ipg.pie.ftl.05 <- ggplot(data = T05_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "mediumpurple1"), 
                    labels = c("Never used the internet", "Never used the internet for gaming"))

prop.table(table(TIAS2005_IAC$TA050027))

ipg.pie.iac.05 <- ggplot(data = T05_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.05, ipg.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Time Use - Voted in Last Presidential Election =============================================================================== 

####
# A11. WTR Voted in 2004: “Did you vote in the national election for President last November, in 2004?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050028)

T05_VLP_FTLW <- TIAS2005[, c("TA050028", "FTL_COUNT")] %>% group_by(TA050028, FTL_COUNT) %>% summarise(Count = n())

T05_VLP_CAT <- TIAS2005[, c("TA050028", "CAT_05")] %>% group_by(TA050028, CAT_05) %>% summarise(Count = n())

head(T05_VLP_CAT, 3)

ggplot(T05_VLP_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050028))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T05_VLP_FTLW, 6)

ggplot(T05_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050028)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

### Time Use - Involvement in Social Action Groups =============================================================================== 

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050029)

T05_ISA_FTLW <- TIAS2005[, c("TA050029", "FTL_COUNT")] %>% group_by(TA050029, FTL_COUNT) %>% summarise(Count = n())

T05_ISA_CAT <- TIAS2005[, c("TA050029", "CAT_05")] %>% group_by(TA050029, CAT_05) %>% summarise(Count = n())

head(T05_ISA_CAT, 3)

ggplot(T05_ISA_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T05_ISA_FTLW, 4)

ggplot(T05_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) ========================================================================= 

####
# A11C. Type of Social Action Groups: “Which political groups were you involved in?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

table(TIAS$TA050030)

T05_TSA_FTLW <- TIAS2005[, c("TA050030", "FTL_COUNT")] %>% group_by(TA050030, FTL_COUNT) %>% summarise(Count = n())

T05_TSA_CAT <- TIAS2005[, c("TA050030", "CAT_05")] %>% group_by(TA050030, CAT_05) %>% summarise(Count = n())

head(T05_TSA_CAT, 7)

ggplot(T05_TSA_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T05_TSA_FTLW, 8)

ggplot(T05_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) ===================================================================== 

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA050031)

T05_SAG_FTLW <- TIAS2005[, c("TA050031", "FTL_COUNT")] %>% group_by(TA050031, FTL_COUNT) %>% summarise(Count = n())

T05_SAG_CAT <- TIAS2005[, c("TA050031", "CAT_05")] %>% group_by(TA050031, CAT_05) %>% summarise(Count = n())

head(T05_SAG_CAT, 8)

ggplot(T05_SAG_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T05_SAG_FTLW, 9)

ggplot(T05_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement =============================================================================== 

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050032)

T05_CGI_FTLW <- TIAS2005[, c("TA050032", "FTL_COUNT")] %>% group_by(TA050032, FTL_COUNT) %>% summarise(Count = n())

T05_CGI_CAT <- TIAS2005[, c("TA050032", "CAT_05")] %>% group_by(TA050032, CAT_05) %>% summarise(Count = n())

head(T05_CGI_CAT, 4)

ggplot(T05_CGI_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

head(T05_CGI_FTLW, 6)

ggplot(T05_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) ======================================================= 

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA050033)

T05_SCG_FTLW <- TIAS2005[, c("TA050033", "FTL_COUNT")] %>% group_by(TA050033, FTL_COUNT) %>% summarise(Count = n())

T05_SCG_CAT <- TIAS2005[, c("TA050033", "CAT_05")] %>% group_by(TA050033, CAT_05) %>% summarise(Count = n())

head(T05_SCG_CAT, 8)

ggplot(T05_SCG_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T05_SCG_FTLW, 10)

ggplot(T05_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ============================================================== 

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050034)

T05_UVW_FTLW <- TIAS2005[, c("TA050034", "FTL_COUNT")] %>% group_by(TA050034, FTL_COUNT) %>% summarise(Count = n())

T05_UVW_CAT <- TIAS2005[, c("TA050034", "CAT_05")] %>% group_by(TA050034, CAT_05) %>% summarise(Count = n())

head(T05_UVW_CAT, 3)

ggplot(T05_UVW_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))
                    
head(T05_UVW_FTLW, 4)

ggplot(T05_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

### Time Use - Type of Volunteer Work ============================================================================================ 

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA050035)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050035 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050035 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050035 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050035 = 8)) 

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA050036)

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA050037)

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA050038)

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA050039)

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA050040)

####
# Creating A14 Heatmaps 
####

A14_FTL05 <- TIAS2005_FTL %>% dplyr::select(TA050035, TA050036, TA050037, TA050038, TA050039, TA050040, PSID_ID)

cols <- sapply(A14_FTL05, is.logical)
A14_FTL05[,cols] <- lapply(A14_FTL05[,cols], as.numeric)

A14_FTL05_TIDY <- A14_FTL05 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL05_TIDY$variable <- factor(A14_FTL05_TIDY$variable, levels = c("TA050035", "TA050036", "TA050037", "TA050038", "TA050039", "TA050040"))

A14_FTL05_IDLEV <- dplyr::pull(A14_FTL05, PSID_ID)
A14_FTL05_TIDY$PSID_ID <- factor(A14_FTL05_TIDY$PSID_ID, levels = A14_FTL05_IDLEV)

A14_FTL05_TIDY$volunteer_type <- factor(A14_FTL05_TIDY$volunteer_type)

ggplot(A14_FTL05_TIDY, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2005 FTL", x="Order of Mention", y="PSID_ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise"), labels = c("Did Not Mention", "Youth Organization", "Hospital/Nursing Home", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC05 <- TIAS2005_IAC %>% dplyr::select(TA050035, TA050036, TA050037, TA050038, TA050039, TA050040, PSID_ID)

nrow(A14_IAC05)  

chunk <- 101  

n <- nrow(A14_IAC05)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC05_list <- split(A14_IAC05, r)   

length(A14_IAC05_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC05_tidylist <- lapply(A14_IAC05_list, tidy.vars)

for(i in 1:7) {
  A14_IAC05_tidylist[[i]]$variable <- factor(A14_IAC05_tidylist[[i]]$variable, levels = c("TA050035", "TA050036", "TA050037", "TA050038", "TA050039", "TA050040"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, PSID_ID)
}

A14_IAC05_levlist <- lapply(A14_IAC05_list, set.ID.levels)

for(i in 1:7) {
  A14_IAC05_tidylist[[i]]$PSID_ID <- factor(A14_IAC05_tidylist[[i]]$PSID_ID, levels = A14_IAC05_levlist[[i]])
}

for(i in 1:7) {
  A14_IAC05_tidylist[[i]]$volunteer_type <- factor(A14_IAC05_tidylist[[i]]$volunteer_type)
}

create.A14.IAC05.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2005 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
    labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC05.heatmaps <- function(x){
  create.A14.IAC05.heatmap(A14_IAC05_tidylist[[x]])
}

# save or view in a horizontally wide frame to view all graphs properly

ggarrange(A14.IAC05.heatmaps(1) + rremove("legend"), A14.IAC05.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC05.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC05.heatmaps(4) + rremove("y.title"), ncol = 4, nrow = 1) 

ggarrange(A14.IAC05.heatmaps(5) + rremove("legend"), A14.IAC05.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC05.heatmaps(7) + rremove("y.title"), ncol = 3, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) =============================================================================== 

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA050041)

T05_TUH_FTLW <- TIAS2005[, c("TA050041", "FTL_COUNT")] %>% group_by(TA050041, FTL_COUNT) %>% summarise(Count = n())

T05_TUH_CAT <- TIAS2005[, c("TA050041", "CAT_05")] %>% group_by(TA050041, CAT_05) %>% summarise(Count = n())

head(T05_TUH_CAT, 8)

ggplot(T05_TUH_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050041))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T05_TUH_FTLW, 9)

ggplot(T05_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050041)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ========================================================== 

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050060)

T05_SRU_FTLW <- TIAS2005[, c("TA050060", "FTL_COUNT")] %>% group_by(TA050060, FTL_COUNT) %>% summarise(Count = n())

T05_SRU_CAT <- TIAS2005[, c("TA050060", "CAT_05")] %>% group_by(TA050060, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRU_FTLW, aes(x = FTL_COUNT, y = TA050060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRU_CAT, aes(x = CAT_05, y = TA050060, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others =========================================================== 

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050061)

T05_SRE_FTLW <- TIAS2005[, c("TA050061", "FTL_COUNT")] %>% group_by(TA050061, FTL_COUNT) %>% summarise(Count = n())

T05_SRE_CAT <- TIAS2005[, c("TA050061", "CAT_05")] %>% group_by(TA050061, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRE_FTLW, aes(x = FTL_COUNT, y = TA050061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRE_CAT, aes(x = CAT_05, y = TA050061, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ======================================================================== 

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050052)

T05_SRS_FTLW <- TIAS2005[, c("TA050052", "FTL_COUNT")] %>% group_by(TA050052, FTL_COUNT) %>% summarise(Count = n())

T05_SRS_CAT <- TIAS2005[, c("TA050052", "CAT_05")] %>% group_by(TA050052, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRS_FTLW, aes(x = FTL_COUNT, y = TA050052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRS_CAT, aes(x = CAT_05, y = TA050052, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Being a Leader ============================================================================ 

####
# C1B. How Good At Leading Comp w/ Others: “Compared to other people, how good are you at being a leader?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050053)

T05_SRB_FTLW <- TIAS2005[, c("TA050053", "FTL_COUNT")] %>% group_by(TA050053, FTL_COUNT) %>% summarise(Count = n())

T05_SRB_CAT <- TIAS2005[, c("TA050053", "CAT_05")] %>% group_by(TA050053, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRB_FTLW, aes(x = FTL_COUNT, y = TA050053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRB_CAT, aes(x = CAT_05, y = TA050053, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Logical/Analytic Thinking ================================================================= 

####
# C1C. How Good At Logic Comp w/ Others: “Compared to other people, how good are you at logical, analytical thinking?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050054)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050054 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050054 = c(8, 9))) 

T05_SRL_FTLW <- TIAS2005[, c("TA050054", "FTL_COUNT")] %>% group_by(TA050054, FTL_COUNT) %>% summarise(Count = n())

T05_SRL_FTLW <- T05_SRL_FTLW[1:11, ]

T05_SRL_CAT <- TIAS2005[, c("TA050054", "CAT_05")] %>% group_by(TA050054, CAT_05) %>% summarise(Count = n())

T05_SRL_CAT <- T05_SRL_CAT[1:9, ]

ggplot(T05_SRL_FTLW, aes(x = FTL_COUNT, y = TA050054, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRL_CAT, aes(x = CAT_05, y = TA050054, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Helping Others Solve Their Problems ======================================================= 

####
# C1D. How Good At Helping Comp w/ Others: “Compared to other people, how good are you at helping others solve their problems?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050055)

T05_SRH_FTLW <- TIAS2005[, c("TA050055", "FTL_COUNT")] %>% group_by(TA050055, FTL_COUNT) %>% summarise(Count = n())

T05_SRH_CAT <- TIAS2005[, c("TA050055", "CAT_05")] %>% group_by(TA050055, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRH_FTLW, aes(x = FTL_COUNT, y = TA050055, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRH_CAT, aes(x = CAT_05, y = TA050055, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ================================================================================================== 

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050049)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050049 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050049 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050049 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050049 = 8)) 

T05_HGP_FTLW <- TIAS2005[, c("TA050049", "FTL_COUNT")] %>% group_by(TA050049, FTL_COUNT) %>% summarise(Count = n())

T05_HGP_FTLW <- T05_HGP_FTLW[1:12, ]

T05_HGP_CAT <- TIAS2005[, c("TA050049", "CAT_05")] %>% group_by(TA050049, CAT_05) %>% summarise(Count = n())

T05_HGP_CAT <- T05_HGP_CAT[1:9, ]

ggplot(T05_HGP_FTLW, aes(x = FTL_COUNT, y = TA050049, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_HGP_CAT, aes(x = CAT_05, y = TA050049, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Intelligence ============================================================================== 

####
# C1E How Intelligent Compared w/ Others: “Compared to other people, how would you rate your intelligence? (On a scale of 1 to 7, 
# where 1 means ‘A lot worse than other people’ and 7 means ‘A lot better than other people’)”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050056)

T05_SRT_FTLW <- TIAS2005[, c("TA050056", "FTL_COUNT")] %>% group_by(TA050056, FTL_COUNT) %>% summarise(Count = n())

T05_SRT_CAT <- TIAS2005[, c("TA050056", "CAT_05")] %>% group_by(TA050056, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRT_FTLW, aes(x = FTL_COUNT, y = TA050056, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRT_CAT, aes(x = CAT_05, y = TA050056, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Independence ============================================================================== 

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050057)

T05_SRI_FTLW <- TIAS2005[, c("TA050057", "FTL_COUNT")] %>% group_by(TA050057, FTL_COUNT) %>% summarise(Count = n())

T05_SRI_CAT <- TIAS2005[, c("TA050057", "CAT_05")] %>% group_by(TA050057, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRI_FTLW, aes(x = FTL_COUNT, y = TA050057, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRI_CAT, aes(x = CAT_05, y = TA050057, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================ 

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050058)

T05_SRC_FTLW <- TIAS2005[, c("TA050058", "FTL_COUNT")] %>% group_by(TA050058, FTL_COUNT) %>% summarise(Count = n())

T05_SRC_CAT <- TIAS2005[, c("TA050058", "CAT_05")] %>% group_by(TA050058, CAT_05) %>% summarise(Count = n())

ggplot(T05_SRC_FTLW, aes(x = FTL_COUNT, y = TA050058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRC_CAT, aes(x = CAT_05, y = TA050058, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ============================================================================== 

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050059)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050059 = c(8, 9))) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050059 = c(8, 9))) 

T05_SRD_FTLW <- TIAS2005[, c("TA050059", "FTL_COUNT")] %>% group_by(TA050059, FTL_COUNT) %>% summarise(Count = n())

T05_SRD_FTLW <- T05_SRD_FTLW[1:11, ]

T05_SRD_CAT <- TIAS2005[, c("TA050059", "CAT_05")] %>% group_by(TA050059, CAT_05) %>% summarise(Count = n())

T05_SRD_CAT <- T05_SRD_CAT[1:9, ]

ggplot(T05_SRD_FTLW, aes(x = FTL_COUNT, y = TA050059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SRD_CAT, aes(x = CAT_05, y = TA050059, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ====================================================================== 

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050755)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050755 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050755 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050755 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050755 = 8)) 

T05_FSI_FTLW <- TIAS2005[, c("TA050755", "FTL_COUNT")] %>% group_by(TA050755, FTL_COUNT) %>% summarise(Count = n())

T05_FSI_FTLW <- T05_FSI_FTLW[1:9, ]

T05_FSI_CAT <- TIAS2005[, c("TA050755", "CAT_05")] %>% group_by(TA050755, CAT_05) %>% summarise(Count = n())

T05_FSI_CAT <- T05_FSI_CAT[1:8, ]

T05_FSI_FTLCAT <- TIAS2005_FTL[, c("TA050755", "CAT_05")] %>% group_by(TA050755, CAT_05) %>% summarise(Count = n())

T05_FSI_IACCAT <- TIAS2005_IAC[, c("TA050755", "CAT_05")] %>% group_by(TA050755, CAT_05) %>% summarise(Count = n())

T05_FSI_IACCAT <- T05_FSI_IACCAT[1:6, ]

head(T05_FSI_CAT, 8)

ggplot(T05_FSI_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050755))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T05_FSI_FTLW, 9)

ggplot(T05_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050755)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2005_FTL$TA050755))

fsi.pie.ftl.05 <- ggplot(data = T05_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050755))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("gold", "turquoise"), 
                    labels = c("A couple of times a month", "Every day"))

prop.table(table(TIAS2005_IAC$TA050755))

fsi.pie.iac.05 <- ggplot(data = T05_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050755))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.05, fsi.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Binge Eating Frequency ======================================================================================================= 

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050756)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050756 = 8)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050756 = 8)) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050756 = 8)) 

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050756 = 8)) 

T05_BEF_FTLW <- TIAS2005[, c("TA050756", "FTL_COUNT")] %>% group_by(TA050756, FTL_COUNT) %>% summarise(Count = n())

T05_BEF_FTLW <- T05_BEF_FTLW[1:10, ]

T05_BEF_CAT <- TIAS2005[, c("TA050756", "CAT_05")] %>% group_by(TA050756, CAT_05) %>% summarise(Count = n())

T05_BEF_CAT <- T05_BEF_CAT[1:8, ]

T05_BEF_FTLCAT <- TIAS2005_FTL[, c("TA050756", "CAT_05")] %>% group_by(TA050756, CAT_05) %>% summarise(Count = n())

T05_BEF_IACCAT <- TIAS2005_IAC[, c("TA050756", "CAT_05")] %>% group_by(TA050756, CAT_05) %>% summarise(Count = n())

T05_BEF_IACCAT <- T05_BEF_IACCAT[1:6, ]

head(T05_BEF_CAT, 8)

ggplot(T05_BEF_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050756))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T05_BEF_FTLW, 10)

ggplot(T05_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050756)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2005_FTL$TA050756))

bef.pie.ftl.05 <- ggplot(data = T05_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA050756))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("gold", "turquoise"), 
                    labels = c("A couple of times a month", "Every day"))

prop.table(table(TIAS2005_IAC$TA050756))

bef.pie.iac.05 <- ggplot(data = T05_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA050756))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.05, bef.pie.iac.05, ncol = 2, nrow = 1, labels = c("FTL 2005", "IAC 2005"))

### Race - Hispanic ============================================================================================================== 

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050883)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050883 = c(8, 9)))

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050883 = c(8, 9))) 

TIAS2005_FTL <- TIAS2005_FTL %>% 
  replace_with_na(replace = list(TA050883 = c(8, 9)))

TIAS2005_IAC <- TIAS2005_IAC %>% 
  replace_with_na(replace = list(TA050883 = c(8, 9)))

T05_HIS_FTLW <- TIAS2005[, c("TA050883", "FTL_COUNT")] %>% group_by(TA050883, FTL_COUNT) %>% summarise(Count = n())

T05_HIS_FTLW <- T05_HIS_FTLW[1:9, ]

T05_HIS_CAT <- TIAS2005[, c("TA050883", "CAT_05")] %>% group_by(TA050883, CAT_05) %>% summarise(Count = n())

T05_HIS_CAT <- T05_HIS_CAT[1:8, ]

head(T05_HIS_CAT, 8)

ggplot(T05_HIS_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050883))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

head(T05_HIS_FTLW, 9)

ggplot(T05_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050883)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA050884)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050884 = c(8, 9)))

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050884 = c(8, 9)))

T05_RAC_FTLW <- TIAS2005[, c("TA050884", "FTL_COUNT")] %>% group_by(TA050884, FTL_COUNT) %>% summarise(Count = n())

T05_RAC_FTLW <- T05_RAC_FTLW[1:8, ]

T05_RAC_CAT <- TIAS2005[, c("TA050884", "CAT_05")] %>% group_by(TA050884, CAT_05) %>% summarise(Count = n())

T05_RAC_CAT <- T05_RAC_CAT[1:7, ]

head(T05_RAC_CAT, 7)

ggplot(T05_RAC_CAT, aes(x = CAT_05, y = Count, fill = as.factor(TA050884))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

head(T05_RAC_FTLW, 8)

ggplot(T05_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA050884)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

### Daily Cigarette Usage ======================================================================================================== 

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK)
####

table(TIAS$TA050759)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050759 = 998)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050759 = 998)) 

T05_CIG_FTLW <- TIAS2005[, c("TA050759", "FTL_COUNT")] %>% group_by(TA050759, FTL_COUNT) %>% summarise(Count = n())

T05_CIG_FTLW <- T05_CIG_FTLW[1:21, ]

T05_CIG_CAT <- TIAS2005[, c("TA050759", "CAT_05")] %>% group_by(TA050759, CAT_05) %>% summarise(Count = n())

T05_CIG_CAT <- T05_CIG_CAT[1:20, ]

ggplot(T05_CIG_FTLW, aes(x = FTL_COUNT, y = TA050759, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_CIG_CAT, aes(x = CAT_05, y = TA050759, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category")) 

### Body Mass Index (BMI) ======================================================================================================== 

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA050944)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050944 = 99)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050944 = 99)) 

T05_BMI_FTLW <- TIAS2005[, c("TA050944", "FTL_COUNT")] %>% group_by(TA050944, FTL_COUNT) %>% summarise(Count = n())

T05_BMI_FTLW <- T05_BMI_FTLW[1:190, ]

T05_BMI_CAT <- TIAS2005[, c("TA050944", "CAT_05")] %>% group_by(TA050944, CAT_05) %>% summarise(Count = n())

T05_BMI_CAT <- T05_BMI_CAT[1:186, ]

ggplot(T05_BMI_FTLW, aes(x = FTL_COUNT, y = TA050944, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

my_comparisons <- list( c("0", "1"), c("1", "2"), c("0", "2"))
ggboxplot(T05_BMI_FTLW, x = "FTL_COUNT", y = "TA050944", title = "TIAS 2005",
          color = "FTL_COUNT", palette = "jco", xlab = "# of Waves for Which Participant Identified as FTL", ylab = "Body Mass Index (BMI)", legend.title="# of FTL Waves") + 
  stat_compare_means(comparisons = my_comparisons) +  
  stat_compare_means(label.y = 50)   

ggplot(T05_BMI_CAT, aes(x = CAT_05, y = TA050944, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ================================================================================================== 

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA050754)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050754 = 98)) 

TIAS2005 <- TIAS2005 %>% 
  replace_with_na(replace = list(TA050754 = 98)) 

T05_SLP_FTLW <- TIAS2005[, c("TA050754", "FTL_COUNT")] %>% group_by(TA050754, FTL_COUNT) %>% summarise(Count = n())

T05_SLP_FTLW <- T05_SLP_FTLW[1:19, ]

T05_SLP_CAT <- TIAS2005[, c("TA050754", "CAT_05")] %>% group_by(TA050754, CAT_05) %>% summarise(Count = n())

T05_SLP_CAT <- T05_SLP_CAT[1:17, ]

ggplot(T05_SLP_FTLW, aes(x = FTL_COUNT, y = TA050754, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2005", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T05_SLP_CAT, aes(x = CAT_05, y = TA050754, group = CAT_05, fill = as.factor(CAT_05))) +
  geom_boxplot() +
  labs(title = "TIAS 2005", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2007 ######################## 

### Amphetamine Usage =========================================================================================================== 

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070755)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070755 = 8)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070755 = 8)) 

T07_AMP_FTLW <- TIAS2007[, c("TA070755", "FTL_COUNT")] %>% group_by(TA070755, FTL_COUNT) %>% summarise(Count = n())

T07_AMP_FTLW <- T07_AMP_FTLW[1:7,]

T07_AMP_CAT <- TIAS2007[, c("TA070755", "CAT_07")] %>% group_by(TA070755, CAT_07) %>% summarise(Count = n())

T07_AMP_CAT <- T07_AMP_CAT[1:6, ]

head(T07_AMP_CAT, 6)

ggplot(T07_AMP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA070755)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

head(T07_AMP_FTLW, 7)

ggplot(T07_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070755)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070776)

T07_BRB_FTLW <- TIAS2007[, c("TA070776", "FTL_COUNT")] %>% group_by(TA070776, FTL_COUNT) %>% summarise(Count = n())

T07_BRB_CAT <- TIAS2007[, c("TA070776", "CAT_07")] %>% group_by(TA070776, CAT_07) %>% summarise(Count = n())

head(T07_BRB_CAT, 5)

ggplot(T07_BRB_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070776)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times"))

head(T07_BRB_FTLW, 6)

ggplot(T07_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070776)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times"))

### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070763)

T07_MAR_FTLW <- TIAS2007[, c("TA070763", "FTL_COUNT")] %>% group_by(TA070763, FTL_COUNT) %>% summarise(Count = n())

T07_MAR_CAT <- TIAS2007[, c("TA070763", "CAT_07")] %>% group_by(TA070763, CAT_07) %>% summarise(Count = n())

head(T07_MAR_CAT, 4)

ggplot(T07_MAR_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070763)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1"), labels = c("Never", "20-39 times", "40 or more times"))

head(T07_MAR_FTLW, 5)

ggplot(T07_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070763)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1"), labels = c("Never", "20-39 times", "40 or more times"))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070747)

T07_DIP_FTLW <- TIAS2007[, c("TA070747", "FTL_COUNT")] %>% group_by(TA070747, FTL_COUNT) %>% summarise(Count = n())

T07_DIP_CAT <- TIAS2007[, c("TA070747", "CAT_07")] %>% group_by(TA070747, CAT_07) %>% summarise(Count = n())

head(T07_DIP_CAT, 3)

ggplot(T07_DIP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070747)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "40 or more times")) 

head(T07_DIP_FTLW, 4)

ggplot(T07_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070747)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "40 or more times")) 

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070792)

T07_STR_FTLW <- TIAS2007[, c("TA070792", "FTL_COUNT")] %>% group_by(TA070792, FTL_COUNT) %>% summarise(Count = n())

T07_STR_CAT <- TIAS2007[, c("TA070792", "CAT_07")] %>% group_by(TA070792, CAT_07) %>% summarise(Count = n())

head(T07_STR_CAT, 3)

ggplot(T07_STR_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070792)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "3-5 times")) 

head(T07_STR_FTLW, 4)

ggplot(T07_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070792)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), labels = c("Never", "3-5 times")) +
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") 

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070784)

T07_TRQ_FTLW <- TIAS2007[, c("TA070784", "FTL_COUNT")] %>% group_by(TA070784, FTL_COUNT) %>% summarise(Count = n())

T07_TRQ_CAT <- TIAS2007[, c("TA070784", "CAT_07")] %>% group_by(TA070784, CAT_07) %>% summarise(Count = n())

head(T07_TRQ_CAT, 6)

ggplot(T07_TRQ_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070784)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times"))

head(T07_TRQ_FTLW, 7)

ggplot(T07_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070784)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA070768)

T07_CCN_FTLW <- TIAS2007[, c("TA070768", "FTL_COUNT")] %>% group_by(TA070768, FTL_COUNT) %>% summarise(Count = n())

T07_CCN_CAT <- TIAS2007[, c("TA070768", "CAT_07")] %>% group_by(TA070768, CAT_07) %>% summarise(Count = n())

head(T07_CCN_CAT, 7)

ggplot(T07_CCN_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070768))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "40 or more times"))

head(T07_CCN_FTLW, 8)

ggplot(T07_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070768)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "40 or more times"))

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA070738)

T07_AAC_FTLW <- TIAS2007[, c("TA070738", "FTL_COUNT")] %>% group_by(TA070738, FTL_COUNT) %>% summarise(Count = n())

T07_AAC_CAT <- TIAS2007[, c("TA070738", "CAT_07")] %>% group_by(TA070738, CAT_07) %>% summarise(Count = n())

T07_AAC_FTLCAT <- TIAS2007_FTL[, c("TA070738", "CAT_07")] %>% group_by(TA070738, CAT_07) %>% summarise(Count = n())

T07_AAC_IACCAT <- TIAS2007_IAC[, c("TA070738", "CAT_07")] %>% group_by(TA070738, CAT_07) %>% summarise(Count = n())

head(T07_AAC_CAT, 9)

ggplot(T07_AAC_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070738))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T07_AAC_FTLW, 12)

ggplot(T07_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070738)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2007_FTL$TA070738))

aac.pie.ftl.07 <- ggplot(data = T07_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070738))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "green3"), 
  labels = c("Never", "About once a month")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070738))

aac.pie.iac.07 <- ggplot(data = T07_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070738))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
  labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.07, aac.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))        

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA070739)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070739 = c(98, 99)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070739 = c(98, 99)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070739 = c(98, 99)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070739 = c(98, 99))) 

T07_DAC_FTLW <- TIAS2007[, c("TA070739", "FTL_COUNT")] %>% group_by(TA070739, FTL_COUNT) %>% summarise(Count = n())

T07_DAC_FTLW <- T07_DAC_FTLW[1:23, ]

T07_DAC_CAT <- TIAS2007[, c("TA070739", "CAT_07")] %>% group_by(TA070739, CAT_07) %>% summarise(Count = n())

T07_DAC_CAT <- T07_DAC_CAT[1:19, ] 

T07_DAC_FTLCAT <- TIAS2007_FTL[, c("TA070739", "CAT_07")] %>% group_by(TA070739, CAT_07) %>% summarise(Count = n())

T07_DAC_IACCAT <- TIAS2007_IAC[, c("TA070739", "CAT_07")] %>% group_by(TA070739, CAT_07) %>% summarise(Count = n())

T07_DAC_IACCAT <- T07_DAC_IACCAT[1:17, ]

head(T07_DAC_CAT, 19)

ggplot(T07_DAC_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070739))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", 
  "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue",
  "coral1", "forestgreen"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", 
  "8 drinks", "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "18 drinks", "20 drinks", "29 drinks"))
                                                          
head(T07_DAC_FTLW, 23)

ggplot(T07_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070739)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", 
  "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue",
  "coral1", "forestgreen"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", 
  "8 drinks", "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "18 drinks", "20 drinks", "29 drinks"))

prop.table(table(TIAS2007_FTL$TA070739))

dac.pie.ftl.07 <- ggplot(data = T07_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070739))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "mediumvioletred"), labels = c("Never", "5 drinks"))

prop.table(table(TIAS2007_IAC$TA070739))

dac.pie.iac.07 <- ggplot(data = T07_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070739))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  theme_void() + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", 
  "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue",
  "coral1", "forestgreen"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", 
  "8 drinks", "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "18 drinks", "20 drinks", "29 drinks"))

ggarrange(dac.pie.ftl.07, dac.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))          

### Degree to Which Condition Limits Normal Daily Activities ==================================================================== 

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA070694)

T07_DCN_FTLW <- TIAS2007[, c("TA070694", "FTL_COUNT")] %>% group_by(TA070694, FTL_COUNT) %>% summarise(Count = n())

T07_DCN_CAT <- TIAS2007[, c("TA070694", "CAT_07")] %>% group_by(TA070694, CAT_07) %>% summarise(Count = n())

T07_DCN_CAT <- T07_DCN_CAT[1:6, ]

head(T07_DCN_CAT, 6)

ggplot(T07_DCN_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070694)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
  labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T07_DCN_FTLW, 7)

ggplot(T07_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070694)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070704)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070704 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070704 = 9)) 

T07_DEP_FTLW <- TIAS2007[, c("TA070704", "FTL_COUNT")] %>% group_by(TA070704, FTL_COUNT) %>% summarise(Count = n())

T07_DEP_FTLW <- T07_DEP_FTLW[1:5, ]

T07_DEP_CAT <- TIAS2007[, c("TA070704", "CAT_07")] %>% group_by(TA070704, CAT_07) %>% summarise(Count = n())

T07_DEP_CAT <- T07_DEP_CAT[1:3, ]

head(T07_DEP_CAT, 3)

ggplot(T07_DEP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070704)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

head(T07_DEP_FTLW, 5)

ggplot(T07_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070704)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)

table(TIAS$TA070705)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070705 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070705 = 9)) 

T07_ANH_FTLW <- TIAS2007[, c("TA070705", "FTL_COUNT")] %>% group_by(TA070705, FTL_COUNT) %>% summarise(Count = n())

T07_ANH_FTLW <- T07_ANH_FTLW[1:5, ]

T07_ANH_CAT <- TIAS2007[, c("TA070705", "CAT_07")] %>% group_by(TA070705, CAT_07) %>% summarise(Count = n())

T07_ANH_CAT <- T07_ANH_CAT[1:3, ]

head(T07_ANH_CAT, 3)

ggplot(T07_ANH_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070705)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

head(T07_ANH_FTLW, 5)

ggplot(T07_ANH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070705)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA070681)

T07_DPD_FTLW <- TIAS2007[, c("TA070681", "FTL_COUNT")] %>% group_by(TA070681, FTL_COUNT) %>% summarise(Count = n())

T07_DPD_CAT <- TIAS2007[, c("TA070681", "CAT_07")] %>% group_by(TA070681, CAT_07) %>% summarise(Count = n())

head(T07_DPD_CAT, 3)

ggplot(T07_DPD_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070681)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T07_DPD_FTLW, 5)

ggplot(T07_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070681)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA070682)

T07_BIP_FTLW <- TIAS2007[, c("TA070682", "FTL_COUNT")] %>% group_by(TA070682, FTL_COUNT) %>% summarise(Count = n())

T07_BIP_CAT <- TIAS2007[, c("TA070682", "CAT_07")] %>% group_by(TA070682, CAT_07) %>% summarise(Count = n())

head(T07_BIP_CAT, 3)

ggplot(T07_BIP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070682)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T07_BIP_FTLW, 4)

ggplot(T07_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070682)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Phobia Diagnosis ============================================================================================================= 

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA070685)

T07_PHB_FTLW <- TIAS2007[, c("TA070685", "FTL_COUNT")] %>% group_by(TA070685, FTL_COUNT) %>% summarise(Count = n())

T07_PHB_CAT <- TIAS2007[, c("TA070685", "CAT_07")] %>% group_by(TA070685, CAT_07) %>% summarise(Count = n())

head(T07_PHB_CAT, 3)

ggplot(T07_PHB_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070685)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T07_PHB_FTLW, 4)

ggplot(T07_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070685)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Anxiety Disorders Diagnosis ================================================================================================== 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA070684)

T07_ANX_FTLW <- TIAS2007[, c("TA070684", "FTL_COUNT")] %>% group_by(TA070684, FTL_COUNT) %>% summarise(Count = n())

T07_ANX_CAT <- TIAS2007[, c("TA070684", "CAT_07")] %>% group_by(TA070684, CAT_07) %>% summarise(Count = n())

head(T07_ANX_CAT, 3)

ggplot(T07_ANX_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070684)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T07_ANX_FTLW, 4)

ggplot(T07_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070684)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### OCD Diagnosis ================================================================================================================ 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA070688)

T07_OCD_FTLW <- TIAS2007[, c("TA070688", "FTL_COUNT")] %>% group_by(TA070688, FTL_COUNT) %>% summarise(Count = n())

T07_OCD_FTLW <- T07_OCD_FTLW[1:4, ]

T07_OCD_CAT <- TIAS2007[, c("TA070688", "CAT_07")] %>% group_by(TA070688, CAT_07) %>% summarise(Count = n())

T07_OCD_CAT <- T07_OCD_CAT[1:3, ]

head(T07_OCD_CAT, 3)

ggplot(T07_OCD_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070688)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T07_OCD_FTLW, 4)

ggplot(T07_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070688)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Emotional/Nervous/Psychiatric Problems ======================================================================================= 

###
# H12. WTR Ever Had Emotional/Psych Problems: "Has a doctor or other health professional ever told you that you have or had any emotional, nervous, or psychiatric problems?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
###

table(TIAS$TA070679)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070679 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070679 = c(8, 9)))

T07_ENP_FTLW <- TIAS2007[, c("TA070679", "FTL_COUNT")] %>% group_by(TA070679, FTL_COUNT) %>% summarise(Count = n())

T07_ENP_FTLW <- T07_ENP_FTLW[1:5, ]

T07_ENP_CAT <- TIAS2007[, c("TA070679", "CAT_07")] %>% group_by(TA070679, CAT_07) %>% summarise(Count = n())

T07_ENP_CAT <- T07_ENP_CAT[1:3, ]

head(T07_ENP_CAT, 3)

ggplot(T07_ENP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070679)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

head(T07_ENP_FTLW, 5)

ggplot(T07_ENP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070679)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA070919)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070919 = 99)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070919 = 99)) 

T07_NPD_FTLW <- TIAS2007[, c("TA070919", "FTL_COUNT")] %>% group_by(TA070919, FTL_COUNT) %>% summarise(Count = n())

T07_NPD_FTLW <- T07_NPD_FTLW[1:31, ]

T07_NPD_CAT <- TIAS2007[, c("TA070919", "CAT_07")] %>% group_by(TA070919, CAT_07) %>% summarise(Count = n())

T07_NPD_CAT <- T07_NPD_CAT[1:27, ]

ggplot(T07_NPD_FTLW, aes(x = FTL_COUNT, y = TA070919, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_NPD_CAT, aes(x = CAT_07, y = TA070919, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA070914)

T07_SOA_FTLW <- TIAS2007[, c("TA070914", "FTL_COUNT")] %>% group_by(TA070914, FTL_COUNT) %>% summarise(Count = n())

T07_SOA_CAT <- TIAS2007[, c("TA070914", "CAT_07")] %>% group_by(TA070914, CAT_07) %>% summarise(Count = n())

ggplot(T07_SOA_FTLW, aes(x = FTL_COUNT, y = TA070914, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SOA_CAT, aes(x = CAT_07, y = TA070914, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Mental Health: Worry ========================================================================================================= 

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA070913)

T07_WRY_FTLW <- TIAS2007[, c("TA070913", "FTL_COUNT")] %>% group_by(TA070913, FTL_COUNT) %>% summarise(Count = n())

T07_WRY_CAT <- TIAS2007[, c("TA070913", "CAT_07")] %>% group_by(TA070913, CAT_07) %>% summarise(Count = n())

ggplot(T07_WRY_FTLW, aes(x = FTL_COUNT, y = TA070913, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_WRY_CAT, aes(x = CAT_07, y = TA070913, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Paid Employment Since Jan 1 of Prior Year ==================================================================================== 

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA070131)

T07_EPJ_FTLW <- TIAS2007[, c("TA070131", "FTL_COUNT")] %>% group_by(TA070131, FTL_COUNT) %>% summarise(Count = n())

T07_EPJ_CAT <- TIAS2007[, c("TA070131", "CAT_07")] %>% group_by(TA070131, CAT_07) %>% summarise(Count = n())

T07_EPJ_FTLCAT <- TIAS2007_FTL[, c("TA070131", "CAT_07")] %>% group_by(TA070131, CAT_07) %>% summarise(Count = n())

T07_EPJ_IACCAT <- TIAS2007_IAC[, c("TA070131", "CAT_07")] %>% group_by(TA070131, CAT_07) %>% summarise(Count = n())

head(T07_EPJ_CAT, 5)

ggplot(T07_EPJ_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070131)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T07_EPJ_FTLW, 8)

ggplot(T07_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070131)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2007_FTL$TA070131))

epj.pie.ftl.07 <- ggplot(data = T07_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightgoldenrod1", "lightpink"), labels = c("Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070131))

epj.pie.iac.07 <- ggplot(data = T07_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.07, epj.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA070341)

T07_EPH_FTLW <- TIAS2007[, c("TA070341", "FTL_COUNT")] %>% group_by(TA070341, FTL_COUNT) %>% summarise(Count = n())

T07_EPH_CAT <- TIAS2007[, c("TA070341", "CAT_07")] %>% group_by(TA070341, CAT_07) %>% summarise(Count = n())

T07_EPH_FTLCAT <- TIAS2007_FTL[, c("TA070341", "CAT_07")] %>% group_by(TA070341, CAT_07) %>% summarise(Count = n())

T07_EPH_IACCAT <- TIAS2007_IAC[, c("TA070341", "CAT_07")] %>% group_by(TA070341, CAT_07) %>% summarise(Count = n())

head(T07_EPH_CAT, 5)

ggplot(T07_EPH_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070341)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

head(T07_EPH_FTLW, 7)

ggplot(T07_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070341)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2007_FTL$TA070341))

eph.pie.ftl.07 <- ggplot(data = T07_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070341))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "No")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070341))

eph.pie.iac.07 <- ggplot(data = T07_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070341))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.07, eph.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Current Marital Status ======================================================================================================= 

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070069)

T07_CMS_FTLW <- TIAS2007[, c("TA070069", "FTL_COUNT")] %>% group_by(TA070069, FTL_COUNT) %>% summarise(Count = n())

T07_CMS_CAT <- TIAS2007[, c("TA070069", "CAT_07")] %>% group_by(TA070069, CAT_07) %>% summarise(Count = n())

head(T07_CMS_CAT, 5)

ggplot(T07_CMS_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue"), labels = c("Married", "Never Married", "Divorced", "Separated"))

head(T07_CMS_FTLW, 6)

ggplot(T07_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue"), labels = c("Married", "Never Married", "Divorced", "Separated"))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA070078)

T07_RRN_FTLW <- TIAS2007[, c("TA070078", "FTL_COUNT")] %>% group_by(TA070078, FTL_COUNT) %>% summarise(Count = n())

T07_RRN_CAT <- TIAS2007[, c("TA070078", "CAT_07")] %>% group_by(TA070078, CAT_07) %>% summarise(Count = n())

T07_RRN_FTLCAT <- TIAS2007_FTL[, c("TA070078", "CAT_07")] %>% group_by(TA070078, CAT_07) %>% summarise(Count = n())

T07_RRN_IACCAT <- TIAS2007_IAC[, c("TA070078", "CAT_07")] %>% group_by(TA070078, CAT_07) %>% summarise(Count = n())

head(T07_RRN_CAT, 5)

ggplot(T07_RRN_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

head(T07_RRN_FTLW, 6)

ggplot(T07_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2007_FTL$TA070078))

rrn.pie.ftl.07 <- ggplot(data = T07_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070078))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkviolet", "deeppink"), labels = c("Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070078))

rrn.pie.iac.07 <- ggplot(data = T07_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070078))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.07, rrn.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Number of Children =========================================================================================================== 

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA070091)

T07_CHL_FTLW <- TIAS2007[, c("TA070091", "FTL_COUNT")] %>% group_by(TA070091, FTL_COUNT) %>% summarise(Count = n())

T07_CHL_CAT <- TIAS2007[, c("TA070091", "CAT_07")] %>% group_by(TA070091, CAT_07) %>% summarise(Count = n())

ggplot(T07_CHL_FTLW, aes(x = FTL_COUNT, y = TA070091, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_CHL_CAT, aes(x = CAT_07, y = TA070091, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070548)

T07_HSG_FTLW <- TIAS2007[, c("TA070548", "FTL_COUNT")] %>% group_by(TA070548, FTL_COUNT) %>% summarise(Count = n())

T07_HSG_CAT <- TIAS2007[, c("TA070548", "CAT_07")] %>% group_by(TA070548, CAT_07) %>% summarise(Count = n())

T07_HSG_FTLCAT <- TIAS2007_FTL[, c("TA070548", "CAT_07")] %>% group_by(TA070548, CAT_07) %>% summarise(Count = n())

T07_HSG_IACCAT <- TIAS2007_IAC[, c("TA070548", "CAT_07")] %>% group_by(TA070548, CAT_07) %>% summarise(Count = n())

head(T07_HSG_CAT, 5)

ggplot(T07_HSG_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070548)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

head(T07_HSG_FTLW, 6)

ggplot(T07_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070548)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

prop.table(table(TIAS2007_FTL$TA070548))

hsg.pie.ftl.07 <- ggplot(data = T07_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070548))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightpink"), labels = c("HS Diploma", "Neither")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070548))

hsg.pie.iac.07 <- ggplot(data = T07_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070548))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither")) +
  theme_void() 

ggarrange(hsg.pie.ftl.07, hsg.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### College Education ============================================================================================================ 

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA070569)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070569 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070569 = c(8, 9))) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070569 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070569 = c(8, 9))) 

T07_CLG_FTLW <- TIAS2007[, c("TA070569", "FTL_COUNT")] %>% group_by(TA070569, FTL_COUNT) %>% summarise(Count = n())

T07_CLG_FTLW <- T07_CLG_FTLW[1:6, ]

T07_CLG_CAT <- TIAS2007[, c("TA070569", "CAT_07")] %>% group_by(TA070569, CAT_07) %>% summarise(Count = n())

T07_CLG_CAT <- T07_CLG_CAT[1:5, ]

T07_CLG_FTLCAT <- TIAS2007_FTL[, c("TA070569", "CAT_07")] %>% group_by(TA070569, CAT_07) %>% summarise(Count = n())

T07_CLG_IACCAT <- TIAS2007_IAC[, c("TA070569", "CAT_07")] %>% group_by(TA070569, CAT_07) %>% summarise(Count = n())

T07_CLG_IACCAT <- T07_CLG_IACCAT[1:3, ]

head(T07_CLG_CAT, 5)

ggplot(T07_CLG_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070569)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") +
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

head(T07_CLG_FTLW, 6)

ggplot(T07_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070569)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

prop.table(table(TIAS2007_FTL$TA070569))

clg.pie.ftl.07 <- ggplot(data = T07_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070569))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightpink"), labels = c("Attended College", "No HS Diploma or GED")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070569))

clg.pie.iac.07 <- ggplot(data = T07_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070569))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

ggarrange(clg.pie.ftl.07, clg.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 99 (NA/DK)
####

table(TIAS$TA070927)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070927 = 99)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070927 = 99)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070927 = 99)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070927 = 99))   

T07_HEL_FTLW <- TIAS2007[, c("TA070927", "FTL_COUNT")] %>% group_by(TA070927, FTL_COUNT) %>% summarise(Count = n())

T07_HEL_FTLW <- T07_HEL_FTLW[1:13, ]

T07_HEL_CAT <- TIAS2007[, c("TA070927", "CAT_07")] %>% group_by(TA070927, CAT_07) %>% summarise(Count = n())

T07_HEL_CAT <- T07_HEL_CAT[1:12, ]

T07_HEL_FTLCAT <- TIAS2007_FTL[, c("TA070927", "CAT_07")] %>% group_by(TA070927, CAT_07) %>% summarise(Count = n())

T07_HEL_IACCAT <- TIAS2007_IAC[, c("TA070927", "CAT_07")] %>% group_by(TA070927, CAT_07) %>% summarise(Count = n())

T07_HEL_IACCAT <- T07_HEL_IACCAT[1:10, ]

head(T07_HEL_CAT, 12)

ggplot(T07_HEL_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070927))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "sandybrown", "lightpink1", "turquoise", "mediumspringgreen", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))
                               
head(T07_HEL_FTLW, 13)

ggplot(T07_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070927)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "sandybrown", "lightpink1", "turquoise", "mediumspringgreen", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

prop.table(table(TIAS2007_FTL$TA070927))

hel.pie.ftl.07 <- ggplot(data = T07_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070927))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Highest Education Level", values = c("lightcoral", "#009E73"), labels = c("No HS Diploma, No GED", "HS Diploma"))

prop.table(table(TIAS2007_IAC$TA070927))

hel.pie.iac.07 <- ggplot(data = T07_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070927))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "sandybrown", "lightpink1", "turquoise", "mediumspringgreen", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

ggarrange(hel.pie.ftl.07, hel.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Responsibility - Earning Own Living ========================================================================================== 

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070044)

T07_REO_FTLW <- TIAS2007[, c("TA070044", "FTL_COUNT")] %>% group_by(TA070044, FTL_COUNT) %>% summarise(Count = n())

T07_REO_CAT <- TIAS2007[, c("TA070044", "CAT_07")] %>% group_by(TA070044, CAT_07) %>% summarise(Count = n())

T07_REO_FTLCAT <- TIAS2007_FTL[, c("TA070044", "CAT_07")] %>% group_by(TA070044, CAT_07) %>% summarise(Count = n())

T07_REO_IACCAT <- TIAS2007_IAC[, c("TA070044", "CAT_07")] %>% group_by(TA070044, CAT_07) %>% summarise(Count = n())

head(T07_REO_CAT, 8)

ggplot(T07_REO_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070044)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T07_REO_FTLW, 12)

ggplot(T07_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070044)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2007_FTL$TA070044))

reo.pie.ftl.07 <- ggplot(data = T07_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070044))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "deepskyblue", "gold"),
  labels = c("Never", "Half of the time", "Most of the time")) +
  theme_void()

prop.table(table(TIAS2007_IAC$TA070044))

reo.pie.iac.07 <- ggplot(data = T07_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070044))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(reo.pie.ftl.07, reo.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Responsibility - Paying Own Rent ============================================================================================= 

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070045)

T07_POR_FTLW <- TIAS2007[, c("TA070045", "FTL_COUNT")] %>% group_by(TA070045, FTL_COUNT) %>% summarise(Count = n())

T07_POR_CAT <- TIAS2007[, c("TA070045", "CAT_07")] %>% group_by(TA070045, CAT_07) %>% summarise(Count = n())

T07_POR_FTLCAT <- TIAS2007_FTL[, c("TA070045", "CAT_07")] %>% group_by(TA070045, CAT_07) %>% summarise(Count = n())

T07_POR_IACCAT <- TIAS2007_IAC[, c("TA070045", "CAT_07")] %>% group_by(TA070045, CAT_07) %>% summarise(Count = n())

head(T07_POR_CAT, 9)

ggplot(T07_POR_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T07_POR_FTLW, 12)

ggplot(T07_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2007_FTL$TA070045))

por.pie.ftl.07 <- ggplot(data = T07_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "green3", "blueviolet"), 
                    labels = c("Never", "Half of the time", "No payments"))  + theme_void()

prop.table(table(TIAS2007_IAC$TA070045))

por.pie.iac.07 <- ggplot(data = T07_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.07, por.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Responsibility - Paying Own Bills ============================================================================================ 

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070046)

T07_POB_FTLW <- TIAS2007[, c("TA070046", "FTL_COUNT")] %>% group_by(TA070046, FTL_COUNT) %>% summarise(Count = n())

T07_POB_CAT <- TIAS2007[, c("TA070046", "CAT_07")] %>% group_by(TA070046, CAT_07) %>% summarise(Count = n())

T07_POB_FTLCAT <- TIAS2007_FTL[, c("TA070046", "CAT_07")] %>% group_by(TA070046, CAT_07) %>% summarise(Count = n())

T07_POB_IACCAT <- TIAS2007_IAC[, c("TA070046", "CAT_07")] %>% group_by(TA070046, CAT_07) %>% summarise(Count = n())

head(T07_POB_CAT, 10)

ggplot(T07_POB_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

head(T07_POB_FTLW, 13)

ggplot(T07_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2007_FTL$TA070046))

pob.pie.ftl.07 <- ggplot(data = T07_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Half of the time", "Most of the time", "All of the time", "No bills"))  

prop.table(table(TIAS2007_IAC$TA070046))

pob.pie.iac.07 <- ggplot(data = T07_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.07, pob.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070047)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070047 = 8)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070047 = 8)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070047 = 8)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070047 = 8))   

T07_RMM_FTLW <- TIAS2007[, c("TA070047", "FTL_COUNT")] %>% group_by(TA070047, FTL_COUNT) %>% summarise(Count = n())

T07_RMM_FTLW <- T07_RMM_FTLW[1:10, ]

T07_RMM_CAT <- TIAS2007[, c("TA070047", "CAT_07")] %>% group_by(TA070047, CAT_07) %>% summarise(Count = n())

T07_RMM_CAT <- T07_RMM_CAT[1:8, ]

T07_RMM_FTLCAT <- TIAS2007_FTL[, c("TA070047", "CAT_07")] %>% group_by(TA070047, CAT_07) %>% summarise(Count = n())

T07_RMM_IACCAT <- TIAS2007_IAC[, c("TA070047", "CAT_07")] %>% group_by(TA070047, CAT_07) %>% summarise(Count = n())

T07_RMM_IACCAT <- T07_RMM_IACCAT[1:5, ]

head(T07_RMM_CAT, 8)

ggplot(T07_RMM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA070047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T07_RMM_FTLW, 10)

ggplot(T07_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2007_FTL$TA070047))

rmm.pie.ftl.07 <- ggplot(data = T07_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070047))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "mediumturquoise", "deepskyblue"),
  labels = c("Never", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2007_IAC$TA070047))

rmm.pie.iac.07 <- ggplot(data = T07_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070047))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(rmm.pie.ftl.07, rmm.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### How Good at Taking Responsibility for Actions ================================================================================ 

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070048)

T07_ROA_FTLW <- TIAS2007[, c("TA070048", "FTL_COUNT")] %>% group_by(TA070048, FTL_COUNT) %>% summarise(Count = n())

T07_ROA_CAT <- TIAS2007[, c("TA070048", "CAT_07")] %>% group_by(TA070048, CAT_07) %>% summarise(Count = n())

ggplot(T07_ROA_FTLW, aes(x = FTL_COUNT, y = TA070048, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_ROA_CAT, aes(x = CAT_07, y = TA070048, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Money Management ================================================================================================= 

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA070050)

T07_GMM_FTLW <- TIAS2007[, c("TA070050", "FTL_COUNT")] %>% group_by(TA070050, FTL_COUNT) %>% summarise(Count = n())

T07_GMM_CAT <- TIAS2007[, c("TA070050", "CAT_07")] %>% group_by(TA070050, CAT_07) %>% summarise(Count = n())

ggplot(T07_GMM_FTLW, aes(x = FTL_COUNT, y = TA070050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_GMM_CAT, aes(x = CAT_07, y = TA070050, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ================================================================================== 

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070051)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070051 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070051 = 9)) 

T07_CCB_FTLW <- TIAS2007[, c("TA070051", "FTL_COUNT")] %>% group_by(TA070051, FTL_COUNT) %>% summarise(Count = n())

T07_CCB_FTLW <- T07_CCB_FTLW[1:12, ]

T07_CCB_CAT <- TIAS2007[, c("TA070051", "CAT_07")] %>% group_by(TA070051, CAT_07) %>% summarise(Count = n())

T07_CCB_CAT <- T07_CCB_CAT[1:11, ]

ggplot(T07_CCB_FTLW, aes(x = FTL_COUNT, y = TA070051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_CCB_CAT, aes(x = CAT_07, y = TA070051, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### MIDUS M1 - Happiness ========================================================================================================= 

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070869)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070869 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070869 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070869 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070869 = 9))

T07_M01_FTLW <- TIAS2007[, c("TA070869", "FTL_COUNT")] %>% group_by(TA070869, FTL_COUNT) %>% summarise(Count = n())

T07_M01_FTLW <- T07_M01_FTLW[1:12, ]

T07_M01_CAT <- TIAS2007[, c("TA070869", "CAT_07")] %>% group_by(TA070869, CAT_07) %>% summarise(Count = n())

T07_M01_CAT <- T07_M01_CAT[1:9, ]

T07_M01_FTLCAT <- TIAS2007_FTL[, c("TA070869", "CAT_07")] %>% group_by(TA070869, CAT_07) %>% summarise(Count = n())

T07_M01_IACCAT <- TIAS2007_IAC[, c("TA070869", "CAT_07")] %>% group_by(TA070869, CAT_07) %>% summarise(Count = n())

T07_M01_IACCAT <- T07_M01_IACCAT[1:6, ]

head(T07_M01_CAT, 9)

ggplot(T07_M01_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070869)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M01_FTLW, 12)

ggplot(T07_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070869)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070869))

m01.pie.ftl.07 <- ggplot(data = T07_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070869))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "Every day")) +
  theme_void()

prop.table(table(TIAS2007_IAC$TA070869))

m01.pie.iac.07 <- ggplot(data = T07_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070869))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.07, m01.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M2 - Interest in Life ================================================================================================== 

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070870)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070870 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070870 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070870 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070870 = 9))

T07_M02_FTLW <- TIAS2007[, c("TA070870", "FTL_COUNT")] %>% group_by(TA070870, FTL_COUNT) %>% summarise(Count = n())

T07_M02_FTLW <- T07_M02_FTLW[1:12, ]

T07_M02_CAT <- TIAS2007[, c("TA070870", "CAT_07")] %>% group_by(TA070870, CAT_07) %>% summarise(Count = n())

T07_M02_CAT <- T07_M02_CAT[1:8, ]

T07_M02_FTLCAT <- TIAS2007_FTL[, c("TA070870", "CAT_07")] %>% group_by(TA070870, CAT_07) %>% summarise(Count = n())

T07_M02_IACCAT <- TIAS2007_IAC[, c("TA070870", "CAT_07")] %>% group_by(TA070870, CAT_07) %>% summarise(Count = n())

T07_M02_IACCAT <- T07_M02_IACCAT[1:6, ]

head(T07_M02_CAT, 8)

ggplot(T07_M02_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070870)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M02_FTLW, 12)

ggplot(T07_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070870)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070870))

m02.pie.ftl.07 <- ggplot(data = T07_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070870))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("mediumturquoise", "mediumpurple1"), 
  labels = c("Two or three times a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070870))

m02.pie.iac.07 <- ggplot(data = T07_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070870))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.07, m02.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M3 - Satisfaction ====================================================================================================== 

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070871)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070871 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070871 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070871 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070871 = 9))

T07_M03_FTLW <- TIAS2007[, c("TA070871", "FTL_COUNT")] %>% group_by(TA070871, FTL_COUNT) %>% summarise(Count = n())

T07_M03_FTLW <- T07_M03_FTLW[1:12, ]

T07_M03_CAT <- TIAS2007[, c("TA070871", "CAT_07")] %>% group_by(TA070871, CAT_07) %>% summarise(Count = n())

T07_M03_CAT <- T07_M03_CAT[1:9, ]

T07_M03_FTLCAT <- TIAS2007_FTL[, c("TA070871", "CAT_07")] %>% group_by(TA070871, CAT_07) %>% summarise(Count = n())

T07_M03_IACCAT <- TIAS2007_IAC[, c("TA070871", "CAT_07")] %>% group_by(TA070871, CAT_07) %>% summarise(Count = n())

T07_M03_IACCAT <- T07_M03_IACCAT[1:6, ]

head(T07_M03_CAT, 9)

ggplot(T07_M03_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070871)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M03_FTLW, 12)

ggplot(T07_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070871)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070871))

m03.pie.ftl.07 <- ggplot(data = T07_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070871))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("gold", "deepskyblue", "mediumpurple1"), 
  labels = c("Once or twice", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070871))

m03.pie.iac.07 <- ggplot(data = T07_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070871))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.07, m03.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M4 - Contribution of Something Important to Society ==================================================================== 

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070872)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070872 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070872 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070872 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070872 = c(8, 9))) 

T07_M04_FTLW <- TIAS2007[, c("TA070872", "FTL_COUNT")] %>% group_by(TA070872, FTL_COUNT) %>% summarise(Count = n())

T07_M04_FTLW <- T07_M04_FTLW[1:12, ]

T07_M04_CAT <- TIAS2007[, c("TA070872", "CAT_07")] %>% group_by(TA070872, CAT_07) %>% summarise(Count = n())

T07_M04_CAT <- T07_M04_CAT[1:9, ]

T07_M04_FTLCAT <- TIAS2007_FTL[, c("TA070872", "CAT_07")] %>% group_by(TA070872, CAT_07) %>% summarise(Count = n())

T07_M04_IACCAT <- TIAS2007_IAC[, c("TA070872", "CAT_07")] %>% group_by(TA070872, CAT_07) %>% summarise(Count = n())

T07_M04_IACCAT <- T07_M04_IACCAT[1:6, ]

head(T07_M04_CAT, 9)

ggplot(T07_M04_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070872)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M04_FTLW, 12)

ggplot(T07_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070872)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070872))

m04.pie.ftl.07 <- ggplot(data = T07_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070872))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("green3", "deepskyblue", "mediumpurple1"), 
  labels = c("About once a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070872))

m04.pie.iac.07 <- ggplot(data = T07_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070872))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.07, m04.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M5 - Belonging to Community ============================================================================================ 

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070873)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070873 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070873 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070873 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070873 = c(8, 9))) 

T07_M05_FTLW <- TIAS2007[, c("TA070873", "FTL_COUNT")] %>% group_by(TA070873, FTL_COUNT) %>% summarise(Count = n())

T07_M05_FTLW <- T07_M05_FTLW[1:12, ]

T07_M05_CAT <- TIAS2007[, c("TA070873", "CAT_07")] %>% group_by(TA070873, CAT_07) %>% summarise(Count = n())

T07_M05_CAT <- T07_M05_CAT[1:8, ]

T07_M05_FTLCAT <- TIAS2007_FTL[, c("TA070873", "CAT_07")] %>% group_by(TA070873, CAT_07) %>% summarise(Count = n())

T07_M05_FTLCAT <- T07_M05_FTLCAT[1:2, ]

T07_M05_IACCAT <- TIAS2007_IAC[, c("TA070873", "CAT_07")] %>% group_by(TA070873, CAT_07) %>% summarise(Count = n())

T07_M05_IACCAT <- T07_M05_IACCAT[1:6, ]

head(T07_M05_CAT, 8)

ggplot(T07_M05_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070873)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T05_M05_FTLW, 12)

ggplot(T05_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070873)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070873))

m05.pie.ftl.07 <- ggplot(data = T07_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070873))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold"), 
  labels = c("Never", "Once or twice")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070873))

m05.pie.iac.07 <- ggplot(data = T07_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070873))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.07, m05.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M6 - Society Getting Better ============================================================================================ 

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070874)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070874 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070874 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070874 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070874 = c(8, 9)))  

T07_M06_FTLW <- TIAS2007[, c("TA070874", "FTL_COUNT")] %>% group_by(TA070874, FTL_COUNT) %>% summarise(Count = n())

T07_M06_FTLW <- T07_M06_FTLW[1:12, ]

T07_M06_CAT <- TIAS2007[, c("TA070874", "CAT_07")] %>% group_by(TA070874, CAT_07) %>% summarise(Count = n())

T07_M06_CAT <- T07_M06_CAT[1:9, ]

T07_M06_FTLCAT <- TIAS2007_FTL[, c("TA070874", "CAT_07")] %>% group_by(TA070874, CAT_07) %>% summarise(Count = n())

T07_M06_IACCAT <- TIAS2007_IAC[, c("TA070874", "CAT_07")] %>% group_by(TA070874, CAT_07) %>% summarise(Count = n())

T07_M06_IACCAT <- T07_M06_IACCAT[1:6, ]

head(T07_M06_CAT, 9)

ggplot(T07_M06_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070874)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M06_FTLW, 12)

ggplot(T07_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070874)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070874))

m06.pie.ftl.07 <- ggplot(data = T07_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070874))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070874))

m06.pie.iac.07 <- ggplot(data = T07_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070874))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.07, m06.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M7 - People Basically Good ============================================================================================= 

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070875)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070875 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070875 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070875 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070875 = c(8, 9)))  

T07_M07_FTLW <- TIAS2007[, c("TA070875", "FTL_COUNT")] %>% group_by(TA070875, FTL_COUNT) %>% summarise(Count = n())

T07_M07_FTLW <- T07_M07_FTLW[1:12, ]

T07_M07_CAT <- TIAS2007[, c("TA070875", "CAT_07")] %>% group_by(TA070875, CAT_07) %>% summarise(Count = n())

T07_M07_CAT <- T07_M07_CAT[1:8, ]

T07_M07_FTLCAT <- TIAS2007_FTL[, c("TA070875", "CAT_07")] %>% group_by(TA070875, CAT_07) %>% summarise(Count = n())

T07_M07_FTLCAT <- T07_M07_FTLCAT[1:2, ]

T07_M07_IACCAT <- TIAS2007_IAC[, c("TA070875", "CAT_07")] %>% group_by(TA070875, CAT_07) %>% summarise(Count = n())

T07_M07_IACCAT <- T07_M07_IACCAT[1:6, ]

head(T07_M07_CAT, 8)

ggplot(T07_M07_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070875)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M07_FTLW, 12)

ggplot(T07_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070875)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070875))

m07.pie.ftl.07 <- ggplot(data = T07_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070875))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("mediumturquoise", "mediumpurple1"), 
                    labels = c("Two or three times a week", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070875))

m07.pie.iac.07 <- ggplot(data = T07_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070875))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.07, m07.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M8 - Way Society Makes Sense =========================================================================================== 

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070876)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070876 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070876 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070876 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070876 = c(8, 9)))

T07_M08_FTLW <- TIAS2007[, c("TA070876", "FTL_COUNT")] %>% group_by(TA070876, FTL_COUNT) %>% summarise(Count = n())

T07_M08_FTLW <- T07_M08_FTLW[1:13, ]

T07_M08_CAT <- TIAS2007[, c("TA070876", "CAT_07")] %>% group_by(TA070876, CAT_07) %>% summarise(Count = n())

T07_M08_CAT <- T07_M08_CAT[1:9, ]

T07_M08_FTLCAT <- TIAS2007_FTL[, c("TA070876", "CAT_07")] %>% group_by(TA070876, CAT_07) %>% summarise(Count = n())

T07_M08_IACCAT <- TIAS2007_IAC[, c("TA070876", "CAT_07")] %>% group_by(TA070876, CAT_07) %>% summarise(Count = n())

T07_M08_IACCAT <- T07_M08_IACCAT[1:6, ]

head(T07_M08_CAT, 9)

ggplot(T07_M08_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070876)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M08_FTLW, 13)

ggplot(T07_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070876)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070876))

m08.pie.ftl.07 <- ggplot(data = T07_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070876))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "green3", "mediumpurple1"), 
                    labels = c("Never", "About once a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070876))

m08.pie.iac.07 <- ggplot(data = T07_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070876))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.07, m08.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================  

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070877)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070877 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070877 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070877 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070877 = c(8, 9)))

T07_M09_FTLW <- TIAS2007[, c("TA070877", "FTL_COUNT")] %>% group_by(TA070877, FTL_COUNT) %>% summarise(Count = n())

T07_M09_FTLW <- T07_M09_FTLW[1:12, ]

T07_M09_CAT <- TIAS2007[, c("TA070877", "CAT_07")] %>% group_by(TA070877, CAT_07) %>% summarise(Count = n())

T07_M09_CAT <- T07_M09_CAT[1:8, ]

T07_M09_FTLCAT <- TIAS2007_FTL[, c("TA070877", "CAT_07")] %>% group_by(TA070877, CAT_07) %>% summarise(Count = n())

T07_M09_IACCAT <- TIAS2007_IAC[, c("TA070877", "CAT_07")] %>% group_by(TA070877, CAT_07) %>% summarise(Count = n())

T07_M09_IACCAT <- T07_M09_IACCAT[1:6, ]

head(T07_M09_CAT, 8)

ggplot(T07_M09_CAT, aes(x = CAT, y = Count, fill = as.factor(TA070877)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M09_FTLW, 12)

ggplot(T07_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070877)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070877))

m09.pie.ftl.07 <- ggplot(data = T07_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070877))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("gold", "mediumpurple1"), 
                    labels = c("Once or twice", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070877))

m09.pie.iac.07 <- ggplot(data = T07_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070877))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.07, m09.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M10 - Trusting Relationships w/ Others ================================================================================= 

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070878)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070878 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070878 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070878 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070878 = 9))

T07_M10_FTLW <- TIAS2007[, c("TA070878", "FTL_COUNT")] %>% group_by(TA070878, FTL_COUNT) %>% summarise(Count = n())

T07_M10_FTLW <- T07_M10_FTLW[1:12, ]

T07_M10_CAT <- TIAS2007[, c("TA070878", "CAT_07")] %>% group_by(TA070878, CAT_07) %>% summarise(Count = n())

T07_M10_CAT <- T07_M10_CAT[1:8, ]

T07_M10_FTLCAT <- TIAS2007_FTL[, c("TA070878", "CAT_07")] %>% group_by(TA070878, CAT_07) %>% summarise(Count = n())

T07_M10_IACCAT <- TIAS2007_IAC[, c("TA070878", "CAT_07")] %>% group_by(TA070878, CAT_07) %>% summarise(Count = n())

T07_M10_IACCAT <- T07_M10_IACCAT[1:6, ]

head(T07_M10_CAT, 8)

ggplot(T07_M10_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070878)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M10_FTLW, 12)

ggplot(T07_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070878)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070878))

m10.pie.ftl.07 <- ggplot(data = T07_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070878))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("green3", "mediumpurple1"), 
                    labels = c("About once a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070878))

m10.pie.iac.07 <- ggplot(data = T07_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070878))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.07, m10.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M11 - Challenged to Grow =============================================================================================== 

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070879)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070879 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070879 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070879 = c(8, 9)))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070879 = c(8, 9)))

T07_M11_FTLW <- TIAS2007[, c("TA070879", "FTL_COUNT")] %>% group_by(TA070879, FTL_COUNT) %>% summarise(Count = n())

T07_M11_FTLW <- T07_M11_FTLW[1:10, ]

T07_M11_CAT <- TIAS2007[, c("TA070879", "CAT_07")] %>% group_by(TA070879, CAT_07) %>% summarise(Count = n())

T07_M11_CAT <- T07_M11_CAT[1:8, ]

T07_M11_FTLCAT <- TIAS2007_FTL[, c("TA070879", "CAT_07")] %>% group_by(TA070879, CAT_07) %>% summarise(Count = n())

T07_M11_IACCAT <- TIAS2007_IAC[, c("TA070879", "CAT_07")] %>% group_by(TA070879, CAT_07) %>% summarise(Count = n())

T07_M11_IACCAT <- T07_M11_IACCAT[1:6, ]

head(T07_M11_CAT, 8)

ggplot(T07_M11_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070879)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M11_FTLW, 10)

ggplot(T07_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070879)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070879))

m11.pie.ftl.07 <- ggplot(data = T07_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070879))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
                    labels = c("Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070879))

m11.pie.iac.07 <- ggplot(data = T07_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070879))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.07, m11.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================  

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070880)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070880 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070880 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070880 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070880 = 9))

T07_M12_FTLW <- TIAS2007[, c("TA070880", "FTL_COUNT")] %>% group_by(TA070880, FTL_COUNT) %>% summarise(Count = n())

T07_M12_FTLW <- T07_M12_FTLW[1:12, ]

T07_M12_CAT <- TIAS2007[, c("TA070880", "CAT_07")] %>% group_by(TA070880, CAT_07) %>% summarise(Count = n())

T07_M12_CAT <- T07_M12_CAT[1:8, ]

T07_M12_FTLCAT <- TIAS2007_FTL[, c("TA070880", "CAT_07")] %>% group_by(TA070880, CAT_07) %>% summarise(Count = n())

T07_M12_IACCAT <- TIAS2007_IAC[, c("TA070880", "CAT_07")] %>% group_by(TA070880, CAT_07) %>% summarise(Count = n())

T07_M12_IACCAT <- T07_M12_IACCAT[1:6, ]

head(T07_M12_CAT, 8)

ggplot(T07_M12_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070880)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M12_FTLW, 12)

ggplot(T07_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070880)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070880))

m12.pie.ftl.07 <- ggplot(data = T07_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070880))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("green3", "mediumpurple1"), 
                    labels = c("About once a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070880))

m12.pie.iac.07 <- ggplot(data = T07_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070880))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.07, m12.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M13 - Liked Personality ================================================================================================ 

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070881)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070881 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070881 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070881 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070881 = 9))

T07_M13_FTLW <- TIAS2007[, c("TA070881", "FTL_COUNT")] %>% group_by(TA070881, FTL_COUNT) %>% summarise(Count = n())

T07_M13_FTLW <- T07_M13_FTLW[1:10, ]

T07_M13_CAT <- TIAS2007[, c("TA070881", "CAT_07")] %>% group_by(TA070881, CAT_07) %>% summarise(Count = n())

T07_M13_CAT <- T07_M13_CAT[1:8, ]

T07_M13_FTLCAT <- TIAS2007_FTL[, c("TA070881", "CAT_07")] %>% group_by(TA070881, CAT_07) %>% summarise(Count = n())

T07_M13_IACCAT <- TIAS2007_IAC[, c("TA070881", "CAT_07")] %>% group_by(TA070881, CAT_07) %>% summarise(Count = n())

T07_M13_IACCAT <- T07_M13_IACCAT[1:6, ]

head(T07_M13_CAT, 8)

ggplot(T07_M13_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070881)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M13_FTLW, 10)

ggplot(T07_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070881)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070881))

m13.pie.ftl.07 <- ggplot(data = T07_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070881))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("green3", "mediumpurple1"), 
                    labels = c("About once a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070881))

m13.pie.iac.07 <- ggplot(data = T07_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070881))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.07, m13.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS M14 - Life Had Direction =============================================================================================== 

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070882)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070882 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070882 = 9)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070882 = 9)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070882 = 9))

T07_M14_FTLW <- TIAS2007[, c("TA070882", "FTL_COUNT")] %>% group_by(TA070882, FTL_COUNT) %>% summarise(Count = n())

T07_M14_FTLW <- T07_M14_FTLW[1:11, ]

T07_M14_CAT <- TIAS2007[, c("TA070882", "CAT_07")] %>% group_by(TA070882, CAT_07) %>% summarise(Count = n())

T07_M14_CAT <- T07_M14_CAT[1:8, ]

T07_M14_FTLCAT <- TIAS2007_FTL[, c("TA070882", "CAT_07")] %>% group_by(TA070882, CAT_07) %>% summarise(Count = n())

T07_M14_IACCAT <- TIAS2007_IAC[, c("TA070882", "CAT_07")] %>% group_by(TA070882, CAT_07) %>% summarise(Count = n())

T07_M14_IACCAT <- T07_M14_IACCAT[1:6, ]

head(T07_M14_CAT, 8)

ggplot(T07_M14_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070882)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T07_M14_FTLW, 11)

ggplot(T07_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070882)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070882))

m14.pie.ftl.07 <- ggplot(data = T07_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070882))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("gold", "mediumpurple1"), 
                    labels = c("Once or twice", "Every day")) +
  theme_void() 

prop.table(table(TIAS2007_IAC$TA070882))

m14.pie.iac.07 <- ggplot(data = T07_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070882))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.07, m14.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### MIDUS Subscale - Emotional =================================================================================================== 

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA070916)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070916 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070916 = 9)) 

T07_MSE_FTLW <- TIAS2007[, c("TA070916", "FTL_COUNT")] %>% group_by(TA070916, FTL_COUNT) %>% summarise(Count = n())

T07_MSE_FTLW <- T07_MSE_FTLW[1:13, ]

T07_MSE_CAT <- TIAS2007[, c("TA070916", "CAT_07")] %>% group_by(TA070916, CAT_07) %>% summarise(Count = n())

T07_MSE_CAT <- T07_MSE_CAT[1:9, ]

ggplot(T07_MSE_FTLW, aes(x = FTL_COUNT, y = TA070916, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_MSE_CAT, aes(x = CAT_07, y = TA070916, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological =============================================================================================== 

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA070918)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070918 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070918 = 9)) 

T07_MSP_FTLW <- TIAS2007[, c("TA070918", "FTL_COUNT")] %>% group_by(TA070918, FTL_COUNT) %>% summarise(Count = n())

T07_MSP_FTLW <- T07_MSP_FTLW[1:11, ]

T07_MSP_CAT <- TIAS2007[, c("TA070918", "CAT_07")] %>% group_by(TA070918, CAT_07) %>% summarise(Count = n())

T07_MSP_CAT <- T07_MSP_CAT[1:7, ]

ggplot(T07_MSP_FTLW, aes(x = FTL_COUNT, y = TA070918, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_MSP_CAT, aes(x = CAT_07, y = TA070918, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ================================================================================================== 

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070015)

T07_TIA_FTLW <- TIAS2007[, c("TA070015", "FTL_COUNT")] %>% group_by(TA070015, FTL_COUNT) %>% summarise(Count = n())

T07_TIA_CAT <- TIAS2007[, c("TA070015", "CAT_07")] %>% group_by(TA070015, CAT_07) %>% summarise(Count = n())

T07_TIA_FTLCAT <- TIAS2007_FTL[, c("TA070015", "CAT_07")] %>% group_by(TA070015, CAT_07) %>% summarise(Count = n())

T07_TIA_IACCAT <- TIAS2007_IAC[, c("TA070015", "CAT_07")] %>% group_by(TA070015, CAT_07) %>% summarise(Count = n())

head(T07_TIA_CAT, 4)

ggplot(T07_TIA_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070015))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T07_TIA_FTLW, 6)

ggplot(T07_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070015)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_FTL$TA070015))

tia.pie.ftl.07 <- ggplot(data = T07_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070015))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_IAC$TA070015)) 

tia.pie.iac.07 <- ggplot(data = T07_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070015))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.07, tia.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Type of Art (Involvement) ========================================================================================= 

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 8871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA070016)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070016 = 9999)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070016 = 9999)) 

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070016 = 9999)) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070016 = 9999))

T07_IIA_FTLW <- TIAS2007[, c("TA070016", "FTL_COUNT")] %>% group_by(TA070016, FTL_COUNT) %>% summarise(Count = n())

T07_IIA_FTLW <- T07_IIA_FTLW[1:20, ]

T07_IIA_CAT <- TIAS2007[, c("TA070016", "CAT_07")] %>% group_by(TA070016, CAT_07) %>% summarise(Count = n())

T07_IIA_CAT <- T07_IIA_CAT[1:18, ]

T07_IIA_FTLCAT <- TIAS2007_FTL[, c("TA070016", "CAT_07")] %>% group_by(TA070016, CAT_07) %>% summarise(Count = n())

T07_IIA_IACCAT <- TIAS2007_IAC[, c("TA070016", "CAT_07")] %>% group_by(TA070016, CAT_07) %>% summarise(Count = n())

T07_IIA_IACCAT <- T07_IIA_IACCAT[1:16, ]

head(T07_IIA_CAT, 18)

ggplot(T07_IIA_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

head(T07_IIA_FTLW, 20)

ggplot(T07_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))       

prop.table(table(TIAS2007_FTL$TA070016)) 

iia.pie.ftl.07 <- ggplot(data = T07_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "coral1"), labels = c("Not Involved in Arts/Music/Theater", "Other Activity"))
  
prop.table(table(TIAS2007_IAC$TA070016)) 

iia.pie.iac.07 <- ggplot(data = T07_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))       

ggarrange(iia.pie.ftl.07, iia.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Art Involvement Frequency (Over 12 Mos) =========================================================================== 

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA070017)

T07_AIF_FTLW <- TIAS2007[, c("TA070017", "FTL_COUNT")] %>% group_by(TA070017, FTL_COUNT) %>% summarise(Count = n())

T07_AIF_CAT <- TIAS2007[, c("TA070017", "CAT_07")] %>% group_by(TA070017, CAT_07) %>% summarise(Count = n())

T07_AIF_FTLCAT <- TIAS2007_FTL[, c("TA070017", "CAT_07")] %>% group_by(TA070017, CAT_07) %>% summarise(Count = n())

T07_AIF_IACCAT <- TIAS2007_IAC[, c("TA070017", "CAT_07")] %>% group_by(TA070017, CAT_07) %>% summarise(Count = n())

head(T07_AIF_CAT, 9)

ggplot(T07_AIF_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T07_AIF_FTLW, 11)

ggplot(T07_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070017)) 

aif.pie.ftl.07 <- ggplot(data = T07_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month"))

prop.table(table(TIAS2007_IAC$TA070017)) 

aif.pie.iac.07 <- ggplot(data = T07_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.07, aif.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### WTR Member of Sports Team (Over 12 Mos) ====================================================================================== 

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070018)

T07_SPO_FTLW <- TIAS2007[, c("TA070018", "FTL_COUNT")] %>% group_by(TA070018, FTL_COUNT) %>% summarise(Count = n())

T07_SPO_CAT <- TIAS2007[, c("TA070018", "CAT_07")] %>% group_by(TA070018, CAT_07) %>% summarise(Count = n())

T07_SPO_FTLCAT <- TIAS2007_FTL[, c("TA070018", "CAT_07")] %>% group_by(TA070018, CAT_07) %>% summarise(Count = n())

T07_SPO_IACCAT <- TIAS2007_IAC[, c("TA070018", "CAT_07")] %>% group_by(TA070018, CAT_07) %>% summarise(Count = n())

head(T07_SPO_CAT, 4)

ggplot(T07_SPO_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T07_SPO_FTLW, 5)

ggplot(T07_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_FTL$TA070018))

spo.pie.ftl.07 <- ggplot(data = T07_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_IAC$TA070018)) 

spo.pie.iac.07 <- ggplot(data = T07_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.07, spo.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Involved in Sports Frequency  ===================================================================================== 

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA070019)

T07_IIS_FTLW <- TIAS2007[, c("TA070019", "FTL_COUNT")] %>% group_by(TA070019, FTL_COUNT) %>% summarise(Count = n())

T07_IIS_CAT <- TIAS2007[, c("TA070019", "CAT_07")] %>% group_by(TA070019, CAT_07) %>% summarise(Count = n())

T07_IIS_FTLCAT <- TIAS2007_FTL[, c("TA070019", "CAT_07")] %>% group_by(TA070019, CAT_07) %>% summarise(Count = n())

T07_IIS_IACCAT <- TIAS2007_IAC[, c("TA070019", "CAT_07")] %>% group_by(TA070019, CAT_07) %>% summarise(Count = n())

head(T07_IIS_CAT, 9)

ggplot(T07_IIS_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T07_IIS_FTLW, 10)

ggplot(T07_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070019))

iis.pie.ftl.07 <- ggplot(data = T07_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "#0072B2"), 
                    labels = c("Not Involved in Sports", "Almost every day"))

prop.table(table(TIAS2007_IAC$TA070019)) 

iis.pie.iac.07 <- ggplot(data = T07_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.07, iis.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Watching/Reading News (Over 12 Mos) =============================================================================== 

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070020)

T07_WRN_FTLW <- TIAS2007[, c("TA070020", "FTL_COUNT")] %>% group_by(TA070020, FTL_COUNT) %>% summarise(Count = n())

T07_WRN_CAT <- TIAS2007[, c("TA070020", "CAT_07")] %>% group_by(TA070020, CAT_07) %>% summarise(Count = n())

T07_WRN_FTLCAT <- TIAS2007_FTL[, c("TA070020", "CAT_07")] %>% group_by(TA070020, CAT_07) %>% summarise(Count = n())

T07_WRN_IACCAT <- TIAS2007_IAC[, c("TA070020", "CAT_07")] %>% group_by(TA070020, CAT_07) %>% summarise(Count = n())

head(T07_WRN_CAT, 10)

ggplot(T07_WRN_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T07_WRN_FTLW, 13)

ggplot(T07_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2007_FTL$TA070020))

wrn.pie.ftl.07 <- ggplot(data = T07_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("lightcoral", "gold", "#0072B2"), 
                    labels = c("At least once a month", "Almost every day", "Every day"))

prop.table(table(TIAS2007_IAC$TA070020)) 

wrn.pie.iac.07 <- ggplot(data = T07_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.07, wrn.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================ 

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070021)

T07_RFP_FTLW <- TIAS2007[, c("TA070021", "FTL_COUNT")] %>% group_by(TA070021, FTL_COUNT) %>% summarise(Count = n())

T07_RFP_CAT <- TIAS2007[, c("TA070021", "CAT_07")] %>% group_by(TA070021, CAT_07) %>% summarise(Count = n())

T07_RFP_FTLCAT <- TIAS2007_FTL[, c("TA070021", "CAT_07")] %>% group_by(TA070021, CAT_07) %>% summarise(Count = n())

T07_RFP_IACCAT <- TIAS2007_IAC[, c("TA070021", "CAT_07")] %>% group_by(TA070021, CAT_07) %>% summarise(Count = n())

head(T07_RFP_CAT, 10) 

ggplot(T07_RFP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T07_RFP_FTLW, 14) 

ggplot(T07_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2007_FTL$TA070021))

rfp.pie.ftl.07 <- ggplot(data = T07_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("lightcoral", "gold", "#0072B2"), 
                    labels = c("At least once a month", "Almost every day", "Every day"))

prop.table(table(TIAS2007_IAC$TA070021)) 

rfp.pie.iac.07 <- ggplot(data = T07_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.07, rfp.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ========================================================================== 

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070022)

T07_NNT_FTLW <- TIAS2007[, c("TA070022", "FTL_COUNT")] %>% group_by(TA070022, FTL_COUNT) %>% summarise(Count = n())

T07_NNT_CAT <- TIAS2007[, c("TA070022", "CAT_07")] %>% group_by(TA070022, CAT_07) %>% summarise(Count = n())

head(T07_NNT_CAT, 8)

ggplot(T07_NNT_CAT, aes(x = CAT, y = Count, fill = as.factor(TA070022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T07_NNT_FTLW, 13)

ggplot(T07_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

### Time Use - Internet Usage ==================================================================================================== 

#### 
# A9. WTR Ever Used Internet: “Have you ever used the internet?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070023)

T07_ITU_FTLW <- TIAS2007[, c("TA070023", "FTL_COUNT")] %>% group_by(TA070023, FTL_COUNT) %>% summarise(Count = n())

T07_ITU_CAT <- TIAS2007[, c("TA070023", "CAT_07")] %>% group_by(TA070023, CAT_07) %>% summarise(Count = n())

head(T07_ITU_CAT, 3)

ggplot(T07_ITU_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T07_ITU_FTLW, 5)

ggplot(T07_ITU_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ========================================================== 

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA070024)

T07_IPE_FTLW <- TIAS2007[, c("TA070024", "FTL_COUNT")] %>% group_by(TA070024, FTL_COUNT) %>% summarise(Count = n())

T07_IPE_CAT <- TIAS2007[, c("TA070024", "CAT_07")] %>% group_by(TA070024, CAT_07) %>% summarise(Count = n())

T07_IPE_FTLCAT <- TIAS2007_FTL[, c("TA070024", "CAT_07")] %>% group_by(TA070024, CAT_07) %>% summarise(Count = n())

T07_IPE_IACCAT <- TIAS2007_IAC[, c("TA070024", "CAT_07")] %>% group_by(TA070024, CAT_07) %>% summarise(Count = n())

head(T07_IPE_CAT, 10)

ggplot(T07_IPE_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T07_IPE_FTLW, 13)

ggplot(T07_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2007_FTL$TA070024))

ipe.pie.ftl.07 <- ggplot(data = T07_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("lightskyblue", "turquoise"), 
                    labels = c("At least once a month", "Every day"))

prop.table(table(TIAS2007_IAC$TA070024)) 

ipe.pie.iac.07 <- ggplot(data = T07_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.07, ipe.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ================================================================== 

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA070025)

T07_IPR_FTLW <- TIAS2007[, c("TA070025", "FTL_COUNT")] %>% group_by(TA070025, FTL_COUNT) %>% summarise(Count = n())

T07_IPR_CAT <- TIAS2007[, c("TA070025", "CAT_07")] %>% group_by(TA070025, CAT_07) %>% summarise(Count = n())

T07_IPR_FTLCAT <- TIAS2007_FTL[, c("TA070025", "CAT_07")] %>% group_by(TA070025, CAT_07) %>% summarise(Count = n())

T07_IPR_IACCAT <- TIAS2007_IAC[, c("TA070025", "CAT_07")] %>% group_by(TA070025, CAT_07) %>% summarise(Count = n())

head(T07_IPR_CAT, 12)

ggplot(T07_IPR_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T07_IPR_FTLW, 13)

ggplot(T07_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2007_FTL$TA070025))

ipr.pie.ftl.07 <- ggplot(data = T07_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("lightcoral", "lightskyblue", "#009E73", "mediumpurple1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Never used the internet for school/research"))

prop.table(table(TIAS2007_IAC$TA070025))

ipr.pie.iac.07 <- ggplot(data = T07_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.07, ipr.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) ========================================================================= 

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA070026)

T07_IPS_FTLW <- TIAS2007[, c("TA070026", "FTL_COUNT")] %>% group_by(TA070026, FTL_COUNT) %>% summarise(Count = n())

T07_IPS_CAT <- TIAS2007[, c("TA070026", "CAT_07")] %>% group_by(TA070026, CAT_07) %>% summarise(Count = n())

T07_IPS_FTLCAT <- TIAS2007_FTL[, c("TA070026", "CAT_07")] %>% group_by(TA070026, CAT_07) %>% summarise(Count = n())

T07_IPS_IACCAT <- TIAS2007_IAC[, c("TA070026", "CAT_07")] %>% group_by(TA070026, CAT_07) %>% summarise(Count = n())

head(T07_IPS_CAT, 10)

ggplot(T07_IPS_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T07_IPS_FTLW, 13)

ggplot(T07_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2007_FTL$TA070026))

ips.pie.ftl.07 <- ggplot(data = T07_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("lightcoral", "mediumpurple1"), 
                    labels = c("Less than once a month", "Never used the internet for shopping"))

prop.table(table(TIAS2007_IAC$TA070026))

ips.pie.iac.07 <- ggplot(data = T07_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.07, ips.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ==================================================================== 

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA070027)

T07_IPG_FTLW <- TIAS2007[, c("TA070027", "FTL_COUNT")] %>% group_by(TA070027, FTL_COUNT) %>% summarise(Count = n())

T07_IPG_CAT <- TIAS2007[, c("TA070027", "CAT_07")] %>% group_by(TA070027, CAT_07) %>% summarise(Count = n())

T07_IPG_FTLCAT <- TIAS2007_FTL[, c("TA070027", "CAT_07")] %>% group_by(TA070027, CAT_07) %>% summarise(Count = n())

T07_IPG_IACCAT <- TIAS2007_IAC[, c("TA070027", "CAT_07")] %>% group_by(TA070027, CAT_07) %>% summarise(Count = n())

head(T07_IPG_CAT, 12)

ggplot(T07_IPG_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T07_IPG_FTLW, 14)

ggplot(T07_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2007_FTL$TA070027))

ipg.pie.ftl.07 <- ggplot(data = T07_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("#009E73", "mediumpurple1"), 
                    labels = c("Once a week", "Never used the internet for gaming"))

prop.table(table(TIAS2007_IAC$TA070027))

ipg.pie.iac.07 <- ggplot(data = T07_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.07, ipg.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Voted in Last Presidential Election =============================================================================== 

####
# A11. WTR Voted in 2006: “Did you vote in the national election for President last November, in 2006?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070028)

T07_VLP_FTLW <- TIAS2007[, c("TA070028", "FTL_COUNT")] %>% group_by(TA070028, FTL_COUNT) %>% summarise(Count = n())

T07_VLP_CAT <- TIAS2007[, c("TA070028", "CAT_07")] %>% group_by(TA070028, CAT_07) %>% summarise(Count = n())

T07_VLP_FTLCAT <- TIAS2007_FTL[, c("TA070028", "CAT_07")] %>% group_by(TA070028, CAT_07) %>% summarise(Count = n())

T07_VLP_IACCAT <- TIAS2007_IAC[, c("TA070028", "CAT_07")] %>% group_by(TA070028, CAT_07) %>% summarise(Count = n())

head(T07_VLP_CAT, 4)

ggplot(T07_VLP_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070028))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2006 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T07_VLP_FTLW, 5)

ggplot(T07_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070028)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2006 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_FTL$TA070028))

vlp.pie.ftl.07 <- ggplot(data = T07_VLP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Voted in 2006 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_IAC$TA070028))

vlp.pie.iac.07 <- ggplot(data = T07_VLP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Voted in 2006 Presidential Election", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(vlp.pie.ftl.07, vlp.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Involvement in Social Action Groups =============================================================================== 

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070029)

T07_ISA_FTLW <- TIAS2007[, c("TA070029", "FTL_COUNT")] %>% group_by(TA070029, FTL_COUNT) %>% summarise(Count = n())

T07_ISA_CAT <- TIAS2007[, c("TA070029", "CAT_07")] %>% group_by(TA070029, CAT_07) %>% summarise(Count = n())

head(T07_ISA_CAT, 4)

ggplot(T07_ISA_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T07_ISA_FTLW, 9)

ggplot(T07_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) ========================================================================= 

####
# A11C. Type of Social Action Groups: “Which political groups were you involved in?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

table(TIAS$TA070030)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070030 = 9)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070030 = 9)) 

T07_TSA_FTLW <- TIAS2007[, c("TA070030", "FTL_COUNT")] %>% group_by(TA070030, FTL_COUNT) %>% summarise(Count = n())

T07_TSA_FTLW <- T07_TSA_FTLW[1:8, ]

T07_TSA_CAT <- TIAS2007[, c("TA070030", "CAT_07")] %>% group_by(TA070030, CAT_07) %>% summarise(Count = n())

T07_TSA_CAT <- T07_TSA_CAT[1:7, ]

head(T07_TSA_CAT, 7)

ggplot(T07_TSA_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T07_TSA_FTLW, 8)

ggplot(T07_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) ===================================================================== 

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA070031)

T07_SAG_FTLW <- TIAS2007[, c("TA070031", "FTL_COUNT")] %>% group_by(TA070031, FTL_COUNT) %>% summarise(Count = n())

T07_SAG_CAT <- TIAS2007[, c("TA070031", "CAT_07")] %>% group_by(TA070031, CAT_07) %>% summarise(Count = n())

head(T07_SAG_CAT, 8)

ggplot(T07_SAG_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T07_SAG_FTLW, 16)

ggplot(T07_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement =============================================================================== 

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070032)

T07_CGI_FTLW <- TIAS2007[, c("TA070032", "FTL_COUNT")] %>% group_by(TA070032, FTL_COUNT) %>% summarise(Count = n())

T07_CGI_CAT <- TIAS2007[, c("TA070032", "CAT_07")] %>% group_by(TA070032, CAT_07) %>% summarise(Count = n())

head(T07_CGI_CAT, 4)

ggplot(T07_CGI_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

head(T07_CGI_FTLW, 6)

ggplot(T07_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) ======================================================= 

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA070033)

T07_SCG_FTLW <- TIAS2007[, c("TA070033", "FTL_COUNT")] %>% group_by(TA070033, FTL_COUNT) %>% summarise(Count = n())

T07_SCG_CAT <- TIAS2007[, c("TA070033", "CAT_07")] %>% group_by(TA070033, CAT_07) %>% summarise(Count = n())

head(T07_SCG_CAT, 8)

ggplot(T07_SCG_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T07_SCG_FTLW, 10)

ggplot(T07_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ============================================================== 

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070034)

T07_UVW_FTLW <- TIAS2007[, c("TA070034", "FTL_COUNT")] %>% group_by(TA070034, FTL_COUNT) %>% summarise(Count = n())

T07_UVW_CAT <- TIAS2007[, c("TA070034", "CAT_07")] %>% group_by(TA070034, CAT_07) %>% summarise(Count = n())

T07_UVW_FTLCAT <- TIAS2007_FTL[, c("TA070034", "CAT_07")] %>% group_by(TA070034, CAT_07) %>% summarise(Count = n())

T07_UVW_IACCAT <- TIAS2007_IAC[, c("TA070034", "CAT_07")] %>% group_by(TA070034, CAT_07) %>% summarise(Count = n())

head(T07_UVW_CAT, 4)

ggplot(T07_UVW_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

head(T07_UVW_FTLW, 6)

ggplot(T07_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_FTL$TA070034))

uvw.pie.ftl.07 <- ggplot(data = T07_UVW_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2007_IAC$TA070034))

uvw.pie.iac.07 <- ggplot(data = T07_UVW_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

ggarrange(uvw.pie.ftl.07, uvw.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Time Use - Type of Volunteer Work ============================================================================================ 

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA070035)

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA070036)

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA070037)

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA070038)

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA070039)

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA070040)

####
# Creating A14 Heatmaps 
####

A14_FTL07 <- TIAS2007_FTL %>% dplyr::select(TA070035, TA070036, TA070037, TA070038, TA070039, TA070040, PSID_ID)

nrow(A14_FTL07)

cols <- sapply(A14_FTL07, is.logical)
A14_FTL07[,cols] <- lapply(A14_FTL07[,cols], as.numeric)

A14_FTL07_TIDY <- A14_FTL07 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL07_TIDY$variable <- factor(A14_FTL07_TIDY$variable, levels = c("TA070035", "TA070036", "TA070037", "TA070038", "TA070039", "TA070040"))

A14_FTL07_IDLEV <- dplyr::pull(A14_FTL07, PSID_ID) 
A14_FTL07_TIDY$PSID_ID <- factor(A14_FTL07_TIDY$PSID_ID, levels = A14_FTL07_IDLEV)

A14_FTL07_TIDY$volunteer_type <- factor(A14_FTL07_TIDY$volunteer_type)

ggplot(A14_FTL07_TIDY, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2007 FTL", x="Order of Mention", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                    labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC07 <- TIAS2007_IAC %>% dplyr::select(TA070035, TA070036, TA070037, TA070038, TA070039, TA070040, PSID_ID)

nrow(A14_IAC07)  

chunk <- 50

n <- nrow(A14_IAC07)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC07_list <- split(A14_IAC07, r)   

length(A14_IAC07_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC07_tidylist <- lapply(A14_IAC07_list, tidy.vars)

for(i in 1:23) {
  A14_IAC07_tidylist[[i]]$variable <- factor(A14_IAC07_tidylist[[i]]$variable, levels = c("TA070035", "TA070036", "TA070037", "TA070038", "TA070039", "TA070040"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, PSID_ID)
}

A14_IAC07_levlist <- lapply(A14_IAC07_list, set.ID.levels)

for(i in 1:23) {
  A14_IAC07_tidylist[[i]]$PSID_ID <- factor(A14_IAC07_tidylist[[i]]$PSID_ID, levels = A14_IAC07_levlist[[i]])
}

for(i in 1:23) {
  A14_IAC07_tidylist[[i]]$volunteer_type <- factor(A14_IAC07_tidylist[[i]]$volunteer_type)
}

create.A14.IAC07.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2007 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                      labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC07.heatmaps <- function(x){
  create.A14.IAC07.heatmap(A14_IAC07_tidylist[[x]])
}

# export graphs as width 3000 x height 1000 to view properly 

ggarrange(A14.IAC07.heatmaps(1) + rremove("legend"), A14.IAC07.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(4) + rremove("legend") + rremove("y.title"), 
          A14.IAC07.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(5) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC07.heatmaps(7) + rremove("legend"), A14.IAC07.heatmaps(8) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(9) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(10) + rremove("legend") + rremove("y.title"), 
          A14.IAC07.heatmaps(11) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(12) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC07.heatmaps(13) + rremove("legend"), A14.IAC07.heatmaps(14) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(15) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(16) + rremove("legend") + rremove("y.title"), 
          A14.IAC07.heatmaps(18) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(17) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC07.heatmaps(23) + rremove("legend"), A14.IAC07.heatmaps(22) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(21) + rremove("legend") + rremove("y.title"), A14.IAC07.heatmaps(20) + rremove("legend") + rremove("y.title"), 
          A14.IAC07.heatmaps(19) + rremove("y.title"), ncol = 5, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) =============================================================================== 

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA070041)

T07_TUH_FTLW <- TIAS2007[, c("TA070041", "FTL_COUNT")] %>% group_by(TA070041, FTL_COUNT) %>% summarise(Count = n())

T07_TUH_CAT <- TIAS2007[, c("TA070041", "CAT_07")] %>% group_by(TA070041, CAT_07) %>% summarise(Count = n())

T07_TUH_FTLCAT <- TIAS2007_FTL[, c("TA070041", "CAT_07")] %>% group_by(TA070041, CAT_07) %>% summarise(Count = n())

T07_TUH_IACCAT <- TIAS2007_IAC[, c("TA070041", "CAT_07")] %>% group_by(TA070041, CAT_07) %>% summarise(Count = n())

head(T07_TUH_CAT, 10)

ggplot(T07_TUH_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070041))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T07_TUH_FTLW, 11)

ggplot(T07_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070041)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2007_FTL$TA070041))

tuh.pie.ftl.07 <- ggplot(data = T07_TUH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070041))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "#009E73", "gold"), 
                    labels = c("Did not volunteer", "At least once a month", "Once a week"))

prop.table(table(TIAS2007_IAC$TA070041))

tuh.pie.iac.07 <- ggplot(data = T07_TUH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070041))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(tuh.pie.ftl.07, tuh.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ========================================================== 

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070060)

T07_SRU_FTLW <- TIAS2007[, c("TA070060", "FTL_COUNT")] %>% group_by(TA070060, FTL_COUNT) %>% summarise(Count = n())

T07_SRU_CAT <- TIAS2007[, c("TA070060", "CAT_07")] %>% group_by(TA070060, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRU_FTLW, aes(x = FTL_COUNT, y = TA070060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRU_CAT, aes(x = CAT_07, y = TA070060, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others =========================================================== 

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070061)

T07_SRE_FTLW <- TIAS2007[, c("TA070061", "FTL_COUNT")] %>% group_by(TA070061, FTL_COUNT) %>% summarise(Count = n())

T07_SRE_CAT <- TIAS2007[, c("TA070061", "CAT_07")] %>% group_by(TA070061, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRE_FTLW, aes(x = FTL_COUNT, y = TA070061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRE_CAT, aes(x = CAT_07, y = TA070061, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ======================================================================== 

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070052)

T07_SRS_FTLW <- TIAS2007[, c("TA070052", "FTL_COUNT")] %>% group_by(TA070052, FTL_COUNT) %>% summarise(Count = n())

T07_SRS_CAT <- TIAS2007[, c("TA070052", "CAT_07")] %>% group_by(TA070052, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRS_FTLW, aes(x = FTL_COUNT, y = TA070052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRS_CAT, aes(x = CAT_07, y = TA070052, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Being a Leader ============================================================================ 

####
# C1B. How Good At Leading Comp w/ Others: “Compared to other people, how good are you at being a leader?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070053)

T07_SRB_FTLW <- TIAS2007[, c("TA070053", "FTL_COUNT")] %>% group_by(TA070053, FTL_COUNT) %>% summarise(Count = n())

T07_SRB_CAT <- TIAS2007[, c("TA070053", "CAT_07")] %>% group_by(TA070053, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRB_FTLW, aes(x = FTL_COUNT, y = TA070053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRB_CAT, aes(x = CAT_07, y = TA070053, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Logical/Analytic Thinking ================================================================= 

####
# C1C. How Good At Logic Comp w/ Others: “Compared to other people, how good are you at logical, analytical thinking?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070054)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070054 = 8)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070054 = 8)) 

T07_SRL_FTLW <- TIAS2007[, c("TA070054", "FTL_COUNT")] %>% group_by(TA070054, FTL_COUNT) %>% summarise(Count = n())

T07_SRL_FTLW <- T07_SRL_FTLW[1:14, ]

T07_SRL_CAT <- TIAS2007[, c("TA070054", "CAT_07")] %>% group_by(TA070054, CAT_07) %>% summarise(Count = n())

T07_SRL_CAT <- T07_SRL_CAT[1:11, ]

ggplot(T07_SRL_FTLW, aes(x = FTL_COUNT, y = TA070054, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRL_CAT, aes(x = CAT_07, y = TA070054, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Helping Others Solve Their Problems ======================================================= 

####
# C1D. How Good At Helping Comp w/ Others: “Compared to other people, how good are you at helping others solve their problems?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070055)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070055 = 8)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070055 = 8)) 

T07_SRH_FTLW <- TIAS2007[, c("TA070055", "FTL_COUNT")] %>% group_by(TA070055, FTL_COUNT) %>% summarise(Count = n())

T07_SRH_FTLW <- T07_SRH_FTLW[1:14, ]

T07_SRH_CAT <- TIAS2007[, c("TA070055", "CAT_07")] %>% group_by(TA070055, CAT_07) %>% summarise(Count = n())

T07_SRH_CAT <- T07_SRH_CAT[1:9, ]

ggplot(T07_SRH_FTLW, aes(x = FTL_COUNT, y = TA070055, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRH_CAT, aes(x = CAT_07, y = TA070055, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ================================================================================================== 

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070049)

T07_HGP_FTLW <- TIAS2007[, c("TA070049", "FTL_COUNT")] %>% group_by(TA070049, FTL_COUNT) %>% summarise(Count = n())

T07_HGP_CAT <- TIAS2007[, c("TA070049", "CAT_07")] %>% group_by(TA070049, CAT_07) %>% summarise(Count = n())

ggplot(T07_HGP_FTLW, aes(x = FTL_COUNT, y = TA070049, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_HGP_CAT, aes(x = CAT_07, y = TA070049, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Intelligence ==============================================================================

####
# C1E How Intelligent Compared w/ Others: “Compared to other people, how would you rate your intelligence? (On a scale of 1 to 7, 
# where 1 means ‘A lot worse than other people’ and 7 means ‘A lot better than other people’)”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070056)

T07_SRT_FTLW <- TIAS2007[, c("TA070056", "FTL_COUNT")] %>% group_by(TA070056, FTL_COUNT) %>% summarise(Count = n())

T07_SRT_CAT <- TIAS2007[, c("TA070056", "CAT_07")] %>% group_by(TA070056, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRT_FTLW, aes(x = FTL_COUNT, y = TA070056, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRT_CAT, aes(x = CAT_07, y = TA070056, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Independence ============================================================================== 

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070057)

T07_SRI_FTLW <- TIAS2007[, c("TA070057", "FTL_COUNT")] %>% group_by(TA070057, FTL_COUNT) %>% summarise(Count = n())

T07_SRI_CAT <- TIAS2007[, c("TA070057", "CAT_07")] %>% group_by(TA070057, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRI_FTLW, aes(x = FTL_COUNT, y = TA070057, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRI_CAT, aes(x = CAT_07, y = TA070057, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================ 

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070058)

T07_SRC_FTLW <- TIAS2007[, c("TA070058", "FTL_COUNT")] %>% group_by(TA070058, FTL_COUNT) %>% summarise(Count = n())

T07_SRC_CAT <- TIAS2007[, c("TA070058", "CAT_07")] %>% group_by(TA070058, CAT_07) %>% summarise(Count = n())

ggplot(T07_SRC_FTLW, aes(x = FTL_COUNT, y = TA070058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRC_CAT, aes(x = CAT_07, y = TA070058, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ============================================================================== 

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070059)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070059 = 8)) 

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070059 = 8)) 

T07_SRD_FTLW <- TIAS2007[, c("TA070059", "FTL_COUNT")] %>% group_by(TA070059, FTL_COUNT) %>% summarise(Count = n())

T07_SRD_FTLW <- T07_SRD_FTLW[1:14, ]

T07_SRD_CAT <- TIAS2007[, c("TA070059", "CAT_07")] %>% group_by(TA070059, CAT_07) %>% summarise(Count = n())

T07_SRD_CAT <- T07_SRD_CAT[1:11, ]

ggplot(T07_SRD_FTLW, aes(x = FTL_COUNT, y = TA070059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SRD_CAT, aes(x = CAT_07, y = TA070059, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ====================================================================== 

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070726)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070726 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070726 = c(8, 9)))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070726 = c(8, 9))) 

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070726 = c(8, 9)))

T07_FSI_FTLW <- TIAS2007[, c("TA070726", "FTL_COUNT")] %>% group_by(TA070726, FTL_COUNT) %>% summarise(Count = n())

T07_FSI_FTLW <- T07_FSI_FTLW[1:12, ]

T07_FSI_CAT <- TIAS2007[, c("TA070726", "CAT_07")] %>% group_by(TA070726, CAT_07) %>% summarise(Count = n())

T07_FSI_CAT <- T07_FSI_CAT[1:10, ]

T07_FSI_FTLCAT <- TIAS2007_FTL[, c("TA070726", "CAT_07")] %>% group_by(TA070726, CAT_07) %>% summarise(Count = n())

T07_FSI_IACCAT <- TIAS2007_IAC[, c("TA070726", "CAT_07")] %>% group_by(TA070726, CAT_07) %>% summarise(Count = n())

T07_FSI_IACCAT <- T07_FSI_IACCAT[1:6, ]

head(T07_FSI_CAT, 10)

ggplot(T07_FSI_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070726))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T07_FSI_FTLW, 12)

ggplot(T07_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070726)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2007_FTL$TA070726))

fsi.pie.ftl.07 <- ggplot(data = T07_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070726))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightskyblue", "#009E73", "#0072B2", "turquoise"), 
                    labels = c("Hardly ever", "Less than once a month", "More than once a week", "Every day"))

prop.table(table(TIAS2007_IAC$TA070726))

fsi.pie.iac.07 <- ggplot(data = T07_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070726))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.07, fsi.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Binge Eating Frequency =======================================================================================================  

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070727)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070727 = 9))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070727 = 9))

TIAS2007_FTL <- TIAS2007_FTL %>% 
  replace_with_na(replace = list(TA070727 = 9))

TIAS2007_IAC <- TIAS2007_IAC %>% 
  replace_with_na(replace = list(TA070727 = 9))

T07_BEF_FTLW <- TIAS2007[, c("TA070727", "FTL_COUNT")] %>% group_by(TA070727, FTL_COUNT) %>% summarise(Count = n())

T07_BEF_FTLW <- T07_BEF_FTLW[1:12, ]

T07_BEF_CAT <- TIAS2007[, c("TA070727", "CAT_07")] %>% group_by(TA070727, CAT_07) %>% summarise(Count = n())

T07_BEF_CAT <- T07_BEF_CAT[1:10, ]

T07_BEF_FTLCAT <- TIAS2007_FTL[, c("TA070727", "CAT_07")] %>% group_by(TA070727, CAT_07) %>% summarise(Count = n())

T07_BEF_IACCAT <- TIAS2007_IAC[, c("TA070727", "CAT_07")] %>% group_by(TA070727, CAT_07) %>% summarise(Count = n())

T07_BEF_IACCAT <- T07_BEF_IACCAT[1:6, ]

head(T07_BEF_CAT, 12)

ggplot(T07_BEF_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070727))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T07_BEF_FTLW, 26)

ggplot(T07_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070727)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2007_FTL$TA070727))

bef.pie.ftl.07 <- ggplot(data = T07_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA070727))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "#009E73", "#0072B2", "turquoise"), 
                    labels = c("Never", "Less than once a month", "More than once a week", "Every day"))

prop.table(table(TIAS2007_IAC$TA070727))

bef.pie.iac.07 <- ggplot(data = T07_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA070727))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.07, bef.pie.iac.07, ncol = 2, nrow = 1, labels = c("FTL 2007", "IAC 2007"))

### Race - Hispanic ============================================================================================================== 

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070864)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070864 = 9))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070864 = 9))

T07_HIS_FTLW <- TIAS2007[, c("TA070864", "FTL_COUNT")] %>% group_by(TA070864, FTL_COUNT) %>% summarise(Count = n())

T07_HIS_FTLW <- T07_HIS_FTLW[1:10, ]

T07_HIS_CAT <- TIAS2007[, c("TA070864", "CAT_07")] %>% group_by(TA070864, CAT_07) %>% summarise(Count = n())

T07_HIS_CAT <- T07_HIS_CAT[1:8, ]

head(T07_HIS_CAT, 8)

ggplot(T07_HIS_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070864))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

head(T07_HIS_FTLW, 10)

ggplot(T07_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070864)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA070865)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070865 = c(8, 9)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070865 = c(8, 9)))

T07_RAC_FTLW <- TIAS2007[, c("TA070865", "FTL_COUNT")] %>% group_by(TA070865, FTL_COUNT) %>% summarise(Count = n())

T07_RAC_FTLW <- T07_RAC_FTLW[1:9, ]

T07_RAC_CAT <- TIAS2007[, c("TA070865", "CAT_07")] %>% group_by(TA070865, CAT_07) %>% summarise(Count = n())

T07_RAC_CAT <- T07_RAC_CAT[1:6, ]

head(T07_RAC_CAT, 6)

ggplot(T07_RAC_CAT, aes(x = CAT_07, y = Count, fill = as.factor(TA070865))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2007", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Other"))

head(T07_RAC_FTLW, 9)

ggplot(T07_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA070865)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2007", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Other"))

### Daily Cigarette Usage ======================================================================================================== 

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK)
####

table(TIAS$TA070730)

T07_CIG_FTLW <- TIAS2007[, c("TA070730", "FTL_COUNT")] %>% group_by(TA070730, FTL_COUNT) %>% summarise(Count = n())

T07_CIG_CAT <- TIAS2007[, c("TA070730", "CAT_07")] %>% group_by(TA070730, CAT_07) %>% summarise(Count = n())

ggplot(T07_CIG_FTLW, aes(x = FTL_COUNT, y = TA070730, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves")) 

ggplot(T07_CIG_CAT, aes(x = CAT_07, y = TA070730, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category")) 

### Body Mass Index (BMI) ======================================================================================================== 

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA070925)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070925 = 99))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070925 = 99))

T07_BMI_FTLW <- TIAS2007[, c("TA070925", "FTL_COUNT")] %>% group_by(TA070925, FTL_COUNT) %>% summarise(Count = n())

T07_BMI_FTLW <- T07_BMI_FTLW[1:233, ]

T07_BMI_CAT <- TIAS2007[, c("TA070925", "CAT_07")] %>% group_by(TA070925, CAT_07) %>% summarise(Count = n())

T07_BMI_CAT <- T07_BMI_CAT[1:227, ]

ggplot(T07_BMI_FTLW, aes(x = FTL_COUNT, y = TA070925, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

my_comparisons <- list( c("0", "1"), c("1", "2"), c("0", "2"))
ggboxplot(T07_BMI_FTLW, x = "FTL_COUNT", y = "TA070925", title = "TIAS 2007",
          color = "FTL_COUNT", palette = "jco", xlab = "# of Waves for Which Participant Identified as FTL", ylab = "Body Mass Index (BMI)", legend.title="# of FTL Waves") + 
  stat_compare_means(comparisons = my_comparisons) +  
  stat_compare_means(label.y = 50)   

ggplot(T07_BMI_CAT, aes(x = CAT_07, y = TA070925, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA070725)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070725 = c(98, 99)))

TIAS2007 <- TIAS2007 %>% 
  replace_with_na(replace = list(TA070725 = c(98, 99)))

T07_SLP_FTLW <- TIAS2007[, c("TA070725", "FTL_COUNT")] %>% group_by(TA070725, FTL_COUNT) %>% summarise(Count = n())

T07_SLP_FTLW <- T07_SLP_FTLW[1:20, ]

T07_SLP_CAT <- TIAS2007[, c("TA070725", "CAT_07")] %>% group_by(TA070725, CAT_07) %>% summarise(Count = n())

T07_SLP_CAT <- T07_SLP_CAT[1:17, ]

ggplot(T07_SLP_FTLW, aes(x = FTL_COUNT, y = TA070725, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2007", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T07_SLP_CAT, aes(x = CAT_07, y = TA070725, group = CAT_07, fill = as.factor(CAT_07))) +
  geom_boxplot() +
  labs(title = "TIAS 2007", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2009 ######################## 

### Amphetamine Usage ==============================================================================================================

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090814)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090814 = 9))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090814 = 9))

T09_AMP_FTLW <- TIAS2009[, c("TA090814", "FTL_COUNT")] %>% group_by(TA090814, FTL_COUNT) %>% summarise(Count = n())

T09_AMP_FTLW <- T09_AMP_FTLW[1:7,]

T09_AMP_CAT <- TIAS2009[, c("TA090814", "CAT_09")] %>% group_by(TA090814, CAT_09) %>% summarise(Count = n())

T09_AMP_CAT <- T09_AMP_CAT[1:6, ]

head(T09_AMP_CAT, 6)

ggplot(T09_AMP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090814)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "40 or more times"))

head(T09_AMP_FTLW, 7)

ggplot(T09_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090814)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "40 or more times"))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090835)

T09_BRB_FTLW <- TIAS2009[, c("TA090835", "FTL_COUNT")] %>% group_by(TA090835, FTL_COUNT) %>% summarise(Count = n())

T09_BRB_CAT <- TIAS2009[, c("TA090835", "CAT_09")] %>% group_by(TA090835, CAT_09) %>% summarise(Count = n())

head(T09_BRB_CAT, 7)

ggplot(T09_BRB_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090835)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times"))

head(T09_BRB_FTLW, 8)

ggplot(T09_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090835)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times"))

### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090822)

T09_MAR_FTLW <- TIAS2009[, c("TA090822", "FTL_COUNT")] %>% group_by(TA090822, FTL_COUNT) %>% summarise(Count = n())

T09_MAR_CAT <- TIAS2009[, c("TA090822", "CAT_09")] %>% group_by(TA090822, CAT_09) %>% summarise(Count = n())

head(T09_MAR_CAT, 6)

ggplot(T09_MAR_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090822)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "6-9 times", "10-19 times","40 or more times"))

head(T09_MAR_FTLW, 7)

ggplot(T09_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090822)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "6-9 times", "10-19 times","40 or more times"))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090806)

T09_DIP_FTLW <- TIAS2009[, c("TA090806", "FTL_COUNT")] %>% group_by(TA090806, FTL_COUNT) %>% summarise(Count = n())

T09_DIP_CAT <- TIAS2009[, c("TA090806", "CAT_09")] %>% group_by(TA090806, CAT_09) %>% summarise(Count = n())

head(T09_DIP_CAT, 5)

ggplot(T09_DIP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090806)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon"), 
                    labels = c("Never", "1-2 times", "6-9 times", "40 or more times")) 

head(T09_DIP_FTLW, 6)

ggplot(T09_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090806)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon"), 
                    labels = c("Never", "1-2 times", "6-9 times", "40 or more times")) 

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090851)

T09_STR_FTLW <- TIAS2009[, c("TA090851", "FTL_COUNT")] %>% group_by(TA090851, FTL_COUNT) %>% summarise(Count = n())

T09_STR_CAT <- TIAS2009[, c("TA090851", "CAT_09")] %>% group_by(TA090851, CAT_09) %>% summarise(Count = n())

head(T09_STR_CAT, 4)

ggplot(T09_STR_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090851)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1"), 
                    labels = c("Never", "1-2 times", "10-19 times")) 

head(T09_STR_FTLW, 5)

ggplot(T09_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090851)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1"), 
                    labels = c("Never", "1-2 times", "10-19 times")) 

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090843)

T09_TRQ_FTLW <- TIAS2009[, c("TA090843", "FTL_COUNT")] %>% group_by(TA090843, FTL_COUNT) %>% summarise(Count = n())

T09_TRQ_CAT <- TIAS2009[, c("TA090843", "CAT_09")] %>% group_by(TA090843, CAT_09) %>% summarise(Count = n())

head(T09_TRQ_CAT, 6)

ggplot(T09_TRQ_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090843)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "10-19 times", "20-39 times"))

head(T09_TRQ_FTLW, 7)

ggplot(T09_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090843)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "10-19 times", "20-39 times"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA090827)

T09_CCN_FTLW <- TIAS2009[, c("TA090827", "FTL_COUNT")] %>% group_by(TA090827, FTL_COUNT) %>% summarise(Count = n())

T09_CCN_CAT <- TIAS2009[, c("TA090827", "CAT_09")] %>% group_by(TA090827, CAT_09) %>% summarise(Count = n())

head(T09_CCN_CAT, 6)

ggplot(T09_CCN_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090827))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

head(T09_CCN_FTLW, 7)

ggplot(T09_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090827)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times"))

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA090797)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090797 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090797 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090797 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090797 = 9))  

T09_AAC_FTLW <- TIAS2009[, c("TA090797", "FTL_COUNT")] %>% group_by(TA090797, FTL_COUNT) %>% summarise(Count = n())

T09_AAC_FTLW <- T09_AAC_FTLW[1:14, ]

T09_AAC_CAT <- TIAS2009[, c("TA090797", "CAT_09")] %>% group_by(TA090797, CAT_09) %>% summarise(Count = n())

T09_AAC_CAT <- T09_AAC_CAT[1:10, ]

T09_AAC_FTLCAT <- TIAS2009_FTL[, c("TA090797", "CAT_09")] %>% group_by(TA090797, CAT_09) %>% summarise(Count = n())

T09_AAC_IACCAT <- TIAS2009_IAC[, c("TA090797", "CAT_09")] %>% group_by(TA090797, CAT_09) %>% summarise(Count = n())

T09_AAC_IACCAT <- T09_AAC_IACCAT[1:7, ]

head(T09_AAC_CAT, 10)

ggplot(T09_AAC_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090797))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
  labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T09_AAC_FTLW, 14)

ggplot(T09_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090797)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
  labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2009_FTL$TA090797))

aac.pie.ftl.09 <- ggplot(data = T09_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090797))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "mediumturquoise"), 
  labels = c("Never", "Less than once a month", "About once a week")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090797))

aac.pie.iac.09 <- ggplot(data = T09_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090797))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
  labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.09, aac.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))      

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA090798)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090798 = c(98, 99)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090798 = c(98, 99)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090798 = c(98, 99)))

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090798 = c(98, 99)))

T09_DAC_FTLW <- TIAS2009[, c("TA090798", "FTL_COUNT")] %>% group_by(TA090798, FTL_COUNT) %>% summarise(Count = n())

T09_DAC_FTLW <- T09_DAC_FTLW[1:24, ]

T09_DAC_CAT <- TIAS2009[, c("TA090798", "CAT_09")] %>% group_by(TA090798, CAT_09) %>% summarise(Count = n())

T09_DAC_CAT <- T09_DAC_CAT[1:21, ]

T09_DAC_FTLCAT <- TIAS2009_FTL[, c("TA090798", "CAT_09")] %>% group_by(TA090798, CAT_09) %>% summarise(Count = n())

T09_DAC_IACCAT <- TIAS2009_IAC[, c("TA090798", "CAT_09")] %>% group_by(TA090798, CAT_09) %>% summarise(Count = n())

T09_DAC_IACCAT <- T09_DAC_IACCAT[1:18, ]

head(T09_DAC_CAT, 21)

ggplot(T09_DAC_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090798))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred",
  "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
  labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "12 drinks",
  "13 drinks", "14 drinks", "15 drinks", "16 drinks", "20 drinks", "25 drinks"))

head(T09_DAC_FTLW, 24)

ggplot(T09_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090798)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred",
  "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
  labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "12 drinks",
  "13 drinks", "14 drinks", "15 drinks", "16 drinks", "20 drinks", "25 drinks"))

prop.table(table(TIAS2009_FTL$TA090798))

dac.pie.ftl.09 <- ggplot(data = T09_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090798))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values = c("skyblue", "mediumspringgreen", "mediumvioletred"), labels = c("Never", "3 drinks", "5 drinks")) + 
  theme_void()

prop.table(table(TIAS2009_IAC$TA090798))

dac.pie.iac.09 <- ggplot(data = T09_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090798))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred",
  "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
  labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "12 drinks",
  "13 drinks", "14 drinks", "15 drinks", "16 drinks", "20 drinks", "25 drinks")) + 
  theme_void() 

ggarrange(dac.pie.ftl.09, dac.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))  

### Degree to Which Condition Limits Normal Daily Activities ====================================================================  

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA090750)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090750 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090750 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090750 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090750 = 9))  

T09_DCN_FTLW <- TIAS2009[, c("TA090750", "FTL_COUNT")] %>% group_by(TA090750, FTL_COUNT) %>% summarise(Count = n())

T09_DCN_FTLW <- T09_DCN_FTLW[1:8, ]

T09_DCN_CAT <- TIAS2009[, c("TA090750", "CAT_09")] %>% group_by(TA090750, CAT_09) %>% summarise(Count = n())

T09_DCN_CAT <- T09_DCN_CAT[1:7, ]

T09_DCN_FTLCAT <- TIAS2009_FTL[, c("TA090750", "CAT_09")] %>% group_by(TA090750, CAT_09) %>% summarise(Count = n())

T09_DCN_IACCAT <- TIAS2009_IAC[, c("TA090750", "CAT_09")] %>% group_by(TA090750, CAT_09) %>% summarise(Count = n())

T09_DCN_IACCAT <- T09_DCN_IACCAT[1:5, ]

head(T09_DCN_CAT, 7)

ggplot(T09_DCN_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090750)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T09_DCN_FTLW, 8)

ggplot(T09_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090750)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

prop.table(table(TIAS2009_FTL$TA090750))

dcn.pie.ftl.09 <- ggplot(data = T09_DCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090750))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "green3"), 
                   labels = c("Inap: No chronic condition", "Somewhat")) 

prop.table(table(TIAS2009_IAC$TA090750))

dcn.pie.iac.09 <- ggplot(data = T09_DCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090750))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                 labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all")) 

ggarrange(dcn.pie.ftl.09, dcn.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090760)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090760 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090760 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090760 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090760 = 9))  

T09_DEP_FTLW <- TIAS2009[, c("TA090760", "FTL_COUNT")] %>% group_by(TA090760, FTL_COUNT) %>% summarise(Count = n())

T09_DEP_FTLW <- T09_DEP_FTLW[1:5, ]

T09_DEP_CAT <- TIAS2009[, c("TA090760", "CAT_09")] %>% group_by(TA090760, CAT_09) %>% summarise(Count = n())

T09_DEP_CAT <- T09_DEP_CAT[1:4, ]

T09_DEP_FTLCAT <- TIAS2009_FTL[, c("TA090760", "CAT_09")] %>% group_by(TA090760, CAT_09) %>% summarise(Count = n())

T09_DEP_IACCAT <- TIAS2009_IAC[, c("TA090760", "CAT_09")] %>% group_by(TA090760, CAT_09) %>% summarise(Count = n())

T09_DEP_IACCAT <- T09_DEP_IACCAT[1:2, ]

head(T09_DEP_CAT, 4)

ggplot(T09_DEP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090760)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

head(T09_DEP_FTLW, 5)

ggplot(T09_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090760)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090760))

dep.pie.ftl.09 <- ggplot(data = T09_DEP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090760))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090760))

dep.pie.iac.09 <- ggplot(data = T09_DEP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090760))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(dep.pie.ftl.09, dep.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090761)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090761 = c(8, 9)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090761 = c(8, 9)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090761 = c(8, 9))) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090761 = c(8, 9)))

T09_ANH_FTLW <- TIAS2009[, c("TA090761", "FTL_COUNT")] %>% group_by(TA090761, FTL_COUNT) %>% summarise(Count = n())

T09_ANH_FTLW <- T09_ANH_FTLW[1:5, ]

T09_ANH_CAT <- TIAS2009[, c("TA090761", "CAT_09")] %>% group_by(TA090761, CAT_09) %>% summarise(Count = n())

T09_ANH_CAT <- T09_ANH_CAT[1:4, ]

T09_ANH_FTLCAT <- TIAS2009_FTL[, c("TA090761", "CAT_09")] %>% group_by(TA090761, CAT_09) %>% summarise(Count = n())

T09_ANH_IACCAT <- TIAS2009_IAC[, c("TA090761", "CAT_09")] %>% group_by(TA090761, CAT_09) %>% summarise(Count = n())

T09_ANH_IACCAT <- T09_ANH_IACCAT[1:2, ]

head(T09_ANH_CAT, 4)

ggplot(T09_ANH_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090761)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

head(T09_ANH_FTLW, 5)

ggplot(T09_ANH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090761)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090761))

anh.pie.ftl.09 <- ggplot(data = T09_ANH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090761))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090761))

anh.pie.iac.09 <- ggplot(data = T09_ANH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090761))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(anh.pie.ftl.09, anh.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA090737)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090737 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090737 = 8)) 

T09_DPD_FTLW <- TIAS2009[, c("TA090737", "FTL_COUNT")] %>% group_by(TA090737, FTL_COUNT) %>% summarise(Count = n())

T09_DPD_FTLW <- T09_DPD_FTLW[1:4, ]

T09_DPD_CAT <- TIAS2009[, c("TA090737", "CAT_09")] %>% group_by(TA090737, CAT_09) %>% summarise(Count = n())

T09_DPD_CAT <- T09_DPD_CAT[1:3, ]

head(T09_DPD_CAT, 3)

ggplot(T09_DPD_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090737)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T09_DPD_FTLW, 4)

ggplot(T09_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090737)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA090738)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090738 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090738 = 8)) 

T09_BIP_FTLW <- TIAS2009[, c("TA090738", "FTL_COUNT")] %>% group_by(TA090738, FTL_COUNT) %>% summarise(Count = n())

T09_BIP_FTLW <- T09_BIP_FTLW[1:4, ]

T09_BIP_CAT <- TIAS2009[, c("TA090738", "CAT_09")] %>% group_by(TA090738, CAT_09) %>% summarise(Count = n())

T09_BIP_CAT <- T09_BIP_CAT[1:3, ]

head(T09_BIP_CAT, 3)

ggplot(T09_BIP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090738)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T09_BIP_FTLW, 4)

ggplot(T09_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090738)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Phobia Diagnosis ============================================================================================================= 

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA090741)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090741 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090741 = 8)) 

T09_PHB_FTLW <- TIAS2009[, c("TA090741", "FTL_COUNT")] %>% group_by(TA090741, FTL_COUNT) %>% summarise(Count = n())

T09_PHB_FTLW <- T09_PHB_FTLW[1:4, ]

T09_PHB_CAT <- TIAS2009[, c("TA090741", "CAT_09")] %>% group_by(TA090741, CAT_09) %>% summarise(Count = n())

T09_PHB_CAT <- T09_PHB_CAT[1:3, ]

head(T09_PHB_CAT, 3)

ggplot(T09_PHB_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090741)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T09_PHB_FTLW, 4)

ggplot(T09_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090741)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Anxiety Disorders Diagnosis ================================================================================================== 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA090740)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090740 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090740 = 8)) 

T09_ANX_FTLW <- TIAS2009[, c("TA090740", "FTL_COUNT")] %>% group_by(TA090740, FTL_COUNT) %>% summarise(Count = n())

T09_ANX_FTLW <- T09_ANX_FTLW[1:4, ]

T09_ANX_CAT <- TIAS2009[, c("TA090740", "CAT_09")] %>% group_by(TA090740, CAT_09) %>% summarise(Count = n())

T09_ANX_CAT <- T09_ANX_CAT[1:3, ]

head(T09_ANX_CAT, 3)

ggplot(T09_ANX_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090740)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T09_ANX_FTLW, 4)

ggplot(T09_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090740)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### OCD Diagnosis ================================================================================================================ 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA090744)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090744 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090744 = 8)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090744 = 8)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090744 = 8))

T09_OCD_FTLW <- TIAS2009[, c("TA090744", "FTL_COUNT")] %>% group_by(TA090744, FTL_COUNT) %>% summarise(Count = n())

T09_OCD_FTLW <- T09_OCD_FTLW[1:4, ]

T09_OCD_CAT <- TIAS2009[, c("TA090744", "CAT_09")] %>% group_by(TA090744, CAT_09) %>% summarise(Count = n())

T09_OCD_CAT <- T09_OCD_CAT[1:3, ]

head(T09_OCD_CAT, 3)

ggplot(T09_OCD_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090744)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T09_OCD_FTLW, 4)

ggplot(T09_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090744)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Emotional/Nervous/Psychiatric Problems ======================================================================================= 

###
# H12. WTR Ever Had Emotional/Psych Problems: "Has a doctor or other health professional ever told you that you have or had any emotional, nervous, or psychiatric problems?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
###

table(TIAS$TA090735)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090735 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090735 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090735 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090735 = 9))

T09_ENP_FTLW <- TIAS2009[, c("TA090735", "FTL_COUNT")] %>% group_by(TA090735, FTL_COUNT) %>% summarise(Count = n())

T09_ENP_FTLW <- T09_ENP_FTLW[1:5, ]

T09_ENP_CAT <- TIAS2009[, c("TA090735", "CAT_09")] %>% group_by(TA090735, CAT_09) %>% summarise(Count = n())

T09_ENP_CAT <- T09_ENP_CAT[1:4, ]

T09_ENP_FTLCAT <- TIAS2009_FTL[, c("TA090735", "CAT_09")] %>% group_by(TA090735, CAT_09) %>% summarise(Count = n())

T09_ENP_IACCAT <- TIAS2009_IAC[, c("TA090735", "CAT_09")] %>% group_by(TA090735, CAT_09) %>% summarise(Count = n())

T09_ENP_IACCAT <- T09_ENP_IACCAT[1:2, ]

head(T09_ENP_CAT, 4)

ggplot(T09_ENP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090735)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

head(T09_ENP_FTLW, 5)

ggplot(T09_ENP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090735)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090735))

enp.pie.ftl.09 <- ggplot(data = T09_ENP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090735))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No")) + 
  theme_void()

prop.table(table(TIAS2009_IAC$TA090735))

enp.pie.iac.09 <- ggplot(data = T09_ENP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090735))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No")) + 
  theme_void()

ggarrange(enp.pie.ftl.09, enp.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA090983)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090983 = 99)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090983 = 99)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090983 = 99)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090983 = 99))

T09_NPD_FTLW <- TIAS2009[, c("TA090983", "FTL_COUNT")] %>% group_by(TA090983, FTL_COUNT) %>% summarise(Count = n())

T09_NPD_FTLW <- T09_NPD_FTLW[1:37, ]

T09_NPD_CAT <- TIAS2009[, c("TA090983", "CAT_09")] %>% group_by(TA090983, CAT_09) %>% summarise(Count = n())

T09_NPD_CAT <- T09_NPD_CAT[1:31, ]

ggplot(T09_NPD_FTLW, aes(x = FTL_COUNT, y = TA090983, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_NPD_CAT, aes(x = CAT_09, y = TA090983, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA090978)

T09_SOA_FTLW <- TIAS2009[, c("TA090978", "FTL_COUNT")] %>% group_by(TA090978, FTL_COUNT) %>% summarise(Count = n())

T09_SOA_CAT <- TIAS2009[, c("TA090978", "CAT_09")] %>% group_by(TA090978, CAT_09) %>% summarise(Count = n())

ggplot(T09_SOA_FTLW, aes(x = FTL_COUNT, y = TA090978, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SOA_CAT, aes(x = CAT_09, y = TA090978, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Worry ========================================================================================================= 

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA090977)

T09_WRY_FTLW <- TIAS2009[, c("TA090977", "FTL_COUNT")] %>% group_by(TA090977, FTL_COUNT) %>% summarise(Count = n())

T09_WRY_CAT <- TIAS2009[, c("TA090977", "CAT_09")] %>% group_by(TA090977, CAT_09) %>% summarise(Count = n())

ggplot(T09_WRY_FTLW, aes(x = FTL_COUNT, y = TA090977, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_WRY_CAT, aes(x = CAT_09, y = TA090977, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Paid Employment Since Jan 1 of Prior Year ====================================================================================

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA090140)

T09_EPJ_FTLW <- TIAS2009[, c("TA090140", "FTL_COUNT")] %>% group_by(TA090140, FTL_COUNT) %>% summarise(Count = n())

T09_EPJ_CAT <- TIAS2009[, c("TA090140", "CAT_09")] %>% group_by(TA090140, CAT_09) %>% summarise(Count = n())

T09_EPJ_FTLCAT <- TIAS2009_FTL[, c("TA090140", "CAT_09")] %>% group_by(TA090140, CAT_09) %>% summarise(Count = n())

T09_EPJ_IACCAT <- TIAS2009_IAC[, c("TA090140", "CAT_09")] %>% group_by(TA090140, CAT_09) %>% summarise(Count = n())

head(T09_EPJ_CAT, 5)

ggplot(T09_EPJ_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T09_EPJ_FTLW, 8)

ggplot(T09_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2009_FTL$TA090140))

epj.pie.ftl.09 <- ggplot(data = T09_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090140))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightgoldenrod1", "lightpink"), labels = c("Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090140))

epj.pie.iac.09 <- ggplot(data = T09_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090140))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.09, epj.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA090358)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090358 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090358 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090358 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090358 = 9))

T09_EPH_FTLW <- TIAS2009[, c("TA090358", "FTL_COUNT")] %>% group_by(TA090358, FTL_COUNT) %>% summarise(Count = n())

T09_EPH_FTLW <- T09_EPH_FTLW[1:7, ]

T09_EPH_CAT <- TIAS2009[, c("TA090358", "CAT_09")] %>% group_by(TA090358, CAT_09) %>% summarise(Count = n())

T09_EPH_CAT <- T09_EPH_CAT[1:6, ]

T09_EPH_FTLCAT <- TIAS2009_FTL[, c("TA090358", "CAT_09")] %>% group_by(TA090358, CAT_09) %>% summarise(Count = n())

T09_EPH_IACCAT <- TIAS2009_IAC[, c("TA090358", "CAT_09")] %>% group_by(TA090358, CAT_09) %>% summarise(Count = n())

T09_EPH_IACCAT <- T09_EPH_IACCAT[1:3, ]

head(T09_EPH_CAT, 6)

ggplot(T09_EPH_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090358)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

head(T09_EPH_FTLW, 7)

ggplot(T09_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090358)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2009_FTL$TA090358))

eph.pie.ftl.09 <- ggplot(data = T09_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090358))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090358))

eph.pie.iac.09 <- ggplot(data = T09_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090358))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.09, eph.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Current Marital Status ======================================================================================================= 

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090078)

T09_CMS_FTLW <- TIAS2009[, c("TA090078", "FTL_COUNT")] %>% group_by(TA090078, FTL_COUNT) %>% summarise(Count = n())

T09_CMS_FTLW <- T09_CMS_FTLW[1:7, ]

T09_CMS_CAT <- TIAS2009[, c("TA090078", "CAT_09")] %>% group_by(TA090078, CAT_09) %>% summarise(Count = n())

T09_CMS_CAT <- T09_CMS_CAT[1:6, ]

head(T09_CMS_CAT, 6)

ggplot(T09_CMS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "mediumpurple1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

head(T09_CMS_FTLW, 7)

ggplot(T09_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "mediumpurple1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA090087)

T09_RRN_FTLW <- TIAS2009[, c("TA090087", "FTL_COUNT")] %>% group_by(TA090087, FTL_COUNT) %>% summarise(Count = n())

T09_RRN_CAT <- TIAS2009[, c("TA090087", "CAT_09")] %>% group_by(TA090087, CAT_09) %>% summarise(Count = n())

T09_RRN_FTLCAT <- TIAS2009_FTL[, c("TA090087", "CAT_09")] %>% group_by(TA090087, CAT_09) %>% summarise(Count = n())

T09_RRN_IACCAT <- TIAS2009_IAC[, c("TA090087", "CAT_09")] %>% group_by(TA090087, CAT_09) %>% summarise(Count = n())

head(T09_RRN_CAT, 5)

ggplot(T09_RRN_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090087)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

head(T09_RRN_FTLW, 6)

ggplot(T09_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090087)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090087))

rrn.pie.ftl.09 <- ggplot(data = T09_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090087))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkviolet", "deeppink"), labels = c("Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090087))

rrn.pie.iac.09 <- ggplot(data = T09_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090087))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.09, rrn.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Number of Children =========================================================================================================== 

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA090100)

T09_CHL_FTLW <- TIAS2009[, c("TA090100", "FTL_COUNT")] %>% group_by(TA090100, FTL_COUNT) %>% summarise(Count = n())

T09_CHL_CAT <- TIAS2009[, c("TA090100", "CAT_09")] %>% group_by(TA090100, CAT_09) %>% summarise(Count = n())

ggplot(T09_CHL_FTLW, aes(x = FTL_COUNT, y = TA090100, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_CHL_CAT, aes(x = CAT_09, y = TA090100, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090590)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090590 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090590 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090590 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090590 = 9))

T09_HSG_FTLW <- TIAS2009[, c("TA090590", "FTL_COUNT")] %>% group_by(TA090590, FTL_COUNT) %>% summarise(Count = n())

T09_HSG_FTLW <- T09_HSG_FTLW[1:8, ]

T09_HSG_CAT <- TIAS2009[, c("TA090590", "CAT_09")] %>% group_by(TA090590, CAT_09) %>% summarise(Count = n())

T09_HSG_CAT <- T09_HSG_CAT[1:6, ]

T09_HSG_FTLCAT <- TIAS2009_FTL[, c("TA090590", "CAT_09")] %>% group_by(TA090590, CAT_09) %>% summarise(Count = n())

T09_HSG_IACCAT <- TIAS2009_IAC[, c("TA090590", "CAT_09")] %>% group_by(TA090590, CAT_09) %>% summarise(Count = n())

T09_HSG_IACCAT <- T09_HSG_IACCAT[1:3, ]

head(T09_HSG_CAT, 6)

ggplot(T09_HSG_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090590)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

head(T09_HSG_FTLW, 8)

ggplot(T09_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090590)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

prop.table(table(TIAS2009_FTL$TA090590))

hsg.pie.ftl.09 <- ggplot(data = T09_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090590))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090590))

hsg.pie.iac.09 <- ggplot(data = T09_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090590))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither")) +
  theme_void() 

ggarrange(hsg.pie.ftl.09, hsg.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### College Education ============================================================================================================  

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA090611)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090611 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090611 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090611 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090611 = 9))

T09_CLG_FTLW <- TIAS2009[, c("TA090611", "FTL_COUNT")] %>% group_by(TA090611, FTL_COUNT) %>% summarise(Count = n())

T09_CLG_FTLW <- T09_CLG_FTLW[1:8, ]

T09_CLG_CAT <- TIAS2009[, c("TA090611", "CAT_09")] %>% group_by(TA090611, CAT_09) %>% summarise(Count = n())

T09_CLG_CAT <- T09_CLG_CAT[1:5, ]

T09_CLG_FTLCAT <- TIAS2009_FTL[, c("TA090611", "CAT_09")] %>% group_by(TA090611, CAT_09) %>% summarise(Count = n())

T09_CLG_IACCAT <- TIAS2009_IAC[, c("TA090611", "CAT_09")] %>% group_by(TA090611, CAT_09) %>% summarise(Count = n())

T09_CLG_IACCAT <- T09_CLG_IACCAT[1:3, ]

head(T09_CLG_CAT, 5)

ggplot(T09_CLG_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090611)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

head(T09_CLG_FTLW, 8)

ggplot(T09_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090611)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

prop.table(table(TIAS2009_FTL$TA090611))

clg.pie.ftl.09 <- ggplot(data = T09_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090611))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightpink"), labels = c("Attended College", "No HS Diploma or GED")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090611))

clg.pie.iac.09 <- ggplot(data = T09_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090611))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

ggarrange(clg.pie.ftl.09, clg.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 99 (NA/DK)
####

table(TIAS$TA090991)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090991 = 99)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090991 = 99)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090991 = 99)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090991 = 99))

T09_HEL_FTLW <- TIAS2009[, c("TA090991", "FTL_COUNT")] %>% group_by(TA090991, FTL_COUNT) %>% summarise(Count = n())

T09_HEL_FTLW <- T09_HEL_FTLW[1:16, ]

T09_HEL_CAT <- TIAS2009[, c("TA090991", "CAT_09")] %>% group_by(TA090991, CAT_09) %>% summarise(Count = n())

T09_HEL_CAT <- T09_HEL_CAT[1:13, ]

T09_HEL_FTLCAT <- TIAS2009_FTL[, c("TA090991", "CAT_09")] %>% group_by(TA090991, CAT_09) %>% summarise(Count = n())

T09_HEL_IACCAT <- TIAS2009_IAC[, c("TA090991", "CAT_09")] %>% group_by(TA090991, CAT_09) %>% summarise(Count = n())

T09_HEL_IACCAT <- T09_HEL_IACCAT[1:10, ]

head(T09_HEL_CAT, 13)

ggplot(T09_HEL_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090991))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))
                              
head(T09_HEL_FTLW, 16)

ggplot(T09_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090991)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

prop.table(table(TIAS2009_FTL$TA090991))

hel.pie.ftl.09 <- ggplot(data = T09_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090991))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma")) 
                              
prop.table(table(TIAS2009_IAC$TA090991))

hel.pie.iac.09 <- ggplot(data = T09_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090991))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
  "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

ggarrange(hel.pie.ftl.09, hel.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Responsibility - Earning Own Living ========================================================================================== 

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090045)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090045 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090045 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090045 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090045 = 9))

T09_REO_FTLW <- TIAS2009[, c("TA090045", "FTL_COUNT")] %>% group_by(TA090045, FTL_COUNT) %>% summarise(Count = n())

T09_REO_FTLW <- T09_REO_FTLW[1:11, ]

T09_REO_CAT <- TIAS2009[, c("TA090045", "CAT_09")] %>% group_by(TA090045, CAT_09) %>% summarise(Count = n())

T09_REO_CAT <- T09_REO_CAT[1:9, ]

T09_REO_FTLCAT <- TIAS2009_FTL[, c("TA090045", "CAT_09")] %>% group_by(TA090045, CAT_09) %>% summarise(Count = n())

T09_REO_FTLCAT <- T09_REO_FTLCAT[1:4, ]

T09_REO_IACCAT <- TIAS2009_IAC[, c("TA090045", "CAT_09")] %>% group_by(TA090045, CAT_09) %>% summarise(Count = n())

T09_REO_IACCAT <- T09_REO_IACCAT[1:5, ]

head(T09_REO_CAT, 9)

ggplot(T09_REO_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T09_REO_FTLW, 11)

ggplot(T09_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2009_FTL$TA090045))

reo.pie.ftl.09 <- ggplot(data = T09_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("mediumturquoise", "deepskyblue", "gold", "green3"),
  labels = c("Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2009_IAC$TA090045))

reo.pie.iac.09 <- ggplot(data = T09_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(reo.pie.ftl.09, reo.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Responsibility - Paying Own Rent ============================================================================================= 

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090046)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090046 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090046 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090046 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090046 = 9))

T09_POR_FTLW <- TIAS2009[, c("TA090046", "FTL_COUNT")] %>% group_by(TA090046, FTL_COUNT) %>% summarise(Count = n())

T09_POR_FTLW <- T09_POR_FTLW[1:13, ]

T09_POR_CAT <- TIAS2009[, c("TA090046", "CAT_09")] %>% group_by(TA090046, CAT_09) %>% summarise(Count = n())

T09_POR_CAT <- T09_POR_CAT[1:11, ]

T09_POR_FTLCAT <- TIAS2009_FTL[, c("TA090046", "CAT_09")] %>% group_by(TA090046, CAT_09) %>% summarise(Count = n())

T09_POR_FTLCAT <- T09_POR_FTLCAT[1:5, ]

T09_POR_IACCAT <- TIAS2009_IAC[, c("TA090046", "CAT_09")] %>% group_by(TA090046, CAT_09) %>% summarise(Count = n())

T09_POR_IACCAT <- T09_POR_IACCAT[1:6, ]

head(T09_POR_CAT, 11)

ggplot(T09_POR_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2005", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T09_POR_FTLW, 13)

ggplot(T09_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2005", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2009_FTL$TA090046)) 

por.pie.ftl.09 <- ggplot(data = T09_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

prop.table(table(TIAS2009_IAC$TA090046))

por.pie.iac.09 <- ggplot(data = T09_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.09, por.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Responsibility - Paying Own Bills ============================================================================================ 

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090047)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090047 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090047 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090047 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090047 = 9))

T09_POB_FTLW <- TIAS2009[, c("TA090047", "FTL_COUNT")] %>% group_by(TA090047, FTL_COUNT) %>% summarise(Count = n())

T09_POB_FTLW <- T09_POB_FTLW[1:14, ]

T09_POB_CAT <- TIAS2009[, c("TA090047", "CAT_09")] %>% group_by(TA090047, CAT_09) %>% summarise(Count = n())

T09_POB_CAT <- T09_POB_CAT[1:11, ]

T09_POB_FTLCAT <- TIAS2009_FTL[, c("TA090047", "CAT_09")] %>% group_by(TA090047, CAT_09) %>% summarise(Count = n())

T09_POB_IACCAT <- TIAS2009_IAC[, c("TA090047", "CAT_09")] %>% group_by(TA090047, CAT_09) %>% summarise(Count = n())

T09_POB_IACCAT <- T09_POB_IACCAT[1:6, ]

head(T09_POB_CAT, 11)

ggplot(T09_POB_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

head(T09_POB_FTLW, 14)

ggplot(T09_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2009_FTL$TA090047))

pob.pie.ftl.09 <- ggplot(data = T09_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Half of the time", "Most of the time", "All of the time", "No bills"))  

prop.table(table(TIAS2009_IAC$TA090047))

pob.pie.iac.09 <- ggplot(data = T09_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.09, pob.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090048)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090048 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090048 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090048 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090048 = 9))

T09_RMM_FTLW <- TIAS2009[, c("TA090048", "FTL_COUNT")] %>% group_by(TA090048, FTL_COUNT) %>% summarise(Count = n())

T09_RMM_FTLW <- T09_RMM_FTLW[1:13, ]

T09_RMM_CAT <- TIAS2009[, c("TA090048", "CAT_09")] %>% group_by(TA090048, CAT_09) %>% summarise(Count = n())

T09_RMM_CAT <- T09_RMM_CAT[1:10, ]

T09_RMM_FTLCAT <- TIAS2009_FTL[, c("TA090048", "CAT_09")] %>% group_by(TA090048, CAT_09) %>% summarise(Count = n())

T09_RMM_IACCAT <- TIAS2009_IAC[, c("TA090048", "CAT_09")] %>% group_by(TA090048, CAT_09) %>% summarise(Count = n())

T09_RMM_IACCAT <- T09_RMM_IACCAT[1:5, ]

head(T09_RMM_CAT, 10)

ggplot(T09_RMM_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T09_RMM_FTLW, 13)

ggplot(T09_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2009_FTL$TA090048))

rmm.pie.ftl.09 <- ggplot(data = T09_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090048))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2009_IAC$TA090048))

rmm.pie.iac.09 <- ggplot(data = T09_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090048))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(rmm.pie.ftl.09, rmm.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### How Good at Taking Responsibility for Actions ================================================================================ 

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090049)

T09_ROA_FTLW <- TIAS2009[, c("TA090049", "FTL_COUNT")] %>% group_by(TA090049, FTL_COUNT) %>% summarise(Count = n())

T09_ROA_CAT <- TIAS2009[, c("TA090049", "CAT_09")] %>% group_by(TA090049, CAT_09) %>% summarise(Count = n())

ggplot(T09_ROA_FTLW, aes(x = FTL_COUNT, y = TA090049, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_ROA_CAT, aes(x = CAT_09, y = TA090049, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Money Management ================================================================================================= 

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090051)

T09_GMM_FTLW <- TIAS2009[, c("TA090051", "FTL_COUNT")] %>% group_by(TA090051, FTL_COUNT) %>% summarise(Count = n())

T09_GMM_CAT <- TIAS2009[, c("TA090051", "CAT_09")] %>% group_by(TA090051, CAT_09) %>% summarise(Count = n())

ggplot(T09_GMM_FTLW, aes(x = FTL_COUNT, y = TA090051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_GMM_CAT, aes(x = CAT_09, y = TA090051, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ================================================================================== 

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA090052)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090052 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090052 = 9)) 

T09_CCB_FTLW <- TIAS2009[, c("TA090052", "FTL_COUNT")] %>% group_by(TA090052, FTL_COUNT) %>% summarise(Count = n())

T09_CCB_FTLW <- T09_CCB_FTLW[1:14, ]

T09_CCB_CAT <- TIAS2009[, c("TA090052", "CAT_09")] %>% group_by(TA090052, CAT_09) %>% summarise(Count = n())

T09_CCB_CAT <- T09_CCB_CAT[1:12, ]

ggplot(T09_CCB_FTLW, aes(x = FTL_COUNT, y = TA090052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_CCB_CAT, aes(x = CAT_09, y = TA090052, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### MIDUS M1 - Happiness ========================================================================================================= 

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090929)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090929 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090929 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090929 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090929 = 9))

T09_M01_FTLW <- TIAS2009[, c("TA090929", "FTL_COUNT")] %>% group_by(TA090929, FTL_COUNT) %>% summarise(Count = n())

T09_M01_FTLW <- T09_M01_FTLW[1:13, ]

T09_M01_CAT <- TIAS2009[, c("TA090929", "CAT_09")] %>% group_by(TA090929, CAT_09) %>% summarise(Count = n())

T09_M01_CAT <- T09_M01_CAT[1:10, ]

T09_M01_FTLCAT <- TIAS2009_FTL[, c("TA090929", "CAT_09")] %>% group_by(TA090929, CAT_09) %>% summarise(Count = n())

T09_M01_IACCAT <- TIAS2009_IAC[, c("TA090929", "CAT_09")] %>% group_by(TA090929, CAT_09) %>% summarise(Count = n())

T09_M01_IACCAT <- T09_M01_IACCAT[1:6, ]

head(T09_M01_CAT, 10)

ggplot(T09_M01_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090929)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M01_FTLW, 13)

ggplot(T09_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090929)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090929))

m01.pie.ftl.09 <- ggplot(data = T09_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090929))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2009_IAC$TA090929))

m01.pie.iac.09 <- ggplot(data = T09_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090929))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.09, m01.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M2 - Interest in Life ================================================================================================== 

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090930)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090930 = c(8, 9))) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090930 = c(8, 9)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090930 = c(8, 9)))

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090930 = c(8, 9)))

T09_M02_FTLW <- TIAS2009[, c("TA090930", "FTL_COUNT")] %>% group_by(TA090930, FTL_COUNT) %>% summarise(Count = n())

T09_M02_FTLW <- T09_M02_FTLW[1:11, ]

T09_M02_CAT <- TIAS2009[, c("TA090930", "CAT_09")] %>% group_by(TA090930, CAT_09) %>% summarise(Count = n())

T09_M02_CAT <- T09_M02_CAT[1:9, ]

T09_M02_FTLCAT <- TIAS2009_FTL[, c("TA090930", "CAT_09")] %>% group_by(TA090930, CAT_09) %>% summarise(Count = n())

T09_M02_FTLCAT <- T09_M02_FTLCAT[1:4, ]

T09_M02_IACCAT <- TIAS2009_IAC[, c("TA090930", "CAT_09")] %>% group_by(TA090930, CAT_09) %>% summarise(Count = n())

T09_M02_IACCAT <- T09_M02_IACCAT[1:6, ]

head(T09_M02_CAT, 9)

ggplot(T09_M02_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090930)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M02_FTLW, 11)

ggplot(T09_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090930)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090930))

m02.pie.ftl.09 <- ggplot(data = T09_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090930))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("gold", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Once or twice", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2009_IAC$TA090930))

m02.pie.iac.09 <- ggplot(data = T09_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090930))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.09, m02.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M3 - Satisfaction ======================================================================================================  

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090931)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090931 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090931 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090931 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090931 = 9))

T09_M03_FTLW <- TIAS2009[, c("TA090931", "FTL_COUNT")] %>% group_by(TA090931, FTL_COUNT) %>% summarise(Count = n())

T09_M03_FTLW <- T09_M03_FTLW[1:11, ]

T09_M03_CAT <- TIAS2009[, c("TA090931", "CAT_09")] %>% group_by(TA090931, CAT_09) %>% summarise(Count = n())

T09_M03_CAT <- T09_M03_CAT[1:9, ]

T09_M03_FTLCAT <- TIAS2009_FTL[, c("TA090931", "CAT_09")] %>% group_by(TA090931, CAT_09) %>% summarise(Count = n())

T09_M03_IACCAT <- TIAS2009_IAC[, c("TA090931", "CAT_09")] %>% group_by(TA090931, CAT_09) %>% summarise(Count = n())

T09_M03_IACCAT <- T09_M03_IACCAT[1:6, ]

head(T09_M03_CAT, 9)

ggplot(T09_M03_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090931)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M03_FTLW, 11)

ggplot(T09_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090931)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090931))

m03.pie.ftl.09 <- ggplot(data = T09_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090931))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2009_IAC$TA090931))

m03.pie.iac.09 <- ggplot(data = T09_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090931))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.09, m03.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M4 - Contribution of Something Important to Society ==================================================================== 

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090932)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090932 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090932 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090932 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090932 = 9))

T09_M04_FTLW <- TIAS2009[, c("TA090932", "FTL_COUNT")] %>% group_by(TA090932, FTL_COUNT) %>% summarise(Count = n())

T09_M04_FTLW <- T09_M04_FTLW[1:14, ]

T09_M04_CAT <- TIAS2009[, c("TA090932", "CAT_09")] %>% group_by(TA090932, CAT_09) %>% summarise(Count = n())

T09_M04_CAT <- T09_M04_CAT[1:12, ]

T09_M04_FTLCAT <- TIAS2009_FTL[, c("TA090932", "CAT_09")] %>% group_by(TA090932, CAT_09) %>% summarise(Count = n())

T09_M04_IACCAT <- TIAS2009_IAC[, c("TA090932", "CAT_09")] %>% group_by(TA090932, CAT_09) %>% summarise(Count = n())

T09_M04_IACCAT <- T09_M04_IACCAT[1:6, ]

head(T09_M04_CAT, 12)

ggplot(T09_M04_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090932)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M04_FTLW, 14)

ggplot(T09_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090932)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090932))

m04.pie.ftl.09 <- ggplot(data = T09_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090932))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090932))

m04.pie.iac.09 <- ggplot(data = T09_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090932))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.09, m04.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M5 - Belonging to Community ============================================================================================ 

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090933)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090933 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090933 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090933 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090933 = 9))

T09_M05_FTLW <- TIAS2009[, c("TA090933", "FTL_COUNT")] %>% group_by(TA090933, FTL_COUNT) %>% summarise(Count = n())

T09_M05_FTLW <- T09_M05_FTLW[1:13, ]

T09_M05_CAT <- TIAS2009[, c("TA090933", "CAT_09")] %>% group_by(TA090933, CAT_09) %>% summarise(Count = n())

T09_M05_CAT <- T09_M05_CAT[1:11, ]

T09_M05_FTLCAT <- TIAS2009_FTL[, c("TA090933", "CAT_09")] %>% group_by(TA090933, CAT_09) %>% summarise(Count = n())

T09_M05_IACCAT <- TIAS2009_IAC[, c("TA090933", "CAT_09")] %>% group_by(TA090933, CAT_09) %>% summarise(Count = n())

T09_M05_IACCAT <- T09_M05_IACCAT[1:6, ]

head(T09_M05_CAT, 11)

ggplot(T09_M05_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090933)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M05_FTLW, 13)

ggplot(T09_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090933)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090933))

m05.pie.ftl.09 <- ggplot(data = T09_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090933))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090933))

m05.pie.iac.09 <- ggplot(data = T09_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090933))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.09, m05.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M6 - Society Getting Better ============================================================================================ 

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090934)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090934 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090934 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090934 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090934 = 9))

T09_M06_FTLW <- TIAS2009[, c("TA090934", "FTL_COUNT")] %>% group_by(TA090934, FTL_COUNT) %>% summarise(Count = n())

T09_M06_FTLW <- T09_M06_FTLW[1:14, ]

T09_M06_CAT <- TIAS2009[, c("TA090934", "CAT_09")] %>% group_by(TA090934, CAT_09) %>% summarise(Count = n())

T09_M06_CAT <- T09_M06_CAT[1:11, ]

T09_M06_FTLCAT <- TIAS2009_FTL[, c("TA090934", "CAT_09")] %>% group_by(TA090934, CAT_09) %>% summarise(Count = n())

T09_M06_IACCAT <- TIAS2009_IAC[, c("TA090934", "CAT_09")] %>% group_by(TA090934, CAT_09) %>% summarise(Count = n())

T09_M06_IACCAT <- T09_M06_IACCAT[1:6, ]

head(T09_M06_CAT, 11)

ggplot(T09_M06_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090934)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M06_FTLW, 14)

ggplot(T09_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090934)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090934))

m06.pie.ftl.09 <- ggplot(data = T09_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090934))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090934))

m06.pie.iac.09 <- ggplot(data = T09_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090934))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.09, m06.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M7 - People Basically Good ============================================================================================= 

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090935)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090935 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090935 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090935 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090935 = 9))

T09_M07_FTLW <- TIAS2009[, c("TA090935", "FTL_COUNT")] %>% group_by(TA090935, FTL_COUNT) %>% summarise(Count = n())

T09_M07_FTLW <- T09_M07_FTLW[1:15, ]

T09_M07_CAT <- TIAS2009[, c("TA090935", "CAT_09")] %>% group_by(TA090935, CAT_09) %>% summarise(Count = n())

T09_M07_CAT <- T09_M07_CAT[1:12, ]

T09_M07_FTLCAT <- TIAS2009_FTL[, c("TA090935", "CAT_09")] %>% group_by(TA090935, CAT_09) %>% summarise(Count = n())

T09_M07_IACCAT <- TIAS2009_IAC[, c("TA090935", "CAT_09")] %>% group_by(TA090935, CAT_09) %>% summarise(Count = n())

T09_M07_IACCAT <- T09_M07_IACCAT[1:6, ]

head(T09_M07_CAT, 12)

ggplot(T09_M07_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090935)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M07_FTLW, 15)

ggplot(T09_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090935)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090935))

m07.pie.ftl.09 <- ggplot(data = T09_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090935))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090935))

m07.pie.iac.09 <- ggplot(data = T09_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090935))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.09, m07.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M8 - Way Society Makes Sense =========================================================================================== 

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090936)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090936 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090936 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090936 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090936 = 9))

T09_M08_FTLW <- TIAS2009[, c("TA090936", "FTL_COUNT")] %>% group_by(TA090936, FTL_COUNT) %>% summarise(Count = n())

T09_M08_FTLW <- T09_M08_FTLW[1:14, ]

T09_M08_CAT <- TIAS2009[, c("TA090936", "CAT_09")] %>% group_by(TA090936, CAT_09) %>% summarise(Count = n())

T09_M08_CAT <- T09_M08_CAT[1:10, ]

T09_M08_FTLCAT <- TIAS2009_FTL[, c("TA090936", "CAT_09")] %>% group_by(TA090936, CAT_09) %>% summarise(Count = n())

T09_M08_IACCAT <- TIAS2009_IAC[, c("TA090936", "CAT_09")] %>% group_by(TA090936, CAT_09) %>% summarise(Count = n())

T09_M08_IACCAT <- T09_M08_IACCAT[1:6, ]

head(T09_M08_CAT, 10)

ggplot(T09_M08_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090936)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M08_FTLW, 14)

ggplot(T09_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090936)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090936))

m08.pie.ftl.09 <- ggplot(data = T09_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090936))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Almost every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090936))

m08.pie.iac.09 <- ggplot(data = T09_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090936))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.09, m08.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================  

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090937)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090937 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090937 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090937 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090937 = 9))

T09_M09_FTLW <- TIAS2009[, c("TA090937", "FTL_COUNT")] %>% group_by(TA090937, FTL_COUNT) %>% summarise(Count = n())

T09_M09_FTLW <- T09_M09_FTLW[1:13, ]

T09_M09_CAT <- TIAS2009[, c("TA090937", "CAT_09")] %>% group_by(TA090937, CAT_09) %>% summarise(Count = n())

T09_M09_CAT <- T09_M09_CAT[1:9, ]

T09_M09_FTLCAT <- TIAS2009_FTL[, c("TA090937", "CAT_09")] %>% group_by(TA090937, CAT_09) %>% summarise(Count = n())

T09_M09_IACCAT <- TIAS2009_IAC[, c("TA090937", "CAT_09")] %>% group_by(TA090937, CAT_09) %>% summarise(Count = n())

T09_M09_IACCAT <- T09_M09_IACCAT[1:6, ]

head(T09_M09_CAT, 9)

ggplot(T09_M09_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090937)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M09_FTLW, 13)

ggplot(T09_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090937)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090937))

m09.pie.ftl.09 <- ggplot(data = T09_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090937))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("green3", "deepskyblue", "mediumpurple1"), 
  labels = c("About once a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090937))

m09.pie.iac.09 <- ggplot(data = T09_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090937))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.09, m09.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M10 - Trusting Relationships w/ Others ================================================================================= 

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090938)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090938 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090938 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090938 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090938 = 9))

T09_M10_FTLW <- TIAS2009[, c("TA090938", "FTL_COUNT")] %>% group_by(TA090938, FTL_COUNT) %>% summarise(Count = n())

T09_M10_FTLW <- T09_M10_FTLW[1:14, ]

T09_M10_CAT <- TIAS2009[, c("TA090938", "CAT_09")] %>% group_by(TA090938, CAT_09) %>% summarise(Count = n())

T09_M10_CAT <- T09_M10_CAT[1:10, ]

T09_M10_FTLCAT <- TIAS2009_FTL[, c("TA090938", "CAT_09")] %>% group_by(TA090938, CAT_09) %>% summarise(Count = n())

T09_M10_IACCAT <- TIAS2009_IAC[, c("TA090938", "CAT_09")] %>% group_by(TA090938, CAT_09) %>% summarise(Count = n())

T09_M10_IACCAT <- T09_M10_IACCAT[1:6, ]

head(T09_M10_CAT, 10)

ggplot(T09_M10_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090938)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M10_FTLW, 14)

ggplot(T09_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090938)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090938))

m10.pie.ftl.09 <- ggplot(data = T09_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090938))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("gold", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Once or twice", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090938))

m10.pie.iac.09 <- ggplot(data = T09_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090938))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.09, m10.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M11 - Challenged to Grow =============================================================================================== 

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090939)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090939 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090939 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090939 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090939 = 9))

T09_M11_FTLW <- TIAS2009[, c("TA090939", "FTL_COUNT")] %>% group_by(TA090939, FTL_COUNT) %>% summarise(Count = n())

T09_M11_FTLW <- T09_M11_FTLW[1:14, ]

T09_M11_CAT <- TIAS2009[, c("TA090939", "CAT_09")] %>% group_by(TA090939, CAT_09) %>% summarise(Count = n())

T09_M11_CAT <- T09_M11_CAT[1:11, ]

T09_M11_FTLCAT <- TIAS2009_FTL[, c("TA090939", "CAT_09")] %>% group_by(TA090939, CAT_09) %>% summarise(Count = n())

T09_M11_IACCAT <- TIAS2009_IAC[, c("TA090939", "CAT_09")] %>% group_by(TA090939, CAT_09) %>% summarise(Count = n())

T09_M11_IACCAT <- T09_M11_IACCAT[1:6, ]

head(T09_M11_CAT, 8)

ggplot(T09_M11_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090939)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M11_FTLW, 10)

ggplot(T09_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090939)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090939)) 
table(TIAS2009_FTL$TA090939)

m11.pie.ftl.09 <- ggplot(data = T09_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090939))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090939))

m11.pie.iac.09 <- ggplot(data = T09_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090939))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.09, m11.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================  

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090940)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090940 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090940 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090940 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090940 = 9))

T09_M12_FTLW <- TIAS2009[, c("TA090940", "FTL_COUNT")] %>% group_by(TA090940, FTL_COUNT) %>% summarise(Count = n())

T09_M12_FTLW <- T09_M12_FTLW[1:12, ]

T09_M12_CAT <- TIAS2009[, c("TA090940", "CAT_09")] %>% group_by(TA090940, CAT_09) %>% summarise(Count = n())

T09_M12_CAT <- T09_M12_CAT[1:9, ]

T09_M12_FTLCAT <- TIAS2009_FTL[, c("TA090940", "CAT_09")] %>% group_by(TA090940, CAT_09) %>% summarise(Count = n())

T09_M12_IACCAT <- TIAS2009_IAC[, c("TA090940", "CAT_09")] %>% group_by(TA090940, CAT_09) %>% summarise(Count = n())

T09_M12_IACCAT <- T09_M12_IACCAT[1:6, ]

head(T09_M12_CAT, 9)

ggplot(T09_M12_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090940)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M12_FTLW, 12)

ggplot(T09_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090940)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090940))

m12.pie.ftl.09 <- ggplot(data = T09_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090940))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("gold", "deepskyblue", "mediumpurple1"), 
  labels = c("Once or twice", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090940))

m12.pie.iac.09 <- ggplot(data = T09_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090940))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.09, m12.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M13 - Liked Personality ================================================================================================ 

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090941)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090941 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090941 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090941 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090941 = 9))

T09_M13_FTLW <- TIAS2009[, c("TA090941", "FTL_COUNT")] %>% group_by(TA090941, FTL_COUNT) %>% summarise(Count = n())

T09_M13_FTLW <- T09_M13_FTLW[1:11, ]

T09_M13_CAT <- TIAS2009[, c("TA090941", "CAT_09")] %>% group_by(TA090941, CAT_09) %>% summarise(Count = n())

T09_M13_CAT <- T09_M13_CAT[1:8, ]

T09_M13_FTLCAT <- TIAS2009_FTL[, c("TA090941", "CAT_09")] %>% group_by(TA090941, CAT_09) %>% summarise(Count = n())

T09_M13_IACCAT <- TIAS2009_IAC[, c("TA090941", "CAT_09")] %>% group_by(TA090941, CAT_09) %>% summarise(Count = n())

T09_M13_IACCAT <- T09_M13_IACCAT[1:6, ]

head(T09_M13_CAT, 8)

ggplot(T09_M13_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090941)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M13_FTLW, 11)

ggplot(T09_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090941)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090941))

m13.pie.ftl.09 <- ggplot(data = T09_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090941))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090941))  

m13.pie.iac.09 <- ggplot(data = T09_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090941))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.09, m13.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS M14 - Life Had Direction =============================================================================================== 

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090942)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090942 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090942 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090942 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090942 = 9))

T09_M14_FTLW <- TIAS2009[, c("TA090942", "FTL_COUNT")] %>% group_by(TA090942, FTL_COUNT) %>% summarise(Count = n())

T09_M14_FTLW <- T09_M14_FTLW[1:14, ]

T09_M14_CAT <- TIAS2009[, c("TA090942", "CAT_09")] %>% group_by(TA090942, CAT_09) %>% summarise(Count = n())

T09_M14_CAT <- T09_M14_CAT[1:10, ]

T09_M14_FTLCAT <- TIAS2009_FTL[, c("TA090942", "CAT_09")] %>% group_by(TA090942, CAT_09) %>% summarise(Count = n())

T09_M14_IACCAT <- TIAS2009_IAC[, c("TA090942", "CAT_09")] %>% group_by(TA090942, CAT_09) %>% summarise(Count = n())

T09_M14_IACCAT <- T09_M14_IACCAT[1:6, ]

head(T09_M14_CAT, 10)

ggplot(T09_M14_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090942)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T09_M14_FTLW, 14)

ggplot(T09_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090942)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090942))

m14.pie.ftl.09 <- ggplot(data = T09_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090942))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2009_IAC$TA090942))

m14.pie.iac.09 <- ggplot(data = T09_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090942))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.09, m14.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### MIDUS Subscale - Emotional =================================================================================================== 

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA090980)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090980 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090980 = 9)) 

T09_MSE_FTLW <- TIAS2009[, c("TA090980", "FTL_COUNT")] %>% group_by(TA090980, FTL_COUNT) %>% summarise(Count = n())

T09_MSE_FTLW <- T09_MSE_FTLW[1:13, ]

T09_MSE_CAT <- TIAS2009[, c("TA090980", "CAT_09")] %>% group_by(TA090980, CAT_09) %>% summarise(Count = n())

T09_MSE_CAT <- T09_MSE_CAT[1:10, ]

ggplot(T09_MSE_FTLW, aes(x = FTL_COUNT, y = TA090980, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_MSE_CAT, aes(x = CAT_09, y = TA090980, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological =============================================================================================== 

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA090982)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090982 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090982 = 9)) 

T09_MSP_FTLW <- TIAS2009[, c("TA090982", "FTL_COUNT")] %>% group_by(TA090982, FTL_COUNT) %>% summarise(Count = n())

T09_MSP_FTLW <- T09_MSP_FTLW[1:12, ]

T09_MSP_CAT <- TIAS2009[, c("TA090982", "CAT_09")] %>% group_by(TA090982, CAT_09) %>% summarise(Count = n())

T09_MSP_CAT <- T09_MSP_CAT[1:10, ]

ggplot(T09_MSP_FTLW, aes(x = FTL_COUNT, y = TA090982, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_MSP_CAT, aes(x = CAT_09, y = TA090982, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ================================================================================================== 

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090016)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090016 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090016 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090016 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090016 = 9))

T09_TIA_FTLW <- TIAS2009[, c("TA090016", "FTL_COUNT")] %>% group_by(TA090016, FTL_COUNT) %>% summarise(Count = n())

T09_TIA_FTLW <- T09_TIA_FTLW[1:6, ]

T09_TIA_CAT <- TIAS2009[, c("TA090016", "CAT_09")] %>% group_by(TA090016, CAT_09) %>% summarise(Count = n())

T09_TIA_CAT <- T09_TIA_CAT[1:4, ]

T09_TIA_FTLCAT <- TIAS2009_FTL[, c("TA090016", "CAT_09")] %>% group_by(TA090016, CAT_09) %>% summarise(Count = n())

T09_TIA_IACCAT <- TIAS2009_IAC[, c("TA090016", "CAT_09")] %>% group_by(TA090016, CAT_09) %>% summarise(Count = n())

T09_TIA_IACCAT <- T09_TIA_IACCAT[1:2, ]

head(T09_TIA_CAT, 4)

ggplot(T09_TIA_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T09_TIA_FTLW, 6)

ggplot(T09_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090016))

tia.pie.ftl.09 <- ggplot(data = T09_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_IAC$TA090016)) 

tia.pie.iac.09 <- ggplot(data = T09_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.09, tia.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Type of Art (Involvement) ========================================================================================= 

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 8871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA090017)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090017 = 9999)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090017 = 9999)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090017 = 9999)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090017 = 9999))

T09_IIA_FTLW <- TIAS2009[, c("TA090017", "FTL_COUNT")] %>% group_by(TA090017, FTL_COUNT) %>% summarise(Count = n())

T09_IIA_FTLW <- T09_IIA_FTLW[1:19, ]

T09_IIA_CAT <- TIAS2009[, c("TA090017", "CAT_09")] %>% group_by(TA090017, CAT_09) %>% summarise(Count = n())

T09_IIA_CAT <- T09_IIA_CAT[1:18, ]

T09_IIA_FTLCAT <- TIAS2009_FTL[, c("TA090017", "CAT_09")] %>% group_by(TA090017, CAT_09) %>% summarise(Count = n())

T09_IIA_IACCAT <- TIAS2009_IAC[, c("TA090017", "CAT_09")] %>% group_by(TA090017, CAT_09) %>% summarise(Count = n())

T09_IIA_IACCAT <- T09_IIA_IACCAT[1:16, ]

head(T09_IIA_CAT, 19)

ggplot(T09_IIA_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                          "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement", 
                                                          "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                     
head(T09_IIA_FTLW, 20)

ggplot(T09_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                       "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                       "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))       

prop.table(table(TIAS2009_FTL$TA090017)) 

iia.pie.ftl.09 <- ggplot(data = T09_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "coral1"), labels = c("Not Involved in Arts/Music/Theater", "Other Activity"))

prop.table(table(TIAS2009_IAC$TA090017)) 

iia.pie.iac.09 <- ggplot(data = T09_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                       "After-School Drama/Art Club", "Arts & Crafts", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                       "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))       

ggarrange(iia.pie.ftl.09, iia.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Art Involvement Frequency (Over 12 Mos) =========================================================================== 

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA090018)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090018 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090018 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090018 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090018 = 9))

T09_AIF_FTLW <- TIAS2009[, c("TA090018", "FTL_COUNT")] %>% group_by(TA090018, FTL_COUNT) %>% summarise(Count = n())

T09_AIF_FTLW <- T09_AIF_FTLW[1:11, ]

T09_AIF_CAT <- TIAS2009[, c("TA090018", "CAT_09")] %>% group_by(TA090018, CAT_09) %>% summarise(Count = n())

T09_AIF_CAT <- T09_AIF_CAT[1:9, ]

T09_AIF_FTLCAT <- TIAS2009_FTL[, c("TA090018", "CAT_09")] %>% group_by(TA090018, CAT_09) %>% summarise(Count = n())

T09_AIF_IACCAT <- TIAS2009_IAC[, c("TA090018", "CAT_09")] %>% group_by(TA090018, CAT_09) %>% summarise(Count = n())

T09_AIF_IACCAT <- T09_AIF_IACCAT[1:7, ]

head(T09_AIF_CAT, 9)

ggplot(T09_AIF_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T09_AIF_FTLW, 11)

ggplot(T09_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090018)) 

aif.pie.ftl.09 <- ggplot(data = T09_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "#009E73"), 
  labels = c("Not Involved in Arts/Music/Theater", "Once a week"))

prop.table(table(TIAS2009_IAC$TA090018)) 

aif.pie.iac.09 <- ggplot(data = T09_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.09, aif.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### WTR Member of Sports Team (Over 12 Mos) ====================================================================================== 

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090019)

T09_SPO_FTLW <- TIAS2009[, c("TA090019", "FTL_COUNT")] %>% group_by(TA090019, FTL_COUNT) %>% summarise(Count = n())

T09_SPO_CAT <- TIAS2009[, c("TA090019", "CAT_09")] %>% group_by(TA090019, CAT_09) %>% summarise(Count = n())

T09_SPO_FTLCAT <- TIAS2009_FTL[, c("TA090019", "CAT_09")] %>% group_by(TA090019, CAT_09) %>% summarise(Count = n())

T09_SPO_IACCAT <- TIAS2009_IAC[, c("TA090019", "CAT_09")] %>% group_by(TA090019, CAT_09) %>% summarise(Count = n())

head(T09_SPO_CAT, 4)

ggplot(T09_SPO_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T09_SPO_FTLW, 5)

ggplot(T09_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090019))

spo.pie.ftl.09 <- ggplot(data = T09_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2009_IAC$TA090019)) 

spo.pie.iac.09 <- ggplot(data = T09_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.09, spo.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Involved in Sports Frequency  ===================================================================================== 

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA090020)

T09_IIS_FTLW <- TIAS2009[, c("TA090020", "FTL_COUNT")] %>% group_by(TA090020, FTL_COUNT) %>% summarise(Count = n())

T09_IIS_CAT <- TIAS2009[, c("TA090020", "CAT_09")] %>% group_by(TA090020, CAT_09) %>% summarise(Count = n())

T09_IIS_FTLCAT <- TIAS2009_FTL[, c("TA090020", "CAT_09")] %>% group_by(TA090020, CAT_09) %>% summarise(Count = n())

T09_IIS_IACCAT <- TIAS2009_IAC[, c("TA090020", "CAT_09")] %>% group_by(TA090020, CAT_09) %>% summarise(Count = n())

head(T09_IIS_CAT, 10)

ggplot(T09_IIS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T09_IIS_FTLW, 11)

ggplot(T09_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_FTL$TA090020))

iis.pie.ftl.09 <- ggplot(data = T09_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "#009E73", "turquoise"), 
  labels = c("Not Involved in Sports", "Once a week", "Every day"))

prop.table(table(TIAS2009_IAC$TA090020)) 

iis.pie.iac.09 <- ggplot(data = T09_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.09, iis.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Watching/Reading News (Over 12 Mos) =============================================================================== 

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090021)

T09_WRN_FTLW <- TIAS2009[, c("TA090021", "FTL_COUNT")] %>% group_by(TA090021, FTL_COUNT) %>% summarise(Count = n())

T09_WRN_CAT <- TIAS2009[, c("TA090021", "CAT_09")] %>% group_by(TA090021, CAT_09) %>% summarise(Count = n())

T09_WRN_FTLCAT <- TIAS2009_FTL[, c("TA090021", "CAT_09")] %>% group_by(TA090021, CAT_09) %>% summarise(Count = n())

T09_WRN_IACCAT <- TIAS2009_IAC[, c("TA090021", "CAT_09")] %>% group_by(TA090021, CAT_09) %>% summarise(Count = n())

head(T09_WRN_CAT, 12)

ggplot(T09_WRN_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T09_WRN_FTLW, 16)

ggplot(T09_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2009_FTL$TA090021))

wrn.pie.ftl.09 <- ggplot(data = T09_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightskyblue", "#009E73", "#0072B2", "turquoise"), 
  labels = c("Less than once a month", "Once a week", "Several times a week", "Every day", "Never watch or read news"))

prop.table(table(TIAS2009_IAC$TA090021)) 

wrn.pie.iac.09 <- ggplot(data = T09_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.09, wrn.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================ 

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090022)

T09_RFP_FTLW <- TIAS2009[, c("TA090022", "FTL_COUNT")] %>% group_by(TA090022, FTL_COUNT) %>% summarise(Count = n())

T09_RFP_CAT <- TIAS2009[, c("TA090022", "CAT_09")] %>% group_by(TA090022, CAT_09) %>% summarise(Count = n())

T09_RFP_FTLCAT <- TIAS2009_FTL[, c("TA090022", "CAT_09")] %>% group_by(TA090022, CAT_09) %>% summarise(Count = n())

T09_RFP_IACCAT <- TIAS2009_IAC[, c("TA090022", "CAT_09")] %>% group_by(TA090022, CAT_09) %>% summarise(Count = n())

head(T09_RFP_CAT, 12) 

ggplot(T09_RFP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T09_RFP_FTLW, 16) 

ggplot(T09_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2009_FTL$TA090022))

rfp.pie.ftl.09 <- ggplot(data = T09_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
  labels = c("At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_IAC$TA090022)) 

rfp.pie.iac.09 <- ggplot(data = T09_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.09, rfp.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ========================================================================== 

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090023)

T09_NNT_FTLW <- TIAS2009[, c("TA090023", "FTL_COUNT")] %>% group_by(TA090023, FTL_COUNT) %>% summarise(Count = n())

T09_NNT_CAT <- TIAS2009[, c("TA090023", "CAT_09")] %>% group_by(TA090023, CAT_09) %>% summarise(Count = n())

T09_NNT_FTLCAT <- TIAS2009_FTL[, c("TA090023", "CAT_09")] %>% group_by(TA090023, CAT_09) %>% summarise(Count = n())

T09_NNT_IACCAT <- TIAS2009_IAC[, c("TA090023", "CAT_09")] %>% group_by(TA090023, CAT_09) %>% summarise(Count = n())

head(T09_NNT_CAT, 10)

ggplot(T09_NNT_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T09_NNT_FTLW, 14)

ggplot(T09_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2009_FTL$TA090023))

nnt.pie.ftl.09 <- ggplot(data = T09_NNT_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("#009E73", "gold", "#0072B2"), 
  labels = c("Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2009_IAC$TA090023)) 

nnt.pie.iac.09 <- ggplot(data = T09_NNT_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

ggarrange(nnt.pie.ftl.09, nnt.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Internet Usage ==================================================================================================== 

#### 
# A9. WTR Ever Used Internet: “Have you ever used the internet?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090024)

T09_ITU_FTLW <- TIAS2009[, c("TA090024", "FTL_COUNT")] %>% group_by(TA090024, FTL_COUNT) %>% summarise(Count = n())

T09_ITU_CAT <- TIAS2009[, c("TA090024", "CAT_09")] %>% group_by(TA090024, CAT_09) %>% summarise(Count = n())

head(T09_ITU_CAT, 3)

ggplot(T09_ITU_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T09_ITU_FTLW, 4)

ggplot(T09_ITU_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ========================================================== 

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA090025)

T09_IPE_FTLW <- TIAS2009[, c("TA090025", "FTL_COUNT")] %>% group_by(TA090025, FTL_COUNT) %>% summarise(Count = n())

T09_IPE_CAT <- TIAS2009[, c("TA090025", "CAT_09")] %>% group_by(TA090025, CAT_09) %>% summarise(Count = n())

T09_IPE_FTLCAT <- TIAS2009_FTL[, c("TA090025", "CAT_09")] %>% group_by(TA090025, CAT_09) %>% summarise(Count = n())

T09_IPE_IACCAT <- TIAS2009_IAC[, c("TA090025", "CAT_09")] %>% group_by(TA090025, CAT_09) %>% summarise(Count = n())

head(T09_IPE_CAT, 13)

ggplot(T09_IPE_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T09_IPE_FTLW, 17)

ggplot(T09_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2009_FTL$TA090025))

ipe.pie.ftl.09 <- ggplot(data = T09_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day"))

prop.table(table(TIAS2009_IAC$TA070024)) 

ipe.pie.iac.09 <- ggplot(data = T09_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
  labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.09, ipe.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ================================================================== 

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA090026)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090026 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090026 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090026 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090026 = 9))

T09_IPR_FTLW <- TIAS2009[, c("TA090026", "FTL_COUNT")] %>% group_by(TA090026, FTL_COUNT) %>% summarise(Count = n())

T09_IPR_FTLW <- T09_IPR_FTLW[1:17, ]

T09_IPR_CAT <- TIAS2009[, c("TA090026", "CAT_09")] %>% group_by(TA090026, CAT_09) %>% summarise(Count = n())

T09_IPR_CAT <- T09_IPR_CAT[1:12, ]

T09_IPR_FTLCAT <- TIAS2009_FTL[, c("TA090026", "CAT_09")] %>% group_by(TA090026, CAT_09) %>% summarise(Count = n())

T09_IPR_IACCAT <- TIAS2009_IAC[, c("TA090026", "CAT_09")] %>% group_by(TA090026, CAT_09) %>% summarise(Count = n())

T09_IPR_IACCAT <- T09_IPR_IACCAT[1:8, ]

head(T09_IPR_CAT, 12)

ggplot(T09_IPR_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T09_IPR_FTLW, 17)

ggplot(T09_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2009_FTL$TA090026))

ipr.pie.ftl.09 <- ggplot(data = T09_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("lightcoral", "lightskyblue", "#009E73", "gold"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week"))

prop.table(table(TIAS2009_IAC$TA090026))

ipr.pie.iac.09 <- ggplot(data = T09_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
  labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.09, ipr.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) ========================================================================= 

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA090027)

T09_IPS_FTLW <- TIAS2009[, c("TA090027", "FTL_COUNT")] %>% group_by(TA090027, FTL_COUNT) %>% summarise(Count = n())

T09_IPS_CAT <- TIAS2009[, c("TA090027", "CAT_09")] %>% group_by(TA090027, CAT_09) %>% summarise(Count = n())

T09_IPS_FTLCAT <- TIAS2009_FTL[, c("TA090027", "CAT_09")] %>% group_by(TA090027, CAT_09) %>% summarise(Count = n())

T09_IPS_IACCAT <- TIAS2009_IAC[, c("TA090027", "CAT_09")] %>% group_by(TA090027, CAT_09) %>% summarise(Count = n())

head(T09_IPS_CAT, 13)

ggplot(T09_IPS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T09_IPS_FTLW, 16)

ggplot(T09_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2009_FTL$TA090027))

ips.pie.ftl.09 <- ggplot(data = T09_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "mediumpurple1"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Almost every day", "Never used the internet for shopping"))

prop.table(table(TIAS2009_IAC$TA090027))

ips.pie.iac.09 <- ggplot(data = T09_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
  labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.09, ips.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ==================================================================== 

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA090028)

T09_IPG_FTLW <- TIAS2009[, c("TA090028", "FTL_COUNT")] %>% group_by(TA090028, FTL_COUNT) %>% summarise(Count = n())

T09_IPG_CAT <- TIAS2009[, c("TA090028", "CAT_09")] %>% group_by(TA090028, CAT_09) %>% summarise(Count = n())

T09_IPG_FTLCAT <- TIAS2009_FTL[, c("TA090028", "CAT_09")] %>% group_by(TA090028, CAT_09) %>% summarise(Count = n())

T09_IPG_IACCAT <- TIAS2009_IAC[, c("TA090028", "CAT_09")] %>% group_by(TA090028, CAT_09) %>% summarise(Count = n())

head(T09_IPG_CAT, 12)

ggplot(T09_IPG_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090028))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T09_IPG_FTLW, 17)

ggplot(T09_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090028)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2009_FTL$TA090028))

ipg.pie.ftl.09 <- ggplot(data = T09_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("lightcoral", "lightskyblue", "#009E73", "turquoise"), 
  labels = c("Less than once a month", "At least once a month", "Once a week", "Every day"))

prop.table(table(TIAS2009_IAC$TA090028))

ipg.pie.iac.09 <- ggplot(data = T09_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
  labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.09, ipg.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Voted in Last Presidential Election =============================================================================== 

####
# A11. WTR Voted in 2008: “Did you vote in the national election for President last November, in 2008?”
# Answers: 0 (Inap: date of birth is after 11/04/1990); 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090029)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090029 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090029 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090029 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090029 = 9))

T09_VLP_FTLW <- TIAS2009[, c("TA090029", "FTL_COUNT")] %>% group_by(TA090029, FTL_COUNT) %>% summarise(Count = n())

T09_VLP_FTLW <- T09_VLP_FTLW[1:9, ]

T09_VLP_CAT <- TIAS2009[, c("TA090029", "CAT_09")] %>% group_by(TA090029, CAT_09) %>% summarise(Count = n())

T09_VLP_CAT <- T09_VLP_CAT[1:6, ]

T09_VLP_FTLCAT <- TIAS2009_FTL[, c("TA090029", "CAT_09")] %>% group_by(TA090029, CAT_09) %>% summarise(Count = n())

T09_VLP_IACCAT <- TIAS2009_IAC[, c("TA090029", "CAT_09")] %>% group_by(TA090029, CAT_09) %>% summarise(Count = n())

T09_VLP_IACCAT <- T09_VLP_IACCAT[1:3, ]

head(T09_VLP_CAT, 6)

ggplot(T09_VLP_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2008 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

head(T09_VLP_FTLW, 9) 

ggplot(T09_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2008 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

prop.table(table(TIAS2009_FTL$TA090029))

vlp.pie.ftl.09 <- ggplot(data = T09_VLP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090029))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Voted in 2008 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

prop.table(table(TIAS2009_IAC$TA090029))

vlp.pie.iac.09 <- ggplot(data = T09_VLP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090029))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Voted in 2008 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

ggarrange(vlp.pie.ftl.09, vlp.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - Involvement in Social Action Groups =============================================================================== 

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090030)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090030 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090030 = 9)) 

T09_ISA_FTLW <- TIAS2009[, c("TA090030", "FTL_COUNT")] %>% group_by(TA090030, FTL_COUNT) %>% summarise(Count = n())

T09_ISA_FTLW <- T09_ISA_FTLW[1:4, ]

T09_ISA_CAT <- TIAS2009[, c("TA090030", "CAT_09")] %>% group_by(TA090030, CAT_09) %>% summarise(Count = n())

T09_ISA_CAT <- T09_ISA_CAT[1:3, ]

head(T09_ISA_CAT, 3)

ggplot(T09_ISA_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T09_ISA_FTLW, 4)

ggplot(T09_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) ========================================================================= 

####
# A11C. Type of Social Action Groups: “Which groups?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

table(TIAS$TA090031)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090031 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090031 = 9)) 

T09_TSA_FTLW <- TIAS2009[, c("TA090031", "FTL_COUNT")] %>% group_by(TA090031, FTL_COUNT) %>% summarise(Count = n())

T09_TSA_FTLW <- T09_TSA_FTLW[1:8, ]

T09_TSA_CAT <- TIAS2009[, c("TA090031", "CAT_09")] %>% group_by(TA090031, CAT_09) %>% summarise(Count = n())

T09_TSA_CAT <- T09_TSA_CAT[1:7, ]

head(T09_TSA_CAT, 7)

ggplot(T09_TSA_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T09_TSA_FTLW, 8)

ggplot(T09_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) ===================================================================== 

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA090032)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090032 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090032 = 9)) 

T09_SAG_FTLW <- TIAS2009[, c("TA090032", "FTL_COUNT")] %>% group_by(TA090032, FTL_COUNT) %>% summarise(Count = n())

T09_SAG_FTLW <- T09_SAG_FTLW[1:7, ]

T09_SAG_CAT <- TIAS2009[, c("TA090032", "CAT_09")] %>% group_by(TA090032, CAT_09) %>% summarise(Count = n())

T09_SAG_CAT <- T09_SAG_CAT[1:6, ]

head(T09_SAG_CAT, 6)

ggplot(T09_SAG_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T09_SAG_FTLW, 7)

ggplot(T09_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement =============================================================================== 

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090033)

T09_CGI_FTLW <- TIAS2009[, c("TA090033", "FTL_COUNT")] %>% group_by(TA090033, FTL_COUNT) %>% summarise(Count = n())

T09_CGI_CAT <- TIAS2009[, c("TA090033", "CAT_09")] %>% group_by(TA090033, CAT_09) %>% summarise(Count = n())

T09_CGI_FTLCAT <- TIAS2009_FTL[, c("TA090033", "CAT_09")] %>% group_by(TA090033, CAT_09) %>% summarise(Count = n())

T09_CGI_IACCAT <- TIAS2009_IAC[, c("TA090033", "CAT_09")] %>% group_by(TA090033, CAT_09) %>% summarise(Count = n())

head(T09_CGI_CAT, 5)

ggplot(T09_CGI_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

head(T09_CGI_FTLW, 6)

ggplot(T09_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2009_FTL$TA090033))

cgi.pie.ftl.09 <- ggplot(data = T09_CGI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("lightskyblue1", "pink"), labels = c("No", "Not in school"))

prop.table(table(TIAS2009_IAC$TA090033)) 

cgi.pie.iac.09 <- ggplot(data = T09_CGI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

ggarrange(cgi.pie.ftl.09, cgi.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) ======================================================= 

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA090034)

T09_SCG_FTLW <- TIAS2009[, c("TA090034", "FTL_COUNT")] %>% group_by(TA090034, FTL_COUNT) %>% summarise(Count = n())

T09_SCG_CAT <- TIAS2009[, c("TA090034", "CAT_09")] %>% group_by(TA090034, CAT_09) %>% summarise(Count = n())

head(T09_SCG_CAT, 8)

ggplot(T09_SCG_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T09_SCG_FTLW, 9)

ggplot(T09_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ============================================================== 

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090035)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090035 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090035 = 8)) 

T09_UVW_FTLW <- TIAS2009[, c("TA090035", "FTL_COUNT")] %>% group_by(TA090035, FTL_COUNT) %>% summarise(Count = n())

T09_UVW_FTLW <- T09_UVW_FTLW[1:4, ]

T09_UVW_CAT <- TIAS2009[, c("TA090035", "CAT_09")] %>% group_by(TA090035, CAT_09) %>% summarise(Count = n())

T09_UVW_CAT <- T09_UVW_CAT[1:3, ]

head(T09_UVW_CAT, 3)

ggplot(T09_UVW_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090035))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

head(T09_UVW_FTLW, 4)

ggplot(T09_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090035)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

### Time Use - Type of Volunteer Work ============================================================================================ 

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA090036)

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA090037)

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA090038)

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA090039)

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA090040)

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA090041)

####
# Creating A14 Heatmaps 
####

A14_FTL09 <- TIAS2009_FTL %>% dplyr::select(TA090036, TA090037, TA090038, TA090039, TA090040, TA090041, PSID_ID)

nrow(A14_FTL09)

cols <- sapply(A14_FTL09, is.logical)
A14_FTL09[,cols] <- lapply(A14_FTL09[,cols], as.numeric)

A14_FTL09_TIDY <- A14_FTL09 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL09_TIDY$variable <- factor(A14_FTL09_TIDY$variable, levels = c("TA090036", "TA090037", "TA090038", "TA090039", "TA090040", "TA090041"))

A14_FTL09_IDLEV <- dplyr::pull(A14_FTL09, PSID_ID) 
A14_FTL09_TIDY$PSID_ID <- factor(A14_FTL09_TIDY$PSID_ID, levels = A14_FTL09_IDLEV)

A14_FTL09_TIDY$volunteer_type <- factor(A14_FTL09_TIDY$volunteer_type)

ggplot(A14_FTL09_TIDY, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2009 FTL", x="Order of Mention", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                    labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC09 <- TIAS2009_IAC %>% dplyr::select(TA090036, TA090037, TA090038, TA090039, TA090040, TA090041, PSID_ID)

nrow(A14_IAC09)  

chunk <- 50

n <- nrow(A14_IAC09)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC09_list <- split(A14_IAC09, r)   

length(A14_IAC09_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC09_tidylist <- lapply(A14_IAC09_list, tidy.vars)

for(i in 1:31) {
  A14_IAC09_tidylist[[i]]$variable <- factor(A14_IAC09_tidylist[[i]]$variable, levels = c("TA090036", "TA090037", "TA090038", "TA090039", "TA090040", "TA090041"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, PSID_ID)
}

A14_IAC09_levlist <- lapply(A14_IAC09_list, set.ID.levels)

for(i in 1:31) {
  A14_IAC09_tidylist[[i]]$PSID_ID <- factor(A14_IAC09_tidylist[[i]]$PSID_ID, levels = A14_IAC09_levlist[[i]])
}

for(i in 1:31) {
  A14_IAC09_tidylist[[i]]$volunteer_type <- factor(A14_IAC09_tidylist[[i]]$volunteer_type)
}

create.A14.IAC09.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=PSID_ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2009 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                      labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC09.heatmaps <- function(x){
  create.A14.IAC09.heatmap(A14_IAC09_tidylist[[x]])
}

# export graphs as width 3000 x height 1000 to view properly 

ggarrange(A14.IAC09.heatmaps(1) + rremove("legend"), A14.IAC09.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(4) + rremove("legend") + rremove("y.title"), 
          A14.IAC09.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(5) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC09.heatmaps(7) + rremove("legend"), A14.IAC09.heatmaps(8) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(9) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(10) + rremove("legend") + rremove("y.title"), 
          A14.IAC09.heatmaps(11) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(12) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC09.heatmaps(13) + rremove("legend"), A14.IAC09.heatmaps(14) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(15) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(16) + rremove("legend") + rremove("y.title"), 
          A14.IAC09.heatmaps(18) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(17) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC09.heatmaps(19) + rremove("legend"), A14.IAC09.heatmaps(20) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(21) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(22) + rremove("legend") + rremove("y.title"), 
          A14.IAC09.heatmaps(23) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(24) + rremove("y.title"), ncol = 6, nrow = 1) 

ggarrange(A14.IAC09.heatmaps(31) + rremove("legend"), A14.IAC09.heatmaps(25) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(26) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(27) + rremove("legend") + rremove("y.title"), 
          A14.IAC09.heatmaps(28) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(29) + rremove("legend") + rremove("y.title"), A14.IAC09.heatmaps(30) + rremove("y.title"), ncol = 7, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) =============================================================================== 

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA090042)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090042 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090042 = 8)) 

T09_TUH_FTLW <- TIAS2009[, c("TA090042", "FTL_COUNT")] %>% group_by(TA090042, FTL_COUNT) %>% summarise(Count = n())

T09_TUH_FTLW <- T09_TUH_FTLW[1:9, ]

T09_TUH_CAT <- TIAS2009[, c("TA090042", "CAT_09")] %>% group_by(TA090042, CAT_09) %>% summarise(Count = n())

T09_TUH_CAT <- T09_TUH_CAT[1:8, ]

head(T09_TUH_CAT, 8)

ggplot(T09_TUH_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090042))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T09_TUH_FTLW, 9)

ggplot(T09_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090042)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ========================================================== 

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090061)

T09_SRU_FTLW <- TIAS2009[, c("TA090061", "FTL_COUNT")] %>% group_by(TA090061, FTL_COUNT) %>% summarise(Count = n())

T09_SRU_CAT <- TIAS2009[, c("TA090061", "CAT_09")] %>% group_by(TA090061, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRU_FTLW, aes(x = FTL_COUNT, y = TA090061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRU_CAT, aes(x = CAT_09, y = TA090061, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others =========================================================== 

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090062)

T09_SRE_FTLW <- TIAS2009[, c("TA090062", "FTL_COUNT")] %>% group_by(TA090062, FTL_COUNT) %>% summarise(Count = n())

T09_SRE_CAT <- TIAS2009[, c("TA090062", "CAT_09")] %>% group_by(TA090062, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRE_FTLW, aes(x = FTL_COUNT, y = TA090062, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRE_CAT, aes(x = CAT_09, y = TA090062, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ======================================================================== 

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090053)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090053 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090053 = 8)) 

T09_SRS_FTLW <- TIAS2009[, c("TA090053", "FTL_COUNT")] %>% group_by(TA090053, FTL_COUNT) %>% summarise(Count = n())

T09_SRS_FTLW <- T09_SRS_FTLW[1:16, ]

T09_SRS_CAT <- TIAS2009[, c("TA090053", "CAT_09")] %>% group_by(TA090053, CAT_09) %>% summarise(Count = n())

T09_SRS_CAT <- T09_SRS_CAT[1:13, ]

ggplot(T09_SRS_FTLW, aes(x = FTL_COUNT, y = TA090053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRS_CAT, aes(x = CAT_09, y = TA090053, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Being a Leader ============================================================================ 

####
# C1B. How Good At Leading Comp w/ Others: “Compared to other people, how good are you at being a leader?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090054)

T09_SRB_FTLW <- TIAS2009[, c("TA090054", "FTL_COUNT")] %>% group_by(TA090054, FTL_COUNT) %>% summarise(Count = n())

T09_SRB_CAT <- TIAS2009[, c("TA090054", "CAT_09")] %>% group_by(TA090054, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRB_FTLW, aes(x = FTL_COUNT, y = TA090054, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRB_CAT, aes(x = CAT_09, y = TA090054, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Logical/Analytic Thinking ================================================================= 

####
# C1C. How Good At Logic Comp w/ Others: “Compared to other people, how good are you at logical, analytical thinking?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090055)

T09_SRL_FTLW <- TIAS2009[, c("TA090055", "FTL_COUNT")] %>% group_by(TA090055, FTL_COUNT) %>% summarise(Count = n())

T09_SRL_CAT <- TIAS2009[, c("TA090055", "CAT_09")] %>% group_by(TA090055, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRL_FTLW, aes(x = FTL_COUNT, y = TA090055, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRL_CAT, aes(x = CAT_09, y = TA090055, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Helping Others Solve Their Problems ======================================================= 

####
# C1D. How Good At Helping Comp w/ Others: “Compared to other people, how good are you at helping others solve their problems?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090056)

T09_SRH_FTLW <- TIAS2009[, c("TA090056", "FTL_COUNT")] %>% group_by(TA090056, FTL_COUNT) %>% summarise(Count = n())

T09_SRH_CAT <- TIAS2009[, c("TA090056", "CAT_09")] %>% group_by(TA090056, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRH_FTLW, aes(x = FTL_COUNT, y = TA090056, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRH_CAT, aes(x = CAT_09, y = TA090056, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ================================================================================================== 

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090050)

T09_HGP_FTLW <- TIAS2009[, c("TA090050", "FTL_COUNT")] %>% group_by(TA090050, FTL_COUNT) %>% summarise(Count = n())

T09_HGP_CAT <- TIAS2009[, c("TA090050", "CAT_09")] %>% group_by(TA090050, CAT_09) %>% summarise(Count = n())

ggplot(T09_HGP_FTLW, aes(x = FTL_COUNT, y = TA090050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_HGP_CAT, aes(x = CAT_09, y = TA090050, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Intelligence ==============================================================================

####
# C1E How Intelligent Compared w/ Others: “Compared to other people, how would you rate your intelligence? (On a scale of 1 to 7, 
# where 1 means ‘A lot worse than other people’ and 7 means ‘A lot better than other people’)”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090057)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090057 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090057 = 8)) 

T09_SRT_FTLW <- TIAS2009[, c("TA090057", "FTL_COUNT")] %>% group_by(TA090057, FTL_COUNT) %>% summarise(Count = n())

T09_SRT_FTLW <- T09_SRT_FTLW[1:12, ]

T09_SRT_CAT <- TIAS2009[, c("TA090057", "CAT_09")] %>% group_by(TA090057, CAT_09) %>% summarise(Count = n())

T09_SRT_CAT <- T09_SRT_CAT[1:10, ]

ggplot(T09_SRT_FTLW, aes(x = FTL_COUNT, y = TA090057, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRT_CAT, aes(x = CAT_09, y = TA090057, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Independence ============================================================================== 

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090058)

T09_SRI_FTLW <- TIAS2009[, c("TA090058", "FTL_COUNT")] %>% group_by(TA090058, FTL_COUNT) %>% summarise(Count = n())

T09_SRI_CAT <- TIAS2009[, c("TA090058", "CAT_09")] %>% group_by(TA090058, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRI_FTLW, aes(x = FTL_COUNT, y = TA090058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRI_CAT, aes(x = CAT_09, y = TA090058, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================ 

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090059)

T09_SRC_FTLW <- TIAS2009[, c("TA090059", "FTL_COUNT")] %>% group_by(TA090059, FTL_COUNT) %>% summarise(Count = n())

T09_SRC_CAT <- TIAS2009[, c("TA090059", "CAT_09")] %>% group_by(TA090059, CAT_09) %>% summarise(Count = n())

ggplot(T09_SRC_FTLW, aes(x = FTL_COUNT, y = TA090059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRC_CAT, aes(x = CAT_09, y = TA090059, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ============================================================================== 

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090060)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090060 = 8)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090060 = 8)) 

T09_SRD_FTLW <- TIAS2009[, c("TA090060", "FTL_COUNT")] %>% group_by(TA090060, FTL_COUNT) %>% summarise(Count = n())

T09_SRD_FTLW <- T09_SRD_FTLW[1:14, ]

T09_SRD_CAT <- TIAS2009[, c("TA090060", "CAT_09")] %>% group_by(TA090060, CAT_09) %>% summarise(Count = n())

T09_SRD_CAT <- T09_SRD_CAT[1:11, ]

ggplot(T09_SRD_FTLW, aes(x = FTL_COUNT, y = TA090060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SRD_CAT, aes(x = CAT_09, y = TA090060, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ====================================================================== 

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090785)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090785 = c(8, 9)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090785 = c(8, 9)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090785 = c(8, 9))) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090785 = c(8, 9)))

T09_FSI_FTLW <- TIAS2009[, c("TA090785", "FTL_COUNT")] %>% group_by(TA090785, FTL_COUNT) %>% summarise(Count = n())

T09_FSI_FTLW <- T09_FSI_FTLW[1:14, ]

T09_FSI_CAT <- TIAS2009[, c("TA090785", "CAT_09")] %>% group_by(TA090785, CAT_09) %>% summarise(Count = n())

T09_FSI_CAT <- T09_FSI_CAT[1:11, ]

T09_FSI_FTLCAT <- TIAS2009_FTL[, c("TA090785", "CAT_09")] %>% group_by(TA090785, CAT_09) %>% summarise(Count = n())

T09_FSI_IACCAT <- TIAS2009_IAC[, c("TA090785", "CAT_09")] %>% group_by(TA090785, CAT_09) %>% summarise(Count = n())

T09_FSI_IACCAT <- T09_FSI_IACCAT[1:6, ]

head(T09_FSI_CAT, 11)

ggplot(T09_FSI_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090785))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T09_FSI_FTLW, 14)

ggplot(T09_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090785)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2009_FTL$TA090785))

fsi.pie.ftl.09 <- ggplot(data = T09_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090785))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "gold", "#0072B2", "turquoise"), 
  labels = c("Never", "Hardly ever", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2009_IAC$TA090785))

fsi.pie.iac.09 <- ggplot(data = T09_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090785))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
  labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.09, fsi.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Binge Eating Frequency =======================================================================================================  

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090786)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090786 = 9)) 

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090786 = 9)) 

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090786 = 9)) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090786 = 9))

T09_BEF_FTLW <- TIAS2009[, c("TA090786", "FTL_COUNT")] %>% group_by(TA090786, FTL_COUNT) %>% summarise(Count = n())

T09_BEF_FTLW <- T09_BEF_FTLW[1:14, ]

T09_BEF_CAT <- TIAS2009[, c("TA090786", "CAT_09")] %>% group_by(TA090786, CAT_09) %>% summarise(Count = n())

T09_BEF_CAT <- T09_BEF_CAT[1:12, ]

T09_BEF_FTLCAT <- TIAS2009_FTL[, c("TA090786", "CAT_09")] %>% group_by(TA090786, CAT_09) %>% summarise(Count = n())

T09_BEF_IACCAT <- TIAS2009_IAC[, c("TA090786", "CAT_09")] %>% group_by(TA090786, CAT_09) %>% summarise(Count = n())

T09_BEF_IACCAT <- T09_BEF_IACCAT[1:6, ]

head(T09_BEF_CAT, 12)

ggplot(T09_BEF_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090786))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T09_BEF_FTLW, 14)

ggplot(T09_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090786)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2009_FTL$TA090786))

bef.pie.ftl.09 <- ggplot(data = T09_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090786))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2009_IAC$TA090786))

bef.pie.iac.09 <- ggplot(data = T09_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090786))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.09, bef.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Race - Hispanic ============================================================================================================== 

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090924)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090924 = c(8, 9)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090924 = c(8, 9)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090924 = c(8, 9))) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090924 = c(8, 9)))

T09_HIS_FTLW <- TIAS2009[, c("TA090924", "FTL_COUNT")] %>% group_by(TA090924, FTL_COUNT) %>% summarise(Count = n())

T09_HIS_FTLW <- T09_HIS_FTLW[1:10, ]

T09_HIS_CAT <- TIAS2009[, c("TA090924", "CAT_09")] %>% group_by(TA090924, CAT_09) %>% summarise(Count = n())

T09_HIS_CAT <- T09_HIS_CAT[1:9, ]

T09_HIS_FTLCAT <- TIAS2009_FTL[, c("TA090924", "CAT_09")] %>% group_by(TA090924, CAT_09) %>% summarise(Count = n())

T09_HIS_IACCAT <- TIAS2009_IAC[, c("TA090924", "CAT_09")] %>% group_by(TA090924, CAT_09) %>% summarise(Count = n())

T09_HIS_IACCAT <- T09_HIS_IACCAT[1:6, ]

head(T09_HIS_CAT, 9)

ggplot(T09_HIS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090924))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

head(T09_HIS_FTLW, 10)

ggplot(T09_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090924)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2009_FTL$TA090924))

his.pie.ftl.09 <- ggplot(data = T09_HIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090924))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American"))

prop.table(table(TIAS2009_IAC$TA090924))

his.pie.iac.09 <- ggplot(data = T09_HIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090924))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

ggarrange(his.pie.ftl.09, his.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA090925)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090925 = c(8, 9)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090925 = c(8, 9)))

TIAS2009_FTL <- TIAS2009_FTL %>% 
  replace_with_na(replace = list(TA090925 = c(8, 9))) 

TIAS2009_IAC <- TIAS2009_IAC %>% 
  replace_with_na(replace = list(TA090925 = c(8, 9)))

T09_RAC_FTLW <- TIAS2009[, c("TA090925", "FTL_COUNT")] %>% group_by(TA090925, FTL_COUNT) %>% summarise(Count = n())

T09_RAC_FTLW <- T09_RAC_FTLW[1:12, ]

T09_RAC_CAT <- TIAS2009[, c("TA090925", "CAT_09")] %>% group_by(TA090925, CAT_09) %>% summarise(Count = n())

T09_RAC_CAT <- T09_RAC_CAT[1:10, ]

T09_RAC_FTLCAT <- TIAS2009_FTL[, c("TA090925", "CAT_09")] %>% group_by(TA090925, CAT_09) %>% summarise(Count = n())

T09_RAC_IACCAT <- TIAS2009_IAC[, c("TA090925", "CAT_09")] %>% group_by(TA090925, CAT_09) %>% summarise(Count = n())

T09_RAC_IACCAT <- T09_RAC_IACCAT[1:6, ]

head(T09_RAC_CAT, 10)

ggplot(T09_RAC_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA090925))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

head(T09_RAC_FTLW, 12)

ggplot(T09_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA090925)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

prop.table(table(TIAS2009_FTL$TA090925))

rac.pie.ftl.09 <- ggplot(data = T09_RAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA090925))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Other"))

prop.table(table(TIAS2009_IAC$TA090925))

rac.pie.iac.09 <- ggplot(data = T09_RAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA090925))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

ggarrange(rac.pie.ftl.09, rac.pie.iac.09, ncol = 2, nrow = 1, labels = c("FTL 2009", "IAC 2009"))

### Daily Cigarette Usage ======================================================================================================== 

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK); 999 (NA/refused) 
####

table(TIAS$TA090789)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090789 = c(998, 999)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090789 = c(998, 999)))

T09_CIG_FTLW <- TIAS2009[, c("TA090789", "FTL_COUNT")] %>% group_by(TA090789, FTL_COUNT) %>% summarise(Count = n())

T09_CIG_FTLW <- T09_CIG_FTLW[1:29, ]

T09_CIG_CAT <- TIAS2009[, c("TA090789", "CAT_09")] %>% group_by(TA090789, CAT_09) %>% summarise(Count = n())

T09_CIG_CAT <- T09_CIG_CAT[1:26, ]

ggplot(T09_CIG_FTLW, aes(x = FTL_COUNT, y = TA090789, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_CIG_CAT, aes(x = CAT_09, y = TA090789, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category"))

### Body Mass Index (BMI) ======================================================================================================== 

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA090989)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090989 = 99))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090989 = 99))

T09_BMI_FTLW <- TIAS2009[, c("TA090989", "FTL_COUNT")] %>% group_by(TA090989, FTL_COUNT) %>% summarise(Count = n())

T09_BMI_FTLW <- T09_BMI_FTLW[1:268, ]

T09_BMI_CAT <- TIAS2009[, c("TA090989", "CAT_09")] %>% group_by(TA090989, CAT_09) %>% summarise(Count = n())

T09_BMI_CAT <- T09_BMI_CAT[1:256, ]

compare_means(TA090989 ~ FTL_COUNT,  data = T09_BMI_FTLW, ref.group = "0",
              method = "t.test")
my_comparisons <- list( c("0", "1"), c("1", "2"), c("0", "2"))
ggboxplot(T09_BMI_FTLW, x = "FTL_COUNT", y = "TA090989", title = "TIAS 2009", 
          color = "FTL_COUNT", palette = "jco", xlab = "# of Waves for Which Participant Identified as FTL", ylab = "Body Mass Index (BMI)", legend.title="# of FTL Waves") + 
  stat_compare_means(comparisons = my_comparisons) +  
  stat_compare_means(label.y = 50)    

ggplot(T09_BMI_FTLW, aes(x = FTL_COUNT, y = TA090989, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_BMI_CAT, aes(x = CAT_09, y = TA090989, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA090784)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090784 = c(98, 99)))

TIAS2009 <- TIAS2009 %>% 
  replace_with_na(replace = list(TA090784 = c(98, 99)))

T09_SLP_FTLW <- TIAS2009[, c("TA090784", "FTL_COUNT")] %>% group_by(TA090784, FTL_COUNT) %>% summarise(Count = n())

T09_SLP_FTLW <- T09_SLP_FTLW[1:26, ]

T09_SLP_CAT <- TIAS2009[, c("TA090784", "CAT_09")] %>% group_by(TA090784, CAT_09) %>% summarise(Count = n())

T09_SLP_CAT <- T09_SLP_CAT[1:21, ]

ggplot(T09_SLP_FTLW, aes(x = FTL_COUNT, y = TA090784, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2009", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T09_SLP_CAT, aes(x = CAT_09, y = TA090784, group = CAT_09, fill = as.factor(CAT_09))) +
  geom_boxplot() +
  labs(title = "TIAS 2009", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2011 ######################## 

### Amphetamine Usage ==============================================================================================================

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110930)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110930 = 9))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110930 = 9))

T11_AMP_FTLW <- TIAS2011[, c("TA110930", "FTL_COUNT")] %>% group_by(TA110930, FTL_COUNT) %>% summarise(Count = n())

T11_AMP_FTLW <- T11_AMP_FTLW[1:8,]

T11_AMP_CAT <- TIAS2011[, c("TA110930", "CAT_11")] %>% group_by(TA110930, CAT_11) %>% summarise(Count = n())

T11_AMP_CAT <- T11_AMP_CAT[1:7, ]

head(T11_AMP_CAT, 7)

ggplot(T11_AMP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110930)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "40 or more times"))

head(T11_AMP_FTLW, 7)

ggplot(T11_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110930)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "40 or more times"))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110951)

T11_BRB_FTLW <- TIAS2011[, c("TA110951", "FTL_COUNT")] %>% group_by(TA110951, FTL_COUNT) %>% summarise(Count = n())

T11_BRB_CAT <- TIAS2011[, c("TA110951", "CAT_11")] %>% group_by(TA110951, CAT_11) %>% summarise(Count = n())

head(T11_BRB_CAT, 6)

ggplot(T11_BRB_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110951)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("Never", "1-2 times", "6-9 times", "10-19 times", "40 or more times"))

head(T11_BRB_FTLW, 7)

ggplot(T11_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110951)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("Never", "1-2 times", "6-9 times", "10-19 times", "40 or more times"))

### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110938)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110938 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110938 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110938 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110938 = 9))

T11_MAR_FTLW <- TIAS2011[, c("TA110938", "FTL_COUNT")] %>% group_by(TA110938, FTL_COUNT) %>% summarise(Count = n())

T11_MAR_FTLW <- T11_MAR_FTLW[1:8, ]

T11_MAR_CAT <- TIAS2011[, c("TA110938", "CAT_11")] %>% group_by(TA110938, CAT_11) %>% summarise(Count = n())

T11_MAR_CAT <- T11_MAR_CAT[1:7, ]

head(T11_MAR_CAT, 7)

ggplot(T11_MAR_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110938)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple"), 
                    labels = c("Never", "1-2 times", "3-5 times", "10-19 times", "20-39 times", "40 or more times"))

head(T11_MAR_FTLW, 8)

ggplot(T11_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110938)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple"), 
                    labels = c("Never", "1-2 times", "3-5 times", "10-19 times", "20-39 times", "40 or more times"))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110922)

T11_DIP_FTLW <- TIAS2011[, c("TA110922", "FTL_COUNT")] %>% group_by(TA110922, FTL_COUNT) %>% summarise(Count = n())

T11_DIP_CAT <- TIAS2011[, c("TA110922", "CAT_11")] %>% group_by(TA110922, CAT_11) %>% summarise(Count = n())

head(T11_DIP_CAT, 5)

ggplot(T11_DIP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110922)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon"), 
                    labels = c("Never", "1-2 times", "3-5 times", "40 or more times")) 

head(T11_DIP_FTLW, 6)

ggplot(T11_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110922)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon"), 
                    labels = c("Never", "1-2 times", "3-5 times", "40 or more times")) 

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110967)

T11_STR_FTLW <- TIAS2011[, c("TA110967", "FTL_COUNT")] %>% group_by(TA110967, FTL_COUNT) %>% summarise(Count = n())

T11_STR_CAT <- TIAS2011[, c("TA110967", "CAT_11")] %>% group_by(TA110967, CAT_11) %>% summarise(Count = n())

head(T11_STR_CAT, 3)

ggplot(T11_STR_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110967)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), 
                    labels = c("Never", "1-2 times")) 

head(T11_STR_FTLW, 4)

ggplot(T11_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110967)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2"), 
                    labels = c("Never", "1-2 times")) 

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110959)

T11_TRQ_FTLW <- TIAS2011[, c("TA110959", "FTL_COUNT")] %>% group_by(TA110959, FTL_COUNT) %>% summarise(Count = n())

T11_TRQ_CAT <- TIAS2011[, c("TA110959", "CAT_11")] %>% group_by(TA110959, CAT_11) %>% summarise(Count = n())

head(T11_TRQ_CAT, 6)

ggplot(T11_TRQ_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110959)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times"))

head(T11_TRQ_FTLW, 7)

ggplot(T11_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110959)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA110943)

T11_CCN_FTLW <- TIAS2011[, c("TA110943", "FTL_COUNT")] %>% group_by(TA110943, FTL_COUNT) %>% summarise(Count = n())

T11_CCN_CAT <- TIAS2011[, c("TA110943", "CAT_11")] %>% group_by(TA110943, CAT_11) %>% summarise(Count = n())

head(T11_CCN_CAT, 8)

ggplot(T11_CCN_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110943))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T11_CCN_FTLW, 9)

ggplot(T11_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110943)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA110913)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110913 = c(8, 9)))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110913 = c(8, 9)))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110913 = c(8, 9)))

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110913 = c(8, 9)))

T11_AAC_FTLW <- TIAS2011[, c("TA110913", "FTL_COUNT")] %>% group_by(TA110913, FTL_COUNT) %>% summarise(Count = n())

T11_AAC_FTLW <- T11_AAC_FTLW[1:13, ]

T11_AAC_CAT <- TIAS2011[, c("TA110913", "CAT_11")] %>% group_by(TA110913, CAT_11) %>% summarise(Count = n())

T11_AAC_CAT <- T11_AAC_CAT[1:10, ]

T11_AAC_FTLCAT <- TIAS2011_FTL[, c("TA110913", "CAT_11")] %>% group_by(TA110913, CAT_11) %>% summarise(Count = n())

T11_AAC_IACCAT <- TIAS2011_IAC[, c("TA110913", "CAT_11")] %>% group_by(TA110913, CAT_11) %>% summarise(Count = n())

T11_AAC_IACCAT <- T11_AAC_IACCAT[1:7, ]

head(T11_AAC_CAT, 10)

ggplot(T11_AAC_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110913))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T11_AAC_FTLW, 13)

ggplot(T11_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110913)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2011_FTL$TA110913))

aac.pie.ftl.11 <- ggplot(data = T11_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110913))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3"), 
                    labels = c("Never", "Less than once a month", "About once a month")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110913))

aac.pie.iac.11 <- ggplot(data = T11_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110913))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.11, aac.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))      

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA110914)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110914 = c(98, 99)))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110914 = c(98, 99)))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110914 = c(98, 99)))

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110914 = c(98, 99)))

T11_DAC_FTLW <- TIAS2011[, c("TA110914", "FTL_COUNT")] %>% group_by(TA110914, FTL_COUNT) %>% summarise(Count = n())

T11_DAC_FTLW <- T11_DAC_FTLW[1:26, ]

T11_DAC_CAT <- TIAS2011[, c("TA110914", "CAT_11")] %>% group_by(TA110914, CAT_11) %>% summarise(Count = n())

T11_DAC_CAT <- T11_DAC_CAT[1:23, ]

T11_DAC_FTLCAT <- TIAS2011_FTL[, c("TA110914", "CAT_11")] %>% group_by(TA110914, CAT_11) %>% summarise(Count = n())

T11_DAC_IACCAT <- TIAS2011_IAC[, c("TA110914", "CAT_11")] %>% group_by(TA110914, CAT_11) %>% summarise(Count = n())

T11_DAC_IACCAT <- T11_DAC_IACCAT[1:20, ]

head(T11_DAC_CAT, 23)

ggplot(T11_DAC_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110914))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "mediumpurple", "lightpink",
                    "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
                    labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "11 drinks", "12 drinks",
                    "14 drinks", "15 drinks", "16 drinks", "17 drinks", "18 drinks", "20 drinks", "25 drinks"))

head(T11_DAC_FTLW, 26)

ggplot(T11_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110914)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "mediumpurple", "lightpink",
                                                                  "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
                    labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "11 drinks", "12 drinks",
                               "14 drinks", "15 drinks", "16 drinks", "17 drinks", "18 drinks", "20 drinks", "25 drinks"))

prop.table(table(TIAS2011_FTL$TA110914))

dac.pie.ftl.11 <- ggplot(data = T11_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110914))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values = c("skyblue", "hotpink", "mediumvioletred"), labels = c("Never", "1 or fewer drinks", "5 drinks")) + 
  theme_void()

prop.table(table(TIAS2011_IAC$TA110914))

dac.pie.iac.11 <- ggplot(data = T11_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110914))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "mediumpurple", "lightpink",
                                                                  "midnightblue", "violet", "olivedrab1", "orange", "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "darkgoldenrod1"),
                    labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "11 drinks", "12 drinks",
                               "14 drinks", "15 drinks", "16 drinks", "17 drinks", "18 drinks", "20 drinks", "25 drinks")) + 
  theme_void() 

ggarrange(dac.pie.ftl.11, dac.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))  

### Degree to Which Condition Limits Normal Daily Activities ====================================================================  

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA110842)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110842 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110842 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110842 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110842 = 9))  

T11_DCN_FTLW <- TIAS2011[, c("TA110842", "FTL_COUNT")] %>% group_by(TA110842, FTL_COUNT) %>% summarise(Count = n())

T11_DCN_FTLW <- T11_DCN_FTLW[1:9, ]

T11_DCN_CAT <- TIAS2011[, c("TA110842", "CAT_11")] %>% group_by(TA110842, CAT_11) %>% summarise(Count = n())

T11_DCN_CAT <- T11_DCN_CAT[1:7, ]

T11_DCN_FTLCAT <- TIAS2011_FTL[, c("TA110842", "CAT_11")] %>% group_by(TA110842, CAT_11) %>% summarise(Count = n())

T11_DCN_IACCAT <- TIAS2011_IAC[, c("TA110842", "CAT_11")] %>% group_by(TA110842, CAT_11) %>% summarise(Count = n())

T11_DCN_IACCAT <- T11_DCN_IACCAT[1:5, ]

head(T11_DCN_CAT, 7)

ggplot(T11_DCN_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110842)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T11_DCN_FTLW, 9)

ggplot(T11_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110842)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

prop.table(table(TIAS2011_FTL$TA110842))

dcn.pie.ftl.11 <- ggplot(data = T11_DCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110842))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold"), 
                    labels = c("Inap: No chronic condition", "A lot")) 

prop.table(table(TIAS2011_IAC$TA110842))

dcn.pie.iac.11 <- ggplot(data = T11_DCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110842))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all")) 

ggarrange(dcn.pie.ftl.11, dcn.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110853)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110853 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110853 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110853 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110853 = 8))  

T11_DEP_FTLW <- TIAS2011[, c("TA110853", "FTL_COUNT")] %>% group_by(TA110853, FTL_COUNT) %>% summarise(Count = n())

T11_DEP_FTLW <- T11_DEP_FTLW[1:6, ]

T11_DEP_CAT <- TIAS2011[, c("TA110853", "CAT_11")] %>% group_by(TA110853, CAT_11) %>% summarise(Count = n())

T11_DEP_CAT <- T11_DEP_CAT[1:4, ]

T11_DEP_FTLCAT <- TIAS2011_FTL[, c("TA110853", "CAT_11")] %>% group_by(TA110853, CAT_11) %>% summarise(Count = n())

T11_DEP_IACCAT <- TIAS2011_IAC[, c("TA110853", "CAT_11")] %>% group_by(TA110853, CAT_11) %>% summarise(Count = n())

T11_DEP_IACCAT <- T11_DEP_IACCAT[1:2, ]

head(T11_DEP_CAT, 4)

ggplot(T11_DEP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110853)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

head(T11_DEP_FTLW, 6)

ggplot(T11_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110853)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

prop.table(table(TIAS2011_FTL$TA110853))

dep.pie.ftl.11 <- ggplot(data = T11_DEP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110853))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110853))

dep.pie.iac.11 <- ggplot(data = T11_DEP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110853))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(dep.pie.ftl.11, dep.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 0 (2011: Inap.: has not had two weeks or longer of feeling sad, empty, or depressed nearly every day for most of the day in the past 12 months (TA110853=5); 
# NA, DK, RF whether had two weeks or longer of feeling sad, empty, or depressed nearly every day for most of the day in the past 12 months (TA110853=8 or 9); 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110854)

T11_ANH_FTLW <- TIAS2011[, c("TA110854", "FTL_COUNT")] %>% group_by(TA110854, FTL_COUNT) %>% summarise(Count = n())

T11_ANH_CAT <- TIAS2011[, c("TA110854", "CAT_11")] %>% group_by(TA110854, CAT_11) %>% summarise(Count = n())

T11_ANH_FTLCAT <- TIAS2011_FTL[, c("TA110854", "CAT_11")] %>% group_by(TA110854, CAT_11) %>% summarise(Count = n())

T11_ANH_IACCAT <- TIAS2011_IAC[, c("TA110854", "CAT_11")] %>% group_by(TA110854, CAT_11) %>% summarise(Count = n())

head(T11_ANH_CAT, 6)

ggplot(T11_ANH_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110854)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("darkseagreen1", "cadetblue1", "lightsalmon"), labels = c("Not applicable", "Yes", "Not >2wks"))

head(T11_ANH_FTLW, 8)

ggplot(T11_ANH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110854)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("darkseagreen1", "cadetblue1", "lightsalmon"), labels = c("Not applicable", "Yes", "Not >2wks"))

prop.table(table(TIAS2011_FTL$TA110854))

anh.pie.ftl.11 <- ggplot(data = T11_ANH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110854))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("darkseagreen1", "cadetblue1", "lightsalmon"), labels = c("Not applicable", "Yes", "Not >2wks")) + 
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110854))

anh.pie.iac.11 <- ggplot(data = T11_ANH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110854))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("darkseagreen1", "cadetblue1", "lightsalmon"), labels = c("Not applicable", "Yes", "Not >2wks")) + 
  theme_void() 

ggarrange(anh.pie.ftl.11, anh.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA110827)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110827 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110827 = 8)) 

T11_DPD_FTLW <- TIAS2011[, c("TA110827", "FTL_COUNT")] %>% group_by(TA110827, FTL_COUNT) %>% summarise(Count = n())

T11_DPD_FTLW <- T11_DPD_FTLW[1:5, ]

T11_DPD_CAT <- TIAS2011[, c("TA110827", "CAT_11")] %>% group_by(TA110827, CAT_11) %>% summarise(Count = n())

T11_DPD_CAT <- T11_DPD_CAT[1:3, ]

head(T11_DPD_CAT, 3)

ggplot(T11_DPD_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110827)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T11_DPD_FTLW, 5)

ggplot(T11_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110827)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA110828)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110828 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110828 = 8)) 

T11_BIP_FTLW <- TIAS2011[, c("TA110828", "FTL_COUNT")] %>% group_by(TA110828, FTL_COUNT) %>% summarise(Count = n())

T11_BIP_FTLW <- T11_BIP_FTLW[1:4, ]

T11_BIP_CAT <- TIAS2011[, c("TA110828", "CAT_11")] %>% group_by(TA110828, CAT_11) %>% summarise(Count = n())

T11_BIP_CAT <- T11_BIP_CAT[1:3, ]

head(T11_BIP_CAT, 3)

ggplot(T11_BIP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110828)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T11_BIP_FTLW, 4)

ggplot(T11_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110828)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Phobia Diagnosis ============================================================================================================= 

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA110831)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110831 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110831 = 8)) 

T11_PHB_FTLW <- TIAS2011[, c("TA110831", "FTL_COUNT")] %>% group_by(TA110831, FTL_COUNT) %>% summarise(Count = n())

T11_PHB_FTLW <- T11_PHB_FTLW[1:4, ]

T11_PHB_CAT <- TIAS2011[, c("TA110831", "CAT_11")] %>% group_by(TA110831, CAT_11) %>% summarise(Count = n())

T11_PHB_CAT <- T11_PHB_CAT[1:3, ]

head(T11_PHB_CAT, 3)

ggplot(T11_PHB_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110831)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T11_PHB_FTLW, 4)

ggplot(T11_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110831)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Anxiety Disorders Diagnosis ================================================================================================== 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA110830)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110830 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110830 = 8)) 

T11_ANX_FTLW <- TIAS2011[, c("TA110830", "FTL_COUNT")] %>% group_by(TA110830, FTL_COUNT) %>% summarise(Count = n())

T11_ANX_FTLW <- T11_ANX_FTLW[1:5, ]

T11_ANX_CAT <- TIAS2011[, c("TA110830", "CAT_11")] %>% group_by(TA110830, CAT_11) %>% summarise(Count = n())

T11_ANX_CAT <- T11_ANX_CAT[1:3, ]

head(T11_ANX_CAT, 3)

ggplot(T11_ANX_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110830)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T11_ANX_FTLW, 5)

ggplot(T11_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110830)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### OCD Diagnosis ================================================================================================================ 

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA110834)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110834 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110834 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110834 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110834 = 8))  

T11_OCD_FTLW <- TIAS2011[, c("TA110834", "FTL_COUNT")] %>% group_by(TA110834, FTL_COUNT) %>% summarise(Count = n())

T11_OCD_FTLW <- T11_OCD_FTLW[1:4, ]

T11_OCD_CAT <- TIAS2011[, c("TA110834", "CAT_11")] %>% group_by(TA110834, CAT_11) %>% summarise(Count = n())

T11_OCD_CAT <- T11_OCD_CAT[1:3, ]

head(T11_OCD_CAT, 3)

ggplot(T11_OCD_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110834)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T11_OCD_FTLW, 4)

ggplot(T11_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110834)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Emotional/Nervous/Psychiatric Problems ======================================================================================= 

###
# H12. WTR Ever Had Emotional/Psych Problems: "Has a doctor or other health professional ever told you that you have or had any emotional, nervous, or psychiatric problems?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
###

table(TIAS$TA110825)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110825 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110825 = 9)) 

T11_ENP_FTLW <- TIAS2011[, c("TA110825", "FTL_COUNT")] %>% group_by(TA110825, FTL_COUNT) %>% summarise(Count = n())

T11_ENP_FTLW <- T11_ENP_FTLW[1:5, ]

T11_ENP_CAT <- TIAS2011[, c("TA110825", "CAT_11")] %>% group_by(TA110825, CAT_11) %>% summarise(Count = n())

T11_ENP_CAT <- T11_ENP_CAT[1:3, ]

head(T11_ENP_CAT, 3)

ggplot(T11_ENP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110825)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

head(T11_ENP_FTLW, 5)

ggplot(T11_ENP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110825)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("WTR Ever Had Emotional/Psych Problems", values = c("palevioletred1", "palegreen"), labels = c("Yes", "No"))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA111125)

T11_NPD_FTLW <- TIAS2011[, c("TA111125", "FTL_COUNT")] %>% group_by(TA111125, FTL_COUNT) %>% summarise(Count = n())

T11_NPD_CAT <- TIAS2011[, c("TA111125", "CAT_11")] %>% group_by(TA111125, CAT_11) %>% summarise(Count = n())

ggplot(T11_NPD_FTLW, aes(x = FTL_COUNT, y = TA111125, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_NPD_CAT, aes(x = CAT_11, y = TA111125, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA111120)

T11_SOA_FTLW <- TIAS2011[, c("TA111120", "FTL_COUNT")] %>% group_by(TA111120, FTL_COUNT) %>% summarise(Count = n())

T11_SOA_CAT <- TIAS2011[, c("TA111120", "CAT_11")] %>% group_by(TA111120, CAT_11) %>% summarise(Count = n())

ggplot(T11_SOA_FTLW, aes(x = FTL_COUNT, y = TA111120, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SOA_CAT, aes(x = CAT_11, y = TA111120, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Worry ========================================================================================================= 

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA111119)

T11_WRY_FTLW <- TIAS2011[, c("TA111119", "FTL_COUNT")] %>% group_by(TA111119, FTL_COUNT) %>% summarise(Count = n())

T11_WRY_CAT <- TIAS2011[, c("TA111119", "CAT_11")] %>% group_by(TA111119, CAT_11) %>% summarise(Count = n())

ggplot(T11_WRY_FTLW, aes(x = FTL_COUNT, y = TA111119, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_WRY_CAT, aes(x = CAT_11, y = TA111119, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Paid Employment Since Jan 1 of Prior Year ====================================================================================

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA110141)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110141 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110141 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110141 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110141 = 8))  

T11_EPJ_FTLW <- TIAS2011[, c("TA110141", "FTL_COUNT")] %>% group_by(TA110141, FTL_COUNT) %>% summarise(Count = n())

T11_EPJ_FTLW <- T11_EPJ_FTLW[1:8, ]

T11_EPJ_CAT <- TIAS2011[, c("TA110141", "CAT_11")] %>% group_by(TA110141, CAT_11) %>% summarise(Count = n())

T11_EPJ_CAT <- T11_EPJ_CAT[1:6, ]

T11_EPJ_FTLCAT <- TIAS2011_FTL[, c("TA110141", "CAT_11")] %>% group_by(TA110141, CAT_11) %>% summarise(Count = n())

T11_EPJ_IACCAT <- TIAS2011_IAC[, c("TA110141", "CAT_11")] %>% group_by(TA110141, CAT_11) %>% summarise(Count = n())

T11_EPJ_IACCAT <- T11_EPJ_IACCAT[1:3, ]

head(T11_EPJ_CAT, 6)

ggplot(T11_EPJ_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110141)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T11_EPJ_FTLW, 8)

ggplot(T11_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110141)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2011_FTL$TA110141))

epj.pie.ftl.11 <- ggplot(data = T11_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110141))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110141))

epj.pie.iac.11 <- ggplot(data = T11_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110141))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.11, epj.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA110348)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110348 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110348 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110348 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110348 = 9))  

T11_EPH_FTLW <- TIAS2011[, c("TA110348", "FTL_COUNT")] %>% group_by(TA110348, FTL_COUNT) %>% summarise(Count = n())

T11_EPH_FTLW <- T11_EPH_FTLW[1:8, ]

T11_EPH_CAT <- TIAS2011[, c("TA110348", "CAT_11")] %>% group_by(TA110348, CAT_11) %>% summarise(Count = n())

T11_EPH_CAT <- T11_EPH_CAT[1:5, ]

T11_EPH_FTLCAT <- TIAS2011_FTL[, c("TA110348", "CAT_11")] %>% group_by(TA110348, CAT_11) %>% summarise(Count = n())

T11_EPH_IACCAT <- TIAS2011_IAC[, c("TA110348", "CAT_11")] %>% group_by(TA110348, CAT_11) %>% summarise(Count = n())

T11_EPH_IACCAT <- T11_EPH_IACCAT[1:3, ]

head(T11_EPH_CAT, 5)

ggplot(T11_EPH_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110348)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

head(T11_EPH_FTLW, 8)

ggplot(T11_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110348)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2011_FTL$TA110348))

eph.pie.ftl.11 <- ggplot(data = T11_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110348))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110348))

eph.pie.iac.11 <- ggplot(data = T11_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110348))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.11, eph.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Current Marital Status ======================================================================================================= 

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110079)

T11_CMS_FTLW <- TIAS2011[, c("TA110079", "FTL_COUNT")] %>% group_by(TA110079, FTL_COUNT) %>% summarise(Count = n())

T11_CMS_CAT <- TIAS2011[, c("TA110079", "CAT_11")] %>% group_by(TA110079, CAT_11) %>% summarise(Count = n())

head(T11_CMS_CAT, 6)

ggplot(T11_CMS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA110079)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "mediumpurple1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

head(T11_CMS_FTLW, 8)

ggplot(T11_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110079)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "mediumpurple1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA110088)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110088 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110088 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110088 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110088 = 9))  

T11_RRN_FTLW <- TIAS2011[, c("TA110088", "FTL_COUNT")] %>% group_by(TA110088, FTL_COUNT) %>% summarise(Count = n())

T11_RRN_FTLW <- T11_RRN_FTLW[1:8, ]

T11_RRN_CAT <- TIAS2011[, c("TA110088", "CAT_11")] %>% group_by(TA110088, CAT_11) %>% summarise(Count = n())

T11_RRN_CAT <- T11_RRN_CAT[1:6, ]

T11_RRN_FTLCAT <- TIAS2011_FTL[, c("TA110088", "CAT_11")] %>% group_by(TA110088, CAT_11) %>% summarise(Count = n())

T11_RRN_IACCAT <- TIAS2011_IAC[, c("TA110088", "CAT_11")] %>% group_by(TA110088, CAT_11) %>% summarise(Count = n())

T11_RRN_IACCAT <- T11_RRN_IACCAT[1:3, ]

head(T11_RRN_CAT, 6)

ggplot(T11_RRN_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110088)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

head(T11_RRN_FTLW, 8)

ggplot(T11_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110088)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2011_FTL$TA110088))

rrn.pie.ftl.11 <- ggplot(data = T11_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110088))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110088))

rrn.pie.iac.11 <- ggplot(data = T11_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110088))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.11, rrn.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Number of Children =========================================================================================================== 

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA110101)

T11_CHL_FTLW <- TIAS2011[, c("TA110101", "FTL_COUNT")] %>% group_by(TA110101, FTL_COUNT) %>% summarise(Count = n())

T11_CHL_CAT <- TIAS2011[, c("TA110101", "CAT_11")] %>% group_by(TA110101, CAT_11) %>% summarise(Count = n())

ggplot(T11_CHL_FTLW, aes(x = FTL_COUNT, y = TA110101, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_CHL_CAT, aes(x = CAT_11, y = TA110101, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 0 (Inap.: TA alumnus and reported education last wave); 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110671)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110671 = 0))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110671 = 0))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110671 = 0))

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110671 = 0))

T11_HSG_FTLW <- TIAS2011[, c("TA110671", "FTL_COUNT")] %>% group_by(TA110671, FTL_COUNT) %>% summarise(Count = n())

T11_HSG_FTLW <- T11_HSG_FTLW[1:7, ]

T11_HSG_CAT <- TIAS2011[, c("TA110671", "CAT_11")] %>% group_by(TA110671, CAT_11) %>% summarise(Count = n())

T11_HSG_CAT <- T09_HSG_CAT[1:6, ]

T11_HSG_FTLCAT <- TIAS2011_FTL[, c("TA110671", "CAT_11")] %>% group_by(TA110671, CAT_11) %>% summarise(Count = n())

T11_HSG_FTLCAT <- T11_HSG_FTLCAT[1:3, ]

T11_HSG_IACCAT <- TIAS2011_IAC[, c("TA110671", "CAT_11")] %>% group_by(TA110671, CAT_11) %>% summarise(Count = n())

T11_HSG_IACCAT <- T11_HSG_IACCAT[1:3, ]

head(T11_HSG_CAT, 6)

ggplot(T11_HSG_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110671)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

head(T11_HSG_FTLW, 7)

ggplot(T11_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110671)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither"))

prop.table(table(TIAS2011_FTL$TA110671))

hsg.pie.ftl.11 <- ggplot(data = T11_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110671))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110671))

hsg.pie.iac.11 <- ggplot(data = T11_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110671))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("HS Diploma", "GED", "Neither")) +
  theme_void() 

ggarrange(hsg.pie.ftl.11, hsg.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### College Education ============================================================================================================  

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA110698)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110698 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110698 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110698 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110698 = 9))  

T11_CLG_FTLW <- TIAS2011[, c("TA110698", "FTL_COUNT")] %>% group_by(TA110698, FTL_COUNT) %>% summarise(Count = n())

T11_CLG_FTLW <- T11_CLG_FTLW[1:8, ]

T11_CLG_CAT <- TIAS2011[, c("TA110698", "CAT_11")] %>% group_by(TA110698, CAT_11) %>% summarise(Count = n())

T11_CLG_CAT <- T11_CLG_CAT[1:5, ]

T11_CLG_FTLCAT <- TIAS2011_FTL[, c("TA110698", "CAT_11")] %>% group_by(TA110698, CAT_11) %>% summarise(Count = n())

T11_CLG_IACCAT <- TIAS2011_IAC[, c("TA110698", "CAT_11")] %>% group_by(TA110698, CAT_11) %>% summarise(Count = n())

T11_CLG_IACCAT <- T11_CLG_IACCAT[1:3, ]

head(T11_CLG_CAT, 5)

ggplot(T11_CLG_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110698)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") +
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

head(T11_CLG_FTLW, 8)

ggplot(T11_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110698)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED"))

prop.table(table(TIAS2011_FTL$TA110698))

clg.pie.ftl.11 <- ggplot(data = T11_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110698))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA110698))

clg.pie.iac.11 <- ggplot(data = T11_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110698))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

ggarrange(clg.pie.ftl.11, clg.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 96 (Skipped, asked in TA-09); 99 (NA/DK)
####

table(TIAS$TA111133)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111133 = c(96, 99))) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111133 = c(96, 99))) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111133 = c(96, 99))) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111133 = c(96, 99))) 

T11_HEL_FTLW <- TIAS2011[, c("TA111133", "FTL_COUNT")] %>% group_by(TA111133, FTL_COUNT) %>% summarise(Count = n())

T11_HEL_FTLW <- T11_HEL_FTLW[1:16, ]

T11_HEL_CAT <- TIAS2011[, c("TA111133", "CAT_11")] %>% group_by(TA111133, CAT_11) %>% summarise(Count = n())

T11_HEL_CAT <- T11_HEL_CAT[1:14, ]

T11_HEL_FTLCAT <- TIAS2011_FTL[, c("TA111133", "CAT_11")] %>% group_by(TA111133, CAT_11) %>% summarise(Count = n())

T11_HEL_FTLCAT <- T11_HEL_FTLCAT[1:4, ]

T11_HEL_IACCAT <- TIAS2011_IAC[, c("TA111133", "CAT_11")] %>% group_by(TA111133, CAT_11) %>% summarise(Count = n())

T11_HEL_IACCAT <- T11_HEL_IACCAT[1:10, ]

head(T11_HEL_CAT, 14)

ggplot(T11_HEL_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111133))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
                               "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

head(T11_HEL_FTLW, 16)

ggplot(T11_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111133)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
                               "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

prop.table(table(TIAS2011_FTL$TA111133))

hel.pie.ftl.11 <- ggplot(data = T11_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111133))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College")) 

prop.table(table(TIAS2011_IAC$TA111133))

hel.pie.iac.11 <- ggplot(data = T11_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111133))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "salmon", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", 
                               "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree",  "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

ggarrange(hel.pie.ftl.11, hel.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Responsibility - Earning Own Living ========================================================================================== 

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110046)

T11_REO_FTLW <- TIAS2011[, c("TA110046", "FTL_COUNT")] %>% group_by(TA110046, FTL_COUNT) %>% summarise(Count = n())

T11_REO_CAT <- TIAS2011[, c("TA110046", "CAT_11")] %>% group_by(TA110046, CAT_11) %>% summarise(Count = n())

T11_REO_FTLCAT <- TIAS2011_FTL[, c("TA110046", "CAT_11")] %>% group_by(TA110046, CAT_11) %>% summarise(Count = n())

T11_REO_IACCAT <- TIAS2011_IAC[, c("TA110046", "CAT_11")] %>% group_by(TA110046, CAT_11) %>% summarise(Count = n())

head(T11_REO_CAT, 9)

ggplot(T11_REO_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T11_REO_FTLW, 13)

ggplot(T11_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2011_FTL$TA110046))

reo.pie.ftl.11 <- ggplot(data = T11_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("mediumturquoise", "deepskyblue", "gold", "green3"),
                    labels = c("Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2011_IAC$TA110046))

reo.pie.iac.11 <- ggplot(data = T11_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(reo.pie.ftl.11, reo.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Responsibility - Paying Own Rent ============================================================================================= 

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110047)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110047 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110047 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110047 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110047 = 8)) 

T11_POR_FTLW <- TIAS2011[, c("TA110047", "FTL_COUNT")] %>% group_by(TA110047, FTL_COUNT) %>% summarise(Count = n())

T11_POR_FTLW <- T11_POR_FTLW[1:16, ]

T11_POR_CAT <- TIAS2011[, c("TA110047", "CAT_11")] %>% group_by(TA110047, CAT_11) %>% summarise(Count = n())

T11_POR_CAT <- T11_POR_CAT[1:10, ]

T11_POR_FTLCAT <- TIAS2011_FTL[, c("TA110047", "CAT_11")] %>% group_by(TA110047, CAT_11) %>% summarise(Count = n())

T11_POR_IACCAT <- TIAS2011_IAC[, c("TA110047", "CAT_11")] %>% group_by(TA110047, CAT_11) %>% summarise(Count = n())

T11_POR_IACCAT <- T11_POR_IACCAT[1:6, ]

head(T11_POR_CAT, 10)

ggplot(T11_POR_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T11_POR_FTLW, 16)

ggplot(T11_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2011_FTL$TA110047)) 

por.pie.ftl.11 <- ggplot(data = T11_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Half of the time", "Most of the time", "All of the time"))  + theme_void()

prop.table(table(TIAS2011_IAC$TA110047))

por.pie.iac.11 <- ggplot(data = T11_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.11, por.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Responsibility - Paying Own Bills ============================================================================================ 

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110048)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110048 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110048 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110048 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110048 = 9))  

T11_POB_FTLW <- TIAS2011[, c("TA110048", "FTL_COUNT")] %>% group_by(TA110048, FTL_COUNT) %>% summarise(Count = n())

T11_POB_FTLW <- T11_POB_FTLW[1:15, ]

T11_POB_CAT <- TIAS2011[, c("TA110048", "CAT_11")] %>% group_by(TA110048, CAT_11) %>% summarise(Count = n())

T11_POB_CAT <- T11_POB_CAT[1:10, ]

T11_POB_FTLCAT <- TIAS2011_FTL[, c("TA110048", "CAT_11")] %>% group_by(TA110048, CAT_11) %>% summarise(Count = n())

T11_POB_IACCAT <- TIAS2011_IAC[, c("TA110048", "CAT_11")] %>% group_by(TA110048, CAT_11) %>% summarise(Count = n())

T11_POB_IACCAT <- T11_POB_IACCAT[1:6, ]

head(T11_POB_CAT, 10)

ggplot(T11_POB_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))


head(T11_POB_FTLW, 15)

ggplot(T11_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2011_FTL$TA110048))

pob.pie.ftl.11 <- ggplot(data = T11_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110048))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Half of the time", "Most of the time", "All of the time"))  

prop.table(table(TIAS2011_IAC$TA110048))

pob.pie.iac.11 <- ggplot(data = T11_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110048))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.11, pob.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110049)

T11_RMM_FTLW <- TIAS2011[, c("TA110049", "FTL_COUNT")] %>% group_by(TA110049, FTL_COUNT) %>% summarise(Count = n())

T11_RMM_CAT <- TIAS2011[, c("TA110049", "CAT_11")] %>% group_by(TA110049, CAT_11) %>% summarise(Count = n())

T11_RMM_FTLCAT <- TIAS2011_FTL[, c("TA110049", "CAT_11")] %>% group_by(TA110049, CAT_11) %>% summarise(Count = n())

T11_RMM_IACCAT <- TIAS2011_IAC[, c("TA110049", "CAT_11")] %>% group_by(TA110049, CAT_11) %>% summarise(Count = n())

head(T11_RMM_CAT, 9)

ggplot(T11_RMM_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110049)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T11_RMM_FTLW, 13)

ggplot(T11_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110049)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2011_FTL$TA110049))

rmm.pie.ftl.11 <- ggplot(data = T11_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110049))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("gold", "green3", "mediumturquoise", "deepskyblue"),
                    labels = c("Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2011_IAC$TA110049))

rmm.pie.iac.11 <- ggplot(data = T11_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110049))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(rmm.pie.ftl.11, rmm.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### How Good at Taking Responsibility for Actions ================================================================================ 

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110050)

T11_ROA_FTLW <- TIAS2011[, c("TA110050", "FTL_COUNT")] %>% group_by(TA110050, FTL_COUNT) %>% summarise(Count = n())

T11_ROA_CAT <- TIAS2011[, c("TA110050", "CAT_11")] %>% group_by(TA110050, CAT_11) %>% summarise(Count = n())

ggplot(T11_ROA_FTLW, aes(x = FTL_COUNT, y = TA110050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_ROA_CAT, aes(x = CAT_11, y = TA110050, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Money Management ================================================================================================= 

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110052)

T11_GMM_FTLW <- TIAS2011[, c("TA110052", "FTL_COUNT")] %>% group_by(TA110052, FTL_COUNT) %>% summarise(Count = n())

T11_GMM_CAT <- TIAS2011[, c("TA110052", "CAT_11")] %>% group_by(TA110052, CAT_11) %>% summarise(Count = n())

ggplot(T11_GMM_FTLW, aes(x = FTL_COUNT, y = TA110052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_GMM_CAT, aes(x = CAT_11, y = TA110052, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ================================================================================== 

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA110053)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110053 = c(8, 9))) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110053 = c(8, 9))) 

T11_CCB_FTLW <- TIAS2011[, c("TA110053", "FTL_COUNT")] %>% group_by(TA110053, FTL_COUNT) %>% summarise(Count = n())

T11_CCB_FTLW <- T11_CCB_FTLW[1:17, ]

T11_CCB_CAT <- TIAS2011[, c("TA110053", "CAT_11")] %>% group_by(TA110053, CAT_11) %>% summarise(Count = n())

T11_CCB_CAT <- T11_CCB_CAT[1:14, ]

ggplot(T11_CCB_FTLW, aes(x = FTL_COUNT, y = TA110053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_CCB_CAT, aes(x = CAT_11, y = TA110053, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### MIDUS M1 - Happiness ========================================================================================================= 

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111061)

T11_M01_FTLW <- TIAS2011[, c("TA111061", "FTL_COUNT")] %>% group_by(TA111061, FTL_COUNT) %>% summarise(Count = n())

T11_M01_CAT <- TIAS2011[, c("TA111061", "CAT_11")] %>% group_by(TA111061, CAT_11) %>% summarise(Count = n())

T11_M01_FTLCAT <- TIAS2011_FTL[, c("TA111061", "CAT_11")] %>% group_by(TA111061, CAT_11) %>% summarise(Count = n())

T11_M01_IACCAT <- TIAS2011_IAC[, c("TA111061", "CAT_11")] %>% group_by(TA111061, CAT_11) %>% summarise(Count = n())

head(T11_M01_CAT, 9)

ggplot(T11_M01_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111061)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M01_FTLW, 14)

ggplot(T11_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111061)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111061))

m01.pie.ftl.11 <- ggplot(data = T11_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111061))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2011_IAC$TA111061))

m01.pie.iac.11 <- ggplot(data = T11_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111061))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.11, m01.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M2 - Interest in Life ================================================================================================== 

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111062)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111062 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111062 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111062 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111062 = 8))  

T11_M02_FTLW <- TIAS2011[, c("TA111062", "FTL_COUNT")] %>% group_by(TA111062, FTL_COUNT) %>% summarise(Count = n())

T11_M02_FTLW <- T11_M02_FTLW[1:13, ]

T11_M02_CAT <- TIAS2011[, c("TA111062", "CAT_11")] %>% group_by(TA111062, CAT_11) %>% summarise(Count = n())

T11_M02_CAT <- T11_M02_CAT[1:9, ]

T11_M02_FTLCAT <- TIAS2011_FTL[, c("TA111062", "CAT_11")] %>% group_by(TA111062, CAT_11) %>% summarise(Count = n())

T11_M02_IACCAT <- TIAS2011_IAC[, c("TA111062", "CAT_11")] %>% group_by(TA111062, CAT_11) %>% summarise(Count = n())

T11_M02_IACCAT <- T11_M02_IACCAT[1:6, ]

head(T11_M02_CAT, 9)

ggplot(T11_M02_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111062)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M02_FTLW, 13)

ggplot(T11_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111062)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111062))

m02.pie.ftl.11 <- ggplot(data = T11_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111062))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("gold", "deepskyblue", "mediumpurple1"), 
  labels = c("Once or twice", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2011_IAC$TA111062))

m02.pie.iac.11 <- ggplot(data = T11_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111062))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.11, m02.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M3 - Satisfaction ======================================================================================================  

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111063)

T11_M03_FTLW <- TIAS2011[, c("TA111063", "FTL_COUNT")] %>% group_by(TA111063, FTL_COUNT) %>% summarise(Count = n())

T11_M03_CAT <- TIAS2011[, c("TA111063", "CAT_11")] %>% group_by(TA111063, CAT_11) %>% summarise(Count = n())

T11_M03_FTLCAT <- TIAS2011_FTL[, c("TA111063", "CAT_11")] %>% group_by(TA111063, CAT_11) %>% summarise(Count = n())

T11_M03_IACCAT <- TIAS2011_IAC[, c("TA111063", "CAT_11")] %>% group_by(TA111063, CAT_11) %>% summarise(Count = n())

head(T11_M03_CAT, 8)

ggplot(T11_M03_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111063)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M03_FTLW, 14)

ggplot(T11_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111063)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111063))

m03.pie.ftl.11 <- ggplot(data = T11_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111063))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("deepskyblue", "mediumpurple1"), 
  labels = c("Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2011_IAC$TA111063))

m03.pie.iac.11 <- ggplot(data = T11_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111063))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.11, m03.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M4 - Contribution of Something Important to Society ==================================================================== 

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111064)

T11_M04_FTLW <- TIAS2011[, c("TA111064", "FTL_COUNT")] %>% group_by(TA111064, FTL_COUNT) %>% summarise(Count = n())

T11_M04_CAT <- TIAS2011[, c("TA111064", "CAT_11")] %>% group_by(TA111064, CAT_11) %>% summarise(Count = n())

T11_M04_FTLCAT <- TIAS2011_FTL[, c("TA111064", "CAT_11")] %>% group_by(TA111064, CAT_11) %>% summarise(Count = n())

T11_M04_IACCAT <- TIAS2011_IAC[, c("TA111064", "CAT_11")] %>% group_by(TA111064, CAT_11) %>% summarise(Count = n())

head(T11_M04_CAT, 12)

ggplot(T11_M04_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111064)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M04_FTLW, 14)

ggplot(T11_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111064)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111064))

m04.pie.ftl.11 <- ggplot(data = T11_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111064))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111064))

m04.pie.iac.11 <- ggplot(data = T11_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111064))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.11, m04.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M5 - Belonging to Community ============================================================================================ 

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111065)

T11_M05_FTLW <- TIAS2011[, c("TA111065", "FTL_COUNT")] %>% group_by(TA111065, FTL_COUNT) %>% summarise(Count = n())

T11_M05_CAT <- TIAS2011[, c("TA111065", "CAT_11")] %>% group_by(TA111065, CAT_11) %>% summarise(Count = n())

T11_M05_FTLCAT <- TIAS2011_FTL[, c("TA111065", "CAT_11")] %>% group_by(TA111065, CAT_11) %>% summarise(Count = n())

T11_M05_IACCAT <- TIAS2011_IAC[, c("TA111065", "CAT_11")] %>% group_by(TA111065, CAT_11) %>% summarise(Count = n())

head(T11_M05_CAT, 11)

ggplot(T11_M05_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111065)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M05_FTLW, 14)

ggplot(T11_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111065)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111065))

m05.pie.ftl.11 <- ggplot(data = T11_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111065))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111065))

m05.pie.iac.11 <- ggplot(data = T11_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111065))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.11, m05.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M6 - Society Getting Better ============================================================================================ 

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111066)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111066 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111066 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111066 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111066 = 9))  

T11_M06_FTLW <- TIAS2011[, c("TA111066", "FTL_COUNT")] %>% group_by(TA111066, FTL_COUNT) %>% summarise(Count = n())

T11_M06_FTLW <- T11_M06_FTLW[1:16, ]

T11_M06_CAT <- TIAS2011[, c("TA111066", "CAT_11")] %>% group_by(TA111066, CAT_11) %>% summarise(Count = n())

T11_M06_CAT <- T11_M06_CAT[1:9, ]

T11_M06_FTLCAT <- TIAS2011_FTL[, c("TA111066", "CAT_11")] %>% group_by(TA111066, CAT_11) %>% summarise(Count = n())

T11_M06_IACCAT <- TIAS2011_IAC[, c("TA111066", "CAT_11")] %>% group_by(TA111066, CAT_11) %>% summarise(Count = n())

T11_M06_IACCAT <- T11_M06_IACCAT[1:6, ]

head(T11_M06_CAT, 9)

ggplot(T11_M06_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111066)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M06_FTLW, 16)

ggplot(T11_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111066)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111066))

m06.pie.ftl.11 <- ggplot(data = T11_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111066))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111066))

m06.pie.iac.11 <- ggplot(data = T11_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111066))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.11, m06.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M7 - People Basically Good ============================================================================================= 

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111067)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111067 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111067 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111067 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111067 = 9))  

T11_M07_FTLW <- TIAS2011[, c("TA111067", "FTL_COUNT")] %>% group_by(TA111067, FTL_COUNT) %>% summarise(Count = n())

T11_M07_FTLW <- T11_M07_FTLW[1:16, ]

T11_M07_CAT <- TIAS2011[, c("TA111067", "CAT_11")] %>% group_by(TA111067, CAT_11) %>% summarise(Count = n())

T11_M07_CAT <- T11_M07_CAT[1:11, ]

T11_M07_FTLCAT <- TIAS2011_FTL[, c("TA111067", "CAT_11")] %>% group_by(TA111067, CAT_11) %>% summarise(Count = n())

T11_M07_IACCAT <- TIAS2011_IAC[, c("TA111067", "CAT_11")] %>% group_by(TA111067, CAT_11) %>% summarise(Count = n())

T11_M07_IACCAT <- T11_M07_IACCAT[1:6, ]

head(T11_M07_CAT, 11)

ggplot(T11_M07_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111067)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M07_FTLW, 16)

ggplot(T11_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111067)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111067))

m07.pie.ftl.11 <- ggplot(data = T11_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111067))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111067))

m07.pie.iac.11 <- ggplot(data = T11_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111067))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.11, m07.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M8 - Way Society Makes Sense =========================================================================================== 

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111068)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111068 = c(8, 9)))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111068 = c(8, 9))) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111068 = c(8, 9))) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111068 = c(8, 9))) 

T11_M08_FTLW <- TIAS2011[, c("TA111068", "FTL_COUNT")] %>% group_by(TA111068, FTL_COUNT) %>% summarise(Count = n())

T11_M08_FTLW <- T11_M08_FTLW[1:26, ]

T11_M08_CAT <- TIAS2011[, c("TA111068", "CAT_11")] %>% group_by(TA111068, CAT_11) %>% summarise(Count = n())

T11_M08_CAT <- T11_M08_CAT[1:12, ]

T11_M08_FTLCAT <- TIAS2011_FTL[, c("TA111068", "CAT_11")] %>% group_by(TA111068, CAT_11) %>% summarise(Count = n())

T11_M08_FTLCAT <- T11_M08_FTLCAT[1:6, ]

T11_M08_IACCAT <- TIAS2011_IAC[, c("TA111068", "CAT_11")] %>% group_by(TA111068, CAT_11) %>% summarise(Count = n())

T11_M08_IACCAT <- T11_M08_IACCAT[1:6, ]

head(T11_M08_CAT, 12)

ggplot(T11_M08_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111068)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M08_FTLW, 26)

ggplot(T11_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111068)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111068))

m08.pie.ftl.11 <- ggplot(data = T11_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111068))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111068))

m08.pie.iac.11 <- ggplot(data = T11_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111068))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.11, m08.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================  

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111069)

T11_M09_FTLW <- TIAS2011[, c("TA111069", "FTL_COUNT")] %>% group_by(TA111069, FTL_COUNT) %>% summarise(Count = n())

T11_M09_CAT <- TIAS2011[, c("TA111069", "CAT_11")] %>% group_by(TA111069, CAT_11) %>% summarise(Count = n())
 
T11_M09_FTLCAT <- TIAS2011_FTL[, c("TA111069", "CAT_11")] %>% group_by(TA111069, CAT_11) %>% summarise(Count = n())

T11_M09_IACCAT <- TIAS2011_IAC[, c("TA111069", "CAT_11")] %>% group_by(TA111069, CAT_11) %>% summarise(Count = n())

head(T11_M09_CAT, 12)

ggplot(T11_M09_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M09_FTLW, 23)

ggplot(T11_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111069))

m09.pie.ftl.11 <- ggplot(data = T11_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111069))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111069))

m09.pie.iac.11 <- ggplot(data = T11_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111069))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.11, m09.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M10 - Trusting Relationships w/ Others ================================================================================= 

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111070)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111070 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111070 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111070 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111070 = 8))

T11_M10_FTLW <- TIAS2011[, c("TA111070", "FTL_COUNT")] %>% group_by(TA111070, FTL_COUNT) %>% summarise(Count = n())

T11_M10_FTLW <- T11_M10_FTLW[1:26, ]

T11_M10_CAT <- TIAS2011[, c("TA111070", "CAT_11")] %>% group_by(TA111070, CAT_11) %>% summarise(Count = n())

T11_M10_CAT <- T11_M10_CAT[1:12, ]

T11_M10_FTLCAT <- TIAS2011_FTL[, c("TA111070", "CAT_11")] %>% group_by(TA111070, CAT_11) %>% summarise(Count = n())

T11_M10_IACCAT <- TIAS2011_IAC[, c("TA111070", "CAT_11")] %>% group_by(TA111070, CAT_11) %>% summarise(Count = n())

T11_M10_IACCAT <- T11_M10_IACCAT[1:6, ]

head(T11_M10_CAT, 12)

ggplot(T11_M10_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M10_FTLW, 26)

ggplot(T11_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111070))

m10.pie.ftl.11 <- ggplot(data = T11_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111070))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111070))

m10.pie.iac.11 <- ggplot(data = T11_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111070))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.11, m10.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M11 - Challenged to Grow =============================================================================================== 

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111071)

T11_M11_FTLW <- TIAS2011[, c("TA111071", "FTL_COUNT")] %>% group_by(TA111071, FTL_COUNT) %>% summarise(Count = n())

T11_M11_CAT <- TIAS2011[, c("TA111071", "CAT_11")] %>% group_by(TA111071, CAT_11) %>% summarise(Count = n())

T11_M11_FTLCAT <- TIAS2011_FTL[, c("TA111071", "CAT_11")] %>% group_by(TA111071, CAT_11) %>% summarise(Count = n())

T11_M11_IACCAT <- TIAS2011_IAC[, c("TA111071", "CAT_11")] %>% group_by(TA111071, CAT_11) %>% summarise(Count = n())

head(T11_M11_CAT, 12)

ggplot(T11_M11_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111071)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M11_FTLW, 22)

ggplot(T11_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111071)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111071)) 

m11.pie.ftl.11 <- ggplot(data = T11_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111071))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111071))

m11.pie.iac.11 <- ggplot(data = T11_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111071))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.11, m11.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================  

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111072)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111072 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111072 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111072 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111072 = 9))

T11_M12_FTLW <- TIAS2011[, c("TA111072", "FTL_COUNT")] %>% group_by(TA111072, FTL_COUNT) %>% summarise(Count = n())

T11_M12_FTLW <- T11_M12_FTLW[1:24, ]

T11_M12_CAT <- TIAS2011[, c("TA111072", "CAT_11")] %>% group_by(TA111072, CAT_11) %>% summarise(Count = n())

T11_M12_CAT <- T11_M12_CAT[1:12, ]

T11_M12_FTLCAT <- TIAS2011_FTL[, c("TA111072", "CAT_11")] %>% group_by(TA111072, CAT_11) %>% summarise(Count = n())

T11_M12_IACCAT <- TIAS2011_IAC[, c("TA111072", "CAT_11")] %>% group_by(TA111072, CAT_11) %>% summarise(Count = n())

T11_M12_IACCAT <- T11_M12_IACCAT[1:6, ]

head(T11_M12_CAT, 12)

ggplot(T11_M12_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111072)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M12_FTLW, 24)

ggplot(T11_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111072)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111072))

m12.pie.ftl.11 <- ggplot(data = T11_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111072))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111072))

m12.pie.iac.11 <- ggplot(data = T11_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111072))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.11, m12.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M13 - Liked Personality ================================================================================================ 

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111073)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111073 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111073 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111073 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111073 = 9))

T11_M13_FTLW <- TIAS2011[, c("TA111073", "FTL_COUNT")] %>% group_by(TA111073, FTL_COUNT) %>% summarise(Count = n())

T11_M13_FTLW <- T11_M13_FTLW[1:20, ]

T11_M13_CAT <- TIAS2011[, c("TA111073", "CAT_11")] %>% group_by(TA111073, CAT_11) %>% summarise(Count = n())

T11_M13_CAT <- T11_M13_CAT[1:11, ]

T11_M13_FTLCAT <- TIAS2011_FTL[, c("TA111073", "CAT_11")] %>% group_by(TA111073, CAT_11) %>% summarise(Count = n())

T11_M13_IACCAT <- TIAS2011_IAC[, c("TA111073", "CAT_11")] %>% group_by(TA111073, CAT_11) %>% summarise(Count = n())

T11_M13_IACCAT <- T11_M13_IACCAT[1:6, ]

head(T11_M13_CAT, 11)

ggplot(T11_M13_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111073)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M13_FTLW, 20)

ggplot(T11_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111073)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111073))

m13.pie.ftl.11 <- ggplot(data = T11_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111073))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111073))  

m13.pie.iac.11 <- ggplot(data = T11_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111073))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.11, m13.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS M14 - Life Had Direction =============================================================================================== 

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111074)

T11_M14_FTLW <- TIAS2011[, c("TA111074", "FTL_COUNT")] %>% group_by(TA111074, FTL_COUNT) %>% summarise(Count = n())

T11_M14_CAT <- TIAS2011[, c("TA111074", "CAT_11")] %>% group_by(TA111074, CAT_11) %>% summarise(Count = n())

T11_M14_FTLCAT <- TIAS2011_FTL[, c("TA111074", "CAT_11")] %>% group_by(TA111074, CAT_11) %>% summarise(Count = n())

T11_M14_IACCAT <- TIAS2011_IAC[, c("TA111074", "CAT_11")] %>% group_by(TA111074, CAT_11) %>% summarise(Count = n())

head(T11_M14_CAT, 12)

ggplot(T11_M14_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111074)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T11_M14_FTLW, 23)

ggplot(T11_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111074)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA111074))

m14.pie.ftl.11 <- ggplot(data = T11_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111074))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2011_IAC$TA111074))

m14.pie.iac.11 <- ggplot(data = T11_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111074))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.11, m14.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### MIDUS Subscale - Emotional =================================================================================================== 

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA111122)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111122 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111122 = 9)) 

T11_MSE_FTLW <- TIAS2011[, c("TA111122", "FTL_COUNT")] %>% group_by(TA111122, FTL_COUNT) %>% summarise(Count = n())

T11_MSE_FTLW <- T11_MSE_FTLW[1:21, ]

T11_MSE_CAT <- TIAS2011[, c("TA111122", "CAT_11")] %>% group_by(TA111122, CAT_11) %>% summarise(Count = n())

T11_MSE_CAT <- T11_MSE_CAT[1:11, ]

ggplot(T11_MSE_FTLW, aes(x = FTL_COUNT, y = TA111122, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_MSE_CAT, aes(x = CAT_11, y = TA111122, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological =============================================================================================== 

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA111124)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111124 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111124 = 9)) 

T11_MSP_FTLW <- TIAS2011[, c("TA111124", "FTL_COUNT")] %>% group_by(TA111124, FTL_COUNT) %>% summarise(Count = n())

T11_MSP_FTLW <- T11_MSP_FTLW[1:20, ]

T11_MSP_CAT <- TIAS2011[, c("TA111124", "CAT_11")] %>% group_by(TA111124, CAT_11) %>% summarise(Count = n())

T11_MSP_CAT <- T11_MSP_CAT[1:11, ]

ggplot(T11_MSP_FTLW, aes(x = FTL_COUNT, y = TA111124, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_MSP_CAT, aes(x = CAT_11, y = TA111124, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ================================================================================================== 

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110016)

T11_TIA_FTLW <- TIAS2011[, c("TA110016", "FTL_COUNT")] %>% group_by(TA110016, FTL_COUNT) %>% summarise(Count = n())

T11_TIA_CAT <- TIAS2011[, c("TA110016", "CAT_11")] %>% group_by(TA110016, CAT_11) %>% summarise(Count = n())

T11_TIA_FTLCAT <- TIAS2011_FTL[, c("TA110016", "CAT_11")] %>% group_by(TA110016, CAT_11) %>% summarise(Count = n())

T11_TIA_IACCAT <- TIAS2011_IAC[, c("TA110016", "CAT_11")] %>% group_by(TA110016, CAT_11) %>% summarise(Count = n())

head(T11_TIA_CAT, 4)

ggplot(T11_TIA_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T11_TIA_FTLW, 11)

ggplot(T11_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2011_FTL$TA110016))

tia.pie.ftl.11 <- ggplot(data = T11_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2011_IAC$TA110016)) 

tia.pie.iac.11 <- ggplot(data = T11_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.11, tia.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Type of Art (Involvement) ========================================================================================= 

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 8871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA110017)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110017 = c(9998, 9999)))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110017 = c(9998, 9999)))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110017 = c(9998, 9999)))

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110017 = c(9998, 9999)))

T11_IIA_FTLW <- TIAS2011[, c("TA110017", "FTL_COUNT")] %>% group_by(TA110017, FTL_COUNT) %>% summarise(Count = n())

T11_IIA_FTLW <- T11_IIA_FTLW[1:31, ]

T11_IIA_CAT <- TIAS2011[, c("TA110017", "CAT_11")] %>% group_by(TA110017, CAT_11) %>% summarise(Count = n())

T11_IIA_CAT <- T11_IIA_CAT[1:24, ]

T11_IIA_FTLCAT <- TIAS2011_FTL[, c("TA110017", "CAT_11")] %>% group_by(TA110017, CAT_11) %>% summarise(Count = n())

T11_IIA_FTLCAT <- T11_IIA_FTLCAT[1:6, ]

T11_IIA_IACCAT <- TIAS2011_IAC[, c("TA110017", "CAT_11")] %>% group_by(TA110017, CAT_11) %>% summarise(Count = n())

T11_IIA_IACCAT <- T11_IIA_IACCAT[1:18, ]

head(T11_IIA_CAT, 24)

rownames(T11_IIA_CAT)

ggplot(T11_IIA_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "green", "purple"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", "After-School Drama/Art Club", "Needle-work", "Arts & Crafts", 
  "Pottery", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement", "Dance Lessons", "Music Lessons", "Other Activity"))     
                                                                                                                              
head(T11_IIA_FTLW, 31)

ggplot(T11_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "green", "purple"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", "After-School Drama/Art Club", "Needle-work", "Arts & Crafts", 
                                                                                                                                                                          "Pottery", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement", "Dance Lessons", "Music Lessons", "Other Activity"))     
prop.table(table(TIAS2011_FTL$TA110017)) 

iia.pie.ftl.11 <- ggplot(data = T11_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred"), labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", "After-School Drama/Art Club", "Arts & Crafts", "Singing", "Non-social Dancing/Ballet/Body Movement"))

prop.table(table(TIAS2011_IAC$TA110017)) 

iia.pie.iac.11 <- ggplot(data = T11_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "green", "purple"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", "After-School Drama/Art Club", "Needle-work", "Arts & Crafts", 
                                                                                                                                                                          "Pottery", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement", "Dance Lessons", "Music Lessons", "Other Activity"))     
ggarrange(iia.pie.ftl.11, iia.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Art Involvement Frequency (Over 12 Mos) =========================================================================== 

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA110018)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110018 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110018 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110018 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110018 = 8))

T11_AIF_FTLW <- TIAS2011[, c("TA110018", "FTL_COUNT")] %>% group_by(TA110018, FTL_COUNT) %>% summarise(Count = n())

T11_AIF_FTLW <- T11_AIF_FTLW[1:22, ]

T11_AIF_CAT <- TIAS2011[, c("TA110018", "CAT_11")] %>% group_by(TA110018, CAT_11) %>% summarise(Count = n())

T11_AIF_CAT <- T11_AIF_CAT[1:12, ]

T11_AIF_FTLCAT <- TIAS2011_FTL[, c("TA110018", "CAT_11")] %>% group_by(TA110018, CAT_11) %>% summarise(Count = n())

T11_AIF_IACCAT <- TIAS2011_IAC[, c("TA110018", "CAT_11")] %>% group_by(TA110018, CAT_11) %>% summarise(Count = n())

T11_AIF_IACCAT <- T11_AIF_IACCAT[1:7, ]

head(T11_AIF_CAT, 12)

ggplot(T11_AIF_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T11_AIF_FTLW, 22)

ggplot(T11_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA110018)) 

aif.pie.ftl.11 <- ggplot(data = T11_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "At least once a month", "Once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2011_IAC$TA110018)) 

aif.pie.iac.11 <- ggplot(data = T11_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.11, aif.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### WTR Member of Sports Team (Over 12 Mos) ====================================================================================== 

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110019)

T11_SPO_FTLW <- TIAS2011[, c("TA110019", "FTL_COUNT")] %>% group_by(TA110019, FTL_COUNT) %>% summarise(Count = n())

T11_SPO_CAT <- TIAS2011[, c("TA110019", "CAT_11")] %>% group_by(TA110019, CAT_11) %>% summarise(Count = n())

T11_SPO_FTLCAT <- TIAS2011_FTL[, c("TA110019", "CAT_11")] %>% group_by(TA110019, CAT_11) %>% summarise(Count = n())

T11_SPO_IACCAT <- TIAS2011_IAC[, c("TA110019", "CAT_11")] %>% group_by(TA110019, CAT_11) %>% summarise(Count = n())

head(T11_SPO_CAT, 4)

ggplot(T11_SPO_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T11_SPO_FTLW, 5)

ggplot(T11_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2011_FTL$TA110019))

spo.pie.ftl.11 <- ggplot(data = T11_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2011_IAC$TA110019)) 

spo.pie.iac.11 <- ggplot(data = T11_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.11, spo.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Involved in Sports Frequency  ===================================================================================== 

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA110020)

T11_IIS_FTLW <- TIAS2011[, c("TA110020", "FTL_COUNT")] %>% group_by(TA110020, FTL_COUNT) %>% summarise(Count = n())

T11_IIS_CAT <- TIAS2011[, c("TA110020", "CAT_11")] %>% group_by(TA110020, CAT_11) %>% summarise(Count = n())

T11_IIS_FTLCAT <- TIAS2011_FTL[, c("TA110020", "CAT_11")] %>% group_by(TA110020, CAT_11) %>% summarise(Count = n())

T11_IIS_IACCAT <- TIAS2011_IAC[, c("TA110020", "CAT_11")] %>% group_by(TA110020, CAT_11) %>% summarise(Count = n())

head(T11_IIS_CAT, 13)

ggplot(T11_IIS_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T11_IIS_FTLW, 20)

ggplot(T11_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_FTL$TA110020))

iis.pie.ftl.11 <- ggplot(data = T11_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_IAC$TA110020)) 

iis.pie.iac.11 <- ggplot(data = T11_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.11, iis.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Watching/Reading News (Over 12 Mos) =============================================================================== 

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110021)

T11_WRN_FTLW <- TIAS2011[, c("TA110021", "FTL_COUNT")] %>% group_by(TA110021, FTL_COUNT) %>% summarise(Count = n())

T11_WRN_CAT <- TIAS2011[, c("TA110021", "CAT_11")] %>% group_by(TA110021, CAT_11) %>% summarise(Count = n())

T11_WRN_FTLCAT <- TIAS2011_FTL[, c("TA110021", "CAT_11")] %>% group_by(TA110021, CAT_11) %>% summarise(Count = n())

T11_WRN_IACCAT <- TIAS2011_IAC[, c("TA110021", "CAT_11")] %>% group_by(TA110021, CAT_11) %>% summarise(Count = n())

head(T11_WRN_CAT, 14)

ggplot(T11_WRN_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T11_WRN_FTLW, 29)

ggplot(T11_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2011_FTL$TA110021))

wrn.pie.ftl.11 <- ggplot(data = T11_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2011_IAC$TA110021)) 

wrn.pie.iac.11 <- ggplot(data = T11_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.11, wrn.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================ 

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110022)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110018 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110022 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110022 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110022 = 9))

T11_RFP_FTLW <- TIAS2011[, c("TA110022", "FTL_COUNT")] %>% group_by(TA110022, FTL_COUNT) %>% summarise(Count = n())

T11_RFP_FTLW <- T11_RFP_FTLW[1:27, ]

T11_RFP_CAT <- TIAS2011[, c("TA110022", "CAT_11")] %>% group_by(TA110022, CAT_11) %>% summarise(Count = n())

T11_RFP_CAT <- T11_RFP_CAT[1:14, ]

T11_RFP_FTLCAT <- TIAS2011_FTL[, c("TA110022", "CAT_11")] %>% group_by(TA110022, CAT_11) %>% summarise(Count = n())

T11_RFP_FTLCAT <- T11_RFP_FTLCAT[1:7, ]

T11_RFP_IACCAT <- TIAS2011_IAC[, c("TA110022", "CAT_11")] %>% group_by(TA110022, CAT_11) %>% summarise(Count = n())

head(T11_RFP_CAT, 14) 

ggplot(T11_RFP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T11_RFP_FTLW, 27) 

ggplot(T11_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2011_FTL$TA110022))

rfp.pie.ftl.11 <- ggplot(data = T11_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2011_IAC$TA110022)) 

rfp.pie.iac.11 <- ggplot(data = T11_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.11, rfp.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ========================================================================== 

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110023)

T11_NNT_FTLW <- TIAS2011[, c("TA110023", "FTL_COUNT")] %>% group_by(TA110023, FTL_COUNT) %>% summarise(Count = n())

T11_NNT_CAT <- TIAS2011[, c("TA110023", "CAT_11")] %>% group_by(TA110023, CAT_11) %>% summarise(Count = n())

T11_NNT_FTLCAT <- TIAS2011_FTL[, c("TA110023", "CAT_11")] %>% group_by(TA110023, CAT_11) %>% summarise(Count = n())

T11_NNT_IACCAT <- TIAS2011_IAC[, c("TA110023", "CAT_11")] %>% group_by(TA110023, CAT_11) %>% summarise(Count = n())

head(T11_NNT_CAT, 13)

ggplot(T11_NNT_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T11_NNT_FTLW, 28)

ggplot(T11_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2011_FTL$TA110023))

nnt.pie.ftl.11 <- ggplot(data = T11_NNT_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2011_IAC$TA110023)) 

nnt.pie.iac.11 <- ggplot(data = T11_NNT_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

ggarrange(nnt.pie.ftl.11, nnt.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Internet Usage ==================================================================================================== 

#### 
# A9. WTR Ever Used Internet: “Have you ever used the internet?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110024)

T11_ITU_FTLW <- TIAS2011[, c("TA110024", "FTL_COUNT")] %>% group_by(TA110024, FTL_COUNT) %>% summarise(Count = n())

T11_ITU_CAT <- TIAS2011[, c("TA110024", "CAT_11")] %>% group_by(TA110024, CAT_11) %>% summarise(Count = n())

head(T11_ITU_CAT, 4)

ggplot(T11_ITU_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T11_ITU_FTLW, 9)

ggplot(T11_ITU_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Ever Used Internet", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ========================================================== 

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA110025)

T11_IPE_FTLW <- TIAS2011[, c("TA110025", "FTL_COUNT")] %>% group_by(TA110025, FTL_COUNT) %>% summarise(Count = n())

T11_IPE_CAT <- TIAS2011[, c("TA110025", "CAT_11")] %>% group_by(TA110025, CAT_11) %>% summarise(Count = n())

T11_IPE_FTLCAT <- TIAS2011_FTL[, c("TA110025", "CAT_11")] %>% group_by(TA110025, CAT_11) %>% summarise(Count = n())

T11_IPE_IACCAT <- TIAS2011_IAC[, c("TA110025", "CAT_11")] %>% group_by(TA110025, CAT_11) %>% summarise(Count = n())

head(T11_IPE_CAT, 13)

ggplot(T11_IPE_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2009", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T11_IPE_FTLW, 17)

ggplot(T11_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2009", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2011_FTL$TA110025))

ipe.pie.ftl.11 <- ggplot(data = T11_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2011_IAC$TA110025)) 

ipe.pie.iac.11 <- ggplot(data = T11_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.11, ipe.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ================================================================== 

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA110026)

T11_IPR_FTLW <- TIAS2011[, c("TA110026", "FTL_COUNT")] %>% group_by(TA110026, FTL_COUNT) %>% summarise(Count = n())

T11_IPR_CAT <- TIAS2011[, c("TA110026", "CAT_11")] %>% group_by(TA110026, CAT_11) %>% summarise(Count = n())

T11_IPR_FTLCAT <- TIAS2011_FTL[, c("TA110026", "CAT_11")] %>% group_by(TA110026, CAT_11) %>% summarise(Count = n())

T11_IPR_IACCAT <- TIAS2011_IAC[, c("TA110026", "CAT_11")] %>% group_by(TA110026, CAT_11) %>% summarise(Count = n())

head(T11_IPR_CAT, 15)

ggplot(T11_IPR_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T11_IPR_FTLW, 31)

ggplot(T11_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2011_FTL$TA110026))

ipr.pie.ftl.11 <- ggplot(data = T11_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Never used the internet for school/research"))

prop.table(table(TIAS2011_IAC$TA110026))

ipr.pie.iac.11 <- ggplot(data = T11_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.11, ipr.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) ========================================================================= 

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA110027)

T11_IPS_FTLW <- TIAS2011[, c("TA110027", "FTL_COUNT")] %>% group_by(TA110027, FTL_COUNT) %>% summarise(Count = n())

T11_IPS_CAT <- TIAS2011[, c("TA110027", "CAT_11")] %>% group_by(TA110027, CAT_11) %>% summarise(Count = n())

T11_IPS_FTLCAT <- TIAS2011_FTL[, c("TA110027", "CAT_11")] %>% group_by(TA110027, CAT_11) %>% summarise(Count = n())

T11_IPS_IACCAT <- TIAS2011_IAC[, c("TA110027", "CAT_11")] %>% group_by(TA110027, CAT_11) %>% summarise(Count = n())

head(T11_IPS_CAT, 16)

ggplot(T11_IPS_CAT, aes(x = CAT_09, y = Count, fill = as.factor(TA110027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T11_IPS_FTLW, 30)

ggplot(T11_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2011_FTL$TA110027))

ips.pie.ftl.11 <- ggplot(data = T11_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2011_IAC$TA110027))

ips.pie.iac.11 <- ggplot(data = T11_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.11, ips.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ==================================================================== 

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA110028)

T11_IPG_FTLW <- TIAS2011[, c("TA110028", "FTL_COUNT")] %>% group_by(TA110028, FTL_COUNT) %>% summarise(Count = n())

T11_IPG_CAT <- TIAS2011[, c("TA110028", "CAT_11")] %>% group_by(TA110028, CAT_11) %>% summarise(Count = n())

T11_IPG_FTLCAT <- TIAS2011_FTL[, c("TA110028", "CAT_11")] %>% group_by(TA110028, CAT_11) %>% summarise(Count = n())

T11_IPG_IACCAT <- TIAS2011_IAC[, c("TA110028", "CAT_11")] %>% group_by(TA110028, CAT_11) %>% summarise(Count = n())

head(T09_IPG_CAT, 16)

ggplot(T09_IPG_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110028))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T11_IPG_FTLW, 33)

ggplot(T11_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110028)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2011_FTL$TA110028))

ipg.pie.ftl.11 <- ggplot(data = T11_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2011_IAC$TA110028))

ipg.pie.iac.11 <- ggplot(data = T11_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.11, ipg.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Voted in Last Presidential Election =============================================================================== 

####
# A11. WTR Voted in 2008: “Did you vote in the national election for President last November, in 2008?”
# Answers: 0 (Inap: date of birth is after 11/04/1990); 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110030)

T11_VLP_FTLW <- TIAS2011[, c("TA110030", "FTL_COUNT")] %>% group_by(TA110030, FTL_COUNT) %>% summarise(Count = n())

T11_VLP_CAT <- TIAS2011[, c("TA110030", "CAT_11")] %>% group_by(TA110030, CAT_11) %>% summarise(Count = n())

T11_VLP_FTLCAT <- TIAS2011_FTL[, c("TA110030", "CAT_11")] %>% group_by(TA110030, CAT_11) %>% summarise(Count = n())

T11_VLP_IACCAT <- TIAS2011_IAC[, c("TA110030", "CAT_11")] %>% group_by(TA110030, CAT_11) %>% summarise(Count = n())

head(T11_VLP_CAT, 6)

ggplot(T11_VLP_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2010 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

head(T11_VLP_FTLW, 13) 

ggplot(T11_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2010 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

prop.table(table(TIAS2011_FTL$TA110030))

vlp.pie.ftl.11 <- ggplot(data = T11_VLP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110030))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Voted in 2010 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

prop.table(table(TIAS2011_IAC$TA110030))

vlp.pie.iac.11 <- ggplot(data = T11_VLP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110030))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Voted in 2010 Presidential Election", values =  c("paleturquoise1", "lightgreen", "lightpink"), labels = c("Was not eligible due to voting age", "Yes", "No"))

ggarrange(vlp.pie.ftl.11, vlp.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - Involvement in Social Action Groups =============================================================================== 

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110031)

T11_ISA_FTLW <- TIAS2011[, c("TA110031", "FTL_COUNT")] %>% group_by(TA110031, FTL_COUNT) %>% summarise(Count = n())

T11_ISA_FTLW <- T11_ISA_FTLW[1:8, ]

T11_ISA_CAT <- TIAS2011[, c("TA110031", "CAT_11")] %>% group_by(TA110031, CAT_11) %>% summarise(Count = n())

T11_ISA_CAT <- T11_ISA_CAT[1:3, ]

head(T11_ISA_CAT, 3)

ggplot(T11_ISA_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T11_ISA_FTLW, 8)

ggplot(T11_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) ========================================================================= 

####
# A11C. Type of Social Action Groups: “Which groups?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

table(TIAS$TA110032)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110032 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110032 = 9)) 

T11_TSA_FTLW <- TIAS2011[, c("TA110032", "FTL_COUNT")] %>% group_by(TA110032, FTL_COUNT) %>% summarise(Count = n())

T11_TSA_FTLW <- T11_TSA_FTLW[1:12, ]

T11_TSA_CAT <- TIAS2011[, c("TA110032", "CAT_11")] %>% group_by(TA110032, CAT_11) %>% summarise(Count = n())

T11_TSA_CAT <- T11_TSA_CAT[1:7, ]

head(T11_TSA_CAT, 7)

ggplot(T11_TSA_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T11_TSA_FTLW, 12)

ggplot(T11_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) ===================================================================== 

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA110033)

T11_SAG_FTLW <- TIAS2011[, c("TA110033", "FTL_COUNT")] %>% group_by(TA110033, FTL_COUNT) %>% summarise(Count = n())

T11_SAG_FTLW <- T11_SAG_FTLW[1:12, ]

T11_SAG_CAT <- TIAS2011[, c("TA110033", "CAT_11")] %>% group_by(TA110033, CAT_11) %>% summarise(Count = n())

T11_SAG_CAT <- T11_SAG_CAT[1:7, ]

head(T11_SAG_CAT, 7)

ggplot(T11_SAG_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T11_SAG_FTLW, 12)

ggplot(T11_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement =============================================================================== 

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110034)

T11_CGI_FTLW <- TIAS2011[, c("TA110034", "FTL_COUNT")] %>% group_by(TA110034, FTL_COUNT) %>% summarise(Count = n())

T11_CGI_CAT <- TIAS2011[, c("TA110034", "CAT_11")] %>% group_by(TA110034, CAT_11) %>% summarise(Count = n())

T11_CGI_FTLCAT <- TIAS2011_FTL[, c("TA110034", "CAT_11")] %>% group_by(TA110034, CAT_11) %>% summarise(Count = n())

T11_CGI_IACCAT <- TIAS2011_IAC[, c("TA110034", "CAT_11")] %>% group_by(TA110034, CAT_11) %>% summarise(Count = n())

head(T11_CGI_CAT, 6)

ggplot(T11_CGI_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

head(T11_CGI_FTLW, 10)

ggplot(T11_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2011_FTL$TA110034))

cgi.pie.ftl.11 <- ggplot(data = T11_CGI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2011_IAC$TA110034)) 

cgi.pie.iac.11 <- ggplot(data = T11_CGI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

ggarrange(cgi.pie.ftl.11, cgi.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) ======================================================= 

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA110035)

T11_SCG_FTLW <- TIAS2011[, c("TA110035", "FTL_COUNT")] %>% group_by(TA110035, FTL_COUNT) %>% summarise(Count = n())

T11_SCG_CAT <- TIAS2011[, c("TA110035", "CAT_11")] %>% group_by(TA110035, CAT_11) %>% summarise(Count = n())

head(T11_SCG_CAT, 11)

ggplot(T11_SCG_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110035))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T11_SCG_FTLW, 16)

ggplot(T11_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110035)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ============================================================== 

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110036)

T11_UVW_FTLW <- TIAS2011[, c("TA110036", "FTL_COUNT")] %>% group_by(TA110036, FTL_COUNT) %>% summarise(Count = n())

T11_UVW_FTLW <- T11_UVW_FTLW[1:9, ]

T11_UVW_CAT <- TIAS2011[, c("TA110036", "CAT_11")] %>% group_by(TA110036, CAT_11) %>% summarise(Count = n())

T11_UVW_CAT <- T11_UVW_CAT[1:4, ]

head(T11_UVW_CAT, 4)

ggplot(T11_UVW_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110036))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

head(T11_UVW_FTLW, 9)

ggplot(T11_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110036)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

### Time Use - Type of Volunteer Work ============================================================================================ 

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA110037)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110037 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110037 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110037 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110037 = 9)) 

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA110038)

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA110039)

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA110040)

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA110041)

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA110042)

### Time Use - How Often Volunteered (Over 12 Mos) =============================================================================== 

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA110043)

T11_TUH_FTLW <- TIAS2011[, c("TA110043", "FTL_COUNT")] %>% group_by(TA110043, FTL_COUNT) %>% summarise(Count = n())

T11_TUH_FTLW <- T11_TUH_FTLW[1:21, ]

T11_TUH_CAT <- TIAS2011[, c("TA110043", "CAT_11")] %>% group_by(TA110043, CAT_11) %>% summarise(Count = n())

T11_TUH_CAT <- T11_TUH_CAT[1:13, ]

head(T11_TUH_CAT, 13)

ggplot(T11_TUH_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110043))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T11_TUH_FTLW, 21)

ggplot(T11_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110043)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ========================================================== 

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110062)

T11_SRU_FTLW <- TIAS2011[, c("TA110062", "FTL_COUNT")] %>% group_by(TA110062, FTL_COUNT) %>% summarise(Count = n())

T11_SRU_CAT <- TIAS2011[, c("TA110062", "CAT_11")] %>% group_by(TA110062, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRU_FTLW, aes(x = FTL_COUNT, y = TA110062, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRU_CAT, aes(x = CAT_11, y = TA110062, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others =========================================================== 

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110062)

T11_SRE_FTLW <- TIAS2011[, c("TA110062", "FTL_COUNT")] %>% group_by(TA110062, FTL_COUNT) %>% summarise(Count = n())

T11_SRE_FTLW <- T11_SRE_FTLW[1:22, ]

T11_SRE_CAT <- TIAS2011[, c("TA110062", "CAT_11")] %>% group_by(TA110062, CAT_11) %>% summarise(Count = n())

T11_SRE_CAT <- T11_SRE_CAT[1:12, ]

ggplot(T11_SRE_FTLW, aes(x = FTL_COUNT, y = TA110062, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRE_CAT, aes(x = CAT_11, y = TA110062, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ======================================================================== 

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110054)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110054 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110054 = 8)) 

T11_SRS_FTLW <- TIAS2011[, c("TA110054", "FTL_COUNT")] %>% group_by(TA110054, FTL_COUNT) %>% summarise(Count = n())

T11_SRS_FTLW <- T11_SRS_FTLW[1:29, ]

T11_SRS_CAT <- TIAS2011[, c("TA110054", "CAT_11")] %>% group_by(TA110054, CAT_11) %>% summarise(Count = n())

T11_SRS_CAT <- T11_SRS_CAT[1:14, ]

ggplot(T11_SRS_FTLW, aes(x = FTL_COUNT, y = TA110054, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRS_CAT, aes(x = CAT_11, y = TA110054, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Being a Leader ============================================================================ 

####
# C1B. How Good At Leading Comp w/ Others: “Compared to other people, how good are you at being a leader?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110055)

T11_SRB_FTLW <- TIAS2011[, c("TA110055", "FTL_COUNT")] %>% group_by(TA110055, FTL_COUNT) %>% summarise(Count = n())

T11_SRB_CAT <- TIAS2011[, c("TA110055", "CAT_11")] %>% group_by(TA110055, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRB_FTLW, aes(x = FTL_COUNT, y = TA110055, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRB_CAT, aes(x = CAT_11, y = TA110055, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Being a Leader (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Logical/Analytic Thinking ================================================================= 

####
# C1C. How Good At Logic Comp w/ Others: “Compared to other people, how good are you at logical, analytical thinking?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110056)

T11_SRL_FTLW <- TIAS2011[, c("TA110056", "FTL_COUNT")] %>% group_by(TA110056, FTL_COUNT) %>% summarise(Count = n())

T11_SRL_CAT <- TIAS2011[, c("TA110056", "CAT_11")] %>% group_by(TA110056, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRL_FTLW, aes(x = FTL_COUNT, y = TA110056, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRL_CAT, aes(x = CAT_11, y = TA110056, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Logical/Analytic Thinking (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Helping Others Solve Their Problems ======================================================= 

####
# C1D. How Good At Helping Comp w/ Others: “Compared to other people, how good are you at helping others solve their problems?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110057)

T11_SRH_FTLW <- TIAS2011[, c("TA110057", "FTL_COUNT")] %>% group_by(TA110057, FTL_COUNT) %>% summarise(Count = n())

T11_SRH_CAT <- TIAS2011[, c("TA110057", "CAT_11")] %>% group_by(TA110057, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRH_FTLW, aes(x = FTL_COUNT, y = TA110057, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRH_CAT, aes(x = CAT_11, y = TA110057, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Helping Others' Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ================================================================================================== 

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110051)

T11_HGP_FTLW <- TIAS2011[, c("TA110051", "FTL_COUNT")] %>% group_by(TA110051, FTL_COUNT) %>% summarise(Count = n())

T11_HGP_CAT <- TIAS2011[, c("TA110051", "CAT_11")] %>% group_by(TA110051, CAT_11) %>% summarise(Count = n())

ggplot(T11_HGP_FTLW, aes(x = FTL_COUNT, y = TA110051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_HGP_CAT, aes(x = CAT_11, y = TA110051, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Intelligence ==============================================================================

####
# C1E How Intelligent Compared w/ Others: “Compared to other people, how would you rate your intelligence? (On a scale of 1 to 7, 
# where 1 means ‘A lot worse than other people’ and 7 means ‘A lot better than other people’)”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110058)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110058 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110058 = 8)) 

T11_SRT_FTLW <- TIAS2011[, c("TA110058", "FTL_COUNT")] %>% group_by(TA110058, FTL_COUNT) %>% summarise(Count = n())

T11_SRT_FTLW <- T11_SRT_FTLW[1:23, ]

T11_SRT_CAT <- TIAS2011[, c("TA110058", "CAT_11")] %>% group_by(TA110058, CAT_11) %>% summarise(Count = n())

T11_SRT_CAT <- T11_SRT_CAT[1:11, ]

ggplot(T11_SRT_FTLW, aes(x = FTL_COUNT, y = TA110058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRT_CAT, aes(x = CAT_11, y = TA110058, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Intelligence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Independence ============================================================================== 

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110059)

T11_SRI_FTLW <- TIAS2011[, c("TA110059", "FTL_COUNT")] %>% group_by(TA110059, FTL_COUNT) %>% summarise(Count = n())

T11_SRI_CAT <- TIAS2011[, c("TA110059", "CAT_11")] %>% group_by(TA110059, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRI_FTLW, aes(x = FTL_COUNT, y = TA110059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRI_CAT, aes(x = CAT_11, y = TA110059, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================ 

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110060)

T11_SRC_FTLW <- TIAS2011[, c("TA110060", "FTL_COUNT")] %>% group_by(TA110060, FTL_COUNT) %>% summarise(Count = n())

T11_SRC_CAT <- TIAS2011[, c("TA110060", "CAT_11")] %>% group_by(TA110060, CAT_11) %>% summarise(Count = n())

ggplot(T11_SRC_FTLW, aes(x = FTL_COUNT, y = TA110060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRC_CAT, aes(x = CAT_11, y = TA110060, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ============================================================================== 

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110061)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110061 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110061 = 8)) 

T11_SRD_FTLW <- TIAS2011[, c("TA110061", "FTL_COUNT")] %>% group_by(TA110061, FTL_COUNT) %>% summarise(Count = n())

T11_SRD_FTLW <- T11_SRD_FTLW[1:29, ]

T11_SRD_CAT <- TIAS2011[, c("TA110061", "CAT_11")] %>% group_by(TA110061, CAT_11) %>% summarise(Count = n())

T11_SRD_CAT <- T11_SRD_CAT[1:13, ]

ggplot(T11_SRD_FTLW, aes(x = FTL_COUNT, y = TA110061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SRD_CAT, aes(x = CAT_11, y = TA110061, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ====================================================================== 

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110901)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110901 = 8)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110901 = 8)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110901 = 8)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110901 = 8)) 

T11_FSI_FTLW <- TIAS2011[, c("TA110901", "FTL_COUNT")] %>% group_by(TA110901, FTL_COUNT) %>% summarise(Count = n())

T11_FSI_FTLW <- T11_FSI_FTLW[1:24, ]

T11_FSI_CAT <- TIAS2011[, c("TA110901", "CAT_11")] %>% group_by(TA110901, CAT_11) %>% summarise(Count = n())

T11_FSI_CAT <- T11_FSI_CAT[1:12, ]

T11_FSI_FTLCAT <- TIAS2011_FTL[, c("TA110901", "CAT_11")] %>% group_by(TA110901, CAT_11) %>% summarise(Count = n())

T11_FSI_IACCAT <- TIAS2011_IAC[, c("TA110901", "CAT_11")] %>% group_by(TA110901, CAT_11) %>% summarise(Count = n())

T11_FSI_IACCAT <- T11_FSI_IACCAT[1:6, ]

head(T11_FSI_CAT, 12)

ggplot(T11_FSI_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110901))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T11_FSI_FTLW, 24)

ggplot(T11_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110901)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2011_FTL$TA110901))

fsi.pie.ftl.11 <- ggplot(data = T11_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110901))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2011_IAC$TA110901))

fsi.pie.iac.11 <- ggplot(data = T11_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110901))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.11, fsi.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Binge Eating Frequency =======================================================================================================  

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA110902)

T11_BEF_FTLW <- TIAS2011[, c("TA110902", "FTL_COUNT")] %>% group_by(TA110902, FTL_COUNT) %>% summarise(Count = n())

T11_BEF_CAT <- TIAS2011[, c("TA110902", "CAT_11")] %>% group_by(TA110902, CAT_11) %>% summarise(Count = n())

T11_BEF_FTLCAT <- TIAS2011_FTL[, c("TA110902", "CAT_11")] %>% group_by(TA110902, CAT_11) %>% summarise(Count = n())

T11_BEF_IACCAT <- TIAS2011_IAC[, c("TA110902", "CAT_11")] %>% group_by(TA110902, CAT_11) %>% summarise(Count = n())

head(T11_BEF_CAT, 12)

ggplot(T11_BEF_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA110902))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T11_BEF_FTLW, 26)

ggplot(T11_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA110902)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2011_FTL$TA110902))

bef.pie.ftl.11 <- ggplot(data = T11_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA110902))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2011_IAC$TA110902))

bef.pie.iac.11 <- ggplot(data = T11_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA110902))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.11, bef.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Race - Hispanic ============================================================================================================== 

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111056)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111056 = 9)) 

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111056 = 9)) 

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111056 = 9)) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111056 = 9)) 

T11_HIS_FTLW <- TIAS2011[, c("TA111056", "FTL_COUNT")] %>% group_by(TA111056, FTL_COUNT) %>% summarise(Count = n())

T11_HIS_FTLW <- T11_HIS_FTLW[1:19, ]

T11_HIS_CAT <- TIAS2011[, c("TA111056", "CAT_11")] %>% group_by(TA111056, CAT_11) %>% summarise(Count = n())

T11_HIS_CAT <- T11_HIS_CAT[1:12, ]

T11_HIS_FTLCAT <- TIAS2011_FTL[, c("TA111056", "CAT_11")] %>% group_by(TA111056, CAT_11) %>% summarise(Count = n())

T11_HIS_IACCAT <- TIAS2011_IAC[, c("TA111056", "CAT_11")] %>% group_by(TA111056, CAT_11) %>% summarise(Count = n())

T11_HIS_IACCAT <- T11_HIS_IACCAT[1:7, ]

head(T11_HIS_CAT, 12)

ggplot(T11_HIS_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111056))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

head(T11_HIS_FTLW, 19)

ggplot(T11_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111056)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2011_FTL$TA111056))

his.pie.ftl.11 <- ggplot(data = T11_HIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111056))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73",  "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Cuban", "Other Spanish"))

prop.table(table(TIAS2011_IAC$TA111056))

his.pie.iac.11 <- ggplot(data = T11_HIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111056))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "yellow", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

ggarrange(his.pie.ftl.11, his.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA111057)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111057 = c(8, 9)))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111057 = c(8, 9)))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA111057 = c(8, 9))) 

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA111057 = c(8, 9)))

T11_RAC_FTLW <- TIAS2011[, c("TA111057", "FTL_COUNT")] %>% group_by(TA111057, FTL_COUNT) %>% summarise(Count = n())

T11_RAC_FTLW <- T11_RAC_FTLW[1:20, ]

T11_RAC_CAT <- TIAS2011[, c("TA111057", "CAT_11")] %>% group_by(TA111057, CAT_11) %>% summarise(Count = n())

T11_RAC_CAT <- T11_RAC_CAT[1:11, ]

T11_RAC_FTLCAT <- TIAS2011_FTL[, c("TA111057", "CAT_11")] %>% group_by(TA111057, CAT_11) %>% summarise(Count = n())

T11_RAC_IACCAT <- TIAS2011_IAC[, c("TA111057", "CAT_11")] %>% group_by(TA111057, CAT_11) %>% summarise(Count = n())

T11_RAC_IACCAT <- T11_RAC_IACCAT[1:6, ]

head(T11_RAC_CAT, 11)

ggplot(T11_RAC_CAT, aes(x = CAT_11, y = Count, fill = as.factor(TA111057))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2011", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

head(T11_RAC_FTLW, 20)

ggplot(T11_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA111057)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  labs(title = "TIAS 2011", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

prop.table(table(TIAS2011_FTL$TA111057))

rac.pie.ftl.11 <- ggplot(data = T11_RAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA111057))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Other"))

prop.table(table(TIAS2011_IAC$TA111057))

rac.pie.iac.11 <- ggplot(data = T11_RAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA111057))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

ggarrange(rac.pie.ftl.11, rac.pie.iac.11, ncol = 2, nrow = 1, labels = c("FTL 2011", "IAC 2011"))

### Daily Cigarette Usage ======================================================================================================== 

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK); 999 (NA/refused) 
####

table(TIAS$TA110905)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110905 = 998))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110905 = 998))

TIAS2011_FTL <- TIAS2011_FTL %>% 
  replace_with_na(replace = list(TA110905 = 998))

TIAS2011_IAC <- TIAS2011_IAC %>% 
  replace_with_na(replace = list(TA110905 = 998))

T11_CIG_FTLW <- TIAS2011[, c("TA110905", "FTL_COUNT")] %>% group_by(TA110905, FTL_COUNT) %>% summarise(Count = n())

T11_CIG_FTLW <- T11_CIG_FTLW[1:45, ]

T11_CIG_CAT <- TIAS2011[, c("TA110905", "CAT_11")] %>% group_by(TA110905, CAT_11) %>% summarise(Count = n())

T11_CIG_CAT <- T11_CIG_CAT[1:31, ]

T11_CIG_FTLCAT <- TIAS2011_FTL[, c("TA110905", "CAT_11")] %>% group_by(TA110905, CAT_11) %>% summarise(Count = n())

T11_CIG_IACCAT <- TIAS2011_IAC[, c("TA110905", "CAT_11")] %>% group_by(TA110905, CAT_11) %>% summarise(Count = n())

T11_CIG_IACCAT <- T11_CIG_IACCAT[1:22, ]

ggplot(T11_CIG_FTLW, aes(x = FTL_COUNT, y = TA110905, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_CIG_CAT, aes(x = CAT_11, y = TA110905, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category"))

### Body Mass Index (BMI) ======================================================================================================== 

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA111131)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA111131 = 99))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA111131 = 99))

T11_BMI_FTLW <- TIAS2011[, c("TA111131", "FTL_COUNT")] %>% group_by(TA111131, FTL_COUNT) %>% summarise(Count = n())

T11_BMI_FTLW <- T11_BMI_FTLW[1:375, ]

T11_BMI_CAT <- TIAS2011[, c("TA111131", "CAT_11")] %>% group_by(TA111131, CAT_11) %>% summarise(Count = n())

T11_BMI_CAT <- T11_BMI_CAT[1:308, ]

ggplot(T11_BMI_FTLW, aes(x = FTL_COUNT, y = TA111131, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_BMI_CAT, aes(x = CAT_11, y = TA111131, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA110900)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110900 = 98))

TIAS2011 <- TIAS2011 %>% 
  replace_with_na(replace = list(TA110900 = 98))

T11_SLP_FTLW <- TIAS2011[, c("TA110900", "FTL_COUNT")] %>% group_by(TA110900, FTL_COUNT) %>% summarise(Count = n())

T11_SLP_FTLW <- T11_SLP_FTLW[1:43, ]

T11_SLP_CAT <- TIAS2011[, c("TA110900", "CAT_11")] %>% group_by(TA110900, CAT_11) %>% summarise(Count = n())

T11_SLP_CAT <- T11_SLP_CAT[1:25, ]

ggplot(T11_SLP_FTLW, aes(x = FTL_COUNT, y = TA110900, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2011", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T11_SLP_CAT, aes(x = CAT_11, y = TA110900, group = CAT_11, fill = as.factor(CAT_11))) +
  geom_boxplot() +
  labs(title = "TIAS 2011", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2013 ######################## 

### Amphetamine Usage =========================================================================================================== 

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130963)

T13_AMP_FTLW <- TIAS2013[, c("TA130963", "FTL_COUNT")] %>% group_by(TA130963, FTL_COUNT) %>% summarise(Count = n())

T13_AMP_CAT <- TIAS2013[, c("TA130963", "CAT_13")] %>% group_by(TA130963, CAT_13) %>% summarise(Count = n())

head(T13_AMP_CAT, 6)

ggplot(T13_AMP_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130963)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))

head(T13_AMP_FTLW, 11)

ggplot(T13_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130963)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130984)

T13_BRB_FTLW <- TIAS2013[, c("TA130984", "FTL_COUNT")] %>% group_by(TA130984, FTL_COUNT) %>% summarise(Count = n())

T13_BRB_CAT <- TIAS2013[, c("TA130984", "CAT_13")] %>% group_by(TA130984, CAT_13) %>% summarise(Count = n())

head(T13_BRB_CAT, 5)

ggplot(T13_BRB_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130984)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_BRB_FTLW, 9)

ggplot(T13_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130984)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130971)

T13_MAR_FTLW <- TIAS2013[, c("TA130971", "FTL_COUNT")] %>% group_by(TA130971, FTL_COUNT) %>% summarise(Count = n())

T13_MAR_CAT <- TIAS2013[, c("TA130971", "CAT_13")] %>% group_by(TA130971, CAT_13) %>% summarise(Count = n())

head(T13_MAR_CAT, 8)

ggplot(T13_MAR_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130971)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "mediumorchid", "blue"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_MAR_FTLW, 12)

ggplot(T13_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130971)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "mediumorchid", "blue"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130955)

T13_DIP_FTLW <- TIAS2013[, c("TA130955", "FTL_COUNT")] %>% group_by(TA130955, FTL_COUNT) %>% summarise(Count = n())

T13_DIP_CAT <- TIAS2013[, c("TA130955", "CAT_13")] %>% group_by(TA130955, CAT_13) %>% summarise(Count = n())

head(T13_DIP_CAT, 5)

ggplot(T13_DIP_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130955)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_DIP_FTLW, 9)

ggplot(T13_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130955)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA131000)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131000 = 9))

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131000 = 9))

T13_STR_FTLW <- TIAS2013[, c("TA131000", "FTL_COUNT")] %>% group_by(TA131000, FTL_COUNT) %>% summarise(Count = n())

T13_STR_FTLW <- T13_STR_FTLW[1:9, ]

T13_STR_CAT <- TIAS2013[, c("TA131000", "CAT_13")] %>% group_by(TA131000, CAT_13) %>% summarise(Count = n())

T13_STR_CAT <- T13_STR_CAT[1:5, ]

head(T13_STR_CAT, 6)

ggplot(T13_STR_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA131000)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_STR_FTLW, 10)

ggplot(T13_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131000)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) +
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") 

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130992)

T13_TRQ_FTLW <- TIAS2013[, c("TA130992", "FTL_COUNT")] %>% group_by(TA130992, FTL_COUNT) %>% summarise(Count = n())

T13_TRQ_CAT <- TIAS2013[, c("TA130992", "CAT_13")] %>% group_by(TA130992, CAT_13) %>% summarise(Count = n())

head(T13_TRQ_CAT, 7)

ggplot(T13_TRQ_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130992)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_TRQ_FTLW, 11)

ggplot(T13_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130992)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA130976)

T13_CCN_FTLW <- TIAS2013[, c("TA130976", "FTL_COUNT")] %>% group_by(TA130976, FTL_COUNT) %>% summarise(Count = n())

T13_CCN_CAT <- TIAS2013[, c("TA130976", "CAT_13")] %>% group_by(TA130976, CAT_13) %>% summarise(Count = n())

T13_CCN_FTLCAT <- TIAS2013_FTL[, c("TA130976", "CAT_13")] %>% group_by(TA130976, CAT_13) %>% summarise(Count = n())

T13_CCN_IACCAT <- TIAS2013_IAC[, c("TA130976", "CAT_13")] %>% group_by(TA130976, CAT_13) %>% summarise(Count = n())

head(T13_CCN_CAT, 8)

ggplot(T13_CCN_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130976))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T13_CCN_FTLW, 12)

ggplot(T13_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130976)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2013_FTL$TA130976))

ccn.pie.ftl.13 <- ggplot(data = T13_CCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130976))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold"), labels = c("Never", "1-2 times")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130976))

ccn.pie.iac.13 <- ggplot(data = T13_CCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130976))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) + 
  theme_void() 

ggarrange(ccn.pie.ftl.13, ccn.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))      

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA130946)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130946 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130946 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130946 = 9))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130946 = 9)) 

T13_AAC_FTLW <- TIAS2013[, c("TA130946", "FTL_COUNT")] %>% group_by(TA130946, FTL_COUNT) %>% summarise(Count = n())

T13_AAC_FTLW <- T13_AAC_FTLW[1:24, ]

T13_AAC_CAT <- TIAS2013[, c("TA130946", "CAT_13")] %>% group_by(TA130946, CAT_13) %>% summarise(Count = n())

T13_AAC_CAT <- T13_AAC_CAT[1:13, ]

T13_AAC_FTLCAT <- TIAS2013_FTL[, c("TA130946", "CAT_13")] %>% group_by(TA130946, CAT_13) %>% summarise(Count = n())

T13_AAC_IACCAT <- TIAS2013_IAC[, c("TA130946", "CAT_13")] %>% group_by(TA130946, CAT_13) %>% summarise(Count = n())

T13_AAC_IACCAT <- T13_AAC_IACCAT[1:7, ]

head(T13_AAC_CAT, 13)

ggplot(T13_AAC_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130946))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink", "rosybrown1"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T13_AAC_FTLW, 24)

ggplot(T13_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130946)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2013_FTL$TA130946))

aac.pie.ftl.13 <- ggplot(data = T13_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130946))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130946))

aac.pie.iac.13 <- ggplot(data = T13_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130946))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.13, aac.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))        

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA130947)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130947 = c(98, 99)))  

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130947 = c(98, 99)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130947 = c(98, 99)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130947 = c(98, 99)))  

T13_DAC_FTLW <- TIAS2013[, c("TA130947", "FTL_COUNT")] %>% group_by(TA130947, FTL_COUNT) %>% summarise(Count = n())

T13_DAC_FTLW <- T13_DAC_FTLW[1:41, ]

T13_DAC_CAT <- TIAS2013[, c("TA130947", "CAT_13")] %>% group_by(TA130947, CAT_13) %>% summarise(Count = n())

T13_DAC_CAT <- T13_DAC_CAT[1:29, ]

T13_DAC_FTLCAT <- TIAS2013_FTL[, c("TA130947", "CAT_13")] %>% group_by(TA130947, CAT_13) %>% summarise(Count = n())

T13_DAC_IACCAT <- TIAS2013_IAC[, c("TA130947", "CAT_13")] %>% group_by(TA130947, CAT_13) %>% summarise(Count = n())

T13_DAC_IACCAT <- T13_DAC_IACCAT[1:19, ]

head(T13_DAC_CAT, 29)

ggplot(T13_DAC_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130947))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
                                                                  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "salmon", "plum", "thistle", "slateblue1"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks",                                                                                                                                                                                                                            "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "16 drinks", "19 drinks", "20 drinks", "25 drinks", "29 drinks"))
head(T13_DAC_FTLW, 4)

ggplot(T13_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130947)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "salmon", "plum", "thistle", "slateblue1"), labels = c("Never", "1 or fewer drinks", "2 drinks", 
  "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "16 drinks", "19 drinks", "20 drinks", "25 drinks", "29 drinks"))
                                                                                                                                                                                                                           
prop.table(table(TIAS2013_FTL$TA130947))

dac.pie.ftl.13 <- ggplot(data = T13_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130947))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values  = c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3"), 
  labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", "12 drinks")) + 
  theme_void()
                                                                                                                                                                                
prop.table(table(TIAS2013_IAC$TA130947))

dac.pie.iac.13 <- ggplot(data = T13_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130947))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Daily Alcohol Consumption", values  = c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "slateblue1"), labels = c("Never", "1 or fewer drinks", "2 drinks", "3 drinks", "4 drinks", 
  "5 drinks", "6 drinks", "7 drinks", "8 drinks", "9 drinks", "10 drinks", "12 drinks", "13 drinks", "15 drinks", "16 drinks", "19 drinks", "20 drinks", "25 drinks", "29 drinks")) + 
  theme_void()

ggarrange(dac.pie.ftl.13, dac.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))          

### Degree to Which Condition Limits Normal Daily Activities ==================================================================== 

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA130866)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130866 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130866 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130866 = 9)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130866 = 9)) 

T13_DCN_FTLW <- TIAS2013[, c("TA130866", "FTL_COUNT")] %>% group_by(TA130866, FTL_COUNT) %>% summarise(Count = n())

T13_DCN_FTLW <- T13_DCN_FTLW[1:15, ]

T13_DCN_CAT <- TIAS2013[, c("TA130866", "CAT_13")] %>% group_by(TA130866, CAT_13) %>% summarise(Count = n())

T13_DCN_CAT <- T13_DCN_CAT[1:8, ]

T13_DCN_FTLCAT <- TIAS2013_FTL[, c("TA130866", "CAT_13")] %>% group_by(TA130866, CAT_13) %>% summarise(Count = n())

T13_DCN_IACCAT <- TIAS2013_IAC[, c("TA130866", "CAT_13")] %>% group_by(TA130866, CAT_13) %>% summarise(Count = n())

T13_DCN_IACCAT <- T13_DCN_IACCAT[1:5, ]

head(T13_DCN_CAT, 8)

ggplot(T13_DCN_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130866)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T13_DCN_FTLW, 15)

ggplot(T13_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130866)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

prop.table(table(TIAS2013_FTL$TA130866))

dcn.pie.ftl.13 <- ggplot(data = T13_DCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130866))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "Just a little", "Not at all")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130866))

dcn.pie.iac.13 <- ggplot(data = T13_DCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130866))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all")) +
  theme_void() 

ggarrange(dcn.pie.ftl.13, dcn.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130877)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130877 = 8)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130877 = 8)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130877 = 8)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130877 = 8)) 

T13_DEP_FTLW <- TIAS2013[, c("TA130877", "FTL_COUNT")] %>% group_by(TA130877, FTL_COUNT) %>% summarise(Count = n())

T13_DEP_FTLW <- T13_DEP_FTLW[1:10, ]

T13_DEP_CAT <- TIAS2013[, c("TA130877", "CAT_13")] %>% group_by(TA130877, CAT_13) %>% summarise(Count = n())

T13_DEP_CAT <- T13_DEP_CAT[1:4, ]

T13_DEP_FTLCAT <- TIAS2013_FTL[, c("TA130877", "CAT_13")] %>% group_by(TA130877, CAT_13) %>% summarise(Count = n())

T13_DEP_IACCAT <- TIAS2013_IAC[, c("TA130877", "CAT_13")] %>% group_by(TA130877, CAT_13) %>% summarise(Count = n())

T13_DEP_IACCAT <- T13_DEP_IACCAT[1:2, ]

head(T13_DEP_CAT, 4)

ggplot(T13_DEP_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130877)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No"))

head(T13_DEP_FTLW, 10)

ggplot(T13_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130877)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130877))

dep.pie.ftl.13 <- ggplot(data = T13_DEP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130877))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130877))

dep.pie.iac.13 <- ggplot(data = T13_DEP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130877))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(dep.pie.ftl.13, dep.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)

table(TIAS$TA130878)

T13_ANH_FTLW <- TIAS2013[, c("TA130878", "FTL_COUNT")] %>% group_by(TA130878, FTL_COUNT) %>% summarise(Count = n())

T13_ANH_CAT <- TIAS2013[, c("TA130878", "CAT_13")] %>% group_by(TA130878, CAT_13) %>% summarise(Count = n())

T13_ANH_FTLCAT <- TIAS2013_FTL[, c("TA130878", "CAT_13")] %>% group_by(TA130878, CAT_13) %>% summarise(Count = n())

T13_ANH_IACCAT <- TIAS2013_IAC[, c("TA130878", "CAT_13")] %>% group_by(TA130878, CAT_13) %>% summarise(Count = n())

ggplot(T13_ANH_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130878)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "yellow"), labels = c("Inap.", "Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130878))

anh.pie.ftl.13 <- ggplot(data = T13_ANH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130878))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "yellow"), labels = c("Inap.", "Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130878))

anh.pie.iac.13 <- ggplot(data = T13_ANH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130878))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "yellow"), labels = c("Inap.", "Yes", "No")) + 
  theme_void() 

ggarrange(anh.pie.ftl.13, anh.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA130850)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130850 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130850 = 9)) 

T13_DPD_FTLW <- TIAS2013[, c("TA130850", "FTL_COUNT")] %>% group_by(TA130850, FTL_COUNT) %>% summarise(Count = n())

T13_DPD_FTLW <- T13_DPD_FTLW[1:8, ]

T13_DPD_CAT <- TIAS2013[, c("TA130850", "CAT_13")] %>% group_by(TA130850, CAT_13) %>% summarise(Count = n())

T13_DPD_CAT <- T13_DPD_CAT[1:3, ]

head(T13_DPD_CAT, 3)

ggplot(T13_DPD_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130850)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T13_DPD_FTLW, 8)

ggplot(T13_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130850)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA130851)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130851 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130851 = 9)) 

T13_BIP_FTLW <- TIAS2013[, c("TA130851", "FTL_COUNT")] %>% group_by(TA130851, FTL_COUNT) %>% summarise(Count = n())

T13_BIP_FTLW <- T13_BIP_FTLW[1:8, ]

T13_BIP_CAT <- TIAS2013[, c("TA130851", "CAT_13")] %>% group_by(TA130851, CAT_13) %>% summarise(Count = n())

T13_BIP_CAT <- T13_BIP_CAT[1:3, ]

head(T13_BIP_CAT, 3)

ggplot(T13_BIP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130851)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T13_BIP_FTLW, 8)

ggplot(T13_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130851)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Phobia Diagnosis =============================================================================================================

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA130854)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130854 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130854 = 9)) 

T13_PHB_FTLW <- TIAS2013[, c("TA130854", "FTL_COUNT")] %>% group_by(TA130854, FTL_COUNT) %>% summarise(Count = n())

T13_PHB_FTLW <- T13_PHB_FTLW[1:6, ]

T13_PHB_CAT <- TIAS2013[, c("TA130854", "CAT_13")] %>% group_by(TA130854, CAT_13) %>% summarise(Count = n())

T13_PHB_CAT <- T13_PHB_CAT[1:2, ]

head(T13_PHB_CAT, 2)

ggplot(T13_PHB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130854)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T13_PHB_FTLW, 6)

ggplot(T13_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130854)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Anxiety Disorders Diagnosis ==================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA130853)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130853 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130853 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130853 = 9))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130853 = 9)) 

T13_ANX_FTLW <- TIAS2013[, c("TA130853", "FTL_COUNT")] %>% group_by(TA130853, FTL_COUNT) %>% summarise(Count = n())

T13_ANX_FTLW <- T13_ANX_FTLW[1:9, ]

T13_ANX_CAT <- TIAS2013[, c("TA130853", "CAT_13")] %>% group_by(TA130853, CAT_13) %>% summarise(Count = n())

T13_ANX_CAT <- T13_ANX_CAT[1:4, ]

T13_ANX_FTLCAT <- TIAS2013_FTL[, c("TA130853", "CAT_13")] %>% group_by(TA130853, CAT_13) %>% summarise(Count = n())

T13_ANX_IACCAT <- TIAS2013_IAC[, c("TA130853", "CAT_13")] %>% group_by(TA130853, CAT_13) %>% summarise(Count = n())

T13_ANX_IACCAT <- T13_ANX_IACCAT[1:2, ]

head(T13_ANX_CAT, 4)

ggplot(T13_ANX_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130853)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T13_ANX_FTLW, 9)

ggplot(T13_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130853)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2013_FTL$TA130853))

anx.pie.ftl.13 <- ggplot(data = T13_ANX_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130853))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed")) + 
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130853))

anx.pie.iac.13 <- ggplot(data = T13_ANX_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130853))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed")) + 
  theme_void() 

ggarrange(anx.pie.ftl.13, anx.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### OCD Diagnosis ================================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA130857)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130857 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130857 = 9)) 

T13_OCD_FTLW <- TIAS2013[, c("TA130857", "FTL_COUNT")] %>% group_by(TA130857, FTL_COUNT) %>% summarise(Count = n())

T13_OCD_FTLW <- T13_OCD_FTLW[1:7, ]

T13_OCD_CAT <- TIAS2013[, c("TA130857", "CAT_13")] %>% group_by(TA130857, CAT_13) %>% summarise(Count = n())

T13_OCD_CAT <- T13_OCD_CAT[1:3, ]

head(T13_OCD_CAT, 3)

ggplot(T13_OCD_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130857)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T13_OCD_FTLW, 7)

ggplot(T13_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130857)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA131217)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131217 = 99)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131217 = 99)) 

T13_NPD_FTLW <- TIAS2013[, c("TA131217", "FTL_COUNT")] %>% group_by(TA131217, FTL_COUNT) %>% summarise(Count = n())

T13_NPD_FTLW <- T13_NPD_FTLW[1:62, ]

T13_NPD_CAT <- TIAS2013[, c("TA131217", "CAT_13")] %>% group_by(TA131217, CAT_13) %>% summarise(Count = n())

T13_NPD_CAT <- T13_NPD_CAT[1:36, ]

ggplot(T13_NPD_FTLW, aes(x = FTL_COUNT, y = TA131217, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_NPD_CAT, aes(x = CAT_13, y = TA131217, group = CAT_13, fill = as.factor(CAT_13))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA131212)

T13_SOA_FTLW <- TIAS2013[, c("TA131212", "FTL_COUNT")] %>% group_by(TA131212, FTL_COUNT) %>% summarise(Count = n())

T13_SOA_CAT <- TIAS2013[, c("TA131212", "CAT_13")] %>% group_by(TA131212, CAT_13) %>% summarise(Count = n())

ggplot(T13_SOA_FTLW, aes(x = FTL_COUNT, y = TA131212, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SOA_CAT, aes(x = CAT_13, y = TA131212, group = CAT_13, fill = as.factor(CAT_13))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Mental Health: Worry =========================================================================================================

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA131211)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131211 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131211 = 9)) 

T13_WRY_FTLW <- TIAS2013[, c("TA131211", "FTL_COUNT")] %>% group_by(TA131211, FTL_COUNT) %>% summarise(Count = n())

T13_WRY_FTLW <- T13_WRY_FTLW[1:31, ]

T13_WRY_CAT <- TIAS2013[, c("TA131211", "CAT_13")] %>% group_by(TA131211, CAT_13) %>% summarise(Count = n())

T13_WRY_CAT <- T13_WRY_CAT[1:14, ]

ggplot(T13_WRY_FTLW, aes(x = FTL_COUNT, y = TA131211, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_WRY_CAT, aes(x = CAT_13, y = TA131211, group = CAT_13, fill = as.factor(CAT_13))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### Paid Employment Since Jan 1 of Prior Year ====================================================================================

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA130140)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130140 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130140 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130140 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130140 = c(8, 9))) 

T13_EPJ_FTLW <- TIAS2013[, c("TA130140", "FTL_COUNT")] %>% group_by(TA130140, FTL_COUNT) %>% summarise(Count = n())

T13_EPJ_FTLW <- T13_EPJ_FTLW[1:16, ]

T13_EPJ_CAT <- TIAS2013[, c("TA130140", "CAT_13")] %>% group_by(TA130140, CAT_13) %>% summarise(Count = n())

T13_EPJ_CAT=T13_EPJ_CAT[1:6, ]

T13_EPJ_FTLCAT <- TIAS2013_FTL[, c("TA130140", "CAT_13")] %>% group_by(TA130140, CAT_13) %>% summarise(Count = n())

T13_EPJ_FTLCAT=T13_EPJ_FTLCAT[1:3, ]

T13_EPJ_IACCAT <- TIAS2013_IAC[, c("TA130140", "CAT_13")] %>% group_by(TA130140, CAT_13) %>% summarise(Count = n())

T13_EPJ_IACCAT=T13_EPJ_IACCAT[1:3, ]

head(T13_EPJ_CAT, 6)

ggplot(T13_EPJ_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1", "seagreen"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T13_EPJ_FTLW, 16)

ggplot(T13_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1", "seagreen"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2013_FTL$TA130140))

epj.pie.ftl.13 <- ggplot(data = T13_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130140))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "rosybrown1", "turquoise1", "sienna1"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130140))

epj.pie.iac.13 <- ggplot(data = T13_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130140))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "rosybrown1", "turquoise1", "sienna1"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.13, epj.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA130347)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130347 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130347 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130347 = 9))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130347 = 9)) 

T13_EPH_FTLW <- TIAS2013[, c("TA130347", "FTL_COUNT")] %>% group_by(TA130347, FTL_COUNT) %>% summarise(Count = n())

T13_EPH_FTLW <- T13_EPH_FTLW[1:13, ]

T13_EPH_CAT <- TIAS2013[, c("TA130347", "CAT_13")] %>% group_by(TA130347, CAT_13) %>% summarise(Count = n())

T13_EPH_CAT <- T13_EPH_CAT[1:6, ]

T13_EPH_FTLCAT <- TIAS2013_FTL[, c("TA130347", "CAT_13")] %>% group_by(TA130347, CAT_13) %>% summarise(Count = n())

T13_EPH_IACCAT <- TIAS2013_IAC[, c("TA130347", "CAT_13")] %>% group_by(TA130347, CAT_13) %>% summarise(Count = n())

T13_EPH_IACCAT <- T13_EPH_IACCAT[1:3, ]

head(T13_EPH_CAT, 6)

ggplot(T13_EPH_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130347)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

head(T13_EPH_FTLW, 15)

ggplot(T13_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130347)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2013_FTL$TA130347))

eph.pie.ftl.13 <- ggplot(data = T13_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130347))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130347))

eph.pie.iac.13 <- ggplot(data = T13_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130347))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.13, eph.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Current Marital Status =======================================================================================================

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130078)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130078 = 9))  

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130078 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130078 = 9))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130078 = 9))  

T13_CMS_FTLW <- TIAS2013[, c("TA130078", "FTL_COUNT")] %>% group_by(TA130078, FTL_COUNT) %>% summarise(Count = n())

T13_CMS_FTLW <- T13_CMS_FTLW[1:13, ]

T13_CMS_CAT <- TIAS2013[, c("TA130078", "CAT_13")] %>% group_by(TA130078, CAT_13) %>% summarise(Count = n())

T13_CMS_CAT <- T13_CMS_CAT[1:7, ]

T13_CMS_FTLCAT <- TIAS2013_FTL[, c("TA130078", "CAT_13")] %>% group_by(TA130078, CAT_13) %>% summarise(Count = n())

T13_CMS_IACCAT <- TIAS2013_IAC[, c("TA130078", "CAT_13")] %>% group_by(TA130078, CAT_13) %>% summarise(Count = n())

T13_CMS_IACCAT <- T13_CMS_IACCAT[1:4, ]

head(T13_CMS_CAT, 7)

ggplot(T13_CMS_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Divorced", "Separated"))

head(T13_CMS_FTLW, 13)

ggplot(T13_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Divorced", "Separated"))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA130087)

T13_RRN_FTLW <- TIAS2013[, c("TA130087", "FTL_COUNT")] %>% group_by(TA130087, FTL_COUNT) %>% summarise(Count = n())

T13_RRN_CAT <- TIAS2013[, c("TA130087", "CAT_13")] %>% group_by(TA130087, CAT_13) %>% summarise(Count = n())

T13_RRN_FTLCAT <- TIAS2013_FTL[, c("TA130087", "CAT_13")] %>% group_by(TA130087, CAT_13) %>% summarise(Count = n())

T13_RRN_IACCAT <- TIAS2013_IAC[, c("TA130087", "CAT_13")] %>% group_by(TA130087, CAT_13) %>% summarise(Count = n())

head(T13_RRN_CAT, 6)

ggplot(T13_RRN_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130087)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Inap: Married", "Yes", "No"))

head(T13_RRN_FTLW, 15)

ggplot(T13_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130087)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130087))

rrn.pie.ftl.13 <- ggplot(data = T13_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130087))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130087))

rrn.pie.iac.13 <- ggplot(data = T13_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130087))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.13, rrn.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Number of Children ===========================================================================================================

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA130100)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130100 = 99)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130100 = 99)) 

T13_CHL_FTLW <- TIAS2013[, c("TA130100", "FTL_COUNT")] %>% group_by(TA130100, FTL_COUNT) %>% summarise(Count = n())

T13_CHL_FTLW <- T13_CHL_FTLW[1:21, ]

T13_CHL_CAT <- TIAS2013[, c("TA130100", "CAT_13")] %>% group_by(TA130100, CAT_13) %>% summarise(Count = n())

T13_CHL_CAT <- T13_CHL_CAT[1:8, ]

ggplot(T13_CHL_FTLW, aes(x = FTL_COUNT, y = TA130100, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_CHL_CAT, aes(x = CAT_13, y = TA130100, group = CAT_13, fill = as.factor(CAT_13))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 0 (Reported last wave); 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130691)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130691 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130691 = c(8, 9)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130691 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130691 = c(8, 9)))  

T13_HSG_FTLW <- TIAS2013[, c("TA130691", "FTL_COUNT")] %>% group_by(TA130691, FTL_COUNT) %>% summarise(Count = n())

T13_HSG_FTLW <- T13_HSG_FTLW[1:18, ]

T13_HSG_CAT <- TIAS2013[, c("TA130691", "CAT_13")] %>% group_by(TA130691, CAT_13) %>% summarise(Count = n())

T13_HSG_CAT <- T13_HSG_CAT[1:8, ]

T13_HSG_FTLCAT <- TIAS2013_FTL[, c("TA130691", "CAT_13")] %>% group_by(TA130691, CAT_13) %>% summarise(Count = n())

T13_HSG_IACCAT <- TIAS2013_IAC[, c("TA130691", "CAT_13")] %>% group_by(TA130691, CAT_13) %>% summarise(Count = n())

T13_HSG_IACCAT <- T13_HSG_IACCAT[1:4, ]

head(T13_HSG_CAT, 8)

ggplot(T13_HSG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130691)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither"))

head(T13_HSG_FTLW, 18)

ggplot(T13_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130691)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither"))

prop.table(table(TIAS2013_FTL$TA130691))

hsg.pie.ftl.13 <- ggplot(data = T13_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130691))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither")) + 
  theme_void()

prop.table(table(TIAS2013_IAC$TA130691))

hsg.pie.iac.13 <- ggplot(data = T13_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130691))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither")) + 
  theme_void()

ggarrange(hsg.pie.ftl.13, hsg.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### College Education ============================================================================================================ 

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA130718)

T13_CLG_FTLW <- TIAS2013[, c("TA130718", "FTL_COUNT")] %>% group_by(TA130718, FTL_COUNT) %>% summarise(Count = n())

T13_CLG_CAT <- TIAS2013[, c("TA130718", "CAT_13")] %>% group_by(TA130718, CAT_13) %>% summarise(Count = n())

T13_CLG_FTLCAT <- TIAS2013_FTL[, c("TA130718", "CAT_13")] %>% group_by(TA130718, CAT_13) %>% summarise(Count = n())

T13_CLG_IACCAT <- TIAS2013_IAC[, c("TA130718", "CAT_13")] %>% group_by(TA130718, CAT_13) %>% summarise(Count = n())

head(T13_CLG_CAT, 6)

ggplot(T13_CLG_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130718)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") +
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1"), labels = c("Reported last wave", "Attended College", "Graduated HS", "No HS Diploma or GED"))

head(T13_CLG_FTLW, 13)

ggplot(T13_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130718)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1"), labels = c("Reported last wave", "Attended College", "Graduated HS", "No HS Diploma or GED"))

prop.table(table(TIAS2013_FTL$TA130718))

clg.pie.ftl.13 <- ggplot(data = T13_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130718))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1"), labels = c("Reported last wave", "Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA130718))

clg.pie.iac.13 <- ggplot(data = T13_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130718))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Higher Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "rosybrown1"), labels = c("Reported last wave", "Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

ggarrange(clg.pie.ftl.13, clg.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 96 (Skipped, asked in 2011); 99 (NA/DK)
####

table(TIAS$TA131225)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131225 =  c(96, 99))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131225 =  c(96, 99)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131225 =  c(96, 99))) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131225 =  c(96, 99)))  

T13_HEL_FTLW <- TIAS2013[, c("TA131225", "FTL_COUNT")] %>% group_by(TA131225, FTL_COUNT) %>% summarise(Count = n())

T13_HEL_FTLW <- T13_HEL_FTLW[1:30, ]

T13_HEL_CAT <- TIAS2013[, c("TA131225", "CAT_13")] %>% group_by(TA131225, CAT_13) %>% summarise(Count = n())

T13_HEL_CAT <- T13_HEL_CAT[1:16, ]

T13_HEL_FTLCAT <- TIAS2013_FTL[, c("TA131225", "CAT_13")] %>% group_by(TA131225, CAT_13) %>% summarise(Count = n())

T13_HEL_FTLCAT <- T13_HEL_FTLCAT[1:6, ]

T13_HEL_IACCAT <- TIAS2013_IAC[, c("TA131225", "CAT_13")] %>% group_by(TA131225, CAT_13) %>% summarise(Count = n())

T13_HEL_IACCAT <- T13_HEL_IACCAT[1:10, ]

head(T13_HEL_CAT, 16)

ggplot(T13_HEL_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131225))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

head(T13_HEL_FTLW, 30)

ggplot(T13_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131225)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

prop.table(table(TIAS2013_FTL$TA131225))

hel.pie.ftl.13 <- ggplot(data = T13_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131225))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

prop.table(table(TIAS2013_IAC$TA131225))

hel.pie.iac.13 <- ggplot(data = T13_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131225))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program"))

ggarrange(hel.pie.ftl.13, hel.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

# [[RESUME HERE]]

### Responsibility - Earning Own Living ==========================================================================================

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130045)

T13_REO_FTLW <- TIAS2013[, c("TA130045", "FTL_COUNT")] %>% group_by(TA130045, FTL_COUNT) %>% summarise(Count = n())

T13_REO_CAT <- TIAS2013[, c("TA130045", "CAT_13")] %>% group_by(TA130045, CAT_13) %>% summarise(Count = n())

T13_REO_FTLCAT <- TIAS2013_FTL[, c("TA130045", "CAT_13")] %>% group_by(TA130045, CAT_13) %>% summarise(Count = n())

T13_REO_IACCAT <- TIAS2013_IAC[, c("TA130045", "CAT_13")] %>% group_by(TA130045, CAT_13) %>% summarise(Count = n())

head(T13_REO_CAT, 10)

ggplot(T13_REO_CAT, aes(x = CAT_13, y = Count, fill = as.factor(TA130045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T13_REO_FTLW, 23)

ggplot(T13_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2013_FTL$TA130045))

reo.pie.ftl.13 <- ggplot(data = T13_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2013_IAC$TA130045))

reo.pie.iac.13 <- ggplot(data = T13_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(reo.pie.ftl.13, reo.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Responsibility - Paying Own Rent =============================================================================================

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130046)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130046 = c(8, 9)))  

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130046 = c(8, 9)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130046 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130046 = c(8, 9)))  

T13_POR_FTLW <- TIAS[, c("TA130046", "FTL_COUNT")] %>% group_by(TA130046, FTL_COUNT) %>% summarise(Count = n())

T13_POR_FTLW <- T13_POR_FTLW[1:27, ]

T13_POR_CAT <- TIAS2013[, c("TA130046", "CAT")] %>% group_by(TA130046, CAT) %>% summarise(Count = n())

T13_POR_CAT <- T13_POR_CAT[1:12, ]

T13_POR_FTLCAT <- TIAS2013_FTL[, c("TA130046", "CAT")] %>% group_by(TA130046, CAT) %>% summarise(Count = n())

T13_POR_FTLCAT=T13_POR_FTLCAT[1:6, ]

T13_POR_IACCAT <- TIAS2013_IAC[, c("TA130046", "CAT")] %>% group_by(TA130046, CAT) %>% summarise(Count = n())

T13_POR_IACCAT <- T13_POR_IACCAT[1:6, ]

head(T13_POR_CAT, 12)

ggplot(T13_POR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T13_POR_FTLW, 28)

ggplot(T13_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2013_FTL$TA130046))

por.pie.ftl.13 <- ggplot(data = T13_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

prop.table(table(TIAS2013_IAC$TA130046))

por.pie.iac.13 <- ggplot(data = T13_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.13, por.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Responsibility - Paying Own Bills ============================================================================================

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130047)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130047 = c(8, 9)))  

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130047 = c(8, 9)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130047 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130047 = c(8, 9))) 

T13_POB_FTLW <- TIAS[, c("TA130047", "FTL_COUNT")] %>% group_by(TA130047, FTL_COUNT) %>% summarise(Count = n())

T13_POB_FTLW <- T13_POB_FTLW[1:28, ]

T13_POB_CAT <- TIAS2013[, c("TA130047", "CAT")] %>% group_by(TA130047, CAT) %>% summarise(Count = n())

T13_POB_CAT=T13_POB_CAT[1:12, ]

T13_POB_FTLCAT <- TIAS2013_FTL[, c("TA130047", "CAT")] %>% group_by(TA130047, CAT) %>% summarise(Count = n())

T13_POB_FTLCAT=T13_POB_FTLCAT[1:6, ]

T13_POB_IACCAT <- TIAS2013_IAC[, c("TA130047", "CAT")] %>% group_by(TA130047, CAT) %>% summarise(Count = n())

T13_POB_IACCAT=T13_POB_IACCAT[1:6, ]

head(T13_POB_CAT, 12)

ggplot(T13_POB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

head(T13_POB_FTLW, 28)

ggplot(T13_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2013_FTL$TA130047))

pob.pie.ftl.13 <- ggplot(data = T13_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))


prop.table(table(TIAS2013_IAC$TA130047))

pob.pie.iac.13 <- ggplot(data = T13_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.13, pob.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130048)

T13_RMM_FTLW <- TIAS[, c("TA130048", "FTL_COUNT")] %>% group_by(TA130048, FTL_COUNT) %>% summarise(Count = n())

T13_RMM_CAT <- TIAS2013[, c("TA130048", "CAT")] %>% group_by(TA130048, CAT) %>% summarise(Count = n())

T13_RMM_FTLCAT <- TIAS2013_FTL[, c("TA130048", "CAT")] %>% group_by(TA130048, CAT) %>% summarise(Count = n())

T13_RMM_IACCAT <- TIAS2013_IAC[, c("TA130048", "CAT")] %>% group_by(TA130048, CAT) %>% summarise(Count = n())

head(T13_RMM_CAT, 10)

ggplot(T13_RMM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T13_RMM_FTLW, 23)

ggplot(T13_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2013_FTL$TA130048))

rmm.pie.ftl.13 <- ggplot(data = T13_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130048))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2013_IAC$TA130048))

rmm.pie.iac.13 <- ggplot(data = T13_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130048))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"),
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) + 
  theme_void()

ggarrange(rmm.pie.ftl.13, rmm.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### How Good at Taking Responsibility for Actions ================================================================================

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130049)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130049 = c(8, 9)))  

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130049 = c(8, 9)))  

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130049 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130049 = c(8, 9))) 

T13_ROA_FTLW <- TIAS[, c("TA130049", "FTL_COUNT")] %>% group_by(TA130049, FTL_COUNT) %>% summarise(Count = n())

T13_ROA_FTLW <- T13_ROA_FTLW[1:24, ]

T13_ROA_CAT <- TIAS2013[, c("TA130049", "CAT")] %>% group_by(TA130049, CAT) %>% summarise(Count = n())

T13_ROA_CAT <- T13_ROA_CAT[1:12, ]

ggplot(T13_ROA_FTLW, aes(x = FTL_COUNT, y = TA130049, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_ROA_CAT, aes(x = CAT, y = TA130049, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2013_IAC$TA130049))
prop.table(table(TIAS2013_FTL$TA130049))

### How Good at Money Management =================================================================================================

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130051)

T13_GMM_FTLW <- TIAS[, c("TA130051", "FTL_COUNT")] %>% group_by(TA130051, FTL_COUNT) %>% summarise(Count = n())

T13_GMM_FTLW <- T13_GMM_FTLW[1:29, ]

T13_GMM_CAT <- TIAS2013[, c("TA130051", "CAT")] %>% group_by(TA130051, CAT) %>% summarise(Count = n())

ggplot(T13_GMM_FTLW, aes(x = FTL_COUNT, y = TA130051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_GMM_CAT, aes(x = CAT, y = TA130051, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ==================================================================================

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA130052)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130052 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130052 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130052 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130052 = c(8, 9))) 

T13_CCB_FTLW <- TIAS[, c("TA130052", "FTL_COUNT")] %>% group_by(TA130052, FTL_COUNT) %>% summarise(Count = n())

T13_CCB_FTLW <- T13_CCB_FTLW[1:34, ]

T13_CCB_CAT <- TIAS2013[, c("TA130052", "CAT")] %>% group_by(TA130052, CAT) %>% summarise(Count = n())

T13_CCB_CAT <- T13_CCB_CAT[1:16, ]

ggplot(T13_CCB_FTLW, aes(x = FTL_COUNT, y = TA130052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_CCB_CAT, aes(x = CAT, y = TA130052, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2013_IAC$TA130052))
prop.table(table(TIAS2013_FTL$TA130052))

### MIDUS M1 - Happiness =========================================================================================================

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131097)

T13_M01_FTLW <- TIAS[, c("TA131097", "FTL_COUNT")] %>% group_by(TA131097, FTL_COUNT) %>% summarise(Count = n())

T13_M01_CAT <- TIAS2013[, c("TA131097", "CAT")] %>% group_by(TA131097, CAT) %>% summarise(Count = n())

T13_M01_FTLCAT <- TIAS2013_FTL[, c("TA131097", "CAT")] %>% group_by(TA131097, CAT) %>% summarise(Count = n())

T13_M01_IACCAT <- TIAS2013_IAC[, c("TA131097", "CAT")] %>% group_by(TA131097, CAT) %>% summarise(Count = n())

head(T13_M01_CAT, 12)

ggplot(T13_M01_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131097)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M01_FTLW, 25)

ggplot(T13_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131097)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131097))

m01.pie.ftl.13 <- ggplot(data = T13_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131097))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or Twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2013_IAC$TA131097))

m01.pie.iac.13 <- ggplot(data = T13_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131097))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.13, m01.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M2 - Interest in Life ==================================================================================================

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131098)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131098 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131098 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131098 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131098 = c(8, 9))) 

T13_M02_FTLW <- TIAS[, c("TA131098", "FTL_COUNT")] %>% group_by(TA131098, FTL_COUNT) %>% summarise(Count = n())

T13_M02_FTLW <- T13_M02_FTLW[1:25, ]

T13_M02_CAT <- TIAS2013[, c("TA131098", "CAT")] %>% group_by(TA131098, CAT) %>% summarise(Count = n())

T13_M02_FTLCAT <- TIAS2013_FTL[, c("TA131098", "CAT")] %>% group_by(TA131098, CAT) %>% summarise(Count = n())

T13_M02_IACCAT <- TIAS2013_IAC[, c("TA131098", "CAT")] %>% group_by(TA131098, CAT) %>% summarise(Count = n())

T13_M02_CAT <- T13_M02_CAT[1:12, ]
T13_M02_FTLCAT <- T13_M02_FTLCAT[1:6, ]
T13_M02_IACCAT <- T13_M02_IACCAT[1:6, ]

head(T13_M02_CAT, 12)

ggplot(T13_M02_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131098)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M02_FTLW, 25)

ggplot(T13_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131098)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131098))

m02.pie.ftl.13 <- ggplot(data = T13_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131098))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131098))

m02.pie.iac.13 <- ggplot(data = T13_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131098))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.13, m02.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M3 - Satisfaction ======================================================================================================

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131099)

T13_M03_FTLW <- TIAS[, c("TA131099", "FTL_COUNT")] %>% group_by(TA131099, FTL_COUNT) %>% summarise(Count = n())

T13_M03_CAT <- TIAS2013[, c("TA131099", "CAT")] %>% group_by(TA131099, CAT) %>% summarise(Count = n())

T13_M03_FTLCAT <- TIAS2013_FTL[, c("TA131099", "CAT")] %>% group_by(TA131099, CAT) %>% summarise(Count = n())

T13_M03_IACCAT <- TIAS2013_IAC[, c("TA131099", "CAT")] %>% group_by(TA131099, CAT) %>% summarise(Count = n())

head(T13_M03_CAT, 12)

ggplot(T13_M03_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131099)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M03_FTLW, 26)

ggplot(T13_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131099)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131099))

m03.pie.ftl.13 <- ggplot(data = T13_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131099))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131099))

m03.pie.iac.13 <- ggplot(data = T13_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131099))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.13, m03.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M4 - Contribution of Something Important to Society ====================================================================

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131100)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131100 = 8)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131100 = 8)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131100 = 8)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131100 = 8)) 

T13_M04_FTLW <- TIAS[, c("TA131100", "FTL_COUNT")] %>% group_by(TA131100, FTL_COUNT) %>% summarise(Count = n())

T13_M04_FTLW <- T13_M04_FTLW[1:29, ]

T13_M04_CAT <- TIAS2013[, c("TA131100", "CAT")] %>% group_by(TA131100, CAT) %>% summarise(Count = n())

T13_M04_CAT <- T13_M04_CAT[1:12, ]

T13_M04_FTLCAT <- TIAS2013_FTL[, c("TA131100", "CAT")] %>% group_by(TA131100, CAT) %>% summarise(Count = n())

T13_M04_FTLCAT <- T13_M04_FTLCAT[1:6, ]

T13_M04_IACCAT <- TIAS2013_IAC[, c("TA131100", "CAT")] %>% group_by(TA131100, CAT) %>% summarise(Count = n())

T13_M04_IACCAT=T13_M04_IACCAT[1:6, ]

head(T13_M04_CAT, 12)

ggplot(T13_M04_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131100)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M04_FTLW, 29)

ggplot(T13_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131100)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131100))

m04.pie.ftl.13 <- ggplot(data = T13_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131100))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131100))

m04.pie.iac.13 <- ggplot(data = T13_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131100))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.13, m04.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M5 - Belonging to Community ============================================================================================

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131101)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131101 = 9)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131101 = 9)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131101 = 9)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131101 = 9)) 


T13_M05_FTLW <- TIAS[, c("TA131101", "FTL_COUNT")] %>% group_by(TA131101, FTL_COUNT) %>% summarise(Count = n())

T13_M05_CAT <- TIAS2013[, c("TA131101", "CAT")] %>% group_by(TA131101, CAT) %>% summarise(Count = n())

T13_M05_FTLCAT <- TIAS2013_FTL[, c("TA131101", "CAT")] %>% group_by(TA131101, CAT) %>% summarise(Count = n())

T13_M05_IACCAT <- TIAS2013_IAC[, c("TA131101", "CAT")] %>% group_by(TA131101, CAT) %>% summarise(Count = n())

T13_M05_FTLW <- T13_M05_FTLW[1:27, ]
T13_M05_CAT <- T13_M05_CAT[1:12, ]
T13_M05_FTLCAT <- T13_M05_FTLCAT[1:6, ]
T13_M05_IACCAT <- T13_M05_IACCAT[1:6, ]

head(T13_M05_CAT, 12)

ggplot(T13_M05_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131101)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M05_FTLW, 27)

ggplot(T13_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131101)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131101))

m05.pie.ftl.13 <- ggplot(data = T13_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131101))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131101))

m05.pie.iac.13 <- ggplot(data = T13_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131101))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.13, m05.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M6 - Society Getting Better ============================================================================================

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131102)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131102 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131102 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131102 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131102 = c(8, 9))) 


T13_M06_FTLW <- TIAS[, c("TA131102", "FTL_COUNT")] %>% group_by(TA131102, FTL_COUNT) %>% summarise(Count = n())

T13_M06_FTLW <- T13_M06_FTLW[1:27, ]

T13_M06_CAT <- TIAS2013[, c("TA131102", "CAT")] %>% group_by(TA131102, CAT) %>% summarise(Count = n())

T13_M06_CAT <- T13_M06_CAT[1:12, ]

T13_M06_FTLCAT <- TIAS2013_FTL[, c("TA131102", "CAT")] %>% group_by(TA131102, CAT) %>% summarise(Count = n())

T13_M06_FTLCAT <- T13_M06_FTLCAT[1:6, ]

T13_M06_IACCAT <- TIAS2013_IAC[, c("TA131102", "CAT")] %>% group_by(TA131102, CAT) %>% summarise(Count = n())

T13_M06_IACCAT <- T13_M06_IACCAT[1:6, ]

head(T13_M06_CAT, 12)

ggplot(T13_M06_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131102)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M06_FTLW, 27)

ggplot(T13_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131102)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131102))

m06.pie.ftl.13 <- ggplot(data = T13_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131102))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131102))

m06.pie.iac.13 <- ggplot(data = T13_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131102))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.13, m06.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M7 - People Basically Good =============================================================================================

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131103)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131103 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131103 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131103 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131103 = c(8, 9))) 

T13_M07_FTLW <- TIAS[, c("TA131103", "FTL_COUNT")] %>% group_by(TA131103, FTL_COUNT) %>% summarise(Count = n())

T13_M07_FTLW <- T13_M07_FTLW[1:26, ]

T13_M07_CAT <- TIAS2013[, c("TA131103", "CAT")] %>% group_by(TA131103, CAT) %>% summarise(Count = n())

T13_M07_CAT <- T13_M07_CAT[1:12, ]

T13_M07_FTLCAT <- TIAS2013_FTL[, c("TA131103", "CAT")] %>% group_by(TA131103, CAT) %>% summarise(Count = n())

T13_M07_FTLCAT <- T13_M07_FTLCAT[1:6, ]

T13_M07_IACCAT <- TIAS2013_IAC[, c("TA131103", "CAT")] %>% group_by(TA131103, CAT) %>% summarise(Count = n())

T13_M07_IACCAT <- T13_M07_IACCAT[1:6, ]

head(T13_M07_CAT, 12)

ggplot(T13_M07_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131103)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M07_FTLW, 26)

ggplot(T13_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131103)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131103))

m07.pie.ftl.13 <- ggplot(data = T13_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131103))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131103))

m07.pie.iac.13 <- ggplot(data = T13_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131103))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.13, m07.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M8 - Way Society Makes Sense ===========================================================================================

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131104)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131104 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131104 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131104 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131104 = c(8, 9))) 

T13_M08_FTLW <- TIAS[, c("TA131104", "FTL_COUNT")] %>% group_by(TA131104, FTL_COUNT) %>% summarise(Count = n())

T13_M08_FTLW <- T13_M08_FTLW[1:29, ]

T13_M08_CAT <- TIAS2013[, c("TA131104", "CAT")] %>% group_by(TA131104, CAT) %>% summarise(Count = n())

T13_M08_CAT <- T13_M08_CAT[1:12, ]

T13_M08_FTLCAT <- TIAS2013_FTL[, c("TA131104", "CAT")] %>% group_by(TA131104, CAT) %>% summarise(Count = n())

T13_M08_FTLCAT <- T13_M08_FTLCAT[1:6, ]

T13_M08_IACCAT <- TIAS2013_IAC[, c("TA131104", "CAT")] %>% group_by(TA131104, CAT) %>% summarise(Count = n())

T13_M08_IACCAT <- T13_M08_IACCAT[1:6, ]

head(T13_M08_CAT, 12)

ggplot(T13_M08_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131104)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M08_FTLW, 29)

ggplot(T13_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131104)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131104))

m08.pie.ftl.13 <- ggplot(data = T13_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131104))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131104))

m08.pie.iac.13 <- ggplot(data = T13_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131104))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.13, m08.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131105)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131105 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131105 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131105 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131105 = c(8, 9))) 

T13_M09_FTLW <- TIAS[, c("TA131105", "FTL_COUNT")] %>% group_by(TA131105, FTL_COUNT) %>% summarise(Count = n())

T13_M09_FTLW <- T13_M09_FTLW[1:27, ]

T13_M09_CAT <- TIAS2013[, c("TA131105", "CAT")] %>% group_by(TA131105, CAT) %>% summarise(Count = n())

T13_M09_FTLCAT <- TIAS2013_FTL[, c("TA131105", "CAT")] %>% group_by(TA131105, CAT) %>% summarise(Count = n())

T13_M09_IACCAT <- TIAS2013_IAC[, c("TA131105", "CAT")] %>% group_by(TA131105, CAT) %>% summarise(Count = n())

T13_M09_CAT <- T13_M05_CAT[1:12, ]
T13_M09_FTLCAT <- T13_M05_FTLCAT[1:6, ]
T13_M09_IACCAT <- T13_M05_IACCAT[1:6, ]

head(T13_M09_CAT, 12)

ggplot(T13_M09_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131105)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M09_FTLW, 27)

ggplot(T13_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131105)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131105))

m09.pie.ftl.13 <- ggplot(data = T13_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131105))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131105))

m09.pie.iac.13 <- ggplot(data = T13_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131105))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.13, m09.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M10 - Trusting Relationships w/ Others =================================================================================

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131106)

T13_M10_FTLW <- TIAS[, c("TA131106", "FTL_COUNT")] %>% group_by(TA131106, FTL_COUNT) %>% summarise(Count = n())

T13_M10_CAT <- TIAS2013[, c("TA131106", "CAT")] %>% group_by(TA131106, CAT) %>% summarise(Count = n())

T13_M10_FTLCAT <- TIAS2013_FTL[, c("TA131106", "CAT")] %>% group_by(TA131106, CAT) %>% summarise(Count = n())

T13_M10_IACCAT <- TIAS2013_IAC[, c("TA131106", "CAT")] %>% group_by(TA131106, CAT) %>% summarise(Count = n())

head(T13_M10_CAT, 12)

ggplot(T13_M10_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131106)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M10_FTLW, 26)

ggplot(T13_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131106)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131106))

m10.pie.ftl.13 <- ggplot(data = T13_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131106))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131106))

m10.pie.iac.13 <- ggplot(data = T13_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131106))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.13, m10.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M11 - Challenged to Grow ===============================================================================================

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131107)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131107 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131107 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131107 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131107 = c(8, 9))) 

T13_M11_FTLW <- TIAS[, c("TA131107", "FTL_COUNT")] %>% group_by(TA131107, FTL_COUNT) %>% summarise(Count = n())

T13_M11_CAT <- TIAS2013[, c("TA131107", "CAT")] %>% group_by(TA131107, CAT) %>% summarise(Count = n())

T13_M11_FTLCAT <- TIAS2013_FTL[, c("TA131107", "CAT")] %>% group_by(TA131107, CAT) %>% summarise(Count = n())

T13_M11_IACCAT <- TIAS2013_IAC[, c("TA131107", "CAT")] %>% group_by(TA131107, CAT) %>% summarise(Count = n())

T13_M11_FTLW <- T13_M11_FTLW[1:26, ]
T13_M11_CAT <- T13_M11_CAT[1:12, ]
T13_M11_FTLCAT <- T13_M11_FTLCAT[1:6, ]
T13_M11_IACCAT <- T13_M11_IACCAT[1:6, ]

head(T13_M11_CAT, 12)

ggplot(T13_M11_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131107)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M11_FTLW, 21)

ggplot(T13_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131107)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131107))

m11.pie.ftl.13 <- ggplot(data = T13_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131107))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

prop.table(table(TIAS2013_IAC$TA131107))

m11.pie.iac.13 <- ggplot(data = T13_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131107))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.13, m11.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131108)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131108 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131108 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131108 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131108 = c(8, 9))) 


T13_M12_FTLW <- TIAS[, c("TA131108", "FTL_COUNT")] %>% group_by(TA131108, FTL_COUNT) %>% summarise(Count = n())

T13_M12_CAT <- TIAS2013[, c("TA131108", "CAT")] %>% group_by(TA131108, CAT) %>% summarise(Count = n())

T13_M12_FTLCAT <- TIAS2013_FTL[, c("TA131108", "CAT")] %>% group_by(TA131108, CAT) %>% summarise(Count = n())

T13_M12_IACCAT <- TIAS2013_IAC[, c("TA131108", "CAT")] %>% group_by(TA131108, CAT) %>% summarise(Count = n())

T13_M12_FTLW <- T13_M12_FTLW[1:28, ]
T13_M12_CAT <- T13_M12_CAT[1:12, ]
T13_M12_FTLCAT <- T13_M12_FTLCAT[1:6, ]
T13_M12_IACCAT <- T13_M12_IACCAT[1:6, ]

head(T13_M12_CAT, 12)

ggplot(T13_M12_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131108)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M12_FTLW, 28)

ggplot(T13_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131108)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131108))

m12.pie.ftl.13 <- ggplot(data = T13_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131108))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131108))

m12.pie.iac.13 <- ggplot(data = T13_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131108))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.13, m12.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M13 - Liked Personality ================================================================================================

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131109)

T13_M13_FTLW <- TIAS[, c("TA131109", "FTL_COUNT")] %>% group_by(TA131109, FTL_COUNT) %>% summarise(Count = n())

T13_M13_CAT <- TIAS2013[, c("TA131109", "CAT")] %>% group_by(TA131109, CAT) %>% summarise(Count = n())

T13_M13_FTLCAT <- TIAS2013_FTL[, c("TA131109", "CAT")] %>% group_by(TA131109, CAT) %>% summarise(Count = n())

T13_M13_IACCAT <- TIAS2013_IAC[, c("TA131109", "CAT")] %>% group_by(TA131109, CAT) %>% summarise(Count = n())

head(T13_M13_CAT, 12)

ggplot(T13_M13_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131109)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M13_FTLW, 24)

ggplot(T13_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131109)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131109))

m13.pie.ftl.13 <- ggplot(data = T13_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131109))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightcoral", "gold"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2013_IAC$TA131109))

m13.pie.iac.13 <- ggplot(data = T13_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131109))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightcoral", "gold"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.13, m13.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS M14 - Life Had Direction ===============================================================================================

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131110)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131110 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131110 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131110 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131110 = c(8, 9))) 

T13_M14_FTLW <- TIAS[, c("TA131110", "FTL_COUNT")] %>% group_by(TA131110, FTL_COUNT) %>% summarise(Count = n())

T13_M14_CAT <- TIAS2013[, c("TA131110", "CAT")] %>% group_by(TA131110, CAT) %>% summarise(Count = n())

T13_M14_FTLCAT <- TIAS2013_FTL[, c("TA131110", "CAT")] %>% group_by(TA131110, CAT) %>% summarise(Count = n())

T13_M14_IACCAT <- TIAS2013_IAC[, c("TA131110", "CAT")] %>% group_by(TA131110, CAT) %>% summarise(Count = n())

T13_M14_FTLW <- T13_M14_FTLW[1:27, ]
T13_M14_CAT <- T13_M14_CAT[1:12, ]
T13_M14_FTLCAT <- T13_M14_FTLCAT[1:6, ]
T13_M14_IACCAT <- T13_M14_IACCAT[1:6, ]

head(T13_M14_CAT, 12)

ggplot(T13_M14_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131110)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T13_M14_FTLW, 27)

ggplot(T13_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131110)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA131110))

m14.pie.ftl.13 <- ggplot(data = T13_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131110))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2013_IAC$TA131110))

m14.pie.iac.13 <- ggplot(data = T13_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131110))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.13, m14.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### MIDUS Subscale - Emotional ===================================================================================================

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA131214)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131214 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131214 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131214 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131214 = c(8, 9))) 

T13_MSE_FTLW <- TIAS[, c("TA131214", "FTL_COUNT")] %>% group_by(TA131214, FTL_COUNT) %>% summarise(Count = n())

T13_MSE_CAT <- TIAS2013[, c("TA131214", "CAT")] %>% group_by(TA131214, CAT) %>% summarise(Count = n())

T13_MSE_FTLW <- T13_MSE_FTLW[1:25, ]
T13_MSE_CAT=T13_MSE_CAT[1:12, ]

ggplot(T13_MSE_FTLW, aes(x = FTL_COUNT, y = TA131214, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_MSE_CAT, aes(x = CAT, y = TA131214, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological ===============================================================================================

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA131216)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131216 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131216 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131216 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131216 = c(8, 9))) 

T13_MSP_FTLW <- TIAS[, c("TA131216", "FTL_COUNT")] %>% group_by(TA131216, FTL_COUNT) %>% summarise(Count = n())

T13_MSP_FTLW <- T13_MSP_FTLW[1:25, ]

T13_MSP_CAT <- TIAS2013[, c("TA131216", "CAT")] %>% group_by(TA131216, CAT) %>% summarise(Count = n())

T13_MSP_CAT=T13_MSP_CAT[1:12, ]

ggplot(T13_MSP_FTLW, aes(x = FTL_COUNT, y = TA131216, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_MSP_CAT, aes(x = CAT, y = TA131216, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ==================================================================================================

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130016)

T13_TIA_FTLW <- TIAS[, c("TA130016", "FTL_COUNT")] %>% group_by(TA130016, FTL_COUNT) %>% summarise(Count = n())

T13_TIA_FTLW=T13_TIA_FTLW[1:11, ]

T13_TIA_CAT <- TIAS2013[, c("TA130016", "CAT")] %>% group_by(TA130016, CAT) %>% summarise(Count = n())

T13_TIA_CAT=T13_TIA_CAT[1:4,]

T13_TIA_FTLCAT <- TIAS2013_FTL[, c("TA130016", "CAT")] %>% group_by(TA130016, CAT) %>% summarise(Count = n())

T13_TIA_IACCAT <- TIAS2013_IAC[, c("TA130016", "CAT")] %>% group_by(TA130016, CAT) %>% summarise(Count = n())


head(T13_TIA_CAT, 4)

ggplot(T13_TIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T13_TIA_FTLW, 11)

ggplot(T13_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130016))

tia.pie.ftl.13 <- ggplot(data = T13_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130016)) 

tia.pie.iac.13 <- ggplot(data = T13_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.13, tia.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Type of Art (Involvement) =========================================================================================

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 8871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA130017)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130017 = 9999)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130017 = 9999)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130017 = 9999)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130017 = 9999)) 

T13_IIA_FTLW <- TIAS[, c("TA130017", "FTL_COUNT")] %>% group_by(TA130017, FTL_COUNT) %>% summarise(Count = n())

T13_IIA_FTLW <- T13_IIA_FTLW[1:33, ]

T13_IIA_CAT <- TIAS2013[, c("TA130017", "CAT")] %>% group_by(TA130017, CAT) %>% summarise(Count = n())

T13_IIA_CAT <- T13_IIA_CAT[1:18, ]

T13_IIA_FTLCAT <- TIAS2013_FTL[, c("TA130017", "CAT")] %>% group_by(TA130017, CAT) %>% summarise(Count = n())

T13_IIA_FTLCAT <- T13_IIA_FTLCAT[1:7, ]

T13_IIA_IACCAT <- TIAS2013_IAC[, c("TA130017", "CAT")] %>% group_by(TA130017, CAT) %>% summarise(Count = n())

T13_IIA_IACCAT <- T13_IIA_IACCAT[1:17, ]

head(T13_IIA_CAT, 18)

ggplot(T13_IIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                            "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                                            "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

head(T13_IIA_FTLW, 35)

ggplot(T13_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                            "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                                            "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

prop.table(table(TIAS2013_FTL$TA130017)) 

iia.pie.ftl.13 <- ggplot(data = T13_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue","mediumspringgreen", "mediumvioletred", "midnightblue", "royalblue1", "seagreen1", "aquamarine"),  labels = c("Not Involved in Arts/Music/Theater", "Arts & Crafts", "Painting", "Drawing/Coloring", "Playing an instrument", "Singing", "Non-social Dancing/Ballet/Body Movement"))   

prop.table(table(TIAS2013_IAC$TA130017)) 

iia.pie.iac.13 <- ggplot(data = T13_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                             "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                             "Dance Lessons", "Music Lessons - Unspecified", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                     

ggarrange(iia.pie.ftl.13, iia.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Art Involvement Frequency (Over 12 Mos) ===========================================================================

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA130018)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130018 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130018 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130018 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130018 = c(8, 9))) 


T13_AIF_FTLW <- TIAS[, c("TA130018", "FTL_COUNT")] %>% group_by(TA130018, FTL_COUNT) %>% summarise(Count = n())

T13_AIF_FTLW <- T13_AIF_FTLW[1:25, ]

T13_AIF_CAT <- TIAS2013[, c("TA130018", "CAT")] %>% group_by(TA130018, CAT) %>% summarise(Count = n())

T13_AIF_FTLCAT <- TIAS2013_FTL[, c("TA130018", "CAT")] %>% group_by(TA130018, CAT) %>% summarise(Count = n())

T13_AIF_CAT=T13_AIF_CAT[1:14, ]

T13_AIF_FTLCAT <- TIAS2013_FTL[, c("TA130018", "CAT")] %>% group_by(TA130018, CAT) %>% summarise(Count = n())

T13_AIF_IACCAT <- TIAS2013_IAC[, c("TA130018", "CAT")] %>% group_by(TA130018, CAT) %>% summarise(Count = n())

T13_AIF_IACCAT=T13_AIF_IACCAT[1:7, ]

head(T13_AIF_CAT, 14)

ggplot(T13_AIF_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T13_AIF_FTLW, 25)

ggplot(T13_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA130018)) 

aif.pie.ftl.13 <- ggplot(data = T13_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day"))

prop.table(table(TIAS2013_IAC$TA130018)) 

aif.pie.iac.13 <- ggplot(data = T13_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.13, aif.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### WTR Member of Sports Team (Over 12 Mos) ======================================================================================

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130019)

T13_SPO_FTLW <- TIAS[, c("TA130019", "FTL_COUNT")] %>% group_by(TA130019, FTL_COUNT) %>% summarise(Count = n())

T13_SPO_FTLW=T13_SPO_FTLW[1:9, ]

T13_SPO_CAT <- TIAS2013[, c("TA130019", "CAT")] %>% group_by(TA130019, CAT) %>% summarise(Count = n())

T13_SPO_CAT=T13_SPO_CAT[1:4, ]

T13_SPO_FTLCAT <- TIAS2013_FTL[, c("TA130019", "CAT")] %>% group_by(TA130019, CAT) %>% summarise(Count = n())

T13_SPO_IACCAT <- TIAS2013_IAC[, c("TA130019", "CAT")] %>% group_by(TA130019, CAT) %>% summarise(Count = n())

head(T13_SPO_CAT, 4)

ggplot(T13_SPO_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T13_SPO_FTLW, 9)

ggplot(T13_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130019))

spo.pie.ftl.13 <- ggplot(data = T13_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130019)) 

spo.pie.iac.13 <- ggplot(data = T13_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.13, spo.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Involved in Sports Frequency  =====================================================================================

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA130020)

T13_IIS_FTLW <- TIAS[, c("TA130020", "FTL_COUNT")] %>% group_by(TA130020, FTL_COUNT) %>% summarise(Count = n())

T13_IIS_FTLW <- T13_IIS_FTLW[1:19, ]

T13_IIS_CAT <- TIAS2013[, c("TA130020", "CAT")] %>% group_by(TA130020, CAT) %>% summarise(Count = n())

T13_IIS_CAT=T13_IIS_CAT[1:11, ]

T13_IIS_FTLCAT <- TIAS2013_FTL[, c("TA130020", "CAT")] %>% group_by(TA130020, CAT) %>% summarise(Count = n())

T13_IIS_IACCAT <- TIAS2013_IAC[, c("TA130020", "CAT")] %>% group_by(TA130020, CAT) %>% summarise(Count = n())

head(T13_IIS_CAT, 11)

ggplot(T13_IIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T13_IIS_FTLW, 19)

ggplot(T13_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA130020))

iis.pie.ftl.13 <- ggplot(data = T13_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("Not Involved in Sports", "At least once a month", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_IAC$TA130020)) 

iis.pie.iac.13 <- ggplot(data = T13_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.13, iis.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Watching/Reading News (Over 12 Mos) ===============================================================================

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130021)

T13_WRN_FTLW <- TIAS[, c("TA130021", "FTL_COUNT")] %>% group_by(TA130021, FTL_COUNT) %>% summarise(Count = n())

T13_WRN_FTLW <- T13_WRN_FTLW[1:27, ]

T13_WRN_CAT <- TIAS2013[, c("TA130021", "CAT")] %>% group_by(TA130021, CAT) %>% summarise(Count = n())

T13_WRN_CAT=T13_WRN_CAT[1:13, ]

T13_WRN_FTLCAT <- TIAS2013_FTL[, c("TA130021", "CAT")] %>% group_by(TA130021, CAT) %>% summarise(Count = n())

T13_WRN_IACCAT <- TIAS2013_IAC[, c("TA130021", "CAT")] %>% group_by(TA130021, CAT) %>% summarise(Count = n())

head(T13_WRN_CAT, 13)

ggplot(T13_WRN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T13_WRN_FTLW, 27)

ggplot(T13_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2013_FTL$TA130021))

wrn.pie.ftl.13 <- ggplot(data = T13_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_IAC$TA130021)) 

wrn.pie.iac.13 <- ggplot(data = T13_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.13, wrn.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130022)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130022 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130022 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130022 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130022 = c(8, 9))) 

T13_RFP_FTLW <- TIAS[, c("TA130022", "FTL_COUNT")] %>% group_by(TA130022, FTL_COUNT) %>% summarise(Count = n())

T13_RFP_FTLW <- T13_RFP_FTLW[1:30, ]

T13_RFP_CAT <- TIAS2013[, c("TA130022", "CAT")] %>% group_by(TA130022, CAT) %>% summarise(Count = n())

T13_RFP_CAT=T13_RFP_CAT[1:14, ]

T13_RFP_FTLCAT <- TIAS2013_FTL[, c("TA130022", "CAT")] %>% group_by(TA130022, CAT) %>% summarise(Count = n())

T13_RFP_IACCAT <- TIAS2013_IAC[, c("TA130022", "CAT")] %>% group_by(TA130022, CAT) %>% summarise(Count = n())

T13_RFP_IACCAT=T13_RFP_IACCAT[1:7, ]

head(T13_RFP_CAT, 14)

ggplot(T13_RFP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T13_RFP_FTLW, 26)

ggplot(T13_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2013_FTL$TA130022))

rfp.pie.ftl.13 <- ggplot(data = T13_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2013_IAC$TA130022)) 

rfp.pie.iac.13 <- ggplot(data = T13_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.13, rfp.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ==========================================================================

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130023)

T13_NNT_FTLW <- TIAS[, c("TA130023", "FTL_COUNT")] %>% group_by(TA130023, FTL_COUNT) %>% summarise(Count = n())

T13_NNT_FTLW <- T13_NNT_FTLW[1:27, ]

T13_NNT_CAT <- TIAS2013[, c("TA130023", "CAT")] %>% group_by(TA130023, CAT) %>% summarise(Count = n())

T13_NNT_CAT=T13_NNT_CAT[1:12, ]

T13_NNT_FTLCAT <- TIAS2013_FTL[, c("TA130023", "CAT")] %>% group_by(TA130023, CAT) %>% summarise(Count = n())

T13_NNT_IACCAT <- TIAS2013_IAC[, c("TA130023", "CAT")] %>% group_by(TA130023, CAT) %>% summarise(Count = n())

head(T13_NNT_CAT, 12)

ggplot(T13_NNT_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T13_NNT_FTLW, 27)

ggplot(T13_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2013_FTL$TA130023))

nnt.pie.ftl.13 <- ggplot(data = T13_NNT_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2013_IAC$TA130023)) 

nnt.pie.iac.13 <- ggplot(data = T13_NNT_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

ggarrange(nnt.pie.ftl.13, nnt.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ==========================================================

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA130024)

T13_IPE_FTLW <- TIAS[, c("TA130024", "FTL_COUNT")] %>% group_by(TA130024, FTL_COUNT) %>% summarise(Count = n())

T13_IPE_FTLW <- T13_IPE_FTLW[1:33, ]

T13_IPE_CAT <- TIAS2013[, c("TA130024", "CAT")] %>% group_by(TA130024, CAT) %>% summarise(Count = n())

T13_IPE_CAT=T13_IPE_CAT[1:14, ]

T13_IPE_FTLCAT <- TIAS2013_FTL[, c("TA130024", "CAT")] %>% group_by(TA130024, CAT) %>% summarise(Count = n())

T13_IPE_IACCAT <- TIAS2013_IAC[, c("TA130024", "CAT")] %>% group_by(TA130024, CAT) %>% summarise(Count = n())

head(T13_IPE_CAT, 14)

ggplot(T13_IPE_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T13_IPE_FTLW, 33)

ggplot(T13_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2013_FTL$TA130024))

ipe.pie.ftl.13 <- ggplot(data = T13_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_IAC$TA130024)) 

ipe.pie.iac.13 <- ggplot(data = T13_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.13, ipe.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ==================================================================

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA130025)

T13_IPR_FTLW <- TIAS[, c("TA130025", "FTL_COUNT")] %>% group_by(TA130025, FTL_COUNT) %>% summarise(Count = n())

T13_IPR_FTLW <- T13_IPR_FTLW[1:34, ]

T13_IPR_CAT <- TIAS2013[, c("TA130025", "CAT")] %>% group_by(TA130025, CAT) %>% summarise(Count = n())

T13_IPR_FTLCAT <- TIAS2013_FTL[, c("TA130025", "CAT")] %>% group_by(TA130025, CAT) %>% summarise(Count = n())

T13_IPR_IACCAT <- TIAS2013_IAC[, c("TA130025", "CAT")] %>% group_by(TA130025, CAT) %>% summarise(Count = n())

head(T13_IPR_CAT, 15)

ggplot(T13_IPR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T13_IPR_FTLW, 33)

ggplot(T13_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2013_FTL$TA130025))

ipr.pie.ftl.13 <- ggplot(data = T13_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Never used the internet for school/research"))

prop.table(table(TIAS2013_IAC$TA130025))

ipr.pie.iac.13 <- ggplot(data = T13_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.13, ipr.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) =========================================================================

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA130026)

T13_IPS_FTLW <- TIAS[, c("TA130026", "FTL_COUNT")] %>% group_by(TA130026, FTL_COUNT) %>% summarise(Count = n())

T13_IPS_FTLW <- T13_IPS_FTLW[1:33, ]

T13_IPS_CAT <- TIAS2013[, c("TA130026", "CAT")] %>% group_by(TA130026, CAT) %>% summarise(Count = n())

T13_IPS_CAT <- T13_IPS_CAT[1:14, ]

T13_IPS_FTLCAT <- TIAS2013_FTL[, c("TA130026", "CAT")] %>% group_by(TA130026, CAT) %>% summarise(Count = n())

T13_IPS_IACCAT <- TIAS2013_IAC[, c("TA130026", "CAT")] %>% group_by(TA130026, CAT) %>% summarise(Count = n())

head(T13_IPS_CAT, 14)

ggplot(T13_IPS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T13_IPS_FTLW, 33)

ggplot(T13_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2013_FTL$TA130026))

ips.pie.ftl.13 <- ggplot(data = T13_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2013_IAC$TA130026))

ips.pie.iac.13 <- ggplot(data = T13_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.13, ips.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ====================================================================

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA130027)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130027 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130027 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130027 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130027 = c(8, 9))) 

T13_IPG_FTLW <- TIAS[, c("TA130027", "FTL_COUNT")] %>% group_by(TA130027, FTL_COUNT) %>% summarise(Count = n())

T13_IPG_FTLW <- T13_IPG_FTLW[1:34, ]

T13_IPG_CAT <- TIAS2013[, c("TA130027", "CAT")] %>% group_by(TA130027, CAT) %>% summarise(Count = n())

T13_IPG_CAT=T13_IPG_CAT[1:15, ]

T13_IPG_FTLCAT <- TIAS2013_FTL[, c("TA130027", "CAT")] %>% group_by(TA130027, CAT) %>% summarise(Count = n())

T13_IPG_IACCAT <- TIAS2013_IAC[, c("TA130027", "CAT")] %>% group_by(TA130027, CAT) %>% summarise(Count = n())

T13_IPG_IACCAT=T13_IPG_IACCAT[1:8, ]

head(T13_IPG_CAT, 15)

ggplot(T13_IPG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T13_IPG_FTLW, 34)

ggplot(T13_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2013_FTL$TA130027))

ipg.pie.ftl.13 <- ggplot(data = T13_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2013_IAC$TA130027))

ipg.pie.iac.13 <- ggplot(data = T13_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.13, ipg.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Voted in Last Presidential Election ===============================================================================

####
# A11. WTR Voted in 2004: “Did you vote in the national election for President last November, in 2004?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130029)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130029 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130029 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130029 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130029 = c(8, 9))) 

T13_VLP_FTLW <- TIAS[, c("TA130029", "FTL_COUNT")] %>% group_by(TA130029, FTL_COUNT) %>% summarise(Count = n())

T13_VLP_FTLW <- T13_VLP_FTLW[1:14, ]

T13_VLP_CAT <- TIAS2013[, c("TA130029", "CAT")] %>% group_by(TA130029, CAT) %>% summarise(Count = n())

T13_VLP_CAT=T13_VLP_CAT[1:5, ]

head(T13_VLP_CAT, 5)

ggplot(T13_VLP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightblue", "lightgreen", "lightpink"), labels = c("Too young", "Yes", "No"))

head(T13_VLP_FTLW, 14)

ggplot(T13_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightblue", "lightgreen", "lightpink"), labels = c("Too young", "Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130029))
prop.table(table(TIAS2013_FTL$TA130029))


### Time Use - Involvement in Social Action Groups ===============================================================================

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130030)

T13_ISA_FTLW <- TIAS[, c("TA130030", "FTL_COUNT")] %>% group_by(TA130030, FTL_COUNT) %>% summarise(Count = n())

T13_ISA_FTLW <- T13_ISA_FTLW[1:8, ]

T13_ISA_CAT <- TIAS2013[, c("TA130030", "CAT")] %>% group_by(TA130030, CAT) %>% summarise(Count = n())

T13_ISA_CAT=T13_ISA_CAT[1:4, ]

head(T13_ISA_CAT, 4)

ggplot(T13_ISA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T13_ISA_FTLW, 8)

ggplot(T13_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130030))
prop.table(table(TIAS2013_FTL$TA130030))

### Time Use - Type of Social Action Group (If Involved) =========================================================================

####
# A11C. Type of Social Action Groups: “Which political groups were you involved in?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

table(TIAS$TA130031)

T13_TSA_FTLW <- TIAS[, c("TA130031", "FTL_COUNT")] %>% group_by(TA130031, FTL_COUNT) %>% summarise(Count = n())

T13_TSA_FTLW <- T13_TSA_FTLW[1:12, ]

T13_TSA_CAT <- TIAS2013[, c("TA130031", "CAT")] %>% group_by(TA130031, CAT) %>% summarise(Count = n())

T13_TSA_CAT=T13_TSA_CAT[1:8, ]

head(T13_TSA_CAT, 8)

ggplot(T13_TSA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T13_TSA_FTLW, 12)

ggplot(T13_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

prop.table(table(TIAS2013_IAC$TA130031))
prop.table(table(TIAS2013_FTL$TA130031))

### Time Use - Social Action Group Involvement (Over 12 Mos) =====================================================================

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA130032)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130032 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130032 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130032 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130032 = c(8, 9))) 

T13_SAG_FTLW <- TIAS[, c("TA130032", "FTL_COUNT")] %>% group_by(TA130032, FTL_COUNT) %>% summarise(Count = n())

T13_SAG_FTLW <- T13_SAG_FTLW[1:13, ]

T13_SAG_CAT <- TIAS2013[, c("TA130032", "CAT")] %>% group_by(TA130032, CAT) %>% summarise(Count = n())

T13_SAG_CAT=T13_SAG_CAT[1:8, ]

head(T13_SAG_CAT, 8)

ggplot(T13_SAG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T13_SAG_FTLW, 13)

ggplot(T13_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_IAC$TA130032))
prop.table(table(TIAS2013_FTL$TA130032))

### Time Use - School Club/Student Gov Involvement ===============================================================================

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130033)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130033 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130033 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130033 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130033 = c(8, 9))) 

T13_CGI_FTLW <- TIAS[, c("TA130033", "FTL_COUNT")] %>% group_by(TA130033, FTL_COUNT) %>% summarise(Count = n())

T13_CGI_CAT <- TIAS2013[, c("TA130033", "CAT")] %>% group_by(TA130033, CAT) %>% summarise(Count = n())

T13_CGI_FTLCAT <- TIAS2013_FTL[, c("TA130033", "CAT")] %>% group_by(TA130033, CAT) %>% summarise(Count = n())

T13_CGI_IACCAT <- TIAS2013_IAC[, c("TA130033", "CAT")] %>% group_by(TA130033, CAT) %>% summarise(Count = n())

T13_CGI_FTLW <- T13_CGI_FTLW[1:11, ]
T13_CGI_CAT <- T13_CGI_CAT[1:5, ]
T13_CGI_FTLCAT <- T13_CGI_FTLCAT[1:2, ]
T13_CGI_IACCAT <- T13_CGI_IACCAT[1:3, ]

head(T13_CGI_CAT, 5)

ggplot(T13_CGI_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink", "sienna1"), labels = c("Yes", "No", "Not in school"))

head(T13_CGI_FTLW, 10)

ggplot(T13_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2013_FTL$TA130033))

cgi.pie.ftl.13 <- ggplot(data = T13_CGI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130033))

cgi.pie.iac.13 <- ggplot(data = T13_CGI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink", "sienna1"), labels = c("Yes", "No", "Not in school"))

ggarrange(cgi.pie.ftl.13, cgi.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) =======================================================

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA130034)

T13_SCG_FTLW <- TIAS[, c("TA130034", "FTL_COUNT")] %>% group_by(TA130034, FTL_COUNT) %>% summarise(Count = n())

T13_SCG_FTLW <- T13_SCG_FTLW[1:18, ]

T13_SCG_CAT <- TIAS2013[, c("TA130034", "CAT")] %>% group_by(TA130034, CAT) %>% summarise(Count = n())

T13_SCG_CAT=T13_SCG_CAT[1:10, ]

T13_SCG_FTLCAT <- TIAS2013_FTL[, c("TA130034", "CAT")] %>% group_by(TA130034, CAT) %>% summarise(Count = n())

T13_SCG_IACCAT <- TIAS2013_IAC[, c("TA130034", "CAT")] %>% group_by(TA130034, CAT) %>% summarise(Count = n())

head(T13_SCG_CAT, 10)

ggplot(T13_SCG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T13_SCG_FTLW, 18)

ggplot(T13_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA130034))

scg.pie.ftl.13 <- ggplot(data = T13_SCG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week"))

prop.table(table(TIAS2013_IAC$TA130034))

scg.pie.iac.13 <- ggplot(data = T13_SCG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(scg.pie.ftl.13, scg.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ==============================================================

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130035)

T13_UVW_FTLW <- TIAS[, c("TA130035", "FTL_COUNT")] %>% group_by(TA130035, FTL_COUNT) %>% summarise(Count = n())

T13_UVW_FTLW <- T13_UVW_FTLW[1:9, ]

T13_UVW_CAT <- TIAS2013[, c("TA130035", "CAT")] %>% group_by(TA130035, CAT) %>% summarise(Count = n())

T13_UVW_CAT=T13_UVW_CAT[1:4, ]

T13_UVW_FTLCAT <- TIAS2013_FTL[, c("TA130035", "CAT")] %>% group_by(TA130035, CAT) %>% summarise(Count = n())

T13_UVW_IACCAT <- TIAS2013_IAC[, c("TA130035", "CAT")] %>% group_by(TA130035, CAT) %>% summarise(Count = n())

head(T13_UVW_CAT, 4)

ggplot(T13_UVW_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130035))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

head(T13_UVW_FTLW, 9)

ggplot(T13_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130035)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_FTL$TA130035))

uvw.pie.ftl.13 <- ggplot(data = T13_UVW_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2013_IAC$TA130035))

uvw.pie.iac.13 <- ggplot(data = T13_UVW_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

ggarrange(uvw.pie.ftl.13, uvw.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Time Use - Type of Volunteer Work ============================================================================================

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA130036)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130036 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130036 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130036 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130036 = c(8, 9))) 

T13_VFM_FTLW <- TIAS[, c("TA130036", "FTL_COUNT")] %>% group_by(TA130036, FTL_COUNT) %>% summarise(Count = n())

T13_VFM_CAT <- TIAS2013[, c("TA130036", "CAT")] %>% group_by(TA130036, CAT) %>% summarise(Count = n())

T13_VFM_FTLCAT <- TIAS2013_FTL[, c("TA130036", "CAT")] %>% group_by(TA130036, CAT) %>% summarise(Count = n())

T13_VFM_IACCAT <- TIAS2013_IAC[, c("TA130036", "CAT")] %>% group_by(TA130036, CAT) %>% summarise(Count = n())

T13_VFM_FTLW <- T13_VFM_FTLW[1:21, ]

T13_VFM_CAT <- T13_VFM_CAT[1:12, ]

T13_VFM_IACCAT <- T13_VFM_IACCAT[1:8, ]


ggplot(T13_VFM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130036))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T13_VFM_FTLW, 21)

ggplot(T13_VFM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130036)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2013_FTL$TA130036))

vfm.pie.ftl.13 <- ggplot(data = T13_VFM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130036))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Religious", "Homelessness", "Other"))

prop.table(table(TIAS2013_IAC$TA130036))

vfm.pie.iac.13 <- ggplot(data = T13_VFM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130036))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(vfm.pie.ftl.13, vfm.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA130037)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130037 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130037 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130037 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130037 = c(8, 9))) 

T13_VSM_FTLW <- TIAS[, c("TA130037", "FTL_COUNT")] %>% group_by(TA130037, FTL_COUNT) %>% summarise(Count = n())

T13_VSM_CAT <- TIAS2013[, c("TA130037", "CAT")] %>% group_by(TA130037, CAT) %>% summarise(Count = n())

T13_VSM_FTLCAT <- TIAS2013_FTL[, c("TA130037", "CAT")] %>% group_by(TA130037, CAT) %>% summarise(Count = n())

T13_VSM_IACCAT <- TIAS2013_IAC[, c("TA130037", "CAT")] %>% group_by(TA130037, CAT) %>% summarise(Count = n())

T13_VSM_FTLW <- T13_VSM_FTLW[1:18, ]

T13_VSM_CAT <- T13_VSM_CAT[1:9, ]

T13_VSM_IACCAT <- T13_VSM_IACCAT[1:8, ]


ggplot(T13_VSM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130037))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T13_VSM_FTLW, 18)

ggplot(T13_VSM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130037)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2013_FTL$TA130037))

VSM.pie.ftl.13 <- ggplot(data = T13_VSM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130037))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "#0072B2", "midnightblue"), 
                    labels = c("Does not volunteer","Religious", "Other"))

prop.table(table(TIAS2013_IAC$TA130037))

VSM.pie.iac.13 <- ggplot(data = T13_VSM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130037))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(VSM.pie.ftl.13, VSM.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA130038)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130038 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130038 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130038 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130038 = c(8, 9))) 

T13_VTM_FTLW <- TIAS[, c("TA130038", "FTL_COUNT")] %>% group_by(TA130038, FTL_COUNT) %>% summarise(Count = n())

T13_VTM_CAT <- TIAS2013[, c("TA130038", "CAT")] %>% group_by(TA130038, CAT) %>% summarise(Count = n())

T13_VTM_FTLCAT <- TIAS2013_FTL[, c("TA130038", "CAT")] %>% group_by(TA130038, CAT) %>% summarise(Count = n())

T13_VTM_IACCAT <- TIAS2013_IAC[, c("TA130038", "CAT")] %>% group_by(TA130038, CAT) %>% summarise(Count = n())

T13_VTM_FTLW <- T13_VTM_FTLW[1:15, ]

T13_VTM_CAT <- T13_VTM_CAT[1:9, ]

T13_VTM_IACCAT <- T13_VTM_IACCAT[1:7, ]


ggplot(T13_VTM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130038))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T13_VTM_FTLW, 18)

ggplot(T13_VTM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130038)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2013_FTL$TA130038))

VTM.pie.ftl.13 <- ggplot(data = T13_VTM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130038))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "#009E73", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Service Organizations", "Homelessness", "Other"))

prop.table(table(TIAS2013_IAC$TA130038))

VTM.pie.iac.13 <- ggplot(data = T13_VTM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130038))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(VTM.pie.ftl.13, VTM.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA130039)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130039 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130039 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130039 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130039 = c(8, 9))) 

T13_V4M_FTLW <- TIAS[, c("TA130039", "FTL_COUNT")] %>% group_by(TA130039, FTL_COUNT) %>% summarise(Count = n())

T13_V4M_CAT <- TIAS2013[, c("TA130039", "CAT")] %>% group_by(TA130039, CAT) %>% summarise(Count = n())

T13_V4M_FTLCAT <- TIAS2013_FTL[, c("TA130039", "CAT")] %>% group_by(TA130039, CAT) %>% summarise(Count = n())

T13_V4M_IACCAT <- TIAS2013_IAC[, c("TA130039", "CAT")] %>% group_by(TA130039, CAT) %>% summarise(Count = n())

T13_V4M_FTLW <- T13_V4M_FTLW[1:15, ]

T13_V4M_CAT <- T13_V4M_CAT[1:9, ]

T13_V4M_IACCAT <- T13_V4M_IACCAT[1:8, ]


ggplot(T13_V4M_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130039))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T13_V4M_FTLW, 15)

ggplot(T13_V4M_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130039)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2013_FTL$TA130039))

V4M.pie.ftl.13 <- ggplot(data = T13_V4M_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130039))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue"), 
                    labels = c("Does not volunteer", "Children and Youth"))

prop.table(table(TIAS2013_IAC$TA130039))

V4M.pie.iac.13 <- ggplot(data = T13_V4M_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130039))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(V4M.pie.ftl.13, V4M.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA130040)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130040 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130040 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130040 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130040 = c(8, 9))) 

T13_V5M_FTLW <- TIAS[, c("TA130040", "FTL_COUNT")] %>% group_by(TA130040, FTL_COUNT) %>% summarise(Count = n())

T13_V5M_CAT <- TIAS2013[, c("TA130040", "CAT")] %>% group_by(TA130040, CAT) %>% summarise(Count = n())

T13_V5M_FTLCAT <- TIAS2013_FTL[, c("TA130040", "CAT")] %>% group_by(TA130040, CAT) %>% summarise(Count = n())

T13_V5M_IACCAT <- TIAS2013_IAC[, c("TA130040", "CAT")] %>% group_by(TA130040, CAT) %>% summarise(Count = n())

T13_V5M_FTLW <- T13_V5M_FTLW[1:11, ]

T13_V5M_CAT <- T13_V5M_CAT[1:6, ]

T13_V5M_IACCAT <- T13_V5M_IACCAT[1:4, ]


ggplot(T13_V5M_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130040))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T13_V5M_FTLW, 11)

ggplot(T13_V5M_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130040)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2013_FTL$TA130040))

V5M.pie.ftl.13 <- ggplot(data = T13_V5M_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130040))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "midnightblue"), 
                    labels = c("Does not volunteer", "Other"))

prop.table(table(TIAS2013_IAC$TA130040))

V5M.pie.iac.13 <- ggplot(data = T13_V5M_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130040))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "gold", "#0072B2", "sienna1"), 
                    labels = c("Does not volunteer", "Healthcare", "Religious", "Homelessness"))

ggarrange(V5M.pie.ftl.13, V5M.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA130041)
prop.table(table(TIAS2013_FTL$TA130041))

# No participants meeting FTL criteria mentioned a sixth organization for 2013 wave. 

####
# Creating A14 Heatmaps 
####

A14_FTL13 <- TIAS2013_FTL %>% select(TA130036, TA130037, TA130038, TA130039, TA130040, TA130041, ID)

cols <- sapply(A14_FTL13, is.logical)
A14_FTL13[,cols] <- lapply(A14_FTL13[,cols], as.numeric)

A14_FTL13_TIDY <- A14_FTL13 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL13_TIDY$variable <- factor(A14_FTL13_TIDY$variable, levels = c("TA130036", "TA130037", "TA130038", "TA130039", "TA130040", "TA130041"))

A14_FTL13_IDLEV <- dplyr::pull(A14_FTL13, ID)
A14_FTL13_TIDY$ID <- factor(A14_FTL13_TIDY$ID, levels = A14_FTL13_IDLEV)

A14_FTL13_TIDY$volunteer_type <- factor(A14_FTL13_TIDY$volunteer_type)

ggplot(A14_FTL13_TIDY, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2013 FTL", x="Order of Mention", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise"), labels = c("Did Not Mention", "Youth Organization", "Hospital/Nursing Home", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC13 <- TIAS2013_IAC %>% select(TA130036, TA130037, TA130038, TA130039, TA130040, TA130041, ID)

nrow(A14_IAC13)  

chunk <- 101  

n <- nrow(A14_IAC13)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC13_list <- split(A14_IAC13, r)   

length(A14_IAC13_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC13_tidylist <- lapply(A14_IAC13_list, tidy.vars)

for(i in 1:7) {
  A14_IAC13_tidylist[[i]]$variable <- factor(A14_IAC13_tidylist[[i]]$variable, levels = c("TA130036", "TA130037", "TA130038", "TA130039", "TA130040", "TA130041"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, ID)
}

A14_IAC13_levlist <- lapply(A14_IAC13_list, set.ID.levels)

for(i in 1:7) {
  A14_IAC13_tidylist[[i]]$ID <- factor(A14_IAC13_tidylist[[i]]$ID, levels = A14_IAC13_levlist[[i]])
}

for(i in 1:7) {
  A14_IAC13_tidylist[[i]]$volunteer_type <- factor(A14_IAC13_tidylist[[i]]$volunteer_type)
}

create.A14.IAC13.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2013 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                      labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC13.heatmaps <- function(x){
  create.heatmap(A14_IAC13_tidylist[[x]])
}

# save or view in a horizontally wide frame to view all graphs properly

ggarrange(A14.IAC13.heatmaps(1) + rremove("legend"), A14.IAC13.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC13.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC13.heatmaps(4) + rremove("y.title"), ncol = 4, nrow = 1) 

ggarrange(A14.IAC13.heatmaps(5) + rremove("legend"), A14.IAC13.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC13.heatmaps(7) + rremove("y.title"), ncol = 3, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) ===============================================================================

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA130042)

T13_TUH_FTLW <- TIAS[, c("TA130042", "FTL_COUNT")] %>% group_by(TA130042, FTL_COUNT) %>% summarise(Count = n())

T13_TUH_FTLW <- T13_TUH_FTLW[1:18, ]

T13_TUH_CAT <- TIAS2013[, c("TA130042", "CAT")] %>% group_by(TA130042, CAT) %>% summarise(Count = n())

T13_TUH_CAT=T13_TUH_CAT[1:11, ]

T13_TUH_FTLCAT <- TIAS2013_FTL[, c("TA130042", "CAT")] %>% group_by(TA130042, CAT) %>% summarise(Count = n())

T13_TUH_IACCAT <- TIAS2013_IAC[, c("TA130042", "CAT")] %>% group_by(TA130042, CAT) %>% summarise(Count = n())

head(T13_TUH_CAT, 11)

ggplot(T13_TUH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130042))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T13_TUH_FTLW, 18)

ggplot(T13_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130042)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2013_FTL$TA130042))

tuh.pie.ftl.13 <- ggplot(data = T13_TUH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130042))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2013_IAC$TA130042))

tuh.pie.iac.13 <- ggplot(data = T13_TUH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130042))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(tuh.pie.ftl.13, tuh.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ==========================================================

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130061)

T13_SRU_FTLW <- TIAS[, c("TA130061", "FTL_COUNT")] %>% group_by(TA130061, FTL_COUNT) %>% summarise(Count = n())

T13_SRU_FTLW <- T13_SRU_FTLW[1:28, ]

T13_SRU_CAT <- TIAS2013[, c("TA130061", "CAT")] %>% group_by(TA130061, CAT) %>% summarise(Count = n())

ggplot(T13_SRU_FTLW, aes(x = FTL_COUNT, y = TA130061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRU_CAT, aes(x = CAT, y = TA130061, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others ===========================================================

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130062)

T13_SRE_FTLW <- TIAS[, c("TA130062", "FTL_COUNT")] %>% group_by(TA130062, FTL_COUNT) %>% summarise(Count = n())

T13_SRE_FTLW <- T13_SRE_FTLW[1:28, ]

T13_SRE_CAT <- TIAS2013[, c("TA130062", "CAT")] %>% group_by(TA130062, CAT) %>% summarise(Count = n())

T13_SRE_CAT=T13_SRE_CAT[1:13, ]


ggplot(T13_SRE_FTLW, aes(x = FTL_COUNT, y = TA130062, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRE_CAT, aes(x = CAT, y = TA130062, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ========================================================================

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130053)

T13_SRS_FTLW <- TIAS[, c("TA130053", "FTL_COUNT")] %>% group_by(TA130053, FTL_COUNT) %>% summarise(Count = n())

T13_SRS_FTLW <- T13_SRS_FTLW[1:28, ]

T13_SRS_CAT <- TIAS2013[, c("TA130053", "CAT")] %>% group_by(TA130053, CAT) %>% summarise(Count = n())

T13_SRS_CAT=T13_SRS_CAT[1:13, ]

ggplot(T13_SRS_FTLW, aes(x = FTL_COUNT, y = TA130053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRS_CAT, aes(x = CAT, y = TA130053, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ==================================================================================================

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130050)

T13_HGP_FTLW <- TIAS[, c("TA130050", "FTL_COUNT")] %>% group_by(TA130050, FTL_COUNT) %>% summarise(Count = n())

T13_HGP_FTLW <- T13_HGP_FTLW[1:24, ]

T13_HGP_CAT <- TIAS2013[, c("TA130050", "CAT")] %>% group_by(TA130050, CAT) %>% summarise(Count = n())

T13_HGP_CAT <- T13_HGP_CAT[1:12, ]

ggplot(T13_HGP_FTLW, aes(x = FTL_COUNT, y = TA130050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_HGP_CAT, aes(x = CAT, y = TA130050, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))


### Self-Rating (Compared to Others) - Independence ==============================================================================

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130058)

T13_SRI_FTLW <- TIAS[, c("TA130058", "FTL_COUNT")] %>% group_by(TA130058, FTL_COUNT) %>% summarise(Count = n())

T13_SRI_FTLW <- T13_SRI_FTLW[1:29, ]

T13_SRI_CAT <- TIAS2013[, c("TA130058", "CAT")] %>% group_by(TA130058, CAT) %>% summarise(Count = n())

T13_SRI_CAT=T13_SRI_CAT[1:13, ]

ggplot(T13_SRI_FTLW, aes(x = FTL_COUNT, y = TA130058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRI_CAT, aes(x = CAT, y = TA130058, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130059)

T13_SRC_FTLW <- TIAS[, c("TA130059", "FTL_COUNT")] %>% group_by(TA130059, FTL_COUNT) %>% summarise(Count = n())

T13_SRC_FTLW <- T13_SRC_FTLW[1:29, ]

T13_SRC_CAT <- TIAS2013[, c("TA130059", "CAT")] %>% group_by(TA130059, CAT) %>% summarise(Count = n())

T13_SRC_CAT=T13_SRC_CAT[1:12, ]

ggplot(T13_SRC_FTLW, aes(x = FTL_COUNT, y = TA130059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRC_CAT, aes(x = CAT, y = TA130059, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ==============================================================================

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130060)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130060 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130060 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130060 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130060 = c(8, 9))) 

T13_SRD_FTLW <- TIAS[, c("TA130060", "FTL_COUNT")] %>% group_by(TA130060, FTL_COUNT) %>% summarise(Count = n())

T13_SRD_FTLW <- T13_SRD_FTLW[1:27, ]

T13_SRD_CAT <- TIAS2013[, c("TA130060", "CAT")] %>% group_by(TA130060, CAT) %>% summarise(Count = n())

T13_SRD_CAT <- T13_SRD_CAT[1:12, ]

ggplot(T13_SRD_FTLW, aes(x = FTL_COUNT, y = TA130060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SRD_CAT, aes(x = CAT, y = TA130060, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ======================================================================

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130934)

T13_FSI_FTLW <- TIAS[, c("TA130934", "FTL_COUNT")] %>% group_by(TA130934, FTL_COUNT) %>% summarise(Count = n())

T13_FSI_FTLW <- T13_FSI_FTLW[1:27, ]

T13_FSI_CAT <- TIAS2013[, c("TA130934", "CAT")] %>% group_by(TA130934, CAT) %>% summarise(Count = n())

T13_FSI_CAT <- T13_FSI_CAT[1:12, ]

T13_FSI_FTLCAT <- TIAS2013_FTL[, c("TA130934", "CAT")] %>% group_by(TA130934, CAT) %>% summarise(Count = n())

T13_FSI_IACCAT <- TIAS2013_IAC[, c("TA130934", "CAT")] %>% group_by(TA130934, CAT) %>% summarise(Count = n())

T13_FSI_IACCAT <- T13_FSI_IACCAT[1:6, ]

head(T13_FSI_CAT, 12)

ggplot(T13_FSI_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130934))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T13_FSI_FTLW, 27)

ggplot(T13_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130934)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2013_FTL$TA130934))

fsi.pie.ftl.13 <- ggplot(data = T13_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130934))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2013_IAC$TA130934))

fsi.pie.iac.13 <- ggplot(data = T13_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130934))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.13, fsi.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Binge Eating Frequency =======================================================================================================

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA130935)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130935 = c(8, 9))) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130935 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130935 = c(8, 9)))  

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130935 = c(8, 9))) 

T13_BEF_FTLW <- TIAS[, c("TA130935", "FTL_COUNT")] %>% group_by(TA130935, FTL_COUNT) %>% summarise(Count = n())

T13_BEF_FTLW <- T13_BEF_FTLW[1:29, ]

T13_BEF_CAT <- TIAS2013[, c("TA130935", "CAT")] %>% group_by(TA130935, CAT) %>% summarise(Count = n())

T13_BEF_CAT <- T13_BEF_CAT[1:12, ]

T13_BEF_FTLCAT <- TIAS2013_FTL[, c("TA130935", "CAT")] %>% group_by(TA130935, CAT) %>% summarise(Count = n())

T13_BEF_IACCAT <- TIAS2013_IAC[, c("TA130935", "CAT")] %>% group_by(TA130935, CAT) %>% summarise(Count = n())

T13_BEF_IACCAT <- T13_BEF_IACCAT[1:6, ]

head(T13_BEF_CAT, 12)

ggplot(T13_BEF_CAT, aes(x = CAT, y = Count, fill = as.factor(TA130935))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T13_BEF_FTLW, 29)

ggplot(T13_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA130935)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2013_FTL$TA130935))

bef.pie.ftl.13 <- ggplot(data = T13_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA130935))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2013_IAC$TA130935))

bef.pie.iac.13 <- ggplot(data = T13_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA130935))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.13, bef.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Race - Hispanic ==============================================================================================================

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131091)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131091 = c(8, 9)))

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131091 = c(8, 9))) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131091 = c(8, 9)))

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131091 = c(8, 9)))

T13_HIS_FTLW <- TIAS[, c("TA131091", "FTL_COUNT")] %>% group_by(TA131091, FTL_COUNT) %>% summarise(Count = n())

T13_HIS_FTLW <- T13_HIS_FTLW[1:22, ]

T13_HIS_CAT <- TIAS2013[, c("TA131091", "CAT")] %>% group_by(TA131091, CAT) %>% summarise(Count = n())

T13_HIS_CAT <- T13_HIS_CAT[1:11, ]

T13_HIS_FTLCAT <- TIAS2013_FTL[, c("TA131091", "CAT")] %>% group_by(TA131091, CAT) %>% summarise(Count = n())

T13_HIS_IACCAT <- TIAS2013_IAC[, c("TA131091", "CAT")] %>% group_by(TA131091, CAT) %>% summarise(Count = n())

T13_HIS_IACCAT <- T13_HIS_IACCAT[1:7, ]

head(T13_HIS_CAT, 11)

ggplot(T13_HIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131091))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

head(T13_HIS_FTLW, 22)

ggplot(T13_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131091)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2013_FTL$TA131091))

his.pie.ftl.13 <- ggplot(data = T13_HIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131091))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2013_IAC$TA131091))

his.pie.iac.13 <- ggplot(data = T13_HIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131091))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

ggarrange(his.pie.ftl.13, his.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA131092)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131092 = c(8, 9)))

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131092 = c(8, 9)))

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA131092 = c(8, 9)))

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA131092 = c(8, 9)))

T13_RAC_FTLW <- TIAS[, c("TA131092", "FTL_COUNT")] %>% group_by(TA131092, FTL_COUNT) %>% summarise(Count = n())

T13_RAC_FTLW <- T13_RAC_FTLW[1:19, ]

T13_RAC_CAT <- TIAS2013[, c("TA131092", "CAT")] %>% group_by(TA131092, CAT) %>% summarise(Count = n())

T13_RAC_CAT <- T13_RAC_CAT[1:11, ]

T13_RAC_FTLCAT <- TIAS2013_FTL[, c("TA131092", "CAT")] %>% group_by(TA131092, CAT) %>% summarise(Count = n())

T13_RAC_FTLCAT <- T13_RAC_FTLCAT[1:5, ]

T13_RAC_IACCAT <- TIAS2013_IAC[, c("TA131092", "CAT")] %>% group_by(TA131092, CAT) %>% summarise(Count = n())

T13_RAC_IACCAT <- T13_RAC_IACCAT[1:6, ]

head(T13_RAC_CAT, 11)

ggplot(T13_RAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA131092))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2013", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian", "Pacific Islander", "Other"))

head(T13_RAC_FTLW, 19)

ggplot(T13_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA131092)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2013", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian", "Pacific Islander", "Other"))

prop.table(table(TIAS2013_FTL$TA131092))

rac.pie.ftl.13 <- ggplot(data = T13_RAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA131092))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Other"))

prop.table(table(TIAS2013_IAC$TA131092))

rac.pie.iac.13 <- ggplot(data = T13_RAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA131092))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Pacific Islander", "Other"))

ggarrange(rac.pie.ftl.13, rac.pie.iac.13, ncol = 2, nrow = 1, labels = c("FTL 2013", "IAC 2013"))

### Daily Cigarette Usage ========================================================================================================

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK)
####

table(TIAS$TA130938)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130938 = 998)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130938 = 998)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130938 = 998)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130938 = 998)) 

T13_CIG_FTLW <- TIAS[, c("TA130938", "FTL_COUNT")] %>% group_by(TA130938, FTL_COUNT) %>% summarise(Count = n())

T13_CIG_FTLW <- T13_CIG_FTLW[1:49, ]

T13_CIG_CAT <- TIAS2013[, c("TA130938", "CAT")] %>% group_by(TA130938, CAT) %>% summarise(Count = n())

T13_CIG_CAT <- T13_CIG_CAT[1:27, ]

ggplot(T13_CIG_FTLW, aes(x = FTL_COUNT, y = TA130938, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_CIG_CAT, aes(x = CAT, y = TA130938, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category"))

### Body Mass Index (BMI) ========================================================================================================

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA131223)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131223 = 99)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA131223 = 99)) 

T13_BMI_FTLW <- TIAS2013[, c("TA131223", "FTL_COUNT")] %>% group_by(TA131223, FTL_COUNT) %>% summarise(Count = n())

T13_BMI_FTLW <- T13_BMI_FTLW[1:292, ]

T13_BMI_CAT <- TIAS2013[, c("TA131223", "CAT_13")] %>% group_by(TA131223, CAT_13) %>% summarise(Count = n())

T13_BMI_CAT <- T13_BMI_CAT[1:270, ]

ggplot(T13_BMI_FTLW, aes(x = FTL_COUNT, y = TA131223, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_BMI_CAT, aes(x = CAT_13, y = TA131223, group = CAT_13, fill = as.factor(CAT_13))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA130933)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA130933 = 98)) 

TIAS2013 <- TIAS2013 %>% 
  replace_with_na(replace = list(TA130933 = 98)) 

TIAS2013_FTL <- TIAS2013_FTL %>% 
  replace_with_na(replace = list(TA130933 = 98)) 

TIAS2013_IAC <- TIAS2013_IAC %>% 
  replace_with_na(replace = list(TA130933 = 98)) 

T13_SLP_FTLW <- TIAS[, c("TA130933", "FTL_COUNT")] %>% group_by(TA130933, FTL_COUNT) %>% summarise(Count = n())

T13_SLP_FTLW <- T13_SLP_FTLW[1:43, ]

T13_SLP_CAT <- TIAS2013[, c("TA130933", "CAT")] %>% group_by(TA130933, CAT) %>% summarise(Count = n())

T13_SLP_CAT <- T13_SLP_CAT[1:23, ]

ggplot(T13_SLP_FTLW, aes(x = FTL_COUNT, y = TA130933, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2013", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T13_SLP_CAT, aes(x = CAT, y = TA130933, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2013", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2015 ######################## 

### Amphetamine Usage =========================================================================================================== 

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA150985)

T15_AMP_FTLW <- TIAS[, c("TA150985", "FTL_COUNT")] %>% group_by(TA150985, FTL_COUNT) %>% summarise(Count = n())

T15_AMP_FTLW <- T15_AMP_FTLW[1:11,]

T15_AMP_CAT <- TIAS2015[, c("TA150985", "CAT")] %>% group_by(TA150985, CAT) %>% summarise(Count = n())

head(T15_AMP_CAT, 7)

ggplot(T15_AMP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150985)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))

head(T15_AMP_FTLW, 11)

ggplot(T15_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150985)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "20-39 times", "40 or more times"))
                    
prop.table(table(TIAS2015_FTL$TA150985))

prop.table(table(TIAS2015_IAC$TA150985))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA151006)

T15_BRB_FTLW <- TIAS[, c("TA151006", "FTL_COUNT")] %>% group_by(TA151006, FTL_COUNT) %>% summarise(Count = n())

T15_BRB_FTLW <- T15_BRB_FTLW[1:7, ]

T15_BRB_CAT <- TIAS2015[, c("TA151006", "CAT")] %>% group_by(TA151006, CAT) %>% summarise(Count = n())

head(T15_BRB_CAT, 5)

ggplot(T15_BRB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151006)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T15_BRB_FTLW, 9)

ggplot(T15_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151006)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightpink1"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))
                    
prop.table(table(TIAS2015_FTL$TA151006))

prop.table(table(TIAS2015_IAC$TA151006))


### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA150993)

T15_MAR_FTLW <- TIAS[, c("TA150993", "FTL_COUNT")] %>% group_by(TA150993, FTL_COUNT) %>% summarise(Count = n())

T15_MAR_FTLW <- T15_MAR_FTLW[1:13, ]

T15_MAR_CAT <- TIAS2015[, c("TA150993", "CAT")] %>% group_by(TA150993, CAT) %>% summarise(Count = n())

head(T15_MAR_CAT, 6)

ggplot(T15_MAR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150993)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))
  
head(T15_MAR_FTLW, 12)

ggplot(T15_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150993)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "mediumorchid", "rosybrown1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))
  
  
prop.table(table(TIAS2015_FTL$TA150993))

prop.table(table(TIAS2015_IAC$TA150993))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA150977)

T15_DIP_FTLW <- TIAS[, c("TA150977", "FTL_COUNT")] %>% group_by(TA150977, FTL_COUNT) %>% summarise(Count = n())

T15_DIP_FTLW <- T15_DIP_FTLW[1:8, ]

T15_DIP_CAT <- TIAS2015[, c("TA150977", "CAT")] %>% group_by(TA150977, CAT) %>% summarise(Count = n())

head(T15_DIP_CAT, 2)

ggplot(T15_DIP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150977)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T15_DIP_FTLW, 9)

ggplot(T15_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150977)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2015_FTL$TA150977))

prop.table(table(TIAS2015_IAC$TA150977))

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA151022)

T15_STR_FTLW <- TIAS[, c("TA151022", "FTL_COUNT")] %>% group_by(TA151022, FTL_COUNT) %>% summarise(Count = n())

T15_STR_FTLW <- T15_STR_FTLW[1:5, ]

T15_STR_CAT <- TIAS2015[, c("TA151022", "CAT")] %>% group_by(TA151022, CAT) %>% summarise(Count = n())

head(T15_STR_CAT, 4)

ggplot(T15_STR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T15_STR_FTLW, 10)

ggplot(T15_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) +
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") 

prop.table(table(TIAS2015_FTL$TA151022))

prop.table(table(TIAS2015_IAC$TA151022))

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA151014)

table(TIAS$TA151014, TIAS$FTL_COUNT)

T15_TRQ_FTLW <- TIAS[, c("TA151014", "FTL_COUNT")] %>% group_by(TA151014, FTL_COUNT) %>% summarise(Count = n())

T15_TRQ_FTLW <- T15_TRQ_FTLW[1:10, ]

T15_TRQ_CAT <- TIAS2015[, c("TA151014", "CAT")] %>% group_by(TA151014, CAT) %>% summarise(Count = n())

T15_TRQ_FTLCAT <- TIAS2015_FTL[, c("TA151014", "CAT")] %>% group_by(TA151014, CAT) %>% summarise(Count = n())

T15_TRQ_IACCAT <- TIAS2015_IAC[, c("TA151014", "CAT")] %>% group_by(TA151014, CAT) %>% summarise(Count = n())

head(T15_TRQ_CAT, 3)

ggplot(T15_TRQ_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151014)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T15_TRQ_FTLW, 11)

ggplot(T15_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151014)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2015_FTL$TA151014))

trq.pie.ftl.15 <- ggplot(data = T15_TRQ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151014))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0)  + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) + 
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151014))

trq.pie.iac.15 <- ggplot(data = T15_TRQ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151014))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))                   

ggarrange(trq.pie.ftl.15, trq.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA150998)

T15_CCN_FTLW <- TIAS[, c("TA150998", "FTL_COUNT")] %>% group_by(TA150998, FTL_COUNT) %>% summarise(Count = n())

T15_CCN_FTLW <- T15_CCN_FTLW[1:12, ]

T15_CCN_CAT <- TIAS2015[, c("TA150998", "CAT")] %>% group_by(TA150998, CAT) %>% summarise(Count = n())

T15_CCN_FTLCAT <- TIAS2015_FTL[, c("TA150998", "CAT")] %>% group_by(TA150998, CAT) %>% summarise(Count = n())

T15_CCN_IACCAT <- TIAS2015_IAC[, c("TA150998", "CAT")] %>% group_by(TA150998, CAT) %>% summarise(Count = n())

table(TIAS2015$TA150998, TIAS2015$CAT)

head(T15_CCN_CAT, 8)

ggplot(T15_CCN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150998))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T15_CCN_FTLW, 12)

ggplot(T15_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150998)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2015_FTL$TA150998))

ccn.pie.ftl.15 <- ggplot(data = T15_CCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150998))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold"), labels = c("Never", "1-2 times")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150998))

ccn.pie.iac.15 <- ggplot(data = T15_CCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150998))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
  labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) + 
  theme_void() 

ggarrange(ccn.pie.ftl.15, ccn.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))      

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA150968)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150968 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150968 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150968 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150968 = 8)) 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150968 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150968 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150968 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150968 = 9)) 

T15_AAC_FTLW <- TIAS[, c("TA150968", "FTL_COUNT")] %>% group_by(TA150968, FTL_COUNT) %>% summarise(Count = n())

T15_AAC_FTLW <- T15_AAC_FTLW[1:26, ]

T15_AAC_CAT <- TIAS2015[, c("TA150968", "CAT")] %>% group_by(TA150968, CAT) %>% summarise(Count = n())

T15_AAC_CAT = T15_AAC_CAT[1:14, ]

T15_AAC_FTLCAT <- TIAS2015_FTL[, c("TA150968", "CAT")] %>% group_by(TA150968, CAT) %>% summarise(Count = n())

T15_AAC_FTLCAT = T15_AAC_FTLCAT[1:6, ]

T15_AAC_IACCAT <- TIAS2015_IAC[, c("TA150968", "CAT")] %>% group_by(TA150968, CAT) %>% summarise(Count = n())

T15_AAC_IACCAT[1:8, ]

head(T15_AAC_CAT, 14)

ggplot(T15_AAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150968))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink", "rosybrown1"), 
                    labels = c("Doesn't drink", "Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T15_AAC_FTLW, 23)

ggplot(T15_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150968)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink", "sienna1"), 
                    labels = c("Doesn't drink", "Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2015_FTL$TA150968))

aac.pie.ftl.15 <- ggplot(data = T15_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150968))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "rosybrown1"), 
  labels = c("Doesn't drink", "Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150968))

aac.pie.iac.15 <- ggplot(data = T15_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150968))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink", "rosybrown1", "aliceblue"), 
  labels = c("Doesn't drink", "Never", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.15, aac.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))        

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA150969)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150969 = 98)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150969 = 98)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150969 = 98)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150969 = 98))
  
TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150969 = 99)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150969 = 99)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150969 = 99)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150969 = 99))  

T15_DAC_FTLW <- TIAS[, c("TA150969", "FTL_COUNT")] %>% group_by(TA150969, FTL_COUNT) %>% summarise(Count = n())

T15_DAC_FTLW <- T15_DAC_FTLW[1:37, ]

T15_DAC_CAT <- TIAS2015[, c("TA150969", "CAT")] %>% group_by(TA150969, CAT) %>% summarise(Count = n())

T15_DAC_CAT <- T15_DAC_CAT[1:24, ]

T15_DAC_FTLCAT <- TIAS2015_FTL[, c("TA150969", "CAT")] %>% group_by(TA150969, CAT) %>% summarise(Count = n())

T15_DAC_FTLCAT <- T15_DAC_FTLCAT[1:8, ]

T15_DAC_IACCAT <- TIAS2015_IAC[, c("TA150969", "CAT")] %>% group_by(TA150969, CAT) %>% summarise(Count = n())

T15_DAC_IACCAT <- T15_DAC_IACCAT[1:16, ]

head(T15_DAC_CAT, 24)

ggplot(T15_DAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150969))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "salmon", "plum", "thistle", "slateblue1"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
  "9 drinks", "10 drinks", "12 drinks", "15 drinks", "20 drinks", "22 drinks", "24 drinks"))

head(T15_DAC_FTLW, 46)

ggplot(T15_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150969)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "salmon", "plum", "thistle", "slateblue1"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
  "9 drinks", "10 drinks", "12 drinks", "15 drinks", "20 drinks", "22 drinks", "24 drinks"))

prop.table(table(TIAS2015_FTL$TA150969))

dac.pie.ftl.15 <- ggplot(data = T15_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150969))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "slateblue1"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks","24 drinks")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150969))

dac.pie.iac.15 <- ggplot(data = T15_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150969))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff", "salmon", "plum", "thistle", "slateblue1"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
  "9 drinks", "10 drinks", "12 drinks", "15 drinks", "20 drinks", "22 drinks", "24 drinks")) +
  theme_void() 

ggarrange(dac.pie.ftl.15, dac.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))          

### Degree to Which Condition Limits Normal Daily Activities ==================================================================== 

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 3 (Somewhat); 5 (Just a little); 7 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA150883)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150883 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150883 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150883 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150883 = 8)) 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150883 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150883 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150883 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150883 = 9)) 

T15_DCN_FTLW <- TIAS[, c("TA150883", "FTL_COUNT")] %>% group_by(TA150883, FTL_COUNT) %>% summarise(Count = n())

T15_DCN_FTLW <- T15_DCN_FTLW[1:16, ]

T15_DCN_CAT <- TIAS2015[, c("TA150883", "CAT")] %>% group_by(TA150883, CAT) %>% summarise(Count = n())

T15_DCN_CAT <- T15_DCN_CAT[1:9, ]

T15_DCN_FTLCAT <- TIAS2015_FTL[, c("TA150883", "CAT")] %>% group_by(TA150883, CAT) %>% summarise(Count = n())


T15_DCN_IACCAT <- TIAS2015_IAC[, c("TA150883", "CAT")] %>% group_by(TA150883, CAT) %>% summarise(Count = n())

T15_DCN_IACCAT <- T15_DCN_IACCAT[1:5, ]

head(T15_DCN_CAT, 10)

ggplot(T15_DCN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150883)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T15_DCN_FTLW, 16)

ggplot(T15_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150883)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

prop.table(table(TIAS2015_FTL$TA150883))

dcn.pie.ftl.15 <- ggplot(data = T15_DCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150883))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "mediumturquoise", "deepskyblue"), 
  labels = c("Inap: No chronic condition", "A lot", "Just a little", "Not at all")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150883))

dcn.pie.iac.15 <- ggplot(data = T15_DCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150883))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1"), 
  labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all")) +
  theme_void() 

ggarrange(dcn.pie.ftl.15, dcn.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150892)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150892 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150892 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150892 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150892 = 8)) 
  
  
TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150892 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150892 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150892 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150892 = 9)) 

T15_DEP_FTLW <- TIAS[, c("TA150892", "FTL_COUNT")] %>% group_by(TA150892, FTL_COUNT) %>% summarise(Count = n())

T15_DEP_FTLW <- T15_DEP_FTLW[1:8, ]

T15_DEP_CAT <- TIAS2015[, c("TA150892", "CAT")] %>% group_by(TA150892, CAT) %>% summarise(Count = n())

T15_DEP_CAT <- T15_DEP_CAT[1:4, ]

T15_DEP_FTLCAT <- TIAS2015_FTL[, c("TA150892", "CAT")] %>% group_by(TA150892, CAT) %>% summarise(Count = n())

T15_DEP_FTLCAT= T15_DEP_FTLCAT[1:2, ]

T15_DEP_IACCAT <- TIAS2015_IAC[, c("TA150892", "CAT")] %>% group_by(TA150892, CAT) %>% summarise(Count = n())

T15_DEP_IACCAT <- T15_DEP_IACCAT[1:2, ]

head(T15_DEP_CAT, 4)

ggplot(T15_DEP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150892)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No"))

head(T15_DEP_FTLW, 8)

ggplot(T15_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150892)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150892))

dep.pie.ftl.15 <- ggplot(data = T15_DEP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150892))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150892))

dep.pie.iac.15 <- ggplot(data = T15_DEP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150892))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2", "rosybrown1"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(dep.pie.ftl.15, dep.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)

table(TIAS$TA150893)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150893 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150893 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150893 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150893 = 8)) 
  
  
TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150893 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150893 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150893 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150893 = 9)) 


T15_ANH_FTLW <- TIAS[, c("TA150893", "FTL_COUNT")] %>% group_by(TA150893, FTL_COUNT) %>% summarise(Count = n())

T15_ANH_FTLW <- T15_ANH_FTLW[1:12,]

T15_ANH_CAT <- TIAS2015[, c("TA150893", "CAT")] %>% group_by(TA150893, CAT) %>% summarise(Count = n())

T15_ANH_CAT = T15_ANH_CAT[1:6, ]

T15_ANH_FTLCAT <- TIAS2015_FTL[, c("TA150893", "CAT")] %>% group_by(TA150893, CAT) %>% summarise(Count = n())

T15_ANH_FTLCAT=T15_ANH_FTLCAT[1:3, ]

T15_ANH_IACCAT <- TIAS2015_IAC[, c("TA150893", "CAT")] %>% group_by(TA150893, CAT) %>% summarise(Count = n())

T15_ANH_IACCAT = T15_ANH_IACCAT[1:3, ]

table(TIAS2015$TA150893, TIAS2015$CAT)

ggplot(T15_ANH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150893)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue"), labels = c("Has had two weeks or longer of feeling sad, empty, or depressed nearly every day for most of the day in the past 12 months", "Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150893))

anh.pie.ftl.15 <- ggplot(data = T15_ANH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150893))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue", "gold"), labels = c("Inap", "Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150893))

anh.pie.iac.15 <- ggplot(data = T15_ANH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150893))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue"), labels = c("Inap", "Yes", "No")) + 
  theme_void() 

ggarrange(anh.pie.ftl.15, anh.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA150867)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150867 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150867 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150867 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150867 = c(8, 9))) 

T15_DPD_FTLW <- TIAS[, c("TA150867", "FTL_COUNT")] %>% group_by(TA150867, FTL_COUNT) %>% summarise(Count = n())

T15_DPD_FTLW <- T15_DPD_FTLW[1:8, ]

T15_DPD_CAT <- TIAS2015[, c("TA150867", "CAT")] %>% group_by(TA150867, CAT) %>% summarise(Count = n())

T15_DPD_CAT <- T15_DPD_CAT[1:4, ]

T15_DPD_FTLCAT <- TIAS2015_FTL[, c("TA150867", "CAT")] %>% group_by(TA150867, CAT) %>% summarise(Count = n())

T15_DPD_FTLCAT=T15_DPD_FTLCAT[1:2, ]

T15_DPD_IACCAT <- TIAS2015_IAC[, c("TA150867", "CAT")] %>% group_by(TA150867, CAT) %>% summarise(Count = n())

T15_DPD_IACCAT <- T15_DPD_IACCAT[1:2, ]
  
head(T15_DPD_CAT, 4)

prop.table(table(TIAS2015_FTL$TA150867))
prop.table(table(TIAS2015_IAC$TA150867))

ggplot(T15_DPD_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150867)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T15_DPD_FTLW, 8)

ggplot(T15_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150867)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA150868)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150868 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150868 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150868 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150868 = c(8, 9))) 

T15_BIP_FTLW <- TIAS[, c("TA150868", "FTL_COUNT")] %>% group_by(TA150868, FTL_COUNT) %>% summarise(Count = n())

T15_BIP_FTLW <- T15_BIP_FTLW[1:8, ]

T15_BIP_CAT <- TIAS2015[, c("TA150868", "CAT")] %>% group_by(TA150868, CAT) %>% summarise(Count = n())

T15_BIP_CAT <- T15_BIP_CAT[1:3, ]

T15_BIP_FTLCAT <- TIAS2015_FTL[, c("TA150868", "CAT")] %>% group_by(TA150868, CAT) %>% summarise(Count = n())

T15_BIP_IACCAT <- TIAS2015_IAC[, c("TA150868", "CAT")] %>% group_by(TA150868, CAT) %>% summarise(Count = n())

T15_BIP_IACCAT <- T15_BIP_IACCAT[1:2, ]

head(T15_BIP_CAT, 3)

ggplot(T15_BIP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150868)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T15_BIP_FTLW, 8)

ggplot(T15_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150868)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))
  
prop.table(table(TIAS2015_FTL$TA150868))

prop.table(table(TIAS2015_IAC$TA150868))

### Phobia Diagnosis =============================================================================================================

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA150871)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150871 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150871 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150871 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150871 = c(8, 9))) 

T15_PHB_FTLW <- TIAS[, c("TA150871", "FTL_COUNT")] %>% group_by(TA150871, FTL_COUNT) %>% summarise(Count = n())

T15_PHB_FTLW <- T15_PHB_FTLW[1:6, ]

T15_PHB_CAT <- TIAS2015[, c("TA150871", "CAT")] %>% group_by(TA150871, CAT) %>% summarise(Count = n())

T15_PHB_CAT <- T15_PHB_CAT[1:3, ]

T15_PHB_FTLCAT <- TIAS2015_FTL[, c("TA150871", "CAT")] %>% group_by(TA150871, CAT) %>% summarise(Count = n())

T15_PHB_FTLCAT = T15_PHB_FTLCAT[1:1, ] 

T15_PHB_IACCAT <- TIAS2015_IAC[, c("TA150871", "CAT")] %>% group_by(TA150871, CAT) %>% summarise(Count = n())

T15_PHB_IACCAT <- T15_PHB_IACCAT[1:2, ]

head(T15_PHB_CAT, 2)

ggplot(T15_PHB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150871)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T15_PHB_FTLW, 6)

ggplot(T15_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150871)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))
  
prop.table(table(TIAS2015_FTL$TA150871))

prop.table(table(TIAS2015_IAC$TA150871))

### Anxiety Disorders Diagnosis ==================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA150870)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150870 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150870 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150870 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150870 = c(8, 9))) 

T15_ANX_FTLW <- TIAS[, c("TA150870", "FTL_COUNT")] %>% group_by(TA150870, FTL_COUNT) %>% summarise(Count = n())

T15_ANX_FTLW <- T15_ANX_FTLW[1:7, ]

T15_ANX_CAT <- TIAS2015[, c("TA150870", "CAT")] %>% group_by(TA150870, CAT) %>% summarise(Count = n())

T15_ANX_CAT <- T15_ANX_CAT[1:4, ]

T15_ANX_FTLCAT <- TIAS2015_FTL[, c("TA150870", "CAT")] %>% group_by(TA150870, CAT) %>% summarise(Count = n())

T15_ANX_FTLCAT = T15_ANX_FTLCAT[1:2, ]

T15_ANX_IACCAT <- TIAS2015_IAC[, c("TA150870", "CAT")] %>% group_by(TA150870, CAT) %>% summarise(Count = n())

T15_ANX_IACCAT <- T15_ANX_IACCAT[1:2, ]

head(T15_ANX_CAT, 4)

ggplot(T15_ANX_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150870)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T15_ANX_FTLW, 7)

ggplot(T15_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150870)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2015_FTL$TA150870))

anx.pie.ftl.15 <- ggplot(data = T15_ANX_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150870))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed")) + 
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150870))

anx.pie.iac.15 <- ggplot(data = T15_ANX_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150870))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed")) + 
  theme_void() 

ggarrange(anx.pie.ftl.15, anx.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### OCD Diagnosis ================================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA150874)

T15_OCD_FTLW <- TIAS[, c("TA150874", "FTL_COUNT")] %>% group_by(TA150874, FTL_COUNT) %>% summarise(Count = n())

T15_OCD_FTLW <- T15_OCD_FTLW[1:6, ]

T15_OCD_CAT <- TIAS2015[, c("TA150874", "CAT")] %>% group_by(TA150874, CAT) %>% summarise(Count = n())

T15_OCD_CAT <- T15_OCD_CAT[1:3, ]

T15_OCD_FTLCAT <- TIAS2015_FTL[, c("TA150874", "CAT")] %>% group_by(TA150874, CAT) %>% summarise(Count = n())

T15_OCD_FTLCAT = T15_OCD_FTLCAT[1:1, ]

T15_OCD_IACCAT <- TIAS2015_IAC[, c("TA150874", "CAT")] %>% group_by(TA150874, CAT) %>% summarise(Count = n())

T15_OCD_IACCAT <- T15_OCD_IACCAT[1:2, ]

head(T15_OCD_CAT, 3)

ggplot(T15_OCD_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150874)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

head(T15_OCD_FTLW, 6)

ggplot(T15_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150874)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon"), labels = c("Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2015_FTL$TA150874))

prop.table(table(TIAS2015_IAC$TA150874))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA151277)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151277 = 99)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151277 = 99)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151277 = 99)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151277 = 99)) 

T15_NPD_FTLW <- TIAS[, c("TA151277", "FTL_COUNT")] %>% group_by(TA151277, FTL_COUNT) %>% summarise(Count = n())

T15_NPD_FTLW <- T15_NPD_FTLW[1:61, ]

T15_NPD_CAT <- TIAS2015[, c("TA151277", "CAT")] %>% group_by(TA151277, CAT) %>% summarise(Count = n())

T15_NPD_CAT <- T15_NPD_CAT[1:39, ]

ggplot(T15_NPD_FTLW, aes(x = FTL_COUNT, y = TA151277, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_NPD_CAT, aes(x = CAT, y = TA151277, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))
  
prop.table(table(TIAS2015_FTL$TA151277))

prop.table(table(TIAS2015_IAC$TA151277))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA151272)

T15_SOA_FTLW <- TIAS[, c("TA151272", "FTL_COUNT")] %>% group_by(TA151272, FTL_COUNT) %>% summarise(Count = n())

T15_SOA_FTLW <- T15_SOA_FTLW[1:28, ]

T15_SOA_CAT <- TIAS2015[, c("TA151272", "CAT")] %>% group_by(TA151272, CAT) %>% summarise(Count = n())

ggplot(T15_SOA_FTLW, aes(x = FTL_COUNT, y = TA151272, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SOA_CAT, aes(x = CAT, y = TA151272, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))


prop.table(table(TIAS2015_FTL$TA151272))

prop.table(table(TIAS2015_IAC$TA151272))

### Mental Health: Worry =========================================================================================================

####
# Cumulative score from answers to 'Mental Health: Worry' section questions:
# (how often worry about money/future job/feel discouraged about future)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA151271)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151271 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151271 = 9)) 

T15_WRY_FTLW <- TIAS[, c("TA151271", "FTL_COUNT")] %>% group_by(TA151271, FTL_COUNT) %>% summarise(Count = n())

T15_WRY_FTLW <- T15_WRY_FTLW[1:29, ]

T15_WRY_CAT <- TIAS2015[, c("TA151271", "CAT")] %>% group_by(TA151271, CAT) %>% summarise(Count = n())

T15_WRY_CAT <- T15_WRY_CAT[1:14, ]

ggplot(T15_WRY_FTLW, aes(x = FTL_COUNT, y = TA151271, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_WRY_CAT, aes(x = CAT, y = TA151271, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "MH-Worry Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2015_FTL$TA151271))

prop.table(table(TIAS2015_IAC$TA151271))

### Paid Employment Since Jan 1 of Prior Year ====================================================================================

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA150132)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150132 = c(8, 9))) 

T15_EPJ_FTLW <- TIAS[, c("TA150132", "FTL_COUNT")] %>% group_by(TA150132, FTL_COUNT) %>% summarise(Count = n())

T15_EPJ_FTLW <- T15_EPJ_FTLW[1:14, ]

T15_EPJ_CAT <- TIAS2015[, c("TA150132", "CAT")] %>% group_by(TA150132, CAT) %>% summarise(Count = n())

T15_EPJ_CAT = T15_EPJ_CAT[1:6, ]

T15_EPJ_FTLCAT <- TIAS2015_FTL[, c("TA150132", "CAT")] %>% group_by(TA150132, CAT) %>% summarise(Count = n())

T15_EPJ_FTLCAT = T15_EPJ_FTLCAT[1:3, ]

T15_EPJ_IACCAT <- TIAS2015_IAC[, c("TA150132", "CAT")] %>% group_by(TA150132, CAT) %>% summarise(Count = n())

T15_EPJ_IACCAT=T15_EPJ_IACCAT[1:3, ]

head(T15_EPJ_CAT, 6)

ggplot(T15_EPJ_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150132)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T15_EPJ_FTLW, 14)

ggplot(T15_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150132)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2015_FTL$TA150132))

epj.pie.ftl.15 <- ggplot(data = T15_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150132))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) + theme_void() 

prop.table(table(TIAS2015_IAC$TA150132))

epj.pie.iac.15 <- ggplot(data = T15_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150132))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.15, epj.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA150349)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150349 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150349 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150349 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150349 = c(8, 9))) 

T15_EPH_FTLW <- TIAS[, c("TA150349", "FTL_COUNT")] %>% group_by(TA150349, FTL_COUNT) %>% summarise(Count = n())

T15_EPH_FTLW <- T15_EPH_FTLW[1:14, ]

T15_EPH_CAT <- TIAS2015[, c("TA150349", "CAT")] %>% group_by(TA150349, CAT) %>% summarise(Count = n())

T15_EPH_CAT = T15_EPH_CAT[1:6, ]

T15_EPH_FTLCAT <- TIAS2015_FTL[, c("TA150349", "CAT")] %>% group_by(TA150349, CAT) %>% summarise(Count = n())

T15_EPH_FTLCAT = T15_EPH_FTLCAT[1:3, ]

T15_EPH_IACCAT <- TIAS2015_IAC[, c("TA150349", "CAT")] %>% group_by(TA150349, CAT) %>% summarise(Count = n())

T15_EPH_IACCAT=T15_EPH_IACCAT[1:3, ]

head(T15_EPH_CAT, 6)

ggplot(T15_EPH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150349)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Inap", "Yes", "No"))

head(T15_EPH_FTLW, 14)

ggplot(T15_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150349)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2015_FTL$TA150349))

eph.pie.ftl.15 <- ggplot(data = T15_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150349))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150349))

eph.pie.iac.15 <- ggplot(data = T15_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150349))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.15, eph.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Current Marital Status =======================================================================================================

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150070)

T15_CMS_FTLW <- TIAS[, c("TA150070", "FTL_COUNT")] %>% group_by(TA150070, FTL_COUNT) %>% summarise(Count = n())

T15_CMS_FTLW <- T15_CMS_FTLW[1:12, ]

T15_CMS_CAT <- TIAS2015[, c("TA150070", "CAT")] %>% group_by(TA150070, CAT) %>% summarise(Count = n())

T15_CMS_CAT = T15_CMS_CAT[1:7, ]

T15_CMS_FTLCAT <- TIAS2015_FTL[, c("TA150070", "CAT")] %>% group_by(TA150070, CAT) %>% summarise(Count = n())

T15_CMS_FTLCAT=T15_CMS_FTLCAT[1:3, ]

T15_CMS_IACCAT <- TIAS2015_IAC[, c("TA150070", "CAT")] %>% group_by(TA150070, CAT) %>% summarise(Count = n())

T15_CMS_IACCAT = T15_CMS_IACCAT[1:4, ]

head(T15_CMS_CAT, 7)

ggplot(T15_CMS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Divorced", "Separated"))

head(T15_CMS_FTLW, 15)

ggplot(T15_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Divorced", "Separated"))

prop.table(table(TIAS2015_FTL$TA150070))
prop.table(table(TIAS2015_IAC$TA150070))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA150079)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150079 = c(8, 9))) 


T15_RRN_FTLW <- TIAS[, c("TA150079", "FTL_COUNT")] %>% group_by(TA150079, FTL_COUNT) %>% summarise(Count = n())

T15_RRN_FTLW <- T15_RRN_FTLW[1:13, ]

T15_RRN_CAT <- TIAS2015[, c("TA150079", "CAT")] %>% group_by(TA150079, CAT) %>% summarise(Count = n())

T15_RRN_CAT = T15_RRN_CAT[1:6, ]

T15_RRN_FTLCAT <- TIAS2015_FTL[, c("TA150079", "CAT")] %>% group_by(TA150079, CAT) %>% summarise(Count = n())

T15_RRN_FTLCAT = T15_RRN_FTLCAT[1:3, ]

T15_RRN_IACCAT <- TIAS2015_IAC[, c("TA150079", "CAT")] %>% group_by(TA150079, CAT) %>% summarise(Count = n())

T15_RRN_IACCAT = T15_RRN_IACCAT[1:3, ]

head(T15_RRN_CAT, 6)

ggplot(T15_RRN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150079)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No", "DK", "NA/Refused"))

head(T15_RRN_FTLW, 13)

ggplot(T15_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150079)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
 scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150079))

rrn.pie.ftl.15 <- ggplot(data = T15_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150079))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No")) + theme_void()

prop.table(table(TIAS2015_IAC$TA150079))

rrn.pie.iac.15 <- ggplot(data = T15_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150079))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.15, rrn.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Number of Children ===========================================================================================================

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA150092)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150092 = 98)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150092 = 98)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150092 = 98)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150092 = 98)) 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150092 = 99)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150092 = 99)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150092 = 99)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150092 = 99)) 

T15_CHL_FTLW <- TIAS[, c("TA150092", "FTL_COUNT")] %>% group_by(TA150092, FTL_COUNT) %>% summarise(Count = n())

T15_CHL_FTLW <- T15_CHL_FTLW[1:25, ]

T15_CHL_CAT <- TIAS2015[, c("TA150092", "CAT")] %>% group_by(TA150092, CAT) %>% summarise(Count = n())

T15_CHL_CAT <- T15_CHL_CAT[1:16, ]

ggplot(T15_CHL_FTLW, aes(x = FTL_COUNT, y = TA150092, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_CHL_CAT, aes(x = CAT, y = TA150092, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 0 (Inap.: TA alumnus and reported education last wave); 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150701)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150701 = c(0, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150701 = c(0, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150701 = c(0, 9))) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150701 = c(0, 9))) 


T15_HSG_FTLW <- TIAS[, c("TA150701", "FTL_COUNT")] %>% group_by(TA150701, FTL_COUNT) %>% summarise(Count = n())

T15_HSG_FTLW <- T15_HSG_FTLW[1:18, ]

T15_HSG_CAT <- TIAS2015[, c("TA150701", "CAT")] %>% group_by(TA150701, CAT) %>% summarise(Count = n())

T15_HSG_CAT <- T15_HSG_CAT[1:8, ]

T15_HSG_FTLCAT <- TIAS2015_FTL[, c("TA150701", "CAT")] %>% group_by(TA150701, CAT) %>% summarise(Count = n())

T15_HSG_FTLCAT=T15_HSG_FTLCAT[1:4, ]

T15_HSG_IACCAT <- TIAS2015_IAC[, c("TA150701", "CAT")] %>% group_by(TA150701, CAT) %>% summarise(Count = n())

T15_HSG_IACCAT <- T15_HSG_IACCAT[1:4, ]

head(T15_HSG_CAT, 8)

ggplot(T15_HSG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150701)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither"))

head(T15_HSG_FTLW, 18)

ggplot(T15_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150701)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "HS Diploma", "GED", "Neither"))

prop.table(table(TIAS2015_FTL$TA150701))

hsg.pie.ftl.15 <- ggplot(data = T15_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150701))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "Diploma", "GED", "Neither")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150701))

hsg.pie.iac.15 <- ggplot(data = T15_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150701))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink", "sienna1", "rosybrown1"), labels = c("Reported last wave", "Diploma", "GED", "Neither")) +
  theme_void() 

ggarrange(hsg.pie.ftl.15, hsg.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### College Education ============================================================================================================ 

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: did not complete high school or receive a GED)
####

table(TIAS$TA150730)

T15_CLG_FTLW <- TIAS[, c("TA150730", "FTL_COUNT")] %>% group_by(TA150730, FTL_COUNT) %>% summarise(Count = n())

T15_CLG_FTLW <- T15_CLG_FTLW[1:13, ]

T15_CLG_CAT <- TIAS2015[, c("TA150730", "CAT")] %>% group_by(TA150730, CAT) %>% summarise(Count = n())

T15_CLG_CAT <- T15_CLG_CAT[1:6, ]

T15_CLG_FTLCAT <- TIAS2015_FTL[, c("TA150730", "CAT")] %>% group_by(TA150730, CAT) %>% summarise(Count = n())

T15_CLG_FTLCAT=T15_CLG_FTLCAT[1:3, ]

T15_CLG_IACCAT <- TIAS2015_IAC[, c("TA150730", "CAT")] %>% group_by(TA150730, CAT) %>% summarise(Count = n())

T15_CLG_IACCAT <- T15_CLG_IACCAT[1:3, ]

head(T15_CLG_CAT, 6)

ggplot(T15_CLG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150730)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") +
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "Yes", "No"))

head(T15_CLG_FTLW, 13)

ggplot(T15_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150730)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150730))

clg.pie.ftl.15 <- ggplot(data = T15_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150730))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "Yes", "No")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA150730))

clg.pie.iac.15 <- ggplot(data = T15_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150730))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Attended College", "Graduated HS", "No HS Diploma or GED")) +
  theme_void() 

ggarrange(clg.pie.ftl.15, clg.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 99 (NA/DK)
####

table(TIAS$TA151285)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151285 = 99)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151285 = 99)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151285 = 99)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151285 = 99))  

T15_HEL_FTLW <- TIAS[, c("TA151285", "FTL_COUNT")] %>% group_by(TA151285, FTL_COUNT) %>% summarise(Count = n())

T15_HEL_FTLW <- T15_HEL_FTLW[1:33, ]

T15_HEL_CAT <- TIAS2015[, c("TA151285", "CAT")] %>% group_by(TA151285, CAT) %>% summarise(Count = n())

T15_HEL_CAT <- T15_HEL_CAT[1:19, ]

T15_HEL_FTLCAT <- TIAS2015_FTL[, c("TA151285", "CAT")] %>% group_by(TA151285, CAT) %>% summarise(Count = n())

T15_HEL_FTLCAT <- T15_HEL_FTLCAT[1:8, ]

T15_HEL_IACCAT <- TIAS2015_IAC[, c("TA151285", "CAT")] %>% group_by(TA151285, CAT) %>% summarise(Count = n())

T15_HEL_IACCAT <- T15_HEL_IACCAT[1:11, ]

head(T15_HEL_CAT, 18)

ggplot(T15_HEL_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151285))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
             "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

head(T15_HEL_FTLW, 36)

ggplot(T15_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151285)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
             "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

prop.table(table(TIAS2015_FTL$TA151285))

hel.pie.ftl.15 <- ggplot(data = T15_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151285))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
             "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

prop.table(table(TIAS2015_IAC$TA151285))

hel.pie.iac.15 <- ggplot(data = T15_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151285))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
  labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
             "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

ggarrange(hel.pie.ftl.15, hel.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Responsibility - Earning Own Living ==========================================================================================

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150045)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150045 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150045 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150045 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150045 = c(8, 9))) 

T15_REO_FTLW <- TIAS[, c("TA150045", "FTL_COUNT")] %>% group_by(TA150045, FTL_COUNT) %>% summarise(Count = n())

T15_REO_FTLW <- T15_REO_FTLW[1:20, ]

T15_REO_CAT <- TIAS2015[, c("TA150045", "CAT")] %>% group_by(TA150045, CAT) %>% summarise(Count = n())

T15_REO_CAT=T15_REO_CAT[1:10, ]

T15_REO_FTLCAT <- TIAS2015_FTL[, c("TA150045", "CAT")] %>% group_by(TA150045, CAT) %>% summarise(Count = n())

T15_REO_FTLCAT=T15_REO_FTLCAT[1:5, ]

T15_REO_IACCAT <- TIAS2015_IAC[, c("TA150045", "CAT")] %>% group_by(TA150045, CAT) %>% summarise(Count = n())

T15_REO_IACCAT=T15_REO_IACCAT[1:5, ]

head(T15_REO_CAT, 10)

ggplot(T15_REO_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T15_REO_FTLW, 20)

ggplot(T15_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150045)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2015_FTL$TA150045))

reo.pie.ftl.15 <- ggplot(data = T15_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2015_IAC$TA150045))

reo.pie.iac.15 <- ggplot(data = T15_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150045))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("lightcoral", "mediumturquoise", "deepskyblue", "gold", "green3", "sienna1"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "DK")) + 
  theme_void()

ggarrange(reo.pie.ftl.15, reo.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Responsibility - Paying Own Rent =============================================================================================

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150046)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150046 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150046 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150046 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150046 = c(8, 9))) 

T15_POR_FTLW <- TIAS[, c("TA150046", "FTL_COUNT")] %>% group_by(TA150046, FTL_COUNT) %>% summarise(Count = n())

T15_POR_FTLW <- T15_POR_FTLW[1:24, ]

T15_POR_CAT <- TIAS2015[, c("TA150046", "CAT")] %>% group_by(TA150046, CAT) %>% summarise(Count = n())

T15_POR_CAT <- T15_POR_CAT[1:12, ]

T15_POR_FTLCAT <- TIAS2015_FTL[, c("TA150046", "CAT")] %>% group_by(TA150046, CAT) %>% summarise(Count = n())

T15_POR_FTLCAT=T15_POR_FTLCAT[1:6, ]

T15_POR_IACCAT <- TIAS2015_IAC[, c("TA150046", "CAT")] %>% group_by(TA150046, CAT) %>% summarise(Count = n())

T15_POR_IACCAT <- T15_POR_IACCAT[1:6, ]

head(T15_POR_CAT, 12)

ggplot(T15_POR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments", "Refused"))

head(T15_POR_FTLW, 24)

ggplot(T15_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150046)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2015_FTL$TA150046))

por.pie.ftl.15 <- ggplot(data = T15_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments", "Refused"))  + theme_void()

prop.table(table(TIAS2015_IAC$TA150046))

por.pie.iac.15 <- ggplot(data = T15_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150046))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments", "Refused"))  + theme_void()

ggarrange(por.pie.ftl.15, por.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Responsibility - Paying Own Bills ============================================================================================

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150047)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150047 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150047 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150047 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150047 = c(8, 9))) 

T15_POB_FTLW <- TIAS[, c("TA150047", "FTL_COUNT")] %>% group_by(TA150047, FTL_COUNT) %>% summarise(Count = n())

T15_POB_FTLW <- T15_POB_FTLW[1:24, ]

T15_POB_CAT <- TIAS2015[, c("TA150047", "CAT")] %>% group_by(TA150047, CAT) %>% summarise(Count = n())

T15_POB_CAT = T15_POB_CAT [1:12, ]

T15_POB_FTLCAT <- TIAS2015_FTL[, c("TA150047", "CAT")] %>% group_by(TA150047, CAT) %>% summarise(Count = n())

T15_POB_FTLCAT = T15_POB_FTLCAT[1:6, ]

T15_POB_IACCAT <- TIAS2015_IAC[, c("TA150047", "CAT")] %>% group_by(TA150047, CAT) %>% summarise(Count = n())

T15_POB_IACCAT = T15_POB_IACCAT[1:6, ]

head(T15_POB_CAT, 12)

ggplot(T15_POB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

head(T15_POB_FTLW, 24)

ggplot(T15_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150047)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))

prop.table(table(TIAS2015_FTL$TA150047))

pob.pie.ftl.15 <- ggplot(data = T15_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))
                    

prop.table(table(TIAS2015_IAC$TA150047))

pob.pie.iac.15 <- ggplot(data = T15_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150047))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No bills"))  

ggarrange(pob.pie.ftl.15, pob.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150048)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150048 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150048 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150048 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150048 = c(8, 9)))
  
T15_RMM_FTLW <- TIAS[, c("TA150048", "FTL_COUNT")] %>% group_by(TA150048, FTL_COUNT) %>% summarise(Count = n())

T15_RMM_FTLW <- T15_RMM_FTLW[1:21, ]

T15_RMM_CAT <- TIAS2015[, c("TA150048", "CAT")] %>% group_by(TA150048, CAT) %>% summarise(Count = n())

T15_RMM_CAT=T15_RMM_CAT[1:10, ]

T15_RMM_FTLCAT <- TIAS2015_FTL[, c("TA150048", "CAT")] %>% group_by(TA150048, CAT) %>% summarise(Count = n())

T15_RMM_FTLCAT=T15_RMM_FTLCAT[1:5, ]

T15_RMM_IACCAT <- TIAS2015_IAC[, c("TA150048", "CAT")] %>% group_by(TA150048, CAT) %>% summarise(Count = n())

T15_RMM_IACCAT=T15_RMM_IACCAT[1:5, ]

head(T15_RMM_CAT, 10)

ggplot(T15_RMM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T15_RMM_FTLW, 21)

ggplot(T15_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150048)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1", "lightpink"), 
                    labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2015_FTL$TA150048))

rmm.pie.ftl.15 <- ggplot(data = T15_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150048))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1", "lightpink"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

prop.table(table(TIAS2015_IAC$TA150048))

rmm.pie.iac.15 <- ggplot(data = T15_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150048))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
   scale_fill_manual("Responsibility - Managing Money", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "sienna1", "lightpink"),
  labels = c("Never", "Sometimes", "Half of the time", "Most of the time", "All of the time")) +
  theme_void()

ggarrange(rmm.pie.ftl.15, rmm.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### How Good at Taking Responsibility for Actions ================================================================================

####
# B6A. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at taking responsibility for your actions?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150049)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150049 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150049 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150049 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150049 = c(8, 9)))

T15_ROA_FTLW <- TIAS[, c("TA150049", "FTL_COUNT")] %>% group_by(TA150049, FTL_COUNT) %>% summarise(Count = n())

T15_ROA_FTLW <- T15_ROA_FTLW[1:21, ]

T15_ROA_CAT <- TIAS2015[, c("TA150049", "CAT")] %>% group_by(TA150049, CAT) %>% summarise(Count = n())

ggplot(T15_ROA_FTLW, aes(x = FTL_COUNT, y = TA150049, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_ROA_CAT, aes(x = CAT, y = TA150049, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Taking Responsibility for Actions - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Money Management =================================================================================================

####
# B6C. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at managing money?
# Answers: 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150051)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150051 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150051 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150051 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150051 = c(8, 9)))

T15_GMM_FTLW <- TIAS[, c("TA150051", "FTL_COUNT")] %>% group_by(TA150051, FTL_COUNT) %>% summarise(Count = n())

T15_GMM_FTLW <- T15_GMM_FTLW[1:28, ]

T15_GMM_CAT <- TIAS2015[, c("TA150051", "CAT")] %>% group_by(TA150051, CAT) %>% summarise(Count = n())

ggplot(T15_GMM_FTLW, aes(x = FTL_COUNT, y = TA150051, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_GMM_CAT, aes(x = CAT, y = TA150051, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### How Good at Paying Off Credit Card Balances ==================================================================================

####
# B6D. On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well", how good are you at paying off credit card balances each month?
# Answers: 0 (does not have a credit card); 1-7 (Values range from 1 to 7; 1 represents "not at all well" and 7 represents "extremely well"); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA150052)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150052 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150052 = c(8, 9))) 

T15_CCB_FTLW <- TIAS[, c("TA150052", "FTL_COUNT")] %>% group_by(TA150052, FTL_COUNT) %>% summarise(Count = n())

T15_CCB_FTLW <- T15_CCB_FTLW[1:33, ]

T15_CCB_CAT <- TIAS2015[, c("TA150052", "CAT")] %>% group_by(TA150052, CAT) %>% summarise(Count = n())

T15_CCB_CAT <- T15_CCB_CAT[1:16, ]

ggplot(T15_CCB_FTLW, aes(x = FTL_COUNT, y = TA150052, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Paying off Credit Card Balances - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_CCB_CAT, aes(x = CAT, y = TA150052, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "How Good at Money Management - Self-Rating (1 = Not at all well; 7 = Extremely Well)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))

### MIDUS M1 - Happiness =========================================================================================================

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151137)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151137 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151137 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151137 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151137 = c(8, 9))) 


T15_M01_FTLW <- TIAS[, c("TA151137", "FTL_COUNT")] %>% group_by(TA151137, FTL_COUNT) %>% summarise(Count = n())

T15_M01_FTLW <- T15_M01_FTLW[1:22, ]

T15_M01_CAT <- TIAS2015[, c("TA151137", "CAT")] %>% group_by(TA151137, CAT) %>% summarise(Count = n())

T15_M01_CAT=T15_M01_CAT[1:12, ]

T15_M01_FTLCAT <- TIAS2015_FTL[, c("TA151137", "CAT")] %>% group_by(TA151137, CAT) %>% summarise(Count = n())

T15_M01_FTLCAT=T15_M01_FTLCAT[1:6, ]

T15_M01_IACCAT <- TIAS2015_IAC[, c("TA151137", "CAT")] %>% group_by(TA151137, CAT) %>% summarise(Count = n())

T15_M01_IACCAT=T15_M01_IACCAT[1:6, ]

head(T15_M01_CAT, 12)

ggplot(T15_M01_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151137)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M01_FTLW, 22)

ggplot(T15_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151137)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151137))

m01.pie.ftl.15 <- ggplot(data = T15_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151137))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2015_IAC$TA151137))

m01.pie.iac.15 <- ggplot(data = T15_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151137))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.15, m01.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M2 - Interest in Life ==================================================================================================

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151138)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151138 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151138 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151138 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151138 = c(8, 9))) 

T15_M02_FTLW <- TIAS[, c("TA151138", "FTL_COUNT")] %>% group_by(TA151138, FTL_COUNT) %>% summarise(Count = n())

T15_M02_FTLW <- T15_M02_FTLW[1:23, ]

T15_M02_CAT <- TIAS2015[, c("TA151138", "CAT")] %>% group_by(TA151138, CAT) %>% summarise(Count = n())

T15_M02_CAT=T15_M02_CAT[1:12, ]

T15_M02_FTLCAT <- TIAS2015_FTL[, c("TA151138", "CAT")] %>% group_by(TA151138, CAT) %>% summarise(Count = n())

T15_M02_IACCAT <- TIAS2015_IAC[, c("TA151138", "CAT")] %>% group_by(TA151138, CAT) %>% summarise(Count = n())

T15_M02_IACCAT=T15_M02_IACCAT[1:6, ]

head(T15_M02_CAT, 12)

ggplot(T15_M02_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151138)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M02_FTLW, 21)

ggplot(T15_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151138)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151138))

m02.pie.ftl.15 <- ggplot(data = T15_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151138))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151138))

m02.pie.iac.15 <- ggplot(data = T15_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151138))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.15, m02.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M3 - Satisfaction ======================================================================================================

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151139)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151139 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151139 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151139 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151139 = 8)) 
  
TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151139 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151139 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151139 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151139 = 9)) 
  
T15_M03_FTLW <- TIAS[, c("TA151139", "FTL_COUNT")] %>% group_by(TA151139, FTL_COUNT) %>% summarise(Count = n())

T15_M03_FTLW <- T15_M03_FTLW[1:22, ]

T15_M03_CAT <- TIAS2015[, c("TA151139", "CAT")] %>% group_by(TA151139, CAT) %>% summarise(Count = n())

T15_M03_CAT = T15_M03_CAT[1:12, ]

T15_M03_FTLCAT <- TIAS2015_FTL[, c("TA151139", "CAT")] %>% group_by(TA151139, CAT) %>% summarise(Count = n())

T15_M03_FTLCAT = T15_M03_FTLCAT[1:6, ]

T15_M03_IACCAT <- TIAS2015_IAC[, c("TA151139", "CAT")] %>% group_by(TA151139, CAT) %>% summarise(Count = n())

T15_M03_IACCAT = T15_M03_IACCAT[1:6, ]

head(T15_M03_CAT, 12)

ggplot(T15_M03_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151139)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M03_FTLW, 22)

ggplot(T15_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151139)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151139))

m03.pie.ftl.15 <- ggplot(data = T15_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151139))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151139))

m03.pie.iac.15 <- ggplot(data = T15_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151139))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.15, m03.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M4 - Contribution of Something Important to Society ====================================================================

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151140)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151140 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151140 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151140 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151140 = 8)) 


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151140 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151140 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151140 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151140 = 9)) 

T15_M04_FTLW <- TIAS[, c("TA151140", "FTL_COUNT")] %>% group_by(TA151140, FTL_COUNT) %>% summarise(Count = n())

T15_M04_FTLW <- T15_M04_FTLW[1:26, ]

T15_M04_CAT <- TIAS2015[, c("TA151140", "CAT")] %>% group_by(TA151140, CAT) %>% summarise(Count = n())

T15_M04_CAT <- T15_M04_CAT[1:12, ]

T15_M04_FTLCAT <- TIAS2015_FTL[, c("TA151140", "CAT")] %>% group_by(TA151140, CAT) %>% summarise(Count = n())

T15_M04_FTLCAT <- T15_M04_FTLCAT[1:6, ]

T15_M04_IACCAT <- TIAS2015_IAC[, c("TA151140", "CAT")] %>% group_by(TA151140, CAT) %>% summarise(Count = n())

T15_M04_IACCAT = T15_M04_IACCAT[1:6, ]
head(T15_M04_CAT, 12)

ggplot(T15_M04_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M04_FTLW, 29)

ggplot(T15_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151140)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151140))

m04.pie.ftl.15 <- ggplot(data = T15_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151140))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151140))

m04.pie.iac.15 <- ggplot(data = T15_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151140))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.15, m04.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M5 - Belonging to Community ============================================================================================

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151141)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151141 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151141 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151141 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151141 = 8)) 


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151141 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151141 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151141 = 9)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151141 = 9))

T15_M05_FTLW <- TIAS[, c("TA151141", "FTL_COUNT")] %>% group_by(TA151141, FTL_COUNT) %>% summarise(Count = n())

T15_M05_FTLW <- T15_M05_FTLW[1:24, ]

T15_M05_CAT <- TIAS2015[, c("TA151141", "CAT")] %>% group_by(TA151141, CAT) %>% summarise(Count = n())

T15_M05_CAT = T15_M05_CAT[1:12, ]

T15_M05_FTLCAT <- TIAS2015_FTL[, c("TA151141", "CAT")] %>% group_by(TA151141, CAT) %>% summarise(Count = n())

T15_M05_FTLCAT = T15_M05_FTLCAT[1:6, ]

T15_M05_IACCAT <- TIAS2015_IAC[, c("TA151141", "CAT")] %>% group_by(TA151141, CAT) %>% summarise(Count = n())

T15_M05_IACCAT = T15_M05_IACCAT[1:6, ]

head(T15_M05_CAT, 12)

ggplot(T15_M05_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151141)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M05_FTLW, 24)

ggplot(T15_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151141)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151141))

m05.pie.ftl.15 <- ggplot(data = T15_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151141))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151141))

m05.pie.iac.15 <- ggplot(data = T15_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151141))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.15, m05.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M6 - Society Getting Better ============================================================================================

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151142)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151142 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151142 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151142 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151142 = c(8, 9)))  

T15_M06_FTLW <- TIAS[, c("TA151142", "FTL_COUNT")] %>% group_by(TA151142, FTL_COUNT) %>% summarise(Count = n())

T15_M06_FTLW <- T15_M06_FTLW[1:27, ]

T15_M06_CAT <- TIAS2015[, c("TA151142", "CAT")] %>% group_by(TA151142, CAT) %>% summarise(Count = n())

T15_M06_CAT <- T15_M06_CAT[1:12, ]

T15_M06_FTLCAT <- TIAS2015_FTL[, c("TA151142", "CAT")] %>% group_by(TA151142, CAT) %>% summarise(Count = n())

T15_M06_FTLCAT <- T15_M06_FTLCAT[1:6, ]

T15_M06_IACCAT <- TIAS2015_IAC[, c("TA151142", "CAT")] %>% group_by(TA151142, CAT) %>% summarise(Count = n())

T15_M06_IACCAT <- T15_M06_IACCAT[1:6, ]

head(T15_M06_CAT, 12)

ggplot(T15_M06_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151142)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M06_FTLW, 27)

ggplot(T15_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151142)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151142))

m06.pie.ftl.15 <- ggplot(data = T15_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151142))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151142))

m06.pie.iac.15 <- ggplot(data = T15_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151142))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.15, m06.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M7 - People Basically Good =============================================================================================

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151143)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151143 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151143 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151143 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151143 = c(8, 9))) 

T15_M07_FTLW <- TIAS[, c("TA151143", "FTL_COUNT")] %>% group_by(TA151143, FTL_COUNT) %>% summarise(Count = n())

T15_M07_FTLW <- T15_M07_FTLW[1:25, ]

T15_M07_CAT <- TIAS2015[, c("TA151143", "CAT")] %>% group_by(TA151143, CAT) %>% summarise(Count = n())

T15_M07_CAT <- T15_M07_CAT[1:12, ]

T15_M07_FTLCAT <- TIAS2015_FTL[, c("TA151143", "CAT")] %>% group_by(TA151143, CAT) %>% summarise(Count = n())

T15_M07_FTLCAT <- T15_M07_FTLCAT[1:6, ]

T15_M07_IACCAT <- TIAS2015_IAC[, c("TA151143", "CAT")] %>% group_by(TA151143, CAT) %>% summarise(Count = n())

T15_M07_IACCAT <- T15_M07_IACCAT[1:6, ]

head(T15_M07_CAT, 12)

ggplot(T15_M07_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151143)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M07_FTLW, 25)

ggplot(T15_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151143)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151143))

m07.pie.ftl.15 <- ggplot(data = T15_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151143))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151143))

m07.pie.iac.15 <- ggplot(data = T15_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151143))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.15, m07.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M8 - Way Society Makes Sense ===========================================================================================

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151144)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151144 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151144 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151144 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151144 = c(8, 9))) 

T15_M08_FTLW <- TIAS[, c("TA151144", "FTL_COUNT")] %>% group_by(TA151144, FTL_COUNT) %>% summarise(Count = n())

T15_M08_FTLW <- T15_M08_FTLW[1:26, ]

T15_M08_CAT <- TIAS2015[, c("TA151144", "CAT")] %>% group_by(TA151144, CAT) %>% summarise(Count = n())

T15_M08_CAT <- T15_M08_CAT[1:12, ]

T15_M08_FTLCAT <- TIAS2015_FTL[, c("TA151144", "CAT")] %>% group_by(TA151144, CAT) %>% summarise(Count = n())

T15_M08_FTLCAT <- T15_M08_FTLCAT[1:6, ]

T15_M08_IACCAT <- TIAS2015_IAC[, c("TA151144", "CAT")] %>% group_by(TA151144, CAT) %>% summarise(Count = n())

T15_M08_IACCAT <- T15_M08_IACCAT[1:6, ]

head(T15_M08_CAT, 15)

ggplot(T15_M08_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151144)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M08_FTLW, 23)

ggplot(T15_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151144)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151144))

m08.pie.ftl.15 <- ggplot(data = T15_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151144))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151144))

m08.pie.iac.15 <- ggplot(data = T15_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151144))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.15, m08.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151145)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151145 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151145 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151145 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151145 = c(8, 9))) 

T15_M09_FTLW <- TIAS[, c("TA151145", "FTL_COUNT")] %>% group_by(TA151145, FTL_COUNT) %>% summarise(Count = n())

T15_M09_FTLW <- T15_M09_FTLW[1:21, ]

T15_M09_CAT <- TIAS2015[, c("TA151145", "CAT")] %>% group_by(TA151145, CAT) %>% summarise(Count = n())

T15_M09_CAT = T15_M09_CAT [1:12, ]

T15_M09_FTLCAT <- TIAS2015_FTL[, c("TA151145", "CAT")] %>% group_by(TA151145, CAT) %>% summarise(Count = n())

T15_M09_FTLCAT = T15_M09_FTLCAT[1:6, ]

T15_M09_IACCAT <- TIAS2015_IAC[, c("TA151145", "CAT")] %>% group_by(TA151145, CAT) %>% summarise(Count = n())

T15_M09_IACCAT = T15_M09_IACCAT[1:6, ]

head(T15_M09_CAT, 12)

ggplot(T15_M09_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151145)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M09_FTLW, 21)

ggplot(T15_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151145)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151145))

m09.pie.ftl.15 <- ggplot(data = T15_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151145))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151145))

m09.pie.iac.15 <- ggplot(data = T15_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151145))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.15, m09.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M10 - Trusting Relationships w/ Others =================================================================================

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151146)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151146 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151146 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151146 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151146 = c(8, 9))) 


T15_M10_FTLW <- TIAS[, c("TA151146", "FTL_COUNT")] %>% group_by(TA151146, FTL_COUNT) %>% summarise(Count = n())

T15_M10_FTLW <- T15_M10_FTLW[1:25, ]

T15_M10_CAT <- TIAS2015[, c("TA151146", "CAT")] %>% group_by(TA151146, CAT) %>% summarise(Count = n())

T15_M10_CAT = T15_M10_CAT[1:12, ]

T15_M10_FTLCAT <- TIAS2015_FTL[, c("TA151146", "CAT")] %>% group_by(TA151146, CAT) %>% summarise(Count = n())

T15_M10_FTLCAT = T15_M10_FTLCAT[1:6, ]

T15_M10_IACCAT <- TIAS2015_IAC[, c("TA151146", "CAT")] %>% group_by(TA151146, CAT) %>% summarise(Count = n())

T15_M10_IACCAT = T15_M10_IACCAT[1:6, ]

head(T15_M10_CAT, 12)

ggplot(T15_M10_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151146)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M10_FTLW, 25)

ggplot(T15_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151146)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151146))

m10.pie.ftl.15 <- ggplot(data = T15_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151146))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151146))

m10.pie.iac.15 <- ggplot(data = T15_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151146))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.15, m10.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M11 - Challenged to Grow ===============================================================================================

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151147)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151147 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151147 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151147 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151147 = c(8, 9))) 

T15_M11_FTLW <- TIAS[, c("TA151147", "FTL_COUNT")] %>% group_by(TA151147, FTL_COUNT) %>% summarise(Count = n())

T15_M11_FTLW <- T15_M11_FTLW[1:22, ]

T15_M11_CAT <- TIAS2015[, c("TA151147", "CAT")] %>% group_by(TA151147, CAT) %>% summarise(Count = n())

T15_M11_CAT = T15_M11_CAT[1:11, ]

T15_M11_FTLCAT <- TIAS2015_FTL[, c("TA151147", "CAT")] %>% group_by(TA151147, CAT) %>% summarise(Count = n())

T15_M11_FTLCAT = T15_M11_FTLCAT[1:5, ]

T15_M11_IACCAT <- TIAS2015_IAC[, c("TA151147", "CAT")] %>% group_by(TA151147, CAT) %>% summarise(Count = n())

T15_M11_IACCAT = T15_M11_IACCAT[1:6, ]

head(T15_M11_CAT, 11)

ggplot(T15_M11_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151147)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M11_FTLW, 22)

ggplot(T15_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151147)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151147))

m11.pie.ftl.15 <- ggplot(data = T15_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151147))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151147))

m11.pie.iac.15 <- ggplot(data = T15_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151147))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.15, m11.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151148)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151148 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151148 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151148 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151148 = c(8, 9))) 

T15_M12_FTLW <- TIAS[, c("TA151148", "FTL_COUNT")] %>% group_by(TA151148, FTL_COUNT) %>% summarise(Count = n())

T15_M12_FTLW <- T15_M12_FTLW[1:22, ]

T15_M12_CAT <- TIAS2015[, c("TA151148", "CAT")] %>% group_by(TA151148, CAT) %>% summarise(Count = n())

T15_M12_CAT = T15_M12_CAT[1:12, ]

T15_M12_FTLCAT <- TIAS2015_FTL[, c("TA151148", "CAT")] %>% group_by(TA151148, CAT) %>% summarise(Count = n())

T15_M12_FTLCAT = T15_M12_FTLCAT[1:6, ]

T15_M12_IACCAT <- TIAS2015_IAC[, c("TA151148", "CAT")] %>% group_by(TA151148, CAT) %>% summarise(Count = n())

T15_M12_IACCAT = T15_M12_IACCAT[1:6, ]

head(T15_M12_CAT, 12)

ggplot(T15_M12_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151148)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M12_FTLW, 22)

ggplot(T15_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151148)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151148))

m12.pie.ftl.15 <- ggplot(data = T15_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151148))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151148))

m12.pie.iac.15 <- ggplot(data = T15_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151148))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.15, m12.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M13 - Liked Personality ================================================================================================

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151149)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151149 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151149 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151149 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151149 = c(8, 9))) 

T15_M13_FTLW <- TIAS[, c("TA151149", "FTL_COUNT")] %>% group_by(TA151149, FTL_COUNT) %>% summarise(Count = n())

T15_M13_FTLW <- T15_M13_FTLW[1:21, ]

T15_M13_CAT <- TIAS2015[, c("TA151149", "CAT")] %>% group_by(TA151149, CAT) %>% summarise(Count = n())

T15_M13_CAT = T15_M13_CAT[1:12, ]

T15_M13_FTLCAT <- TIAS2015_FTL[, c("TA151149", "CAT")] %>% group_by(TA151149, CAT) %>% summarise(Count = n())

T15_M13_FTLCAT = T15_M13_FTLCAT[1:6, ]

T15_M13_IACCAT <- TIAS2015_IAC[, c("TA151149", "CAT")] %>% group_by(TA151149, CAT) %>% summarise(Count = n())

T15_M13_IACCAT = T15_M13_IACCAT[1:6, ]

head(T15_M13_CAT, 12)

ggplot(T15_M13_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151149)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M13_FTLW, 21)

ggplot(T15_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151149)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151149))

m13.pie.ftl.15 <- ggplot(data = T15_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151149))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightcoral", "gold"), 
  labels = c("About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151149))

m13.pie.iac.15 <- ggplot(data = T15_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151149))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightcoral", "gold"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.15, m13.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### MIDUS M14 - Life Had Direction ===============================================================================================

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151150)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151150 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151150 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151150 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151150 = c(8, 9))) 

T15_M14_FTLW <- TIAS[, c("TA151150", "FTL_COUNT")] %>% group_by(TA151150, FTL_COUNT) %>% summarise(Count = n())

T15_M14_FTLW <- T15_M14_FTLW[1:21, ]

T15_M14_CAT <- TIAS2015[, c("TA151150", "CAT")] %>% group_by(TA151150, CAT) %>% summarise(Count = n())

T15_M14_CAT = T15_M14_CAT[1:12, ]

T15_M14_FTLCAT <- TIAS2015_FTL[, c("TA151150", "CAT")] %>% group_by(TA151150, CAT) %>% summarise(Count = n())

T15_M14_FTLCAT = T15_M14_FTLCAT[1:6, ]

T15_M14_IACCAT <- TIAS2015_IAC[, c("TA151150", "CAT")] %>% group_by(TA151150, CAT) %>% summarise(Count = n())

T15_M14_IACCAT = T15_M14_IACCAT[1:6, ]

head(T15_M14_CAT, 12)

ggplot(T15_M14_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151150)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T15_M14_FTLW, 21)

ggplot(T15_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151150)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA151150))

m14.pie.ftl.15 <- ggplot(data = T15_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151150))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2015_IAC$TA151150))

m14.pie.iac.15 <- ggplot(data = T15_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151150))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
  labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.15, m14.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))
### MIDUS Subscale - Emotional ===================================================================================================

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA151274)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151274 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151274 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151274 = 9))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151274 = 9)) 
  
T15_MSE_FTLW <- TIAS[, c("TA151274", "FTL_COUNT")] %>% group_by(TA151274, FTL_COUNT) %>% summarise(Count = n())

T15_MSE_FTLW <- T15_MSE_FTLW[1:22, ]

T15_MSE_CAT <- TIAS2015[, c("TA151274", "CAT")] %>% group_by(TA151274, CAT) %>% summarise(Count = n())

T15_MSE_CAT=T15_MSE_CAT[1:11, ]

ggplot(T15_MSE_FTLW, aes(x = FTL_COUNT, y = TA151274, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_MSE_CAT, aes(x = CAT, y = TA151274, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### MIDUS Subscale - Psychological ===============================================================================================

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA151276)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151276 = 9)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151276 = 9)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151276 = 9))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151276 = 9)) 


T15_MSP_FTLW <- TIAS[, c("TA151276", "FTL_COUNT")] %>% group_by(TA151276, FTL_COUNT) %>% summarise(Count = n())

T15_MSP_FTLW <- T15_MSP_FTLW[1:20, ]

T15_MSP_CAT <- TIAS2015[, c("TA151276", "CAT")] %>% group_by(TA151276, CAT) %>% summarise(Count = n())

T15_MSP_CAT = T15_MSP_CAT[1:10, ]

ggplot(T15_MSP_FTLW, aes(x = FTL_COUNT, y = TA151276, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_MSP_CAT, aes(x = CAT, y = TA151276, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Time Use - Involved in Arts ==================================================================================================

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150016)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150016 = c(8,9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150016 = c(8,9)))  

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150016 = c(8,9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150016 = c(8,9))) 

T15_TIA_FTLW <- TIAS[, c("TA150016", "FTL_COUNT")] %>% group_by(TA150016, FTL_COUNT) %>% summarise(Count = n())

T15_TIA_FTLW <- T15_TIA_FTLW[1:9, ]

T15_TIA_CAT <- TIAS2015[, c("TA150016", "CAT")] %>% group_by(TA150016, CAT) %>% summarise(Count = n())

T15_TIA_CAT <- T15_TIA_CAT[1:4, ]

T15_TIA_FTLCAT <- TIAS2015_FTL[, c("TA150016", "CAT")] %>% group_by(TA150016, CAT) %>% summarise(Count = n())

T15_TIA_FTLCAT=T15_TIA_FTLCAT[1:2, ]

T15_TIA_IACCAT <- TIAS2015_IAC[, c("TA150016", "CAT")] %>% group_by(TA150016, CAT) %>% summarise(Count = n())

T15_TIA_IACCAT <- T15_TIA_IACCAT[1:2, ]

head(T15_TIA_CAT, 4)

ggplot(T15_TIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T15_TIA_FTLW, 9)

ggplot(T15_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150016))

tia.pie.ftl.15 <- ggplot(data = T15_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_IAC$TA150016)) 

tia.pie.iac.15 <- ggplot(data = T15_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.15, tia.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Type of Art (Involvement) =========================================================================================

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 88,871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 
####

table(TIAS$TA150017)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150017 = c(9998, 9999))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150017 = c(9998, 9999)))  

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150017 = c(9998, 9999)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150017 = c(9998, 9999))) 

T15_IIA_FTLW <- TIAS[, c("TA150017", "FTL_COUNT")] %>% group_by(TA150017, FTL_COUNT) %>% summarise(Count = n())

T15_IIA_FTLW <- T15_IIA_FTLW[1:36, ]

T15_IIA_CAT <- TIAS2015[, c("TA150017", "CAT")] %>% group_by(TA150017, CAT) %>% summarise(Count = n())

T15_IIA_CAT <- T15_IIA_CAT[1:27, ]

T15_IIA_FTLCAT <- TIAS2015_FTL[, c("TA150017", "CAT")] %>% group_by(TA150017, CAT) %>% summarise(Count = n())

T15_IIA_FTLCAT <- T15_IIA_FTLCAT[1:9, ]

T15_IIA_IACCAT <- TIAS2015_IAC[, c("TA150017", "CAT")] %>% group_by(TA150017, CAT) %>% summarise(Count = n())

T15_IIA_IACCAT <- T15_IIA_IACCAT[1:18, ]

head(T15_IIA_CAT, 27)

ggplot(T15_IIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

head(T15_IIA_FTLW, 35)

ggplot(T15_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
  "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Literature", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       

prop.table(table(TIAS2015_FTL$TA150017)) 

iia.pie.ftl.15 <- ggplot(data = T15_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumspringgreen", "midnightblue", "royalblue1", "seagreen1", "yellow", "cornflowerblue", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-school band/choir/orchestra", "Arts & Crafts", "Drawing/Coloring", "Musical Instrument", "Singing", "Acting", "Dance", "Other Activity"))
                                                                                                                                                                          
prop.table(table(TIAS2015_IAC$TA150017)) 

iia.pie.iac.15 <- ggplot(data = T15_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "sienna1", "mediumturquoise", "mediumvioletred", "midnightblue", "olivedrab1", "orange", 
  "royalblue", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
  "After-School Drama/Art Club", "Needle-work", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Writing", "Poetry", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
  "Dance Lessons", "Voice Lessons", "Musical Instrument Lessons", "Other Activity"))                                                                                                                                       
ggarrange(iia.pie.ftl.15, iia.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Art Involvement Frequency (Over 12 Mos) ===========================================================================

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA150018)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150018 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150018 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150018 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150018 = c(8, 9))) 


T15_AIF_FTLW <- TIAS[, c("TA150018", "FTL_COUNT")] %>% group_by(TA150018, FTL_COUNT) %>% summarise(Count = n())

T15_AIF_FTLW <- T15_AIF_FTLW[1:20, ]

T15_AIF_CAT <- TIAS2015[, c("TA150018", "CAT")] %>% group_by(TA150018, CAT) %>% summarise(Count = n())

T15_AIF_CAT=T15_AIF_CAT[1:13, ]

T15_AIF_FTLCAT <- TIAS2015_FTL[, c("TA150018", "CAT")] %>% group_by(TA150018, CAT) %>% summarise(Count = n())

T15_AIF_FTLCAT=T15_AIF_FTLCAT[1:6, ]

T15_AIF_IACCAT <- TIAS2015_IAC[, c("TA150018", "CAT")] %>% group_by(TA150018, CAT) %>% summarise(Count = n())

T15_AIF_IACCAT=T15_AIF_IACCAT[1:7, ]

head(T15_AIF_CAT, 13)

ggplot(T15_AIF_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T15_AIF_FTLW, 20)

ggplot(T15_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA150018)) 

aif.pie.ftl.15 <- ggplot(data = T15_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_IAC$TA150018)) 

aif.pie.iac.15 <- ggplot(data = T15_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.15, aif.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### WTR Member of Sports Team (Over 12 Mos) ======================================================================================

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150019)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150019 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150019 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150019 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150019 = c(8, 9))) 

T15_SPO_FTLW <- TIAS[, c("TA150019", "FTL_COUNT")] %>% group_by(TA150019, FTL_COUNT) %>% summarise(Count = n())

T15_SPO_FTLW <- T15_SPO_FTLW[1:8, ]

T15_SPO_CAT <- TIAS2015[, c("TA150019", "CAT")] %>% group_by(TA150019, CAT) %>% summarise(Count = n())

T15_SPO_FTLCAT <- TIAS2015_FTL[, c("TA150019", "CAT")] %>% group_by(TA150019, CAT) %>% summarise(Count = n())

T15_SPO_IACCAT <- TIAS2015_IAC[, c("TA150019", "CAT")] %>% group_by(TA150019, CAT) %>% summarise(Count = n())

T15_SPO_CAT=T15_SPO_CAT[1:4, ]

T15_SPO_FTLCAT=T15_SPO_FTLCAT[1:2, ]

T15_SPO_IACCAT=T15_SPO_IACCAT[1:2, ]


head(T15_SPO_CAT, 4)

ggplot(T15_SPO_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T15_SPO_FTLW, 10)

ggplot(T15_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150019))

spo.pie.ftl.15 <- ggplot(data = T15_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_IAC$TA150019)) 

spo.pie.iac.15 <- ggplot(data = T15_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.15, spo.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Involved in Sports Frequency  =====================================================================================

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA150020)

T15_IIS_FTLW <- TIAS[, c("TA150020", "FTL_COUNT")] %>% group_by(TA150020, FTL_COUNT) %>% summarise(Count = n())

T15_IIS_CAT <- TIAS2015[, c("TA150020", "CAT")] %>% group_by(TA150020, CAT) %>% summarise(Count = n())

T15_IIS_FTLCAT <- TIAS2015_FTL[, c("TA150020", "CAT")] %>% group_by(TA150020, CAT) %>% summarise(Count = n())

T15_IIS_IACCAT <- TIAS2015_IAC[, c("TA150020", "CAT")] %>% group_by(TA150020, CAT) %>% summarise(Count = n())

T15_IIS_FTLW <- T15_IIS_FTLW[1:17, ]

T15_IIS_CAT=T15_IIS_CAT[1:12, ]

T15_IIS_FTLCAT=T15_IIS_FTLCAT[1:5, ]

T15_IIS_IACCAT=T15_IIS_IACCAT[1:7, ]

head(T15_IIS_CAT, 12)

ggplot(T15_IIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T15_IIS_FTLW, 17)

ggplot(T15_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA150020))

iis.pie.ftl.15 <- ggplot(data = T15_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Every day"))

prop.table(table(TIAS2015_IAC$TA150020)) 

iis.pie.iac.15 <- ggplot(data = T15_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.15, iis.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Watching/Reading News (Over 12 Mos) ===============================================================================

####
# A6. How Often Watch/Read News (TV or Magazine): “During the last 12 months, about how often did you watch or read news?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150021)

T15_WRN_FTLW <- TIAS[, c("TA150021", "FTL_COUNT")] %>% group_by(TA150021, FTL_COUNT) %>% summarise(Count = n())

T15_WRN_CAT <- TIAS2015[, c("TA150021", "CAT")] %>% group_by(TA150021, CAT) %>% summarise(Count = n())

T15_WRN_FTLCAT <- TIAS2015_FTL[, c("TA150021", "CAT")] %>% group_by(TA150021, CAT) %>% summarise(Count = n())

T15_WRN_IACCAT <- TIAS2015_IAC[, c("TA150021", "CAT")] %>% group_by(TA150021, CAT) %>% summarise(Count = n())

T15_WRN_FTLW <- T15_WRN_FTLW[1:26, ]

T15_WRN_CAT <- T15_WRN_CAT [1:13, ]

T15_WRN_FTLCAT <- T15_WRN_FTLCAT[1:6, ]

T15_WRN_IACCAT <- T15_WRN_IACCAT[1:7, ]

head(T15_WRN_CAT, 13)

ggplot(T15_WRN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

head(T15_WRN_FTLW, 27)

ggplot(T15_WRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

prop.table(table(TIAS2015_FTL$TA150021))

wrn.pie.ftl.15 <- ggplot(data = T15_WRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_IAC$TA150021)) 

wrn.pie.iac.15 <- ggplot(data = T15_WRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Watching/Reading News", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watch or read news"))

ggarrange(wrn.pie.ftl.15, wrn.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Reading for Pleasure (Over 12 Mos) ================================================================================

####
# A7. How Often Read for Pleasure: “During the last 12 months, about how often did you read for pleasure?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150022)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150022 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150022 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150022 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150022 = c(8, 9))) 


T15_RFP_FTLW <- TIAS[, c("TA150022", "FTL_COUNT")] %>% group_by(TA150022, FTL_COUNT) %>% summarise(Count = n())

T15_RFP_CAT <- TIAS2015[, c("TA150022", "CAT")] %>% group_by(TA150022, CAT) %>% summarise(Count = n())

T15_RFP_FTLCAT <- TIAS2015_FTL[, c("TA150022", "CAT")] %>% group_by(TA150022, CAT) %>% summarise(Count = n())

T15_RFP_IACCAT <- TIAS2015_IAC[, c("TA150022", "CAT")] %>% group_by(TA150022, CAT) %>% summarise(Count = n())

T15_RFP_FTLW <- T15_RFP_FTLW[1:28, ]

T15_RFP_CAT <- T15_RFP_CAT[1:14, ]

T15_RFP_FTLCAT <- T15_RFP_FTLCAT[1:7, ]

T15_RFP_IACCAT <- T15_RFP_IACCAT[1:7, ]

head(T15_RFP_CAT, 14)

ggplot(T15_RFP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                  labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

head(T15_RFP_FTLW, 26)

ggplot(T15_RFP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2015_FTL$TA150022))

rfp.pie.ftl.15 <- ggplot(data = T15_RFP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

prop.table(table(TIAS2015_IAC$TA150022)) 

rfp.pie.iac.15 <- ggplot(data = T15_RFP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Reading for Pleasure", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never read for pleasure"))

ggarrange(rfp.pie.ftl.15, rfp.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Watching Non-News TV Shows (Over 12 Mos) ==========================================================================

####
# A8. How Often Watch Non-News TV Shows: “During the last 12 months, about how often did you watch non-news TV shows?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150023)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150023 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150023 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150023 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150023 = c(8, 9))) 
  

T15_NNT_FTLW <- TIAS[, c("TA150023", "FTL_COUNT")] %>% group_by(TA150023, FTL_COUNT) %>% summarise(Count = n())

T15_NNT_CAT <- TIAS2015[, c("TA150023", "CAT")] %>% group_by(TA150023, CAT) %>% summarise(Count = n())

T15_NNT_FTLCAT <- TIAS2015_FTL[, c("TA150023", "CAT")] %>% group_by(TA150023, CAT) %>% summarise(Count = n())

T15_NNT_IACCAT <- TIAS2015_IAC[, c("TA150023", "CAT")] %>% group_by(TA150023, CAT) %>% summarise(Count = n())

T15_NNT_FTLW <- T15_NNT_FTLW[1:27, ]

T15_NNT_CAT <- T15_NNT_CAT[1:14, ]

T15_NNT_FTLCAT <- T15_NNT_FTLCAT[1:7, ]

T15_NNT_IACCAT <- T15_NNT_IACCAT[1:7, ]

head(T15_NNT_CAT, 14)

ggplot(T15_NNT_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150023))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

head(T15_NNT_FTLW, 27)

ggplot(T15_NNT_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150023)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2015_FTL$TA150023))

nnt.pie.ftl.15 <- ggplot(data = T15_NNT_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

prop.table(table(TIAS2015_IAC$TA150023)) 

nnt.pie.iac.15 <- ggplot(data = T15_NNT_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150023))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Non-News TV Shows", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never watched non-news TV shows"))

ggarrange(nnt.pie.ftl.15, nnt.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Internet Usage for Email/Instant Messenger (Over 12 Mos) ==========================================================

####
# A10A. WTR Used Internet for email/instant messenger: “In the last 12 months, how often did you use the Internet for email/instant messenger?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA150024)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150024 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150024 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150024 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150024 = c(8, 9))) 
  

T15_IPE_FTLW <- TIAS[, c("TA150024", "FTL_COUNT")] %>% group_by(TA150024, FTL_COUNT) %>% summarise(Count = n())

T15_IPE_CAT <- TIAS2015[, c("TA150024", "CAT")] %>% group_by(TA150024, CAT) %>% summarise(Count = n())

T15_IPE_FTLCAT <- TIAS2015_FTL[, c("TA150024", "CAT")] %>% group_by(TA150024, CAT) %>% summarise(Count = n())

T15_IPE_IACCAT <- TIAS2015_IAC[, c("TA150024", "CAT")] %>% group_by(TA150024, CAT) %>% summarise(Count = n())

T15_IPE_FTLW <- T15_IPE_FTLW[1:31, ]

T15_IPE_CAT <- T15_IPE_CAT[1:14, ]

T15_IPE_FTLCAT <- T15_IPE_FTLCAT[1:6, ]

T15_IPE_IACCAT <- T15_IPE_IACCAT[1:8, ]


head(T15_IPE_CAT, 14)

ggplot(T15_IPE_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

head(T15_IPE_FTLW, 31)

ggplot(T15_IPE_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

prop.table(table(TIAS2015_FTL$TA150024))

ipe.pie.ftl.15 <- ggplot(data = T15_IPE_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_IAC$TA150024)) 

ipe.pie.iac.15 <- ggplot(data = T15_IPE_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150024))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Email/Instant Messenger", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for email/instant messenger"))

ggarrange(ipe.pie.ftl.15, ipe.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Internet Usage for School/Research (Over 12 Mos) ==================================================================

####
# A10B. WTR Used Internet for school/research for school-related papers and projects: “In the last 12 months, how often did you use 
# the Internet for school-related papers and projects?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA150025)

T15_IPR_FTLW <- TIAS[, c("TA150025", "FTL_COUNT")] %>% group_by(TA150025, FTL_COUNT) %>% summarise(Count = n())

T15_IPR_CAT <- TIAS2015[, c("TA150025", "CAT")] %>% group_by(TA150025, CAT) %>% summarise(Count = n())

T15_IPR_FTLCAT <- TIAS2015_FTL[, c("TA150025", "CAT")] %>% group_by(TA150025, CAT) %>% summarise(Count = n())

T15_IPR_IACCAT <- TIAS2015_IAC[, c("TA150025", "CAT")] %>% group_by(TA150025, CAT) %>% summarise(Count = n())


T15_IPR_FTLW <- T15_IPR_FTLW[1:29, ]

T15_IPR_CAT <- T15_IPR_CAT[1:15, ]

T15_IPR_FTLCAT <- T15_IPR_FTLCAT[1:7, ]

T15_IPR_IACCAT <- T15_IPR_IACCAT[1:8, ]


head(T15_IPR_CAT, 15)

ggplot(T15_IPR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

head(T15_IPR_FTLW, 29)

ggplot(T15_IPR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2015_FTL$TA150025))

ipr.pie.ftl.15 <- ggplot(data = T15_IPR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for School/Research", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

prop.table(table(TIAS2015_IAC$TA150025))

ipr.pie.iac.15 <- ggplot(data = T15_IPR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150025))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for School/Research", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for school/research"))

ggarrange(ipr.pie.ftl.15, ipr.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Internet Usage for Shopping (Over 12 Mos) =========================================================================

####
# A10C. WTR Used Internet for shopping: “In the last 12 months, how often did you use the Internet for shopping?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA150026)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150026 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150026 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150026 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150026 = c(8, 9))) 

T15_IPS_FTLW <- TIAS[, c("TA150026", "FTL_COUNT")] %>% group_by(TA150026, FTL_COUNT) %>% summarise(Count = n())

T15_IPS_CAT <- TIAS2015[, c("TA150026", "CAT")] %>% group_by(TA150026, CAT) %>% summarise(Count = n())

T15_IPS_FTLCAT <- TIAS2015_FTL[, c("TA150026", "CAT")] %>% group_by(TA150026, CAT) %>% summarise(Count = n())

T15_IPS_IACCAT <- TIAS2015_IAC[, c("TA150026", "CAT")] %>% group_by(TA150026, CAT) %>% summarise(Count = n())

T15_IPS_FTLW <- T15_IPS_FTLW[1:31, ]

T15_IPS_CAT <- T15_IPS_CAT[1:15, ]

T15_IPS_FTLCAT=T15_IPS_FTLCAT[1:7, ]

T15_IPS_IACCAT <- T15_IPS_IACCAT[1:8, ]

head(T15_IPS_CAT, 15)

ggplot(T15_IPS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

head(T15_IPS_FTLW, 31)

ggplot(T15_IPS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2015_FTL$TA150026))

ips.pie.ftl.15 <- ggplot(data = T15_IPS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Shopping", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

prop.table(table(TIAS2015_IAC$TA150026))

ips.pie.iac.15 <- ggplot(data = T15_IPS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150026))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Shopping", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for shopping"))

ggarrange(ips.pie.ftl.15, ips.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Internet Usage for Playing Games (Over 12 Mos) ====================================================================

####
# A10D. WTR Used Internet for playing games: “In the last 12 months, how often did you use the Internet for playing games?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: never used the Internet)
####

table(TIAS$TA150027)


T15_IPG_FTLW <- TIAS[, c("TA150027", "FTL_COUNT")] %>% group_by(TA150027, FTL_COUNT) %>% summarise(Count = n())

T15_IPG_CAT <- TIAS2015[, c("TA150027", "CAT")] %>% group_by(TA150027, CAT) %>% summarise(Count = n())

T15_IPG_FTLCAT <- TIAS2015_FTL[, c("TA150027", "CAT")] %>% group_by(TA150027, CAT) %>% summarise(Count = n())

T15_IPG_IACCAT <- TIAS2015_IAC[, c("TA150027", "CAT")] %>% group_by(TA150027, CAT) %>% summarise(Count = n())

T15_IPG_FTLW <- T15_IPG_FTLW[1:31, ]

T15_IPG_CAT <- T15_IPG_CAT[1:15, ]

T15_IPG_FTLCAT <- T15_IPG_FTLCAT[1:7, ]

T15_IPG_IACCAT <- T15_IPG_IACCAT[1:8, ]

head(T15_IPG_CAT, 15)

ggplot(T15_IPG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

head(T15_IPG_FTLW, 31)

ggplot(T15_IPG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2015_FTL$TA150027))

ipg.pie.ftl.15 <- ggplot(data = T15_IPG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Internet Usage for Playing Games", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

prop.table(table(TIAS2015_IAC$TA150027))

ipg.pie.iac.15 <- ggplot(data = T15_IPG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150027))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Internet Usage for Playing Games", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1", "sienna1"), 
                    labels = c("Never used the internet", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day", "Never used the internet for gaming"))

ggarrange(ipg.pie.ftl.15, ipg.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Voted in Last Presidential Election ===============================================================================

####
# A11. WTR Voted in 2004: “Did you vote in the national election for President last November, in 2004?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150029)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150029 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150029 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150029 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150029 = c(8, 9))) 

T15_VLP_FTLW <- TIAS[, c("TA150029", "FTL_COUNT")] %>% group_by(TA150029, FTL_COUNT) %>% summarise(Count = n())

T15_VLP_CAT <- TIAS2015[, c("TA150029", "CAT")] %>% group_by(TA150029, CAT) %>% summarise(Count = n())

T15_VLP_FTLW <- T15_VLP_FTLW[1:12, ]

T15_VLP_CAT <- T15_VLP_FTLW[1:6, ]

head(T15_VLP_CAT, 6)

ggplot(T15_VLP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink", "gold", "sienna1", "rosybrown1"), labels = c("Yes", "No"))

head(T15_VLP_FTLW, 10)

ggplot(T15_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink", "gold", "sienna1", "rosybrown1"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_IAC$TA150029))
prop.table(table(TIAS2015_FTL$TA150029))

### Time Use - Involvement in Social Action Groups ===============================================================================

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

prop.table(table(TIAS2015_IAC$TA150030))
prop.table(table(TIAS2015_FTL$TA150030))


table(TIAS$TA150030)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150030 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150030 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150030 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150030 = c(8, 9))) 


T15_ISA_FTLW <- TIAS[, c("TA150030", "FTL_COUNT")] %>% group_by(TA150030, FTL_COUNT) %>% summarise(Count = n())

T15_ISA_FTLW <- T15_ISA_FTLW[1:7, ]

T15_ISA_CAT <- TIAS2015[, c("TA150030", "CAT")] %>% group_by(TA150030, CAT) %>% summarise(Count = n())

T15_ISA_CAT <- T15_ISA_CAT[1:4, ]

head(T15_ISA_CAT, 4)

ggplot(T15_ISA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T15_ISA_FTLW, 7)

ggplot(T15_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) =========================================================================

####
# A11C. Type of Social Action Groups: “Which political groups were you involved in?”
# Answers: 1 (Young Democrats/Democratic Party); 2 (Young Republicans/Republican Party); 3 (NAACP); 4 (Amnesty International/social justice groups)
# 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

prop.table(table(TIAS2015_IAC$TA150030))
prop.table(table(TIAS2015_FTL$TA150030))

table(TIAS$TA150031)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150031 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150031 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150031 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150031 = c(8, 9)))

T15_TSA_FTLW <- TIAS[, c("TA150031", "FTL_COUNT")] %>% group_by(TA150031, FTL_COUNT) %>% summarise(Count = n())

T15_TSA_CAT <- TIAS2015[, c("TA150031", "CAT")] %>% group_by(TA150031, CAT) %>% summarise(Count = n())

T15_TSA_FTLW <- T15_TSA_FTLW[1:11, ]

T15_TSA_CAT <- T15_TSA_CAT[1:7, ]

head(T15_TSA_CAT, 7)

ggplot(T15_TSA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

head(T15_TSA_FTLW, 11)

ggplot(T15_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved", "Young Democrats", "Young Republicans", "NAACP", "Amnesty International/Social Justice", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) =====================================================================

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA150032)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150032 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150032 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150032 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150032 = c(8, 9)))

T15_SAG_FTLW <- TIAS[, c("TA150032", "FTL_COUNT")] %>% group_by(TA150032, FTL_COUNT) %>% summarise(Count = n())

T15_SAG_CAT <- TIAS2015[, c("TA150032", "CAT")] %>% group_by(TA150032, CAT) %>% summarise(Count = n())

T15_SAG_FTLW <- T15_SAG_FTLW[1:13, ]

T15_SAG_CAT <- T15_SAG_CAT[1:10, ]

head(T15_SAG_CAT, 10)

ggplot(T15_SAG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150032))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T15_SAG_FTLW, 13)

ggplot(T15_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150032)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement ===============================================================================

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150033)

T15_CGI_FTLW <- TIAS[, c("TA150033", "FTL_COUNT")] %>% group_by(TA150033, FTL_COUNT) %>% summarise(Count = n())

T15_CGI_CAT <- TIAS2015[, c("TA150033", "CAT")] %>% group_by(TA150033, CAT) %>% summarise(Count = n())

T15_CGI_FTLCAT <- TIAS2015_FTL[, c("TA150033", "CAT")] %>% group_by(TA150033, CAT) %>% summarise(Count = n())

T15_CGI_IACCAT <- TIAS2015_IAC[, c("TA150033", "CAT")] %>% group_by(TA150033, CAT) %>% summarise(Count = n())

T15_CGI_FTLW <- T15_CGI_FTLW[1:8, ]
T15_CGI_CAT <- T15_CGI_CAT[1:5, ]
T15_CGI_FTLCAT <- T15_CGI_FTLCAT[1:2, ]
T15_CGI_IACCAT <- T15_CGI_IACCAT[1:3, ]


head(T15_CGI_CAT, 5)

ggplot(T15_CGI_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150033))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink", "sienna1"), labels = c("Yes", "No", "Not in school"))

head(T15_CGI_FTLW, 8)

ggplot(T15_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150033)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink", "sienna1"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2015_FTL$TA150033))

cgi.pie.ftl.15 <- ggplot(data = T15_CGI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_IAC$TA150033))

cgi.pie.iac.15 <- ggplot(data = T15_CGI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150033))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink", "sienna1"), labels = c("Yes", "No", "Not in school"))

ggarrange(cgi.pie.ftl.15, cgi.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) =======================================================

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA150034)

T15_SCG_FTLW <- TIAS[, c("TA150034", "FTL_COUNT")] %>% group_by(TA150034, FTL_COUNT) %>% summarise(Count = n())

T15_SCG_FTLW <- T15_SCG_FTLW[1:18, ]

T15_SCG_CAT <- TIAS2015[, c("TA150034", "CAT")] %>% group_by(TA150034, CAT) %>% summarise(Count = n())

T15_SCG_FTLCAT <- TIAS2015_FTL[, c("TA150034", "CAT")] %>% group_by(TA150034, CAT) %>% summarise(Count = n())

T15_SCG_IACCAT <- TIAS2015_IAC[, c("TA150034", "CAT")] %>% group_by(TA150034, CAT) %>% summarise(Count = n())

head(T15_SCG_CAT, 9)

ggplot(T15_SCG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150034))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T15_SCG_FTLW, 18)

ggplot(T15_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150034)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA150034))

scg.pie.ftl.15 <- ggplot(data = T15_SCG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "gold", "lightskyblue", "sienna1", "rosybrown1"), 
                    labels = c("Not Involved", "Once a week"))

prop.table(table(TIAS2015_IAC$TA150034))

scg.pie.iac.15 <- ggplot(data = T15_SCG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150034))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(scg.pie.ftl.15, scg.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ==============================================================

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150035)

T15_UVW_FTLW <- TIAS[, c("TA150035", "FTL_COUNT")] %>% group_by(TA150035, FTL_COUNT) %>% summarise(Count = n())

T15_UVW_CAT <- TIAS2015[, c("TA150035", "CAT")] %>% group_by(TA150035, CAT) %>% summarise(Count = n())

T15_UVW_FTLCAT <- TIAS2015_FTL[, c("TA150035", "CAT")] %>% group_by(TA150035, CAT) %>% summarise(Count = n())

T15_UVW_IACCAT <- TIAS2015_IAC[, c("TA150035", "CAT")] %>% group_by(TA150035, CAT) %>% summarise(Count = n())

T15_UVW_FTLW <- T15_UVW_FTLW[1:8, ]

T15_UVW_CAT <- T15_UVW_CAT[1:4, ]

T15_UVW_FTLCAT <- T15_UVW_FTLCAT[1:2, ]

head(T15_UVW_CAT, 4)

ggplot(T15_UVW_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150035))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))
                    
head(T15_UVW_FTLW, 8)

ggplot(T15_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150035)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_FTL$TA150035))

uvw.pie.ftl.15 <- ggplot(data = T15_UVW_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2015_IAC$TA150035))

uvw.pie.iac.15 <- ggplot(data = T15_UVW_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

ggarrange(uvw.pie.ftl.15, uvw.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Time Use - Type of Volunteer Work ============================================================================================

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior league); 
# 3 (Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 
# 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or Nature Conservancy); 6 (Shelters, soup kitchens, 
# Habitat for Humanity, or other organizations helping families in need); 7 (Other); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer 
# or service work)
####

table(TIAS$TA150036)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150036 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150036 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150036 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150036 = c(8, 9)))

T15_VFM_FTLW <- TIAS[, c("TA150036", "FTL_COUNT")] %>% group_by(TA150036, FTL_COUNT) %>% summarise(Count = n())

T15_VFM_CAT <- TIAS2015[, c("TA150036", "CAT")] %>% group_by(TA150036, CAT) %>% summarise(Count = n())

T15_VFM_FTLCAT <- TIAS2015_FTL[, c("TA150036", "CAT")] %>% group_by(TA150036, CAT) %>% summarise(Count = n())

T15_VFM_IACCAT <- TIAS2015_IAC[, c("TA150036", "CAT")] %>% group_by(TA150036, CAT) %>% summarise(Count = n())

T15_VFM_FTLW <- T15_VFM_FTLW[1:19, ]

T15_VFM_CAT <- T15_VFM_CAT[1:14, ]

T15_VFM_IACCAT <- T15_VFM_IACCAT[1:8, ]


ggplot(T15_VFM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150036))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T15_VFM_FTLW, 19)

ggplot(T15_VFM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150036)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
    scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))
                    
vfm.pie.ftl.15 <- ggplot(data = T15_VFM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150036))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2015_IAC$TA150036))

vfm.pie.iac.15 <- ggplot(data = T15_VFM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150036))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(vfm.pie.ftl.15, vfm.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))
                    
#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA150037)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150037 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150037 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150037 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150037 = c(8, 9)))

T15_vsm_FTLW <- TIAS[, c("TA150037", "FTL_COUNT")] %>% group_by(TA150037, FTL_COUNT) %>% summarise(Count = n())

T15_vsm_CAT <- TIAS2015[, c("TA150037", "CAT")] %>% group_by(TA150037, CAT) %>% summarise(Count = n())

T15_vsm_FTLCAT <- TIAS2015_FTL[, c("TA150037", "CAT")] %>% group_by(TA150037, CAT) %>% summarise(Count = n())

T15_vsm_IACCAT <- TIAS2015_IAC[, c("TA150037", "CAT")] %>% group_by(TA150037, CAT) %>% summarise(Count = n())

T15_vsm_FTLW <- T15_vsm_FTLW[1:14, ]

T15_vsm_CAT <- T15_vsm_CAT[1:11, ]


ggplot(T15_vsm_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150037))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T15_vsm_FTLW, 14)

ggplot(T15_vsm_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150037)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
    scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))
                    
vsm.pie.ftl.15 <- ggplot(data = T15_vsm_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150037))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2015_IAC$TA150037))

vsm.pie.iac.15 <- ggplot(data = T15_vsm_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150037))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(vsm.pie.ftl.15, vsm.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA150038)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150038 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150038 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150038 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150038 = c(8, 9)))

T15_vtm_FTLW <- TIAS[, c("TA150038", "FTL_COUNT")] %>% group_by(TA150038, FTL_COUNT) %>% summarise(Count = n())

T15_vtm_CAT <- TIAS2015[, c("TA150038", "CAT")] %>% group_by(TA150038, CAT) %>% summarise(Count = n())

T15_vtm_FTLCAT <- TIAS2015_FTL[, c("TA150038", "CAT")] %>% group_by(TA150038, CAT) %>% summarise(Count = n())

T15_vtm_IACCAT <- TIAS2015_IAC[, c("TA150038", "CAT")] %>% group_by(TA150038, CAT) %>% summarise(Count = n())

T15_vtm_FTLW <- T15_vtm_FTLW[1:13, ]

T15_vtm_CAT <- T15_vtm_CAT[1:10, ]


ggplot(T15_vtm_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150038))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

head(T15_vtm_FTLW, 13)

ggplot(T15_vtm_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150038)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
    scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))
                    
vtm.pie.ftl.15 <- ggplot(data = T15_vtm_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150038))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

prop.table(table(TIAS2015_IAC$TA150038))

vtm.pie.iac.15 <- ggplot(data = T15_vtm_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150038))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Other"))

ggarrange(vtm.pie.ftl.15, vtm.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA150039)

prop.table(table(TIAS2015_IAC$TA150039))
prop.table(table(TIAS2015_FTL$TA150039))

# No FTL participants mentioned a 4th org in 2015 wave.

#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA150040)

prop.table(table(TIAS2015_IAC$TA150040))
prop.table(table(TIAS2015_FTL$TA150040))

# No FTL participants mentioned a 5th org in 2015 wave.

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

prop.table(table(TIAS2015_IAC$TA150041))
prop.table(table(TIAS2015_FTL$TA150041))

# No FTL participants mentioned a 6th org in 2015 wave.

####
# Creating A14 Heatmaps 
####

A14_FTL15 <- TIAS2015_FTL %>% select(TA150036, TA150037, TA150038, TA150039, TA150040, TA150041, ID)

cols <- sapply(A14_FTL15, is.logical)
A14_FTL15[,cols] <- lapply(A14_FTL15[,cols], as.numeric)

A14_FTL15_TIDY <- A14_FTL15 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL15_TIDY$variable <- factor(A14_FTL15_TIDY$variable, levels = c("TA150036", "TA150037", "TA150038", "TA150039", "TA150040", "TA150041"))

A14_FTL15_IDLEV <- dplyr::pull(A14_FTL15, ID)
A14_FTL15_TIDY$ID <- factor(A14_FTL15_TIDY$ID, levels = A14_FTL15_IDLEV)

A14_FTL15_TIDY$volunteer_type <- factor(A14_FTL15_TIDY$volunteer_type)

ggplot(A14_FTL15_TIDY, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2015 FTL", x="Order of Mention", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise"), labels = c("Did Not Mention", "Youth Organization", "Hospital/Nursing Home", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC15 <- TIAS2015_IAC %>% select(TA150036, TA150037, TA150038, TA150039, TA150040, TA150041, ID)

nrow(A14_IAC15)  

chunk <- 101  

n <- nrow(A14_IAC15)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC15_list <- split(A14_IAC15, r)   

length(A14_IAC15_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC15_tidylist <- lapply(A14_IAC15_list, tidy.vars)

for(i in 1:7) {
  A14_IAC15_tidylist[[i]]$variable <- factor(A14_IAC15_tidylist[[i]]$variable, levels = c("TA150036", "TA150037", "TA150038", "TA150039", "TA150040", "TA150041"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, ID)
}

A14_IAC15_levlist <- lapply(A14_IAC15_list, set.ID.levels)

for(i in 1:7) {
  A14_IAC15_tidylist[[i]]$ID <- factor(A14_IAC15_tidylist[[i]]$ID, levels = A14_IAC15_levlist[[i]])
}

for(i in 1:7) {
  A14_IAC15_tidylist[[i]]$volunteer_type <- factor(A14_IAC15_tidylist[[i]]$volunteer_type)
}

create.A14.IAC15.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2015 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
    labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC15.heatmaps <- function(x){
  create.heatmap(A14_IAC15_tidylist[[x]])
}

# save or view in a horizontally wide frame to view all graphs properly

ggarrange(A14.IAC15.heatmaps(1) + rremove("legend"), A14.IAC15.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC15.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC15.heatmaps(4) + rremove("y.title"), ncol = 4, nrow = 1) 

ggarrange(A14.IAC15.heatmaps(5) + rremove("legend"), A14.IAC15.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC15.heatmaps(7) + rremove("y.title"), ncol = 3, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) ===============================================================================

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA150042)

T15_TUH_FTLW <- TIAS[, c("TA150042", "FTL_COUNT")] %>% group_by(TA150042, FTL_COUNT) %>% summarise(Count = n())

T15_TUH_CAT <- TIAS2015[, c("TA150042", "CAT")] %>% group_by(TA150042, CAT) %>% summarise(Count = n())

T15_TUH_FTLCAT <- TIAS2015_FTL[, c("TA150042", "CAT")] %>% group_by(TA150042, CAT) %>% summarise(Count = n())

T15_TUH_IACCAT <- TIAS2015_IAC[, c("TA150042", "CAT")] %>% group_by(TA150042, CAT) %>% summarise(Count = n())

T15_TUH_FTLW <- T15_TUH_FTLW[1:18, ]

T15_TUH_CAT <- T15_TUH_CAT[1:11, ]



head(T15_TUH_CAT, 11)

ggplot(T15_TUH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150042))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T15_TUH_FTLW, 18)

ggplot(T15_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150042)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2015_FTL$TA150042))

tuh.pie.ftl.15 <- ggplot(data = T15_TUH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150042))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "At least once a month", "Once a week", "Several times a week"))

prop.table(table(TIAS2015_IAC$TA150042))

tuh.pie.iac.15 <- ggplot(data = T15_TUH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150042))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(tuh.pie.ftl.15, tuh.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Self-Rating (Compared to Others) - Listening & Understanding Others ==========================================================

####
# C1J. How Well Listen Compared w/ Others: “Compared to other people, how good are you at listening to and understanding others? 
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150061)

T15_SRU_FTLW <- TIAS[, c("TA150061", "FTL_COUNT")] %>% group_by(TA150061, FTL_COUNT) %>% summarise(Count = n())

T15_SRU_CAT <- TIAS2015[, c("TA150061", "CAT")] %>% group_by(TA150061, CAT) %>% summarise(Count = n())


T15_SRU_FTLW <- T15_SRU_FTLW[1:23, ]
T15_SRU_CAT <- T15_SRU_CAT[1:13, ]

ggplot(T15_SRU_FTLW, aes(x = FTL_COUNT, y = TA150061, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRU_CAT, aes(x = CAT, y = TA150061, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Listening & Understanding Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Teaching & Explaining to Others ===========================================================

####
# C1K. How Good At Teaching Compared w/ Others: “Compared to other people, how good are you at teaching and explaining to others?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150062)

T15_SRE_FTLW <- TIAS[, c("TA150062", "FTL_COUNT")] %>% group_by(TA150062, FTL_COUNT) %>% summarise(Count = n())

T15_SRE_FTLW <- T15_SRE_FTLW[1:25, ]

T15_SRE_CAT <- TIAS2015[, c("TA150062", "CAT")] %>% group_by(TA150062, CAT) %>% summarise(Count = n())

ggplot(T15_SRE_FTLW, aes(x = FTL_COUNT, y = TA150062, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRE_CAT, aes(x = CAT, y = TA150062, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Teaching & Explaining to Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Supervising Others ========================================================================

####
# C1A. How Good At Supervising Comp: "Compared to other people, how good are you at supervising others?"
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150053)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150053 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150053 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150053 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150053 = c(8, 9))) 


T15_SRS_FTLW <- TIAS[, c("TA150053", "FTL_COUNT")] %>% group_by(TA150053, FTL_COUNT) %>% summarise(Count = n())

T15_SRS_FTLW <- T15_SRS_FTLW[1:27, ]

T15_SRS_CAT <- TIAS2015[, c("TA150053", "CAT")] %>% group_by(TA150053, CAT) %>% summarise(Count = n())

T15_SRS_CAT <- T15_SRS_CAT[1:13, ]

ggplot(T15_SRS_FTLW, aes(x = FTL_COUNT, y = TA150053, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRS_CAT, aes(x = CAT, y = TA150053, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Supervising Others (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### How Good at Problem Solving ==================================================================================================

####
# B6B. How Good At Problem Solving: “(On a scale of 1 to 7, where 1 means "Not At All Well" and 7 means "Extremely Well",) how good are you at solving problems you encounter?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150050)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150050 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150050 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150050 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150050 = 8)) 

T15_HGP_FTLW <- TIAS[, c("TA150050", "FTL_COUNT")] %>% group_by(TA150050, FTL_COUNT) %>% summarise(Count = n())

T15_HGP_FTLW <- T15_HGP_FTLW[1:21, ]

T15_HGP_CAT <- TIAS2015[, c("TA150050", "CAT")] %>% group_by(TA150050, CAT) %>% summarise(Count = n())

T15_HGP_CAT <- T15_HGP_CAT[1:12, ]

ggplot(T15_HGP_FTLW, aes(x = FTL_COUNT, y = TA150050, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_HGP_CAT, aes(x = CAT, y = TA150050, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Problem-Solving (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))


### Self-Rating (Compared to Others) - Independence ==============================================================================

####
# C1F. How Independent Compared w/ Others: “Compared to other people, how would you rate your independence?
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150058)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150058 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150058 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150058 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150058 = 8)) 

T15_SRI_FTLW <- TIAS[, c("TA150058", "FTL_COUNT")] %>% group_by(TA150058, FTL_COUNT) %>% summarise(Count = n())

T15_SRI_CAT <- TIAS2015[, c("TA150058", "CAT")] %>% group_by(TA150058, CAT) %>% summarise(Count = n())

T15_SRI_FTLW <- T15_SRI_FTLW[1:27, ]
T15_SRI_CAT <- T15_SRI_CAT[1:14, ]

ggplot(T15_SRI_FTLW, aes(x = FTL_COUNT, y = TA150058, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRI_CAT, aes(x = CAT, y = TA150058, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Independence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Confidence ================================================================================

####
# C1G. How Confident Compared w/ Others: “Compared to other people, how would you rate your self-confidence?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150059)

T15_SRC_FTLW <- TIAS[, c("TA150059", "FTL_COUNT")] %>% group_by(TA150059, FTL_COUNT) %>% summarise(Count = n())


T15_SRC_CAT <- TIAS2015[, c("TA150059", "CAT")] %>% group_by(TA150059, CAT) %>% summarise(Count = n())

T15_SRC_FTLW <- T15_SRC_FTLW[1:23, ]
T15_SRC_CAT <- T15_SRC_CAT[1:13, ]

ggplot(T15_SRC_FTLW, aes(x = FTL_COUNT, y = TA150059, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRC_CAT, aes(x = CAT, y = TA150059, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Confidence (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Self-Rating (Compared to Others) - Decisiveness ==============================================================================

####
# C1H. How Decisive Compared w/ Others: “Compared to other people, how would you rate your decisiveness?”
# Answers: 1-7 (1 = a lot worse than others <=> 7 = a lot better than others); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150060)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150060 = c(8, 9))) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150060 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150060 = c(8, 9)))  

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150060 = c(8, 9))) 

T15_SRD_FTLW <- TIAS[, c("TA150060", "FTL_COUNT")] %>% group_by(TA150060, FTL_COUNT) %>% summarise(Count = n())


T15_SRD_CAT <- TIAS2015[, c("TA150060", "CAT")] %>% group_by(TA150060, CAT) %>% summarise(Count = n())

T15_SRD_FTLW <- T15_SRD_FTLW[1:26, ]

T15_SRD_CAT <- T15_SRD_CAT[1:14, ]

ggplot(T15_SRD_FTLW, aes(x = FTL_COUNT, y = TA150060, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SRD_CAT, aes(x = CAT, y = TA150060, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Self-Rating - Decisiveness (1 = a lot worse than others <=> 7 = a lot better than others)") + 
  scale_y_continuous(breaks = seq(1, 7, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

### Frequency - Snacking Instead of Consuming Regular Meals ======================================================================

####
# H28A. Freq of Snack Instead of Regular Meal: “How often do you snack instead of eating regular meals? Would you say: Never, hardly ever, 
# less than once a month, a couple of times a month, more than once a week, or every day?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150950)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150950 = c(8, 9)))

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150950 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150950 = c(8, 9))) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150950 = c(8, 9))) 

T15_FSI_FTLW <- TIAS[, c("TA150950", "FTL_COUNT")] %>% group_by(TA150950, FTL_COUNT) %>% summarise(Count = n())

T15_FSI_FTLW <- T15_FSI_FTLW[1:25, ]

T15_FSI_CAT <- TIAS2015[, c("TA150950", "CAT")] %>% group_by(TA150950, CAT) %>% summarise(Count = n())

T15_FSI_CAT <- T15_FSI_CAT[1:12, ]

T15_FSI_FTLCAT <- TIAS2015_FTL[, c("TA150950", "CAT")] %>% group_by(TA150950, CAT) %>% summarise(Count = n())

T15_FSI_IACCAT <- TIAS2015_IAC[, c("TA150950", "CAT")] %>% group_by(TA150950, CAT) %>% summarise(Count = n())

T15_FSI_IACCAT <- T15_FSI_IACCAT[1:6, ]

head(T15_FSI_CAT, 12)

ggplot(T15_FSI_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150950))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T15_FSI_FTLW, 27)

ggplot(T15_FSI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150950)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2015_FTL$TA150950))

fsi.pie.ftl.15 <- ggplot(data = T15_FSI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150950))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2015_IAC$TA150950))

fsi.pie.iac.15 <- ggplot(data = T15_FSI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150950))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Snacking Instead of Regular Meals", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(fsi.pie.ftl.15, fsi.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Binge Eating Frequency =======================================================================================================

####
# H28B. Frequency of Binge Eating: “How often do you eat abnormally large amounts of food within a few hours, that is eat in binges?”
# Answers: 1 (Never); 2 (Hardly ever); 3 (Less than once a month); 4 (A couple of times a month); 5 (More than once a week); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA150951)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150951 = 8)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150951 = 8)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150951 = 8)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150951 = 8)) 

T15_BEF_FTLW <- TIAS[, c("TA150951", "FTL_COUNT")] %>% group_by(TA150951, FTL_COUNT) %>% summarise(Count = n())

T15_BEF_FTLW <- T15_BEF_FTLW[1:22, ]

T15_BEF_CAT <- TIAS2015[, c("TA150951", "CAT")] %>% group_by(TA150951, CAT) %>% summarise(Count = n())

T15_BEF_CAT <- T15_BEF_CAT[1:12, ]

T15_BEF_FTLCAT <- TIAS2015_FTL[, c("TA150951", "CAT")] %>% group_by(TA150951, CAT) %>% summarise(Count = n())

T15_BEF_IACCAT <- TIAS2015_IAC[, c("TA150951", "CAT")] %>% group_by(TA150951, CAT) %>% summarise(Count = n())

T15_BEF_IACCAT <- T15_BEF_IACCAT[1:6, ]

head(T15_BEF_CAT, 12)

ggplot(T15_BEF_CAT, aes(x = CAT, y = Count, fill = as.factor(TA150951))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

head(T15_BEF_FTLW, 22)

ggplot(T15_BEF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA150951)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2015_FTL$TA150951))

bef.pie.ftl.15 <- ggplot(data = T15_BEF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA150951))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

prop.table(table(TIAS2015_IAC$TA150951))

bef.pie.iac.15 <- ggplot(data = T15_BEF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA150951))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Binge Eating Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Never", "Hardly ever", "Less than once a month", "A couple of times a month", "More than once a week", "Every day"))

ggarrange(bef.pie.ftl.15, bef.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Race - Hispanic ==============================================================================================================

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151131)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151131 = c(8, 9)))

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151131 = c(8, 9))) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151131 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151131 = c(8, 9)))

T15_HIS_FTLW <- TIAS[, c("TA151131", "FTL_COUNT")] %>% group_by(TA151131, FTL_COUNT) %>% summarise(Count = n())

T15_HIS_FTLW <- T15_HIS_FTLW[1:21, ]

T15_HIS_CAT <- TIAS2015[, c("TA151131", "CAT")] %>% group_by(TA151131, CAT) %>% summarise(Count = n())

T15_HIS_CAT <- T15_HIS_CAT[1:13, ]

T15_HIS_FTLCAT <- TIAS2015_FTL[, c("TA151131", "CAT")] %>% group_by(TA151131, CAT) %>% summarise(Count = n())

T15_HIS_IACCAT <- TIAS2015_IAC[, c("TA151131", "CAT")] %>% group_by(TA151131, CAT) %>% summarise(Count = n())

T15_HIS_IACCAT <- T15_HIS_IACCAT[1:7, ]

head(T15_HIS_CAT, 13)

ggplot(T15_HIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151131))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

head(T15_HIS_FTLW, 21)

ggplot(T15_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151131)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2015_FTL$TA151131))

his.pie.ftl.15 <- ggplot(data = T15_HIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Puerto Rican", "Cuban", "Other Spanish"))

prop.table(table(TIAS2015_IAC$TA151131))

his.pie.iac.15 <- ggplot(data = T15_HIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151131))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Spanish, Hispanic, or Latino", "Mexican", "Mexican-American", "Chicano", "Puerto Rican", "Cuban", "Other Spanish"))

ggarrange(his.pie.ftl.15, his.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA151132)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151132 = c(8, 9)))

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151132 = c(8, 9)))

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA151132 = c(8, 9)))

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA151132 = c(8, 9)))

T15_RAC_FTLW <- TIAS[, c("TA151132", "FTL_COUNT")] %>% group_by(TA151132, FTL_COUNT) %>% summarise(Count = n())

T15_RAC_FTLW <- T15_RAC_FTLW[1:17, ]

T15_RAC_CAT <- TIAS2015[, c("TA151132", "CAT")] %>% group_by(TA151132, CAT) %>% summarise(Count = n())

T15_RAC_CAT <- T15_RAC_CAT[1:11, ]

T15_RAC_FTLCAT <- TIAS2015_FTL[, c("TA151132", "CAT")] %>% group_by(TA151132, CAT) %>% summarise(Count = n())

T15_RAC_FTLCAT <- T15_RAC_FTLCAT[1:5, ]

T15_RAC_IACCAT <- TIAS2015_IAC[, c("TA151132", "CAT")] %>% group_by(TA151132, CAT) %>% summarise(Count = n())

T15_RAC_IACCAT <- T15_RAC_IACCAT[1:6, ]

head(T15_RAC_CAT, 11)

ggplot(T15_RAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA151132))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2015", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

head(T15_RAC_FTLW, 17)

ggplot(T15_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA151132)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2015", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

prop.table(table(TIAS2015_FTL$TA151132))

rac.pie.ftl.15 <- ggplot(data = T15_RAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA151132))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Other"))

prop.table(table(TIAS2015_IAC$TA151132))

rac.pie.iac.15 <- ggplot(data = T15_RAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA151132))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("White", "Black", "American Indian or Alaska Native", "Asian", "Native Hawaiian or Pacific Islander", "Other"))

ggarrange(rac.pie.ftl.15, rac.pie.iac.15, ncol = 2, nrow = 1, labels = c("FTL 2015", "IAC 2015"))

### Daily Cigarette Usage ========================================================================================================

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK)
####

table(TIAS$TA150954)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150954 = 998)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150954 = 998)) 

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150954 = 998)) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150954 = 998)) 

T15_CIG_FTLW <- TIAS[, c("TA150954", "FTL_COUNT")] %>% group_by(TA150954, FTL_COUNT) %>% summarise(Count = n())

T15_CIG_FTLW <- T15_CIG_FTLW[1:46, ]

T15_CIG_CAT <- TIAS2015[, c("TA150954", "CAT")] %>% group_by(TA150954, CAT) %>% summarise(Count = n())

T15_CIG_CAT <- T15_CIG_CAT[1:30, ]

ggplot(T15_CIG_FTLW, aes(x = FTL_COUNT, y = TA150954, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_CIG_CAT, aes(x = CAT, y = TA150954, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category"))

### Body Mass Index (BMI) ========================================================================================================

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA151283)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151283 = 99)) 

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA151283 = 99)) 

T15_BMI_FTLW <- TIAS2015[, c("TA151283", "FTL_COUNT")] %>% group_by(TA151283, FTL_COUNT) %>% summarise(Count = n())

T15_BMI_FTLW <- T15_BMI_FTLW[1:280, ]

T15_BMI_CAT <- TIAS2015[, c("TA151283", "CAT_15")] %>% group_by(TA151283, CAT_15) %>% summarise(Count = n())

T15_BMI_CAT <- T15_BMI_CAT[1:257, ]

ggplot(T15_BMI_FTLW, aes(x = FTL_COUNT, y = TA151283, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_BMI_CAT, aes(x = CAT_15, y = TA151283, group = CAT_15, fill = as.factor(CAT_15))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test")

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA150949)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA150949 = c(98, 99)))  

TIAS2015 <- TIAS2015 %>% 
  replace_with_na(replace = list(TA150949 = c(98, 99)))  

TIAS2015_FTL <- TIAS2015_FTL %>% 
  replace_with_na(replace = list(TA150949 = c(98, 99))) 

TIAS2015_IAC <- TIAS2015_IAC %>% 
  replace_with_na(replace = list(TA150949 = c(98, 99)))  

T15_SLP_FTLW <- TIAS[, c("TA150949", "FTL_COUNT")] %>% group_by(TA150949, FTL_COUNT) %>% summarise(Count = n())

T15_SLP_FTLW <- T15_SLP_FTLW[1:42, ]

T15_SLP_CAT <- TIAS2015[, c("TA150949", "CAT")] %>% group_by(TA150949, CAT) %>% summarise(Count = n())

T15_SLP_CAT <- T15_SLP_CAT[1:26, ]

ggplot(T15_SLP_FTLW, aes(x = FTL_COUNT, y = TA150949, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2015", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T15_SLP_CAT, aes(x = CAT, y = TA150949, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2015", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS-D Analysis - TIAS 2017 ######################## 

### Amphetamine Usage =========================================================================================================== 

####
# H44B. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used amphetamine on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171868)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171868 = 9))

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171868 = 9))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171868 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171868 = 9))

T17_AMP_FTLW <- TIAS[, c("TA171868", "FTL_COUNT")] %>% group_by(TA171868, FTL_COUNT) %>% summarise(Count = n())

T17_AMP_FTLW <- T17_AMP_FTLW[1:18,]

T17_AMP_CAT <- TIAS2017[, c("TA171868", "CAT")] %>% group_by(TA171868, CAT) %>% summarise(Count = n())

T17_AMP_CAT=T17_AMP_CAT[1:11, ]

head(T17_AMP_CAT, 11)

ggplot(T17_AMP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171852)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1", "gold"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T17_AMP_FTLW, 18)

ggplot(T17_AMP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171852)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Amphetamine Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1", "gold"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2017_FTL$TA171852))

prop.table(table(TIAS2017_IAC$TA171852))

### Barbiturate Usage =========================================================================================================== 

####
# H44E. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used barbiturates on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171868)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171868 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171868 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171868 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171868 = c(8, 9))) 

T17_BRB_FTLW <- TIAS[, c("TA171868", "FTL_COUNT")] %>% group_by(TA171868, FTL_COUNT) %>% summarise(Count = n())

T17_BRB_FTLW <- T17_BRB_FTLW[1:11, ]

T17_BRB_CAT <- TIAS2017[, c("TA171868", "CAT")] %>% group_by(TA171868, CAT) %>% summarise(Count = n())

T17_BRB_CAT=T17_BRB_CAT[1:8, ]

head(T17_BRB_CAT, 8)

ggplot(T17_BRB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171868)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1", "gold"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T17_BRB_FTLW, 11)

ggplot(T17_BRB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171868)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Barbiturate Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightgoldenrod1", "lightsalmon", "lightpink1", "mediumpurple1", "gold"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2017_FTL$TA171868))

prop.table(table(TIAS2017_IAC$TA171868))


### Marijuana Usage ============================================================================================================= 

####
# H44C. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used marijuana on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171860)

T17_MAR_FTLW <- TIAS[, c("TA171860", "FTL_COUNT")] %>% group_by(TA171860, FTL_COUNT) %>% summarise(Count = n())

T17_MAR_FTLW <- T17_MAR_FTLW[1:7, ]

T17_MAR_CAT <- TIAS2017[, c("TA171860", "CAT")] %>% group_by(TA171860, CAT) %>% summarise(Count = n())

T17_MAR_CAT=T17_MAR_CAT[1:4, ]

head(T17_MAR_CAT, 4)

ggplot(T17_MAR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171860)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Marijuana Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "maroon2"), labels = c("Never", "1-2 times", "10-19 times"))

head(T17_MAR_FTLW, 7)

ggplot(T17_MAR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171860)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Marijuana Usage (Prev. Year)",values = c("darkseagreen2", "darkslategray2", "maroon2"), labels = c("Never", "1-2 times", "10-19 times"))


prop.table(table(TIAS2017_FTL$TA171860))

prop.table(table(TIAS2017_IAC$TA171860))

### Diet Pill Usage ============================================================================================================= 

####
# H44A. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used diet pills on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171834)

T17_DIP_FTLW <- TIAS[, c("TA171834", "FTL_COUNT")] %>% group_by(TA171834, FTL_COUNT) %>% summarise(Count = n())

T17_DIP_FTLW <- T17_DIP_FTLW[1:12, ]

T17_DIP_CAT <- TIAS2017[, c("TA171834", "CAT")] %>% group_by(TA171834, CAT) %>% summarise(Count = n())

T17_DIP_CAT=T17_DIP_CAT[1:8, ]

head(T17_DIP_CAT, 8)

ggplot(T17_DIP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171834)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T17_DIP_FTLW, 12)

ggplot(T17_DIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171834)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Diet Pill Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold", "sienna1"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2017_FTL$TA171834))

prop.table(table(TIAS2017_IAC$TA171834))

### Steroid Usage =============================================================================================================== 

####
# H44G. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used steroids on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171884)

T17_STR_FTLW <- TIAS[, c("TA171884", "FTL_COUNT")] %>% group_by(TA171884, FTL_COUNT) %>% summarise(Count = n())

T17_STR_FTLW <- T17_STR_FTLW[1:10, ]

T17_STR_CAT <- TIAS2017[, c("TA171884", "CAT")] %>% group_by(TA171884, CAT) %>% summarise(Count = n())

T17_STR_CAT=T17_STR_CAT[1:7, ]

head(T17_STR_CAT, 7)

ggplot(T17_STR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171884)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times"))

head(T17_STR_FTLW, 10)

ggplot(T17_STR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171884)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_fill_manual("Steroid Usage (Prev. Year)", values = c("darkseagreen2", "darkslategray2", "lightpink1", "maroon2", "orangered", "gold"), labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times"))

prop.table(table(TIAS2017_FTL$TA171884))

prop.table(table(TIAS2017_IAC$TA171884))

### Tranquilizer Usage ========================================================================================================== 

####
# H44F. # of Times Took w/o Doc in Past 12mos: "On how many occasions (if any) have you taken/used tranquilizers on your own
# w/o a doctor telling you to take them during the last 12 months?" 
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171876)

table(TIAS$TA171876, TIAS$FTL_COUNT)

T17_TRQ_FTLW <- TIAS[, c("TA171876", "FTL_COUNT")] %>% group_by(TA171876, FTL_COUNT) %>% summarise(Count = n())

T17_TRQ_CAT <- TIAS2017[, c("TA171876", "CAT")] %>% group_by(TA171876, CAT) %>% summarise(Count = n())

T17_TRQ_FTLCAT <- TIAS2017_FTL[, c("TA171876", "CAT")] %>% group_by(TA171876, CAT) %>% summarise(Count = n())

T17_TRQ_IACCAT <- TIAS2017_IAC[, c("TA171876", "CAT")] %>% group_by(TA171876, CAT) %>% summarise(Count = n())

T17_TRQ_FTLW <- T17_TRQ_FTLW[1:6, ]
T17_TRQ_CAT <- T17_TRQ_CAT[1:3, ]


head(T17_TRQ_CAT, 3)

ggplot(T17_TRQ_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171876)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2", "gold"), labels = c("Never", "20-39 times"))

head(T17_TRQ_FTLW, 6)

ggplot(T17_TRQ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171876)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2",  "gold"), labels = c("Never","20-39 times"))

prop.table(table(TIAS2017_FTL$TA171876))

trq.pie.ftl.17 <- ggplot(data = T17_TRQ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171876))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0)  + 
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2",  "gold"), labels = c("Never","20-39 times"))

prop.table(table(TIAS2017_IAC$TA171876))

trq.pie.iac.17 <- ggplot(data = T17_TRQ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171876))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Tranquilizer Usage (Prev. Year)", values = c("darkseagreen2",  "gold"), labels = c("Never","20-39 times"))               

ggarrange(trq.pie.ftl.17, trq.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Cocaine Usage =============================================================================================================== 

####
# H42D_B. # of Occasions in Past 12mos: "On how many occasions (if any) have you used cocaine in the past 12 months?"
# Answers: 1 (1-2); 2 (3-5); 3 (6-9); 4 (10-19); 5 (20-39); 6 (40 or more); 8 (DK); 9 (NA/refused); 0 (Inap: 0 in past 12 mos or never)
#### 

table(TIAS$TA171839)

T17_CCN_FTLW <- TIAS[, c("TA171839", "FTL_COUNT")] %>% group_by(TA171839, FTL_COUNT) %>% summarise(Count = n())

T17_CCN_CAT <- TIAS2017[, c("TA171839", "CAT")] %>% group_by(TA171839, CAT) %>% summarise(Count = n())

T17_CCN_FTLCAT <- TIAS2017_FTL[, c("TA171839", "CAT")] %>% group_by(TA171839, CAT) %>% summarise(Count = n())

T17_CCN_IACCAT <- TIAS2017_IAC[, c("TA171839", "CAT")] %>% group_by(TA171839, CAT) %>% summarise(Count = n())

T17_CCN_FTLW <- T17_CCN_FTLW[1:17, ]
T17_CCN_CAT <- T17_CCN_CAT[1:9, ]

table(TIAS2017$TA171839, TIAS2017$CAT)

head(T17_CCN_CAT, 9)


ggplot(T17_CCN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171839))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

head(T17_CCN_FTLW, 17)

ggplot(T17_CCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171839)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times"))

prop.table(table(TIAS2017_FTL$TA171839))

ccn.pie.ftl.17 <- ggplot(data = T17_CCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171839))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold"), labels = c("Never", "1-2 times")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA171839))

ccn.pie.iac.17 <- ggplot(data = T17_CCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171839))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Cocaine Usage (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "hotpink"), 
                    labels = c("Never", "1-2 times", "3-5 times", "6-9 times", "10-19 times", "20-39 times", "40 or more times")) + 
  theme_void() 

ggarrange(ccn.pie.ftl.17, ccn.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))      

### Average Alcohol Consumption Frequency Over Past Year ======================================================================== 

#### 
# H37. How Often Have Drinks-HD: “In the last year, on average, how often did you have any alcohol to drink? Would you say: 
# less than once a month, about once a month, several times a month, about once a week, several times a week, or every day?”
# Answers: 1 (Less than once a month); 2 (About once a month); 3 (Several times a month); 4 (About once a week); 5 (Several times a week); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: Does not drink alcohol)
####

table(TIAS$TA171825)

T17_AAC_FTLW <- TIAS[, c("TA171825", "FTL_COUNT")] %>% group_by(TA171825, FTL_COUNT) %>% summarise(Count = n())

T17_AAC_FTLW <- T17_AAC_FTLW[1:25, ]

T17_AAC_CAT <- TIAS2017[, c("TA171825", "CAT")] %>% group_by(TA171825, CAT) %>% summarise(Count = n())

T17_AAC_CAT = T17_AAC_CAT[1:13, ]

T17_AAC_FTLCAT <- TIAS2017_FTL[, c("TA171825", "CAT")] %>% group_by(TA171825, CAT) %>% summarise(Count = n())

T17_AAC_FTLCAT = T17_AAC_FTLCAT[1:6, ]

T17_AAC_IACCAT <- TIAS2017_IAC[, c("TA171825", "CAT")] %>% group_by(TA171825, CAT) %>% summarise(Count = n())

T17_AAC_IACCAT=T17_AAC_IACCAT[1:7, ]

head(T17_AAC_CAT, 13)

ggplot(T17_AAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171825))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "rosybrown1", "sienna1"), 
                    labels = c("Never/Doesn't drink", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day"))

head(T17_AAC_FTLW, 23)

ggplot(T17_AAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171825)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "rosybrown1", "sienna1"), 
                    labels = c("Never/Doesn't drink", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) 

prop.table(table(TIAS2017_FTL$TA171825))

aac.pie.ftl.17 <- ggplot(data = T17_AAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171825))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "rosybrown1"), 
                    labels = c("Never/Doesn't drink", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA171825))

aac.pie.iac.17 <- ggplot(data = T17_AAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171825))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Alcohol Consumption (Prev. Year)", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "rosybrown1", "sienna1"), 
                    labels = c("Never/Doesn't drink", "Less than once a month", "About once a month", "Several times a month", "About once a week", "Several times a week", "Every day")) +
  theme_void() 

ggarrange(aac.pie.ftl.17, aac.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))        

### Average Daily Alcohol Consumption =========================================================================================== 

#### 
# H38. # Alcoholic Drinks Per Day: "In the last year, on the days you drank, about how many drinks did you have?”
# Answers: 1 (One drink or fewer); 2-50 (Actual number of drinks); 98 (DK); 99 (NA/refused); 0 (Inap.: Does not drink alcohol or drinks alcohol but frequency of drinking is DK or NA)
####

table(TIAS$TA171826)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171826 = 98)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171826 = 98)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171826 = 98)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171826 = 98))

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171826 = 99)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171826 = 99)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171826 = 99)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171826 = 99))  

T17_DAC_FTLW <- TIAS[, c("TA171826", "FTL_COUNT")] %>% group_by(TA171826, FTL_COUNT) %>% summarise(Count = n())

T17_DAC_FTLW <- T17_DAC_FTLW[1:36, ]

T17_DAC_CAT <- TIAS2017[, c("TA171826", "CAT")] %>% group_by(TA171826, CAT) %>% summarise(Count = n())

T17_DAC_CAT <- T17_DAC_CAT[1:25, ]

T17_DAC_FTLCAT <- TIAS2017_FTL[, c("TA171826", "CAT")] %>% group_by(TA171826, CAT) %>% summarise(Count = n())

T17_DAC_FTLCAT <- T17_DAC_FTLCAT[1:8, ]

T17_DAC_IACCAT <- TIAS2017_IAC[, c("TA171826", "CAT")] %>% group_by(TA171826, CAT) %>% summarise(Count = n())

T17_DAC_IACCAT <- T17_DAC_IACCAT[1:17, ]

head(T17_DAC_CAT, 25)

ggplot(T17_DAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171826))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
                                                                  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
                                                                                                                                                                                "10 drinks", "12 drinks", "15 drinks", "16 drinks", "20 drinks", "21 drinks", "24 drinks", "25 drinks"))

head(T17_DAC_FTLW, 46)

ggplot(T17_DAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171826)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
                                                                  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
                                                                                                                                                                                "10 drinks", "12 drinks", "15 drinks", "16 drinks", "20 drinks", "21 drinks", "24 drinks", "25 drinks"))

prop.table(table(TIAS2017_FTL$TA171826))

dac.pie.ftl.17 <- ggplot(data = T17_DAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171826))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "green3"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", 
                                                                                                                                                                  "10 drinks"))

prop.table(table(TIAS2017_IAC$TA171826))

dac.pie.iac.17 <- ggplot(data = T17_DAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171826))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) +
  scale_fill_manual("Avg. Daily Alcohol Consumption", values =  c("#E69F00", "#56B4E9", "#009E73", "gold", "#0072B2", "#D55E00", "#CC79A7", "lightcoral", "wheat", "green3", "mediumturquoise", 
                                                                  "deepskyblue", "mediumpurple1", "hotpink", "khaki1", "palegreen1", "paleturquoise1", "peachpuff"), labels = c("Never", "1 drink", "2 drinks", "3 drinks", "4 drinks", "5 drinks", "6 drinks", "7 drinks", "8 drinks", 
                                                                                                                                                                                "10 drinks", "12 drinks", "15 drinks", "16 drinks", "20 drinks", "21 drinks", "24 drinks", "25 drinks"))

ggarrange(dac.pie.ftl.17, dac.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))          

### Degree to Which Condition Limits Normal Daily Activities ==================================================================== 

####
# H13B. How much limits normal activities: "How much does this condition limit your normal daily activities? Would you say: A lot, somewhat, just a little, or not at all?”
# Answers: 1 (A lot); 2 (Somewhat); 3 (Just a little); 4 (Not at all); 8 (DK); 9 (NA; refused); 0 (Inap: Never diagnosed with any serious chronic condition)
####

table(TIAS$TA170923)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170923 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170923 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170923 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170923 = 9)) 

T17_DCN_FTLW <- TIAS[, c("TA170923", "FTL_COUNT")] %>% group_by(TA170923, FTL_COUNT) %>% summarise(Count = n())

T17_DCN_FTLW <- T17_DCN_FTLW[1:16, ]

T17_DCN_CAT <- TIAS2017[, c("TA170923", "CAT")] %>% group_by(TA170923, CAT) %>% summarise(Count = n())

T17_DCN_CAT <- T17_DCN_CAT[1:8, ]

T17_DCN_FTLCAT <- TIAS2017_FTL[, c("TA170923", "CAT")] %>% group_by(TA170923, CAT) %>% summarise(Count = n())


T17_DCN_IACCAT <- TIAS2017_IAC[, c("TA170923", "CAT")] %>% group_by(TA170923, CAT) %>% summarise(Count = n())

T17_DCN_IACCAT <- T17_DCN_IACCAT[1:5, ]

head(T17_DCN_CAT, 8)

ggplot(T17_DCN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170923)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

head(T17_DCN_FTLW, 16)

ggplot(T17_DCN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170923)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all"))

prop.table(table(TIAS2017_FTL$TA170923))

dcn.pie.ftl.17 <- ggplot(data = T17_DCN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170923))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Not at all")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170923))

dcn.pie.iac.17 <- ggplot(data = T17_DCN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170923))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Condition Limits Daily Activities", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Inap: No chronic condition", "A lot", "Somewhat", "Just a little", "Not at all")) +
  theme_void() 

ggarrange(dcn.pie.ftl.17, dcn.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Depression Over Past Year =================================================================================================== 

####
# H15. WTR>2 Wks Depressed In Past 12mos: “Now I want to ask you about periods of feeling sad, empty, or depressed. 
# In the past 12 months, have you had two weeks or longer when nearly every day you felt sad, empty, or depressed for most of the day?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA171806)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171806 = 8)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171806 = 8)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171806 = 8)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171806 = 8)) 


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171806 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171806 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171806 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171806 = 9)) 

T17_DEP_FTLW <- TIAS[, c("TA171806", "FTL_COUNT")] %>% group_by(TA171806, FTL_COUNT) %>% summarise(Count = n())

T17_DEP_FTLW <- T17_DEP_FTLW[1:9, ]

T17_DEP_CAT <- TIAS2017[, c("TA171806", "CAT")] %>% group_by(TA171806, CAT) %>% summarise(Count = n())

T17_DEP_CAT <- T17_DEP_CAT[1:4, ]

T17_DEP_FTLCAT <- TIAS2017_FTL[, c("TA171806", "CAT")] %>% group_by(TA171806, CAT) %>% summarise(Count = n())

T17_DEP_IACCAT <- TIAS2017_IAC[, c("TA171806", "CAT")] %>% group_by(TA171806, CAT) %>% summarise(Count = n())

T17_DEP_IACCAT <- T17_DEP_IACCAT[1:2, ]

head(T17_DEP_CAT, 4)

ggplot(T17_DEP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171806)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

head(T17_DEP_FTLW, 9)

ggplot(T17_DEP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171806)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") +
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_FTL$TA171806))

dep.pie.ftl.17 <- ggplot(data = T17_DEP_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171806))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2017_IAC$TA171806))

dep.pie.iac.17 <- ggplot(data = T17_DEP_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171806))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Depressed >2 Weeks", values = c("aquamarine3", "cadetblue2"), labels = c("Yes", "No")) + 
  theme_void() 

ggarrange(dep.pie.ftl.17, dep.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Depression - Anhedonia ======================================================================================================= 

####
# H16. WTR>2 Wks No Interest in Life: “In the past 12 months, have you had two weeks or longer when you lost interest in most things 
# like work, hobbies, and other things you usually enjoyed?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)

table(TIAS$TA171807)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171807 = 8)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171807 = 8)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171807 = 8)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171807 = 8)) 


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171807 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171807 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171807 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171807 = 9)) 


T17_ANH_FTLW <- TIAS[, c("TA171807", "FTL_COUNT")] %>% group_by(TA171807, FTL_COUNT) %>% summarise(Count = n())

T17_ANH_FTLW <- T17_ANH_FTLW[1:14,]

T17_ANH_CAT <- TIAS2017[, c("TA171807", "CAT")] %>% group_by(TA171807, CAT) %>% summarise(Count = n())

T17_ANH_CAT = T17_ANH_CAT[1:6, ]

T17_ANH_FTLCAT <- TIAS2017_FTL[, c("TA171807", "CAT")] %>% group_by(TA171807, CAT) %>% summarise(Count = n())

T17_ANH_FTLCAT=T17_ANH_FTLCAT[1:3, ]

T17_ANH_IACCAT <- TIAS2017_IAC[, c("TA171807", "CAT")] %>% group_by(TA171807, CAT) %>% summarise(Count = n())

T17_ANH_IACCAT = T17_ANH_IACCAT[1:3, ]

table(TIAS2017$TA171807, TIAS2017$CAT)

ggplot(T17_ANH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171807)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue"), labels = c("Inap (Anhedonia for >2wks", "Yes", "No"))

prop.table(table(TIAS2017_FTL$TA171807))

anh.pie.ftl.17 <- ggplot(data = T17_ANH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171807))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue"), labels = c("Inap (Anhedonia for >2wks", "Yes", "No")) + 
  theme_void() 

prop.table(table(TIAS2017_IAC$TA171807))

anh.pie.iac.17 <- ggplot(data = T17_ANH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171807))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anhedonia >2 Weeks", values = c("cadetblue1", "lightsalmon", "aliceblue"), labels = c("Inap (Anhedonia for >2wks", "Yes", "No")) + 
  theme_void() 

ggarrange(anh.pie.ftl.17, anh.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Depression Diagnosis ========================================================================================================= 

####
# H12B. WTR Depression: "What was the diagnosis? What is the emotional or psychiatric disorder?--DEPRESSION"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA170907)


T17_DPD_FTLW <- TIAS[, c("TA170907", "FTL_COUNT")] %>% group_by(TA170907, FTL_COUNT) %>% summarise(Count = n())

T17_DPD_FTLW <- T17_DPD_FTLW[1:9, ]

T17_DPD_CAT <- TIAS2017[, c("TA170907", "CAT")] %>% group_by(TA170907, CAT) %>% summarise(Count = n())

T17_DPD_CAT <- T17_DPD_CAT[1:4, ]

T17_DPD_FTLCAT <- TIAS2017_FTL[, c("TA170907", "CAT")] %>% group_by(TA170907, CAT) %>% summarise(Count = n())


T17_DPD_IACCAT <- TIAS2017_IAC[, c("TA170907", "CAT")] %>% group_by(TA170907, CAT) %>% summarise(Count = n())

head(T17_DPD_CAT, 4)

prop.table(table(TIAS2017_FTL$TA170907))
prop.table(table(TIAS2017_IAC$TA170907))

ggplot(T17_DPD_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170907)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

head(T17_DPD_FTLW, 8)

ggplot(T17_DPD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170907)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Depression Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))


### Bipolar Disorder Diagnosis =================================================================================================== 

####
# H12B. WTR Bipolar: "What was the diagnosis? What is the emotional or psychiatric disorder?--BIPOLAR DISORDER"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA170908)

T17_BIP_FTLW <- TIAS[, c("TA170908", "FTL_COUNT")] %>% group_by(TA170908, FTL_COUNT) %>% summarise(Count = n())

T17_BIP_FTLW <- T17_BIP_FTLW[1:9, ]

T17_BIP_CAT <- TIAS2017[, c("TA170908", "CAT")] %>% group_by(TA170908, CAT) %>% summarise(Count = n())

T17_BIP_CAT <- T17_BIP_CAT[1:4, ]

T17_BIP_FTLCAT <- TIAS2017_FTL[, c("TA170908", "CAT")] %>% group_by(TA170908, CAT) %>% summarise(Count = n())

T17_BIP_IACCAT <- TIAS2017_IAC[, c("TA170908", "CAT")] %>% group_by(TA170908, CAT) %>% summarise(Count = n())


head(T17_BIP_CAT, 4)

ggplot(T17_BIP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170908)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

head(T17_BIP_FTLW, 8)

ggplot(T17_BIP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170908)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Bipolar Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2017_FTL$TA170908))

prop.table(table(TIAS2017_IAC$TA170908))

### Phobia Diagnosis =============================================================================================================

####
# H12B. WTR Phobia: "What was the diagnosis? What is the emotional or psychiatric disorder?--PHOBIAS"
# Answers: 1 (Diagnosed); 8 (DK); 9 (NA/refused); 0 (Not Diagnosed)
####

table(TIAS$TA170911)

T17_PHB_FTLW <- TIAS[, c("TA170911", "FTL_COUNT")] %>% group_by(TA170911, FTL_COUNT) %>% summarise(Count = n())

T17_PHB_FTLW <- T17_PHB_FTLW[1:8, ]

T17_PHB_CAT <- TIAS2017[, c("TA170911", "CAT")] %>% group_by(TA170911, CAT) %>% summarise(Count = n())

T17_PHB_CAT <- T17_PHB_CAT[1:4, ]

T17_PHB_FTLCAT <- TIAS2017_FTL[, c("TA170911", "CAT")] %>% group_by(TA170911, CAT) %>% summarise(Count = n())

T17_PHB_IACCAT <- TIAS2017_IAC[, c("TA170911", "CAT")] %>% group_by(TA170911, CAT) %>% summarise(Count = n())

head(T17_PHB_CAT, 4)

ggplot(T17_PHB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170911)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

head(T17_PHB_FTLW, 8)

ggplot(T17_PHB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170911)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Phobia Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2017_FTL$TA170911))

prop.table(table(TIAS2017_IAC$TA170911))

### Anxiety Disorders Diagnosis ==================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Anxiety 
# Answers: 1 (Diagnosed w/ Anxiety); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA170910)

T17_ANX_FTLW <- TIAS[, c("TA170910", "FTL_COUNT")] %>% group_by(TA170910, FTL_COUNT) %>% summarise(Count = n())

T17_ANX_FTLW <- T17_ANX_FTLW[1:9, ]

T17_ANX_CAT <- TIAS2017[, c("TA170910", "CAT")] %>% group_by(TA170910, CAT) %>% summarise(Count = n())

T17_ANX_CAT <- T17_ANX_CAT[1:4, ]

T17_ANX_FTLCAT <- TIAS2017_FTL[, c("TA170910", "CAT")] %>% group_by(TA170910, CAT) %>% summarise(Count = n())

T17_ANX_IACCAT <- TIAS2017_IAC[, c("TA170910", "CAT")] %>% group_by(TA170910, CAT) %>% summarise(Count = n())

head(T17_ANX_CAT, 4)

ggplot(T17_ANX_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170910)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

head(T17_ANX_FTLW, 9)

ggplot(T17_ANX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170910)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed"))

prop.table(table(TIAS2017_FTL$TA170910))

anx.pie.ftl.17 <- ggplot(data = T17_ANX_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170910))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed")) + 
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170910))

anx.pie.iac.17 <- ggplot(data = T17_ANX_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170910))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Anxiety Disorder Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed")) + 
  theme_void() 

ggarrange(anx.pie.ftl.17, anx.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### OCD Diagnosis ================================================================================================================

#### 
# H12B. What was the diagnosis? What is the emotional or psychiatric disorder? -- Obsessive Compulsive Disorder 
# Answers: 1 (Diagnosed w/ OCD); 8 (DK); 9 (NA/refused); 
# 0 (Inap. Never Diagnosed w/ Anxiety or Never Diagnosed with Emotional/Nervous/Psychiatric Problems)
####

table(TIAS$TA170914)

T17_OCD_FTLW <- TIAS[, c("TA170914", "FTL_COUNT")] %>% group_by(TA170914, FTL_COUNT) %>% summarise(Count = n())

T17_OCD_FTLW <- T17_OCD_FTLW[1:8, ]

T17_OCD_CAT <- TIAS2017[, c("TA170914", "CAT")] %>% group_by(TA170914, CAT) %>% summarise(Count = n())

T17_OCD_CAT <- T17_OCD_CAT[1:4, ]

T17_OCD_FTLCAT <- TIAS2017_FTL[, c("TA170914", "CAT")] %>% group_by(TA170914, CAT) %>% summarise(Count = n())

T17_OCD_IACCAT <- TIAS2017_IAC[, c("TA170914", "CAT")] %>% group_by(TA170914, CAT) %>% summarise(Count = n())

head(T17_OCD_CAT, 4)


ggplot(T17_OCD_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170914)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed")) 


head(T17_OCD_FTLW, 8)

ggplot(T17_OCD_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170914)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("OCD Diagnosis", values = c("cadetblue1", "lightsalmon", "aquamarine3"), labels = c("No mental health problems", "Not Diagnosed", "Diagnosed")) 

prop.table(table(TIAS2017_FTL$TA170914))

prop.table(table(TIAS2017_IAC$TA170914))

### Mental Health: Non-Spec Psych Distress ======================================================================================= 

####
# Cumulative score from answers to NSPD scale questions: 
# (how often felt nervous/hopeless/restless/everything as an effort/sad/worthless in past mo.)
# Possible scores: 0-24; 99 (all items are DK/NA/refused)
####

table(TIAS$TA171975)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171975 = 99)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171975 = 99)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171975 = 99)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171975 = 99)) 

T17_NPD_FTLW <- TIAS[, c("TA171975", "FTL_COUNT")] %>% group_by(TA171975, FTL_COUNT) %>% summarise(Count = n())

T17_NPD_FTLW <- T17_NPD_FTLW[1:62, ]

T17_NPD_CAT <- TIAS2017[, c("TA171975", "CAT")] %>% group_by(TA171975, CAT) %>% summarise(Count = n())

T17_NPD_CAT <- T17_NPD_CAT[1:38, ]

ggplot(T17_NPD_FTLW, aes(x = FTL_COUNT, y = TA171975, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  scale_y_continuous(limits = c(0, 25), breaks = seq(0, 25, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_NPD_CAT, aes(x = CAT, y = TA171975, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "NSPD Scale Score") + 
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2017_FTL$TA171975))

prop.table(table(TIAS2017_IAC$TA171975))

### Mental Health: Social Anxiety ================================================================================================ 

####
# Cumulative score from answers to SA scale questions: 
# (how often nervous meeting others/feel shy/feel self-conscious/feel nervous performing)
# Possible scores: 1-7; 9 (all items are DK/NA/refused)
####

table(TIAS$TA171971)

T17_SOA_FTLW <- TIAS[, c("TA171971", "FTL_COUNT")] %>% group_by(TA171971, FTL_COUNT) %>% summarise(Count = n())

T17_SOA_FTLW <- T17_SOA_FTLW[1:20, ]

T17_SOA_CAT <- TIAS2017[, c("TA171971", "CAT")] %>% group_by(TA171971, CAT) %>% summarise(Count = n())

ggplot(T17_SOA_FTLW, aes(x = FTL_COUNT, y = TA171971, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) +
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_SOA_CAT, aes(x = CAT, y = TA171971, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "SA Scale Score") + 
  scale_y_continuous(limits = c(1, 7), breaks = seq(1, 7, by = 1)) +
  guides(fill = guide_legend(title = "Category"))


prop.table(table(TIAS2017_FTL$TA171971))

prop.table(table(TIAS2017_IAC$TA171971))


### Paid Employment Since Jan 1 of Prior Year ====================================================================================

#### 
# E3A. WTR Worked Since Jan 1 Of Prior Year: “Have you done any work for money since January 1, 2003? Please include any type of work, no matter how small”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Working Now)
####

table(TIAS$TA170187)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170187 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170187 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170187 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170187 = 9)) 


T17_EPJ_FTLW <- TIAS[, c("TA170187", "FTL_COUNT")] %>% group_by(TA170187, FTL_COUNT) %>% summarise(Count = n())

T17_EPJ_FTLW <- T17_EPJ_FTLW[1:14, ]

T17_EPJ_CAT <- TIAS2017[, c("TA170187", "CAT")] %>% group_by(TA170187, CAT) %>% summarise(Count = n())

T17_EPJ_CAT = T17_EPJ_CAT[1:6, ]

T17_EPJ_FTLCAT <- TIAS2017_FTL[, c("TA170187", "CAT")] %>% group_by(TA170187, CAT) %>% summarise(Count = n())

T17_EPJ_IACCAT <- TIAS2017_IAC[, c("TA170187", "CAT")] %>% group_by(TA170187, CAT) %>% summarise(Count = n())

T17_EPJ_IACCAT=T17_EPJ_IACCAT[1:3, ]

head(T17_EPJ_CAT, 6)

ggplot(T17_EPJ_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170187)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

head(T17_EPJ_FTLW, 14)

ggplot(T17_EPJ_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170187)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2017_FTL$TA170187))

epj.pie.ftl.17 <- ggplot(data = T17_EPJ_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170187))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) + theme_void() 

prop.table(table(TIAS2017_IAC$TA170187))

epj.pie.iac.17 <- ggplot(data = T17_EPJ_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170187))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment Since Prior Year", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Yes (Working Now)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(epj.pie.ftl.17, epj.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Paid Employment History ====================================================================================================== 

####
# E62. WTR Ever Worked: “Have you ever done any work for money?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Has worked since 01/01/2003)
####

table(TIAS$TA170386)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170386 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170386 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170386 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170386 = c(8, 9))) 

T17_EPH_FTLW <- TIAS[, c("TA170386", "FTL_COUNT")] %>% group_by(TA170386, FTL_COUNT) %>% summarise(Count = n())

T17_EPH_FTLW <- T17_EPH_FTLW[1:11, ]

T17_EPH_CAT <- TIAS2017[, c("TA170386", "CAT")] %>% group_by(TA170386, CAT) %>% summarise(Count = n())

T17_EPH_CAT = T17_EPH_CAT[1:6, ]

T17_EPH_FTLCAT <- TIAS2017_FTL[, c("TA170386", "CAT")] %>% group_by(TA170386, CAT) %>% summarise(Count = n())

T17_EPH_IACCAT <- TIAS2017_IAC[, c("TA170386", "CAT")] %>% group_by(TA170386, CAT) %>% summarise(Count = n())

T17_EPH_IACCAT=T17_EPH_IACCAT[1:3, ]

head(T17_EPH_CAT, 6)

ggplot(T17_EPH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170386)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes", "No"))

head(T17_EPH_FTLW, 11)

ggplot(T17_EPH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170386)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No"))

prop.table(table(TIAS2017_FTL$TA170386))

eph.pie.ftl.17 <- ggplot(data = T17_EPH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170386))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170386))

eph.pie.iac.17 <- ggplot(data = T17_EPH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170386))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Paid Employment History", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1"), labels = c("Yes (Employed Since 2003 or Before)", "Yes (Not Now)", "No")) +
  theme_void() 

ggarrange(eph.pie.ftl.17, eph.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Current Marital Status =======================================================================================================

####
# D1 Current Marital Status: Are you married, have you never been married, or are you widowed, divorced, or separated?
# Answers: 1 (Married); 2 (Never Married); 3 (Widowed); 4 (Divorced); 5 (Separated); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170093)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170093 = 9))

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170093 = 9))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170093 = 9))

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170093 = 9))

T17_CMS_FTLW <- TIAS[, c("TA170093", "FTL_COUNT")] %>% group_by(TA170093, FTL_COUNT) %>% summarise(Count = n())

T17_CMS_FTLW <- T17_CMS_FTLW[1:13, ]

T17_CMS_CAT <- TIAS2017[, c("TA170093", "CAT")] %>% group_by(TA170093, CAT) %>% summarise(Count = n())

T17_CMS_CAT = T17_CMS_CAT[1:9, ]

T17_CMS_FTLCAT <- TIAS2017_FTL[, c("TA170093", "CAT")] %>% group_by(TA170093, CAT) %>% summarise(Count = n())

T17_CMS_IACCAT <- TIAS2017_IAC[, c("TA170093", "CAT")] %>% group_by(TA170093, CAT) %>% summarise(Count = n())

T17_CMS_IACCAT = T17_CMS_IACCAT[1:5, ]

head(T17_CMS_CAT, 9)

ggplot(T17_CMS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170093)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

head(T17_CMS_FTLW, 15)

ggplot(T17_CMS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170093)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Current Marital Status", values = c("lightcoral", "khaki1", "mediumaquamarine", "lightskyblue", "sienna1"), labels = c("Married", "Never Married", "Widowed", "Divorced", "Separated"))

prop.table(table(TIAS2017_FTL$TA170093))
prop.table(table(TIAS2017_IAC$TA170093))

### Romantic Relationships ======================================================================================================= 

####
# D8. WTR Romantic Relationship Now: “Are you currently involved in a romantic relationship?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused); 0 (Inap: Married)
####

table(TIAS$TA170116)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170116 = c(8, 9))) 


T17_RRN_FTLW <- TIAS[, c("TA170116", "FTL_COUNT")] %>% group_by(TA170116, FTL_COUNT) %>% summarise(Count = n())

T17_RRN_FTLW <- T17_RRN_FTLW[1:14, ]

T17_RRN_CAT <- TIAS2017[, c("TA170116", "CAT")] %>% group_by(TA170116, CAT) %>% summarise(Count = n())

T17_RRN_CAT = T17_RRN_CAT[1:6, ]

T17_RRN_FTLCAT <- TIAS2017_FTL[, c("TA170116", "CAT")] %>% group_by(TA170116, CAT) %>% summarise(Count = n())

T17_RRN_IACCAT <- TIAS2017_IAC[, c("TA170116", "CAT")] %>% group_by(TA170116, CAT) %>% summarise(Count = n())

T17_RRN_IACCAT = T17_RRN_IACCAT[1:3, ]

head(T17_RRN_CAT, 6)

ggplot(T17_RRN_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170116)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink"), labels = c("Inap: Married", "Yes", "No"))

head(T17_RRN_FTLW, 14)

ggplot(T17_RRN_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170116)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No"))

prop.table(table(TIAS2017_FTL$TA170116))

rrn.pie.ftl.17 <- ggplot(data = T17_RRN_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170116))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No")) + theme_void()

prop.table(table(TIAS2017_IAC$TA170116))

rrn.pie.iac.17 <- ggplot(data = T17_RRN_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170116))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Involved in Romantic Rel.", values = c("darkturquoise", "darkviolet", "deeppink", "sienna1", "gold"), labels = c("Inap: Married", "Yes", "No")) +
  theme_void() 

ggarrange(rrn.pie.ftl.17, rrn.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Number of Children ===========================================================================================================

####
# D28A. Number of Children: “How many (biological,) adopted, or step- children do you have?”
# Answers: 0-20 (# of Children); 98 (DK); 99 (NA/refused)
####

table(TIAS$TA170176)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170176 = 99)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170176 = 99)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170176 = 99)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170176 = 99)) 

T17_CHL_FTLW <- TIAS[, c("TA170176", "FTL_COUNT")] %>% group_by(TA170176, FTL_COUNT) %>% summarise(Count = n())

T17_CHL_FTLW <- T17_CHL_FTLW[1:25, ]

T17_CHL_CAT <- TIAS2017[, c("TA170176", "CAT")] %>% group_by(TA170176, CAT) %>% summarise(Count = n())

T17_CHL_CAT <- T17_CHL_CAT[1:13, ]

ggplot(T17_CHL_FTLW, aes(x = FTL_COUNT, y = TA170176, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "Number of Children") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_CHL_CAT, aes(x = CAT, y = TA170176, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "Number of Children") + 
  guides(fill = guide_legend(title = "Category"))

### High School Education ======================================================================================================== 

####
# G1. WTR Graduated High School: “Now I would like to talk about the education you have received. Did you graduate from high school, get a GED, or neither?”
# Answers: 1 (Graduated from high school); 2 (Got a GED); 3 (Neither); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170781)

T17_HSG_FTLW <- TIAS[, c("TA170781", "FTL_COUNT")] %>% group_by(TA170781, FTL_COUNT) %>% summarise(Count = n())

T17_HSG_FTLW <- T17_HSG_FTLW[1:8, ]

T17_HSG_CAT <- TIAS2017[, c("TA170781", "CAT")] %>% group_by(TA170781, CAT) %>% summarise(Count = n())

T17_HSG_CAT <- T17_HSG_CAT[1:5, ]

T17_HSG_FTLCAT <- TIAS2017_FTL[, c("TA170781", "CAT")] %>% group_by(TA170781, CAT) %>% summarise(Count = n())

T17_HSG_IACCAT <- TIAS2017_IAC[, c("TA170781", "CAT")] %>% group_by(TA170781, CAT) %>% summarise(Count = n())

head(T17_HSG_CAT, 5)

ggplot(T17_HSG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170781)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "HS Diploma", "GED"))

head(T17_HSG_FTLW, 8)

ggplot(T17_HSG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170781)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "HS Diploma", "GED"))

prop.table(table(TIAS2017_FTL$TA170781))

hsg.pie.ftl.17 <- ggplot(data = T17_HSG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170781))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "Diploma")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170781))

hsg.pie.iac.17 <- ggplot(data = T17_HSG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170781))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("High School Education", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("Reported last wave", "Diploma", "GED")) +
  theme_void() 

ggarrange(hsg.pie.ftl.17, hsg.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### College Education ============================================================================================================ 

####
# G10. WTR Ever Attended College: “Have you ever attended college?” 
# Answers: 1 (In college); 2 (was in college); 3(never attended college/NA)
####

table(TIAS$TA170795)

T17_CLG_FTLW <- TIAS[, c("TA170795", "FTL_COUNT")] %>% group_by(TA170795, FTL_COUNT) %>% summarise(Count = n())

T17_CLG_FTLW <- T17_CLG_FTLW[1:12, ]

T17_CLG_CAT <- TIAS2017[, c("TA170795", "CAT")] %>% group_by(TA170795, CAT) %>% summarise(Count = n())

T17_CLG_CAT <- T17_CLG_CAT[1:4, ]

T17_CLG_FTLCAT <- TIAS2017_FTL[, c("TA170795", "CAT")] %>% group_by(TA170795, CAT) %>% summarise(Count = n())

T17_CLG_IACCAT <- TIAS2017_IAC[, c("TA170795", "CAT")] %>% group_by(TA170795, CAT) %>% summarise(Count = n())

head(T17_CLG_CAT, 4)

ggplot(T17_CLG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170795)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") +
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("In college", "Was in college", "Never attended college/other"))

head(T17_CLG_FTLW, 12)

ggplot(T17_CLG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170795)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("In college", "Was in college", "Never attended college/other"))

prop.table(table(TIAS2017_FTL$TA170795))

clg.pie.ftl.17 <- ggplot(data = T17_CLG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170795))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Attended college?", values = c("lightpink"), labels = c("Never attended college/other")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170795))

clg.pie.iac.17 <- ggplot(data = T17_CLG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170795))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Attended college?", values = c("lightblue1", "lightgoldenrod1", "lightpink"), labels = c("In college", "Was in college", "Never attended college/other"))

ggarrange(clg.pie.ftl.17, clg.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Highest Education Level ====================================================================================================== 

####
# Enrollment Status 
# Answers: 1 (No high school diploma and no GED); 2 (no high school diploma but has GED); 3 (Has high school diploma); 4 (Not enrolled, some college);
# 5 (Not enrolled, 2-yr college graduate); 6 (Not enrolled, 4-yr college graduate); 7 (Not enrolled, graduate degree); 9 (Enrolled, has no prior degree);
# 10 (Enrolled, has a prior degree); 11 (Enrolled, graduate program); 95 (Less than HS in PSID but never asked); 99 (NA/DK)
####

table(TIAS$TA171980)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171980 =  c(95, 99)))  

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171980 =  c(95, 99)))  

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171980 =  c(95, 99)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171980 =  c(95, 99)))  

T17_HEL_FTLW <- TIAS[, c("TA171980", "FTL_COUNT")] %>% group_by(TA171980, FTL_COUNT) %>% summarise(Count = n())

T17_HEL_FTLW <- T17_HEL_FTLW[1:29, ]

T17_HEL_CAT <- TIAS2017[, c("TA171980", "CAT")] %>% group_by(TA171980, CAT) %>% summarise(Count = n())

T17_HEL_CAT <- T17_HEL_CAT[1:15, ]

T17_HEL_FTLCAT <- TIAS2017_FTL[, c("TA171980", "CAT")] %>% group_by(TA171980, CAT) %>% summarise(Count = n())

T17_HEL_FTLCAT <- T17_HEL_FTLCAT[1:5, ]

T17_HEL_IACCAT <- TIAS2017_IAC[, c("TA171980", "CAT")] %>% group_by(TA171980, CAT) %>% summarise(Count = n())

T17_HEL_IACCAT <- T17_HEL_IACCAT[1:10, ]

head(T17_HEL_CAT, 15)

ggplot(T17_HEL_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171980))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

head(T17_HEL_FTLW, 29)

ggplot(T17_HEL_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171980)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

prop.table(table(TIAS2017_FTL$TA171980))

hel.pie.ftl.17 <- ggplot(data = T17_HEL_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171980))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate"))

prop.table(table(TIAS2017_IAC$TA171980))

hel.pie.iac.17 <- ggplot(data = T17_HEL_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171980))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Highest Education Level", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumspringgreen", "mediumslateblue", "sienna1", "rosybrown1", "aliceblue"), 
                    labels = c("No HS Diploma, No GED", "No HS Diploma, GED", "HS Diploma", "Not Enrolled, Some College", "Not Enrolled, 2-yr College Graduate", "Not Enrolled, 4-yr College Graduate", "Not Enrolled, Graduate Degree", "Enrolled in College, No Prior Degree", 
                               "Enrolled in College, Has Prior Degree", "Enrolled in Graduate Program", "Previously Reported"))

ggarrange(hel.pie.ftl.17, hel.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Responsibility - Earning Own Living ==========================================================================================

####
# B5A. How Much Responsibility Earning Own Living: “As people get older they begin to take more responsibility for themselves. How much responsibility do you currently take for earning your own living?”
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA170061)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170061 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170061 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170061 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170061 = c(8, 9))) 

T17_REO_FTLW <- TIAS[, c("TA170061", "FTL_COUNT")] %>% group_by(TA170061, FTL_COUNT) %>% summarise(Count = n())

T17_REO_FTLW <- T17_REO_FTLW[1:22, ]

T17_REO_CAT <- TIAS2017[, c("TA170061", "CAT")] %>% group_by(TA170061, CAT) %>% summarise(Count = n())

T17_REO_CAT=T17_REO_CAT[1:12, ]

T17_REO_FTLCAT <- TIAS2017_FTL[, c("TA170061", "CAT")] %>% group_by(TA170061, CAT) %>% summarise(Count = n())

T17_REO_IACCAT <- TIAS2017_IAC[, c("TA170061", "CAT")] %>% group_by(TA170061, CAT) %>% summarise(Count = n())

T17_REO_IACCAT=T17_REO_IACCAT[1:6, ]

head(T17_REO_CAT, 12)

ggplot(T17_REO_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170061)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

head(T17_REO_FTLW, 22)

ggplot(T17_REO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170061)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2017_FTL$TA170061))

reo.pie.ftl.17 <- ggplot(data = T17_REO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170061))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

prop.table(table(TIAS2017_IAC$TA170061))

reo.pie.iac.17 <- ggplot(data = T17_REO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170061))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Earning Own Living", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time"))

ggarrange(reo.pie.ftl.17, reo.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Responsibility - Paying Own Rent =============================================================================================

####
# B5B. How Much Responsibility Paying Own Rent: “How much responsibility do you currently take for paying your rent or mortgage?"  
# Answers: 0 (not 18-24); 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 
# 4 (I do this most of the time); 5 (I am completely responsible for this all the time); 6 (No rent or mortgage to pay); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA170062)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170062 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170062 = c(8, 9)))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170062 = c(8, 9)))

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170062 = c(8, 9))) 

T17_POR_FTLW <- TIAS[, c("TA170062", "FTL_COUNT")] %>% group_by(TA170062, FTL_COUNT) %>% summarise(Count = n())

T17_POR_FTLW <- T17_POR_FTLW[1:24, ]

T17_POR_CAT <- TIAS2017[, c("TA170062", "CAT")] %>% group_by(TA170062, CAT) %>% summarise(Count = n())

T17_POR_CAT <- T17_POR_CAT[1:14, ]

T17_POR_FTLCAT <- TIAS2017_FTL[, c("TA170062", "CAT")] %>% group_by(TA170062, CAT) %>% summarise(Count = n())

T17_POR_IACCAT <- TIAS2017_IAC[, c("TA170062", "CAT")] %>% group_by(TA170062, CAT) %>% summarise(Count = n())

T17_POR_IACCAT <- T17_POR_IACCAT[1:7, ]

head(T17_POR_CAT, 14)

ggplot(T17_POR_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170062)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T17_POR_FTLW, 24)

ggplot(T17_POR_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170062)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2017_FTL$TA170062))

por.pie.ftl.17 <- ggplot(data = T17_POR_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170062))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

prop.table(table(TIAS2017_IAC$TA170062))

por.pie.iac.17 <- ggplot(data = T17_POR_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170062))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Paying Own Rent", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))  + theme_void()

ggarrange(por.pie.ftl.17, por.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Responsibility - Paying Own Bills ============================================================================================

####
# B5C. How Much Responsibility for Own Bills: How much responsibility do you currently take for paying your bills?  
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 6 (No bills; 8 (DK); 9 (NA; refused)
####

table(TIAS$TA170063)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170063 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170063 = c(8, 9)))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170063 = c(8, 9)))

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170063 = c(8, 9))) 

T17_POB_FTLW <- TIAS[, c("TA170063", "FTL_COUNT")] %>% group_by(TA170063, FTL_COUNT) %>% summarise(Count = n())

T17_POB_FTLW <- T17_POB_FTLW[1:24, ]

T17_POB_CAT <- TIAS2017[, c("TA170063", "CAT")] %>% group_by(TA170063, CAT) %>% summarise(Count = n())

T17_POB_CAT = T17_POB_CAT [1:14, ]

T17_POB_FTLCAT <- TIAS2017_FTL[, c("TA170063", "CAT")] %>% group_by(TA170063, CAT) %>% summarise(Count = n())

T17_POB_FTLCAT = T17_POB_FTLCAT[1:7, ]

T17_POB_IACCAT <- TIAS2017_IAC[, c("TA170063", "CAT")] %>% group_by(TA170063, CAT) %>% summarise(Count = n())

T17_POB_IACCAT = T17_POB_IACCAT[1:7, ]

head(T17_POB_CAT, 14)

ggplot(T17_POB_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170063)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T17_POB_FTLW, 24)

ggplot(T17_POB_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170063)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2017_FTL$TA170063))

pob.pie.ftl.17 <- ggplot(data = T17_POB_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170063))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))


prop.table(table(TIAS2017_IAC$TA170063))

pob.pie.iac.17 <- ggplot(data = T17_POB_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170063))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Responsibility - Paying Own Bills", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

ggarrange(pob.pie.ftl.17, pob.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Responsibility - Managing Money ============================================================================================== 

####
# B5D. How Much Responsibility Managing Money: "How much responsibility do you currently take for managing your money?"
# Answers: 1 (Somebody else does this for me all of the time); 2 (Somebody else does this most of the time); 3 (I do this half of the time); 4 (I do this most of the time); 
# 5 (I am completely responsible for this all the time); 8 (DK); 9 (NA; refused)
####

table(TIAS$TA170064)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170064 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170064 = c(8, 9)))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170064 = c(8, 9)))

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170064 = c(8, 9)))

T17_RMM_FTLW <- TIAS[, c("TA170064", "FTL_COUNT")] %>% group_by(TA170064, FTL_COUNT) %>% summarise(Count = n())

T17_RMM_FTLW <- T17_RMM_FTLW[1:20, ]

T17_RMM_CAT <- TIAS2017[, c("TA170064", "CAT")] %>% group_by(TA170064, CAT) %>% summarise(Count = n())

T17_RMM_CAT=T17_RMM_CAT[1:12, ]

T17_RMM_FTLCAT <- TIAS2017_FTL[, c("TA170064", "CAT")] %>% group_by(TA170064, CAT) %>% summarise(Count = n())

T17_RMM_FTLCAT=T17_RMM_FTLCAT[1:6, ]

T17_RMM_IACCAT <- TIAS2017_IAC[, c("TA170064", "CAT")] %>% group_by(TA170064, CAT) %>% summarise(Count = n())

T17_RMM_IACCAT=T17_RMM_IACCAT[1:6, ]

head(T17_RMM_CAT, 12)

ggplot(T17_RMM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170064)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

head(T17_RMM_FTLW, 20)

ggplot(T17_RMM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170064)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Responsibility - Managing Money", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments"))

prop.table(table(TIAS2017_FTL$TA170064))

rmm.pie.ftl.17 <- ggplot(data = T17_RMM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170064))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments")) +
  theme_void()

prop.table(table(TIAS2017_IAC$TA170064))

rmm.pie.iac.17 <- ggplot(data = T17_RMM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170064))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Responsibility - Managing Money", values = c("aliceblue", "lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "blueviolet"), 
                    labels = c("Not 18-24", "Never", "Sometimes", "Half of the time", "Most of the time", "All of the time", "No payments")) +
  theme_void()

ggarrange(rmm.pie.ftl.17, rmm.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M1 - Happiness =========================================================================================================

####
# M1. Frequency of Happiness in the Last Month: "These last questions are about how you have been feeling in the last month. In the last month, how often did you feel happy?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170065)

T17_M01_FTLW <- TIAS[, c("TA170065", "FTL_COUNT")] %>% group_by(TA170065, FTL_COUNT) %>% summarise(Count = n())

T17_M01_FTLW <- T17_M01_FTLW[1:23, ]

T17_M01_CAT <- TIAS2017[, c("TA170065", "CAT")] %>% group_by(TA170065, CAT) %>% summarise(Count = n())

T17_M01_CAT=T17_M01_CAT[1:12, ]

T17_M01_FTLCAT <- TIAS2017_FTL[, c("TA170065", "CAT")] %>% group_by(TA170065, CAT) %>% summarise(Count = n())

T17_M01_IACCAT <- TIAS2017_IAC[, c("TA170065", "CAT")] %>% group_by(TA170065, CAT) %>% summarise(Count = n())

head(T17_M01_CAT, 12)

ggplot(T17_M01_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170065)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M01_FTLW, 23)

ggplot(T17_M01_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170065)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170065))

m01.pie.ftl.17 <- ggplot(data = T17_M01_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170065))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

prop.table(table(TIAS2017_IAC$TA170065))

m01.pie.iac.17 <- ggplot(data = T17_M01_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170065))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Happiness in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m01.pie.ftl.17, m01.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M2 - Interest in Life ==================================================================================================

####
# M2. Freq of Interest in Life in the Last Month: "In the last month, how often did you feel interested in life?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170066)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170066 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170066 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170066 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170066 = c(8, 9))) 

T17_M02_FTLW <- TIAS[, c("TA170066", "FTL_COUNT")] %>% group_by(TA170066, FTL_COUNT) %>% summarise(Count = n())

T17_M02_FTLW <- T17_M02_FTLW[1:19, ]

T17_M02_CAT <- TIAS2017[, c("TA170066", "CAT")] %>% group_by(TA170066, CAT) %>% summarise(Count = n())

T17_M02_CAT=T17_M02_CAT[1:11, ]

T17_M02_FTLCAT <- TIAS2017_FTL[, c("TA170066", "CAT")] %>% group_by(TA170066, CAT) %>% summarise(Count = n())

T17_M02_IACCAT <- TIAS2017_IAC[, c("TA170066", "CAT")] %>% group_by(TA170066, CAT) %>% summarise(Count = n())

T17_M02_IACCAT=T17_M02_IACCAT[1:6, ]

head(T17_M02_CAT, 11)

ggplot(T17_M02_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170066)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M02_FTLW, 19)

ggplot(T17_M02_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170066)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170066))

m02.pie.ftl.17 <- ggplot(data = T17_M02_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170066))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170066))

m02.pie.iac.17 <- ggplot(data = T17_M02_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170066))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m02.pie.ftl.17, m02.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M3 - Satisfaction ======================================================================================================

####
# M3. Freq of Feeling Satisfied in Last Month: "In the last month, how often did you feel satisfied?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170067)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170067 = 8)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170067 = 8)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170067 = 8)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170067 = 8)) 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170067 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170067 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170067 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170067 = 9)) 

T17_M03_FTLW <- TIAS[, c("TA170067", "FTL_COUNT")] %>% group_by(TA170067, FTL_COUNT) %>% summarise(Count = n())

T17_M03_FTLW <- T17_M03_FTLW[1:23, ]

T17_M03_CAT <- TIAS2017[, c("TA170067", "CAT")] %>% group_by(TA170067, CAT) %>% summarise(Count = n())

T17_M03_CAT = T17_M03_CAT[1:12, ]

T17_M03_FTLCAT <- TIAS2017_FTL[, c("TA170067", "CAT")] %>% group_by(TA170067, CAT) %>% summarise(Count = n())

T17_M03_IACCAT <- TIAS2017_IAC[, c("TA170067", "CAT")] %>% group_by(TA170067, CAT) %>% summarise(Count = n())

T17_M03_IACCAT = T17_M03_IACCAT[1:6, ]

head(T17_M03_CAT, 12)

ggplot(T17_M03_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170067)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M03_FTLW, 23)

ggplot(T17_M03_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170067)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170067))

m03.pie.ftl.17 <- ggplot(data = T17_M03_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170067))) +  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Satisfaction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170067))

m03.pie.iac.17 <- ggplot(data = T17_M03_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170067))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Interest in Life in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "lightpink"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m03.pie.ftl.17, m03.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M4 - Contribution of Something Important to Society ====================================================================

####
# M4. Freq of Feeling Contributed to Society: “In the last month, how often did you feel that you had something important to contribute to society?"
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170068)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170068 = 8)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170068 = 8)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170068 = 8)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170068 = 8)) 


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170068 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170068 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170068 = 9)) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170068 = 9)) 

T17_M04_FTLW <- TIAS[, c("TA170068", "FTL_COUNT")] %>% group_by(TA170068, FTL_COUNT) %>% summarise(Count = n())

T17_M04_FTLW <- T17_M04_FTLW[1:23, ]

T17_M04_CAT <- TIAS2017[, c("TA170068", "CAT")] %>% group_by(TA170068, CAT) %>% summarise(Count = n())

T17_M04_CAT <- T17_M04_CAT[1:12, ]

T17_M04_FTLCAT <- TIAS2017_FTL[, c("TA170068", "CAT")] %>% group_by(TA170068, CAT) %>% summarise(Count = n())

T17_M04_IACCAT <- TIAS2017_IAC[, c("TA170068", "CAT")] %>% group_by(TA170068, CAT) %>% summarise(Count = n())

T17_M04_IACCAT = T17_M04_IACCAT[1:6, ]
head(T17_M04_CAT, 12)

ggplot(T17_M04_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170068)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M04_FTLW, 24)

ggplot(T17_M04_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170068)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170068))

m04.pie.ftl.17 <- ggplot(data = T17_M04_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170068))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170068))

m04.pie.iac.17 <- ggplot(data = T17_M04_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170068))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Contributed to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m04.pie.ftl.17, m04.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M5 - Belonging to Community ============================================================================================

####
# M5. Freq of Feeling Belonging to Community: "In the last month, how often did you feel that you belonged to a community like a social group, your school, or your neighborhood?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170069)

T17_M05_FTLW <- TIAS[, c("TA170069", "FTL_COUNT")] %>% group_by(TA170069, FTL_COUNT) %>% summarise(Count = n())

T17_M05_FTLW <- T17_M05_FTLW[1:24, ]

T17_M05_CAT <- TIAS2017[, c("TA170069", "CAT")] %>% group_by(TA170069, CAT) %>% summarise(Count = n())

T17_M05_CAT = T17_M05_CAT[1:12, ]

T17_M05_FTLCAT <- TIAS2017_FTL[, c("TA170069", "CAT")] %>% group_by(TA170069, CAT) %>% summarise(Count = n())

T17_M05_IACCAT <- TIAS2017_IAC[, c("TA170069", "CAT")] %>% group_by(TA170069, CAT) %>% summarise(Count = n())


head(T17_M05_CAT, 12)

ggplot(T17_M05_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M05_FTLW, 24)

ggplot(T17_M05_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170069)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170069))

m05.pie.ftl.17 <- ggplot(data = T17_M05_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170069))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170069))

m05.pie.iac.17 <- ggplot(data = T17_M05_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170069))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Belonging to Society in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m05.pie.ftl.17, m05.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M6 - Society Getting Better ============================================================================================

####
# M6. Freq of Feeling Society Getting Better: "In the last month, how often did you feel that our society is becoming a better place?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170070)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170070 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170070 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170070 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170070 = c(8, 9)))  

T17_M06_FTLW <- TIAS[, c("TA170070", "FTL_COUNT")] %>% group_by(TA170070, FTL_COUNT) %>% summarise(Count = n())

T17_M06_FTLW <- T17_M06_FTLW[1:25, ]

T17_M06_CAT <- TIAS2017[, c("TA170070", "CAT")] %>% group_by(TA170070, CAT) %>% summarise(Count = n())

T17_M06_CAT <- T17_M06_CAT[1:12, ]

T17_M06_FTLCAT <- TIAS2017_FTL[, c("TA170070", "CAT")] %>% group_by(TA170070, CAT) %>% summarise(Count = n())

T17_M06_IACCAT <- TIAS2017_IAC[, c("TA170070", "CAT")] %>% group_by(TA170070, CAT) %>% summarise(Count = n())

T17_M06_IACCAT <- T17_M06_IACCAT[1:6, ]

head(T17_M06_CAT, 12)

ggplot(T17_M06_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M06_FTLW, 25)

ggplot(T17_M06_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170070)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170070))

m06.pie.ftl.17 <- ggplot(data = T17_M06_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170070))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170070))

m06.pie.iac.17 <- ggplot(data = T17_M06_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170070))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Society Getting Better in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m06.pie.ftl.17, m06.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M7 - People Basically Good =============================================================================================

####
# M7. Freq of Feeling People Basically Good: "In the last month, how often did you feel that people are basically good?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170071)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170071 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170071 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170071 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170071 = c(8, 9))) 

T17_M07_FTLW <- TIAS[, c("TA170071", "FTL_COUNT")] %>% group_by(TA170071, FTL_COUNT) %>% summarise(Count = n())

T17_M07_FTLW <- T17_M07_FTLW[1:24, ]

T17_M07_CAT <- TIAS2017[, c("TA170071", "CAT")] %>% group_by(TA170071, CAT) %>% summarise(Count = n())

T17_M07_CAT <- T17_M07_CAT[1:12, ]

T17_M07_FTLCAT <- TIAS2017_FTL[, c("TA170071", "CAT")] %>% group_by(TA170071, CAT) %>% summarise(Count = n())

T17_M07_FTLCAT <- T17_M07_FTLCAT[1:6, ]

T17_M07_IACCAT <- TIAS2017_IAC[, c("TA170071", "CAT")] %>% group_by(TA170071, CAT) %>% summarise(Count = n())

T17_M07_IACCAT <- T17_M07_IACCAT[1:6, ]

head(T17_M07_CAT, 12)

ggplot(T17_M07_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170071)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M07_FTLW, 24)

ggplot(T17_M07_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170071)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170071))

m07.pie.ftl.17 <- ggplot(data = T17_M07_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170071))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170071))

m07.pie.iac.17 <- ggplot(data = T17_M07_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170071))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling People are Good in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m07.pie.ftl.17, m07.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M8 - Way Society Makes Sense ===========================================================================================

####
# M8. Freq Feeling Way Soc Works Makes Sense: "In the last month, how often did you feel that the way our society works made sense to you?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170072)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170072 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170072 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170072 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170072 = c(8, 9))) 

T17_M08_FTLW <- TIAS[, c("TA170072", "FTL_COUNT")] %>% group_by(TA170072, FTL_COUNT) %>% summarise(Count = n())

T17_M08_FTLW <- T17_M08_FTLW[1:24, ]

T17_M08_CAT <- TIAS2017[, c("TA170072", "CAT")] %>% group_by(TA170072, CAT) %>% summarise(Count = n())

T17_M08_CAT <- T17_M08_CAT[1:12, ]

T17_M08_FTLCAT <- TIAS2017_FTL[, c("TA170072", "CAT")] %>% group_by(TA170072, CAT) %>% summarise(Count = n())

T17_M08_FTLCAT <- T17_M08_FTLCAT[1:6, ]

T17_M08_IACCAT <- TIAS2017_IAC[, c("TA170072", "CAT")] %>% group_by(TA170072, CAT) %>% summarise(Count = n())

T17_M08_IACCAT <- T17_M08_IACCAT[1:6, ]

head(T17_M08_CAT, 12)

ggplot(T17_M08_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170072)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M08_FTLW, 24)

ggplot(T17_M08_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170072)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170072))

m08.pie.ftl.17 <- ggplot(data = T17_M08_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170072))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170072))

m08.pie.iac.17 <- ggplot(data = T17_M08_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170072))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Soc. Makes Sense in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m08.pie.ftl.17, m08.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M9 - Managing Daily Responsibility =====================================================================================

####
# M9. Freq Feel Managing Responsibility: "In the last month, how often did you feel good at managing the responsibilities of your daily life?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170073)

T17_M09_FTLW <- TIAS[, c("TA170073", "FTL_COUNT")] %>% group_by(TA170073, FTL_COUNT) %>% summarise(Count = n())

T17_M09_FTLW <- T17_M09_FTLW[1:22, ]

T17_M09_CAT <- TIAS2017[, c("TA170073", "CAT")] %>% group_by(TA170073, CAT) %>% summarise(Count = n())

T17_M09_CAT = T17_M09_CAT [1:12, ]

T17_M09_FTLCAT <- TIAS2017_FTL[, c("TA170073", "CAT")] %>% group_by(TA170073, CAT) %>% summarise(Count = n())

T17_M09_FTLCAT = T17_M09_FTLCAT[1:6, ]

T17_M09_IACCAT <- TIAS2017_IAC[, c("TA170073", "CAT")] %>% group_by(TA170073, CAT) %>% summarise(Count = n())

T17_M09_IACCAT = T17_M09_IACCAT[1:6, ]

head(T17_M09_CAT, 12)

ggplot(T17_M09_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170073)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M09_FTLW, 22)

ggplot(T17_M09_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170073)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170073))

m09.pie.ftl.17 <- ggplot(data = T17_M09_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170073))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170073))

m09.pie.iac.17 <- ggplot(data = T17_M09_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170073))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Managing Resp. in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m09.pie.ftl.17, m09.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M10 - Trusting Relationships w/ Others =================================================================================

####
# M10. Freq Feeling Trusting Rels w/ Others: "In the last month, how often did you feel that you have warm and trusting relationships with other people?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170074)

T17_M10_FTLW <- TIAS[, c("TA170074", "FTL_COUNT")] %>% group_by(TA170074, FTL_COUNT) %>% summarise(Count = n())

T17_M10_FTLW <- T17_M10_FTLW[1:22, ]

T17_M10_CAT <- TIAS2017[, c("TA170074", "CAT")] %>% group_by(TA170074, CAT) %>% summarise(Count = n())

T17_M10_CAT = T17_M10_CAT[1:12, ]

T17_M10_FTLCAT <- TIAS2017_FTL[, c("TA170074", "CAT")] %>% group_by(TA170074, CAT) %>% summarise(Count = n())

T17_M10_FTLCAT = T17_M10_FTLCAT[1:6, ]

T17_M10_IACCAT <- TIAS2017_IAC[, c("TA170074", "CAT")] %>% group_by(TA170074, CAT) %>% summarise(Count = n())

T17_M10_IACCAT = T17_M10_IACCAT[1:6, ]

head(T17_M10_CAT, 12)

ggplot(T17_M10_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170074)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M10_FTLW, 22)

ggplot(T17_M10_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170074)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170074))

m10.pie.ftl.17 <- ggplot(data = T17_M10_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170074))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170074))

m10.pie.iac.17 <- ggplot(data = T17_M10_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170074))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Trusting Rels w/ Others in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m10.pie.ftl.17, m10.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M11 - Challenged to Grow ===============================================================================================

####
# M11. Freq Feeling Challenged to Grow: "In the last month, how often did you feel that you have experiences that challenged you to grow or become a better person?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170075)

T17_M11_FTLW <- TIAS[, c("TA170075", "FTL_COUNT")] %>% group_by(TA170075, FTL_COUNT) %>% summarise(Count = n())

T17_M11_FTLW <- T17_M11_FTLW[1:23, ]

T17_M11_CAT <- TIAS2017[, c("TA170075", "CAT")] %>% group_by(TA170075, CAT) %>% summarise(Count = n())

T17_M11_CAT = T17_M11_CAT[1:11, ]

T17_M11_FTLCAT <- TIAS2017_FTL[, c("TA170075", "CAT")] %>% group_by(TA170075, CAT) %>% summarise(Count = n())

T17_M11_FTLCAT = T17_M11_FTLCAT[1:5, ]

T17_M11_IACCAT <- TIAS2017_IAC[, c("TA170075", "CAT")] %>% group_by(TA170075, CAT) %>% summarise(Count = n())

T17_M11_IACCAT = T17_M11_IACCAT[1:6, ]

head(T17_M11_CAT, 11)

ggplot(T17_M11_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170075)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M11_FTLW, 23)

ggplot(T17_M11_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170075)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170075))

m11.pie.ftl.17 <- ggplot(data = T17_M11_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170075))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Once or twice a week", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170075))

m11.pie.iac.17 <- ggplot(data = T17_M11_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170075))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Challenged to Grow in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) + 
  theme_void()

ggarrange(m11.pie.ftl.17, m11.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M12 - Confident of Own Ideas ===========================================================================================

####
# M12. Freq Feeling Confident of Own Ideas: "In the last month, how often did you feel confident to think or express your own ideas and opinions?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170076)

T17_M12_FTLW <- TIAS[, c("TA170076", "FTL_COUNT")] %>% group_by(TA170076, FTL_COUNT) %>% summarise(Count = n())

T17_M12_FTLW <- T17_M12_FTLW[1:22, ]

T17_M12_CAT <- TIAS2017[, c("TA170076", "CAT")] %>% group_by(TA170076, CAT) %>% summarise(Count = n())

T17_M12_CAT = T17_M12_CAT[1:12, ]

T17_M12_FTLCAT <- TIAS2017_FTL[, c("TA170076", "CAT")] %>% group_by(TA170076, CAT) %>% summarise(Count = n())

T17_M12_IACCAT <- TIAS2017_IAC[, c("TA170076", "CAT")] %>% group_by(TA170076, CAT) %>% summarise(Count = n())

head(T17_M12_CAT, 12)

ggplot(T17_M12_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170076)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M12_FTLW, 22)

ggplot(T17_M12_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170076)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170076))

m12.pie.ftl.17 <- ggplot(data = T17_M12_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170076))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170076))

m12.pie.iac.17 <- ggplot(data = T17_M12_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170076))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Confident of Own Ideas in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m12.pie.ftl.17, m12.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M13 - Liked Personality ================================================================================================

####
# M13. Freq Feeling Liked Personality: "In the last month, how often did you feel that you liked your personality?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170077)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170077 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170077 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170077 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170077 = c(8, 9))) 

T17_M13_FTLW <- TIAS[, c("TA170077", "FTL_COUNT")] %>% group_by(TA170077, FTL_COUNT) %>% summarise(Count = n())

T17_M13_FTLW <- T17_M13_FTLW[1:21, ]

T17_M13_CAT <- TIAS2017[, c("TA170077", "CAT")] %>% group_by(TA170077, CAT) %>% summarise(Count = n())

T17_M13_CAT = T17_M13_CAT[1:11, ]

T17_M13_FTLCAT <- TIAS2017_FTL[, c("TA170077", "CAT")] %>% group_by(TA170077, CAT) %>% summarise(Count = n())

T17_M13_IACCAT <- TIAS2017_IAC[, c("TA170077", "CAT")] %>% group_by(TA170077, CAT) %>% summarise(Count = n())

T17_M13_IACCAT = T17_M13_IACCAT[1:6, ]

head(T17_M13_CAT, 11)

ggplot(T17_M13_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170077)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M13_FTLW, 21)

ggplot(T17_M13_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170077)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170077))

m13.pie.ftl.17 <- ggplot(data = T17_M13_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170077))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral",  "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_IAC$TA170077))

m13.pie.iac.17 <- ggplot(data = T17_M13_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170077))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Liked Own Personality in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m13.pie.ftl.17, m13.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS M14 - Life Had Direction ===============================================================================================

####
# M14. Freq Feeling Life Had Direction: "In the last month, how often did you feel that your life had a direction or purpose?”
# Answers: 1 (Never); 2 (Once or twice); 3 (About once a week); 4 (Two or three times a week); 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170078)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170078 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170078 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170078 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170078 = c(8, 9))) 

T17_M14_FTLW <- TIAS[, c("TA170078", "FTL_COUNT")] %>% group_by(TA170078, FTL_COUNT) %>% summarise(Count = n())

T17_M14_FTLW <- T17_M14_FTLW[1:21, ]

T17_M14_CAT <- TIAS2017[, c("TA170078", "CAT")] %>% group_by(TA170078, CAT) %>% summarise(Count = n())

T17_M14_CAT = T17_M14_CAT[1:12, ]

T17_M14_FTLCAT <- TIAS2017_FTL[, c("TA170078", "CAT")] %>% group_by(TA170078, CAT) %>% summarise(Count = n())

T17_M14_IACCAT <- TIAS2017_IAC[, c("TA170078", "CAT")] %>% group_by(TA170078, CAT) %>% summarise(Count = n())

T17_M14_IACCAT = T17_M14_IACCAT[1:6, ]

head(T17_M14_CAT, 12)

ggplot(T17_M14_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

head(T17_M14_FTLW, 21)

ggplot(T17_M14_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170078)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170078))

m14.pie.ftl.17 <- ggplot(data = T17_M14_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170078))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void() 

prop.table(table(TIAS2017_IAC$TA170078))

m14.pie.iac.17 <- ggplot(data = T17_M14_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170078))) + geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  scale_fill_manual("Feeling Life Had Direction in Last Mo.", values = c("lightcoral", "gold", "green3", "mediumturquoise", "deepskyblue", "mediumpurple1", "sienna1", "rosybrown1"), 
                    labels = c("Never", "Once or twice", "About once a week", "Two or three times a week", "Almost every day", "Every day")) +
  theme_void()

ggarrange(m14.pie.ftl.17, m14.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### MIDUS Subscale - Emotional ===================================================================================================

####
# MIDUS Subscale - Emotional (M1-M3): Total Average for Frequency of (1) Happiness in Last Month; (2) Interest in Life in Last Month; (3) Feeling Satisfied in Last Month
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA171972)


TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171972 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171972 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171972 = 9))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171972 = 9)) 

T17_MSE_FTLW <- TIAS[, c("TA171972", "FTL_COUNT")] %>% group_by(TA171972, FTL_COUNT) %>% summarise(Count = n())

T17_MSE_FTLW <- T17_MSE_FTLW[1:19, ]

T17_MSE_CAT <- TIAS2017[, c("TA171972", "CAT")] %>% group_by(TA171972, CAT) %>% summarise(Count = n())

T17_MSE_CAT=T17_MSE_CAT[1:11, ]

ggplot(T17_MSE_FTLW, aes(x = FTL_COUNT, y = TA171972, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_MSE_CAT, aes(x = CAT, y = TA171972, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Emotional Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2017_IAC$TA171972))
prop.table(table(TIAS2017_FTL$TA171972))


### MIDUS Subscale - Psychological ===============================================================================================

####
# MIDUS Subscale - Psychological (M9-M14): Total Average for Frequency of (1) Feeling Good at Managing Daily Responsibility; (2) Feeling Has Trusting Relationships with Others; 
# (3) Feeling Challenged to Grow; (4) Feeling Confident of Own Ideas; (5) Feeling Liked Own Personality; (6) Feeling Life Had Direction 
# Possible Score: 1-6 (Actual value); 9 (At least one component is DK/NA/refused)
####

table(TIAS$TA171974)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171974 = 9)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171974 = 9)) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171974 = 9))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171974 = 9)) 


T17_MSP_FTLW <- TIAS[, c("TA171974", "FTL_COUNT")] %>% group_by(TA171974, FTL_COUNT) %>% summarise(Count = n())

T17_MSP_FTLW <- T17_MSP_FTLW[1:22, ]

T17_MSP_CAT <- TIAS2017[, c("TA171974", "CAT")] %>% group_by(TA171974, CAT) %>% summarise(Count = n())

T17_MSP_CAT = T17_MSP_CAT[1:10, ]

ggplot(T17_MSP_FTLW, aes(x = FTL_COUNT, y = TA171974, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_MSP_CAT, aes(x = CAT, y = TA171974, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "MIDUS Psychological Subscale Score") + 
  scale_y_continuous(limits = c(1, 6), breaks = seq(1, 6, by = 1)) + 
  guides(fill = guide_legend(title = "Category"))

prop.table(table(TIAS2017_IAC$TA171974))
prop.table(table(TIAS2017_FTL$TA171974))


### Time Use - Involved in Arts ==================================================================================================

####
# A1. WTR Involved in Arts: “I would like to ask you about things you like to do in your free time. In the last 12 months, have you been involved/participated in any organized activities related to art, music, or the theater?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170016)

T17_TIA_FTLW <- TIAS[, c("TA170016", "FTL_COUNT")] %>% group_by(TA170016, FTL_COUNT) %>% summarise(Count = n())

T17_TIA_FTLW <- T17_TIA_FTLW[1:9, ]

T17_TIA_CAT <- TIAS2017[, c("TA170016", "CAT")] %>% group_by(TA170016, CAT) %>% summarise(Count = n())

T17_TIA_CAT <- T17_TIA_CAT[1:4, ]

T17_TIA_FTLCAT <- TIAS2017_FTL[, c("TA170016", "CAT")] %>% group_by(TA170016, CAT) %>% summarise(Count = n())

T17_TIA_IACCAT <- TIAS2017_IAC[, c("TA170016", "CAT")] %>% group_by(TA170016, CAT) %>% summarise(Count = n())

head(T17_TIA_CAT, 4)

ggplot(T17_TIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170016))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T17_TIA_FTLW, 9)

ggplot(T17_TIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170016)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_FTL$TA170016))

tia.pie.ftl.17 <- ggplot(data = T17_TIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_IAC$TA170016)) 

tia.pie.iac.17 <- ggplot(data = T17_TIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170016))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Involved in Arts", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(tia.pie.ftl.17, tia.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Type of Art (Involvement) =========================================================================================

####
# A2 Type of Arts: “Follow up question: What Activities Are Those?”
# Answers: 6132 (Band/ choir/orchestra - after school); 6133 (Drama/art club - after school); 8420 (Needle-work, including classes (knitting, crocheting,beading, embroidery, cross-stitch, weaving, quilting, macrame)
# 8510 (Arts, arts and crafts, arts unspecified); 8511 (Pottery, ceramics); 8512 (Painting); 8513 (Drawing, coloring); 8514 (Sculpture); 8520 (Literature, literature unspecified); 8521 (Writing [not letters; not homework])
# 8522 (Poetry); 8523 (Writing in a diary); 8610 (Playing a musical instrument [include practicing], whistling--NA which activity); 8620 (Singing for fun, karaoke, special event, or competition)
# 8630 (Acting in/rehearsing for a play); 8640 (Non-social dancing; ballet modern dance, body movement); 8810 (Lessons in dance); 8870 (Music lessons, unspecified); 88,871 (Voice lessons)
# 8872 (Lessons in musical instruments); 9997 (Other activity); 9998 (DK); 9999 (NA; refused); 0 (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months) 

####

table(TIAS$TA170017)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170017 = c(9998, 9999))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170017 = c(9998, 9999)))  

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170017 = c(9998, 9999)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170017 = c(9998, 9999))) 

T17_IIA_FTLW <- TIAS[, c("TA170017", "FTL_COUNT")] %>% group_by(TA170017, FTL_COUNT) %>% summarise(Count = n())

T17_IIA_FTLW <- T17_IIA_FTLW[1:35, ]

T17_IIA_CAT <- TIAS2017[, c("TA170017", "CAT")] %>% group_by(TA170017, CAT) %>% summarise(Count = n())

T17_IIA_CAT <- T17_IIA_CAT[1:25, ]

T17_IIA_FTLCAT <- TIAS2017_FTL[, c("TA170017", "CAT")] %>% group_by(TA170017, CAT) %>% summarise(Count = n())

T17_IIA_FTLCAT <- T17_IIA_FTLCAT[1:8, ]

T17_IIA_IACCAT <- TIAS2017_IAC[, c("TA170017", "CAT")] %>% group_by(TA170017, CAT) %>% summarise(Count = n())

T17_IIA_IACCAT <- T17_IIA_IACCAT[1:17, ]

head(T17_IIA_CAT, 25)

ggplot(T17_IIA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170017))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                            "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                                            "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Other Activity"))                                                                                                                                                  
head(T17_IIA_FTLW, 35)

ggplot(T17_IIA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170017)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                            "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                                            "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Other Activity"))                                                                                           


prop.table(table(TIAS2017_FTL$TA170017)) 

iia.pie.ftl.17 <- ggplot(data = T17_IIA_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "olivedrab1", "orange", "seagreen1", "yellow", "aquamarine", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                           "After-School Drama/Art Club", "Writing", "Musical Instrument", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement", "Other Activity")) 

prop.table(table(TIAS2017_IAC$TA170017)) 

iia.pie.iac.17 <- ggplot(data = T17_IIA_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170017))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Art Involvement", values =  c("skyblue", "hotpink", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "violet", "olivedrab1", "orange", 
                                                           "royalblue1", "seagreen1", "yellow", "aquamarine", "cornflowerblue", "coral1", "forestgreen", "wheat", "lawngreen"),  labels = c("Not Involved in Arts/Music/Theater", "After-School Band/Choir/Orchestra", 
                                                                                                                                                                                            "After-School Drama/Art Club", "Arts & Crafts", "Pottery/Ceramics", "Painting", "Drawing/Coloring", "Sculpture", "Writing", "Musical Instrument", "Singing", "Play Rehearsal/Acting", "Non-social Dancing/Ballet/Body Movement",
                                                                                                                                                                                            "Dance Lessons", "Music Lessons - Unspecified", "Voice Lessons", "Other Activity"))                              
ggarrange(iia.pie.ftl.17, iia.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Art Involvement Frequency (Over 12 Mos) ===========================================================================

####
# A3. How Often Participated In Arts: “During the last 12 months, about how often did you participate in any activity related to art, music, or the theater?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0  (Inap.: not involved in organized activities related to art, music, or theater in the last 12 months)
####

table(TIAS$TA170018)

T17_AIF_FTLW <- TIAS[, c("TA170018", "FTL_COUNT")] %>% group_by(TA170018, FTL_COUNT) %>% summarise(Count = n())

T17_AIF_FTLW <- T17_AIF_FTLW[1:21, ]

T17_AIF_CAT <- TIAS2017[, c("TA170018", "CAT")] %>% group_by(TA170018, CAT) %>% summarise(Count = n())

T17_AIF_CAT=T17_AIF_CAT[1:14, ]

T17_AIF_FTLCAT <- TIAS2017_FTL[, c("TA170018", "CAT")] %>% group_by(TA170018, CAT) %>% summarise(Count = n())

T17_AIF_IACCAT <- TIAS2017_IAC[, c("TA170018", "CAT")] %>% group_by(TA170018, CAT) %>% summarise(Count = n())

T17_AIF_IACCAT=T17_AIF_IACCAT[1:7, ]

head(T17_AIF_CAT, 14)

ggplot(T17_AIF_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170018))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T17_AIF_FTLW, 21)

ggplot(T17_AIF_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170018)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170018)) 

aif.pie.ftl.17 <- ggplot(data = T17_AIF_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_IAC$TA170018)) 

aif.pie.iac.17 <- ggplot(data = T17_AIF_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170018))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Art Involvement Frequency", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1"), 
                    labels = c("Not Involved in Arts/Music/Theater", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(aif.pie.ftl.17, aif.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### WTR Member of Sports Team (Over 12 Mos) ======================================================================================

####
# A4. WTR Member of Sports Team: “Were you a member of any athletic or sports teams in the last 12 months?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170019)

T17_SPO_FTLW <- TIAS[, c("TA170019", "FTL_COUNT")] %>% group_by(TA170019, FTL_COUNT) %>% summarise(Count = n())

T17_SPO_FTLW <- T17_SPO_FTLW[1:8, ]

T17_SPO_CAT <- TIAS2017[, c("TA170019", "CAT")] %>% group_by(TA170019, CAT) %>% summarise(Count = n())

T17_SPO_FTLCAT <- TIAS2017_FTL[, c("TA170019", "CAT")] %>% group_by(TA170019, CAT) %>% summarise(Count = n())

T17_SPO_IACCAT <- TIAS2017_IAC[, c("TA170019", "CAT")] %>% group_by(TA170019, CAT) %>% summarise(Count = n())

T17_SPO_CAT=T17_SPO_CAT[1:4, ]

T17_SPO_FTLCAT=T17_SPO_FTLCAT[1:2, ]

T17_SPO_IACCAT=T17_SPO_IACCAT[1:2, ]


head(T17_SPO_CAT, 4)

ggplot(T17_SPO_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170019))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

head(T17_SPO_FTLW, 8)

ggplot(T17_SPO_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170019)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_FTL$TA170019))

spo.pie.ftl.17 <- ggplot(data = T17_SPO_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_IAC$TA170019)) 

spo.pie.iac.17 <- ggplot(data = T17_SPO_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170019))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("WTR Member of Sports Team", values =  c("lightgreen", "lightpink"), labels = c("Yes", "No"))

ggarrange(spo.pie.ftl.17, spo.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Involved in Sports Frequency  =====================================================================================

####
# A5. How Often Participated in Sports: “During the last 12 months, how often did you spend time on athletic or sports teams?"
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 7 (Never); 8 (DK); 9 (NA/refused); 0 (Inap: not a member of athletic or sports teams)
####

table(TIAS$TA170020)

T17_IIS_FTLW <- TIAS[, c("TA170020", "FTL_COUNT")] %>% group_by(TA170020, FTL_COUNT) %>% summarise(Count = n())

T17_IIS_CAT <- TIAS2017[, c("TA170020", "CAT")] %>% group_by(TA170020, CAT) %>% summarise(Count = n())

T17_IIS_FTLCAT <- TIAS2017_FTL[, c("TA170020", "CAT")] %>% group_by(TA170020, CAT) %>% summarise(Count = n())

T17_IIS_IACCAT <- TIAS2017_IAC[, c("TA170020", "CAT")] %>% group_by(TA170020, CAT) %>% summarise(Count = n())

T17_IIS_FTLW <- T17_IIS_FTLW[1:18, ]

T17_IIS_CAT=T17_IIS_CAT[1:11, ]

T17_IIS_FTLCAT=T17_IIS_FTLCAT[1:4, ]

T17_IIS_IACCAT=T17_IIS_IACCAT[1:7, ]

head(T17_IIS_CAT, 11)

ggplot(T17_IIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170020))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T17_IIS_FTLW, 18)

ggplot(T17_IIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170020)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170020))

iis.pie.ftl.17 <- ggplot(data = T17_IIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_IAC$TA170020)) 

iis.pie.iac.17 <- ggplot(data = T17_IIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170020))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Time Use - Involved in Sports", values =  c("darkolivegreen1", "lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise"), 
                    labels = c("Not Involved in Sports", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(iis.pie.ftl.17, iis.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Voted in Last Presidential Election ===============================================================================

####
# A11. WTR Voted in 2016: “Did you vote in the national election for President last November, in 2016?”
# Answers: 0 (Was too young); 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170024)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170024 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170024 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170024 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170024 = c(8, 9))) 

T17_VLP_FTLW <- TIAS[, c("TA170024", "FTL_COUNT")] %>% group_by(TA170024, FTL_COUNT) %>% summarise(Count = n())

T17_VLP_CAT <- TIAS2017[, c("TA170024", "CAT")] %>% group_by(TA170024, CAT) %>% summarise(Count = n())

T17_VLP_FTLW <- T17_VLP_FTLW[1:11, ]

T17_VLP_CAT <- T17_VLP_FTLW[1:6, ]

head(T17_VLP_CAT, 6)

ggplot(T17_VLP_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170024))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink", "lightblue"), labels = c("Too young", "Yes", "No"))

head(T17_VLP_FTLW, 10)

ggplot(T17_VLP_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170024)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Voted in 2004 Presidential Election", values =  c("lightgreen", "lightpink", "gold", "sienna1", "rosybrown1"), labels = c("Too young", "Yes", "No"))

prop.table(table(TIAS2017_IAC$TA170024))
prop.table(table(TIAS2017_FTL$TA170024))

### Time Use - Involvement in Social Action Groups ===============================================================================

####
# A11B. WTR In Social Action Groups: “During the last 12 months, were you involved in any political groups, solidarity or 
# ethnic-support groups, such as NAACP, or social-action groups?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

prop.table(table(TIAS2017_IAC$TA170025))
prop.table(table(TIAS2017_FTL$TA170025))


table(TIAS$TA170025)

T17_ISA_FTLW <- TIAS[, c("TA170025", "FTL_COUNT")] %>% group_by(TA170025, FTL_COUNT) %>% summarise(Count = n())

T17_ISA_FTLW <- T17_ISA_FTLW[1:7, ]

T17_ISA_CAT <- TIAS2017[, c("TA170025", "CAT")] %>% group_by(TA170025, CAT) %>% summarise(Count = n())

T17_ISA_CAT <- T17_ISA_CAT[1:4, ]

head(T17_ISA_CAT, 4)

ggplot(T17_ISA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170025))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

head(T17_ISA_FTLW, 7)

ggplot(T17_ISA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170025)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightskyblue1", "pink"), labels = c("Yes", "No"))

### Time Use - Type of Social Action Group (If Involved) =========================================================================

####
# A11C. Type of Social Action Groups: “Which political groups were you involved in?”
# Answers: 1 (Political parties); 2 (Environmental party); 3 (Racial/ethnic cultural groups); 4 (LGBTQ groups); 5 (Women's rights groups);
# 7 (Non-Partisan voting rights group); 8 (Civil liberties); 9 (Health and/or disability); 10 (Social Policy); 97 (other); 0 (Inap.: not involved in political, solidarity, or ethnic-support groups in the last 12 months)
####

prop.table(table(TIAS2017_IAC$TA170026))
prop.table(table(TIAS2017_FTL$TA170026))

table(TIAS$TA170026)

T17_TSA_FTLW <- TIAS[, c("TA170026", "FTL_COUNT")] %>% group_by(TA170026, FTL_COUNT) %>% summarise(Count = n())

T17_TSA_CAT <- TIAS2017[, c("TA170026", "CAT")] %>% group_by(TA170026, CAT) %>% summarise(Count = n())

T17_TSA_FTLW <- T17_TSA_FTLW[1:17, ]

T17_TSA_CAT <- T17_TSA_CAT[1:13, ]

head(T17_TSA_CAT, 13)

ggplot(T17_TSA_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170026))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("skyblue", "hotpink", "mediumslateblue", "olivedrab1", "orange", "seagreen1", "yellow", "aquamarine", "lawngreen", "lightcoral", "lightskyblue"),
                    labels = c("Not involved", "Political parties", "Environmental", "Racial/ethnic cultural groups", "LGBTQ groups", "Women's rights groups", "Non-Partisan voting rights group", "Civil liberties", "Health and/or disability", "Social Policy", "Other"))

head(T17_TSA_FTLW, 17)

ggplot(T17_TSA_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170026)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Type", values =  c("skyblue", "hotpink", "mediumslateblue", "olivedrab1", "orange", "seagreen1", "yellow", "aquamarine", "lawngreen", "lightcoral", "lightskyblue"),
                    labels = c("Not involved", "Political parties", "Environmental", "Racial/ethnic cultural groups", "LGBTQ groups", "Women's rights groups", "Non-Partisan voting rights group", "Civil liberties", "Health and/or disability", "Social Policy", "Other"))

### Time Use - Social Action Group Involvement (Over 12 Mos) =====================================================================

####
# A11D. How Often Did Social Action Groups: “During the last 12 months, about how often were you involved in social action groups?" 
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved in political, solidarity or ethnic-support groups)
####

table(TIAS$TA170027)

T17_SAG_FTLW <- TIAS[, c("TA170027", "FTL_COUNT")] %>% group_by(TA170027, FTL_COUNT) %>% summarise(Count = n())

T17_SAG_CAT <- TIAS2017[, c("TA170027", "CAT")] %>% group_by(TA170027, CAT) %>% summarise(Count = n())

T17_SAG_FTLW <- T17_SAG_FTLW[1:15, ]

T17_SAG_CAT <- T17_SAG_CAT[1:10, ]

head(T17_SAG_CAT, 10)

ggplot(T17_SAG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170027))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T17_SAG_FTLW, 15)

ggplot(T17_SAG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170027)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Social Action Group Involvement", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

### Time Use - School Club/Student Gov Involvement ===============================================================================

####
# A12. WTR Involved With School Clubs: “In the last 12 months, were you involved with any school clubs or student government?
# Answers: 1 (Yes); 5 (No); 6 (Not in school); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170021)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170021 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170021 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170021 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170021 = c(8, 9))) 

T17_CGI_FTLW <- TIAS[, c("TA170021", "FTL_COUNT")] %>% group_by(TA170021, FTL_COUNT) %>% summarise(Count = n())

T17_CGI_CAT <- TIAS2017[, c("TA170021", "CAT")] %>% group_by(TA170021, CAT) %>% summarise(Count = n())

T17_CGI_FTLCAT <- TIAS2017_FTL[, c("TA170021", "CAT")] %>% group_by(TA170021, CAT) %>% summarise(Count = n())

T17_CGI_IACCAT <- TIAS2017_IAC[, c("TA170021", "CAT")] %>% group_by(TA170021, CAT) %>% summarise(Count = n())

T17_CGI_FTLW <- T17_CGI_FTLW[1:10, ]
T17_CGI_CAT <- T17_CGI_CAT[1:6, ]
T17_CGI_FTLCAT <- T17_CGI_FTLCAT[1:3, ]
T17_CGI_IACCAT <- T17_CGI_IACCAT[1:3, ]


head(T17_CGI_CAT, 6)

ggplot(T17_CGI_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170021))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

head(T17_CGI_FTLW, 10)

ggplot(T17_CGI_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170021)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2017_FTL$TA170021))

cgi.pie.ftl.17 <- ggplot(data = T17_CGI_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

prop.table(table(TIAS2017_IAC$TA170021))

cgi.pie.iac.17 <- ggplot(data = T17_CGI_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170021))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement", values =  c("darkseagreen1", "lightskyblue1", "pink"), labels = c("Yes", "No", "Not in school"))

ggarrange(cgi.pie.ftl.17, cgi.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - School Club/Student Gov Involvement Frequency (Over 12 Mos) =======================================================

####
# A12B. How Often Did School Clubs: “During the last 12 months, about how often were you involved in school clubs or student government? (Would you say: 
# less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?)”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week)
# 5 (Almost every day); 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap.: not involved with school clubs or student government)
####

table(TIAS$TA170022)

T17_SCG_FTLW <- TIAS[, c("TA170022", "FTL_COUNT")] %>% group_by(TA170022, FTL_COUNT) %>% summarise(Count = n())

T17_SCG_FTLW <- T17_SCG_FTLW[1:17, ]

T17_SCG_CAT <- TIAS2017[, c("TA170022", "CAT")] %>% group_by(TA170022, CAT) %>% summarise(Count = n())

T17_SCG_FTLCAT <- TIAS2017_FTL[, c("TA170022", "CAT")] %>% group_by(TA170022, CAT) %>% summarise(Count = n())

T17_SCG_IACCAT <- TIAS2017_IAC[, c("TA170022", "CAT")] %>% group_by(TA170022, CAT) %>% summarise(Count = n())

head(T17_SCG_CAT, 12)

ggplot(T17_SCG_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170022))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T17_SCG_FTLW, 17)

ggplot(T17_SCG_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170022)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170022))

scg.pie.ftl.17 <- ggplot(data = T17_SCG_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("School Club/Student Gov Involvement (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_IAC$TA170022))

scg.pie.iac.17 <- ggplot(data = T17_SCG_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170022))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("School Club/Student Gov Involvement Frequency", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Not Involved", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(scg.pie.ftl.17, scg.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Unpaid Volunteer/Community Sevice Work (Over 12 Mos) ==============================================================

####
# A13. WTR Did OTR Volunteer Work: “During the last 12 months, did you do any unpaid volunteer or community service work that you have not told me about?”
# Answers: 1 (Yes); 5 (No); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA170028)

T17_UVW_FTLW <- TIAS[, c("TA170028", "FTL_COUNT")] %>% group_by(TA170028, FTL_COUNT) %>% summarise(Count = n())

T17_UVW_CAT <- TIAS2017[, c("TA170028", "CAT")] %>% group_by(TA170028, CAT) %>% summarise(Count = n())

T17_UVW_FTLCAT <- TIAS2017_FTL[, c("TA170028", "CAT")] %>% group_by(TA170028, CAT) %>% summarise(Count = n())

T17_UVW_IACCAT <- TIAS2017_IAC[, c("TA170028", "CAT")] %>% group_by(TA170028, CAT) %>% summarise(Count = n())

T17_UVW_FTLW <- T17_UVW_FTLW[1:8, ]

T17_UVW_CAT <- T17_UVW_CAT[1:4, ]

T17_UVW_FTLCAT <- T17_UVW_FTLCAT[1:2, ]

head(T17_UVW_CAT, 4)

ggplot(T17_UVW_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170028))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

head(T17_UVW_FTLW, 8)

ggplot(T17_UVW_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170028)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_FTL$TA170028))

uvw.pie.ftl.17 <- ggplot(data = T17_UVW_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

prop.table(table(TIAS2017_IAC$TA170028))

uvw.pie.iac.17 <- ggplot(data = T17_UVW_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170028))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Unpaid Volunteer Work (Over 12mos)", values =  c("turquoise", "mediumpurple1"), labels = c("Yes", "No"))

ggarrange(uvw.pie.ftl.17, uvw.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Time Use - Type of Volunteer Work ============================================================================================

#### 
# A14. Type Volunteer ORG--FIRST MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIRST MENTION) [PROBE: Anything else?]”
# Answers: 1 (Organizations for children and youth); 2 (Service organizations, such as Big Brothers-Big Sisters or Junior League); 3 Organized volunteer groups in hospitals or nursing homes); 4 (Religious groups, not including worship); 5 (Conservation, recycling, or environmental groups, such as the Sierra Club or The Nature Conservancy); 6 (Shelters, soup kitchens, Habitat for Humanity, or other organizations helping families in need); 8 (Organizations for animals); 9 (Helping community/government agencies such as fire department, library or police department or picking up trash); 97 (Other); 0 (Inap: no unpaid volunteer or service work)
####

table(TIAS$TA170029)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170029 = c(98, 99))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170029 = c(98, 99))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170029 = c(98, 99)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170029 = c(98, 99)))

T17_VFM_FTLW <- TIAS[, c("TA170029", "FTL_COUNT")] %>% group_by(TA170029, FTL_COUNT) %>% summarise(Count = n())

T17_VFM_CAT <- TIAS2017[, c("TA170029", "CAT")] %>% group_by(TA170029, CAT) %>% summarise(Count = n())

T17_VFM_FTLCAT <- TIAS2017_FTL[, c("TA170029", "CAT")] %>% group_by(TA170029, CAT) %>% summarise(Count = n())

T17_VFM_IACCAT <- TIAS2017_IAC[, c("TA170029", "CAT")] %>% group_by(TA170029, CAT) %>% summarise(Count = n())

T17_VFM_FTLW <- T17_VFM_FTLW[1:24, ]

T17_VFM_CAT <- T17_VFM_CAT[1:15, ]

T17_VFM_IACCAT <- T17_VFM_IACCAT[1:10, ]


ggplot(T17_VFM_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170029))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

head(T17_VFM_FTLW, 24)

ggplot(T17_VFM_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170029)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

prop.table(table(TIAS2017_FTL$TA170029))

vfm.pie.ftl.17 <- ggplot(data = T17_VFM_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170029))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization", values = c("lightcoral", "lightskyblue", "#009E73", "gold", "sienna1"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Homelessness"))

prop.table(table(TIAS2017_IAC$TA170029))

vfm.pie.iac.17 <- ggplot(data = T17_VFM_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170029))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

ggarrange(vfm.pie.ftl.17, vfm.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

#### 
# A14 Type Volunteer ORG--SECOND MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SECOND MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA170030)

T17_vsm_FTLW <- TIAS[, c("TA170030", "FTL_COUNT")] %>% group_by(TA170030, FTL_COUNT) %>% summarise(Count = n())

T17_vsm_CAT <- TIAS2017[, c("TA170030", "CAT")] %>% group_by(TA170030, CAT) %>% summarise(Count = n())

T17_vsm_FTLCAT <- TIAS2017_FTL[, c("TA170030", "CAT")] %>% group_by(TA170030, CAT) %>% summarise(Count = n())

T17_vsm_IACCAT <- TIAS2017_IAC[, c("TA170030", "CAT")] %>% group_by(TA170030, CAT) %>% summarise(Count = n())

T17_vsm_FTLW <- T17_vsm_FTLW[1:21, ]

T17_vsm_CAT <- T17_vsm_CAT[1:13, ]

ggplot(T17_vsm_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170030))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

head(T17_vsm_FTLW, 21)

ggplot(T17_vsm_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170030)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

prop.table(table(TIAS2017_FTL$TA170030))

vsm.pie.ftl.17 <- ggplot(data = T17_vsm_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170030))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "#0072B2", "turquoise"), 
                    labels = c("Does not volunteer","Religious", "Environmental"))

prop.table(table(TIAS2017_IAC$TA170030))

vsm.pie.iac.17 <- ggplot(data = T17_vsm_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170030))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

ggarrange(vsm.pie.ftl.17, vsm.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

#### 
# A14 Type Volunteer ORG--THIRD MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(THIRD MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA170031)

T17_vtm_FTLW <- TIAS[, c("TA170031", "FTL_COUNT")] %>% group_by(TA170031, FTL_COUNT) %>% summarise(Count = n())

T17_vtm_CAT <- TIAS2017[, c("TA170031", "CAT")] %>% group_by(TA170031, CAT) %>% summarise(Count = n())

T17_vtm_FTLCAT <- TIAS2017_FTL[, c("TA170031", "CAT")] %>% group_by(TA170031, CAT) %>% summarise(Count = n())

T17_vtm_IACCAT <- TIAS2017_IAC[, c("TA170031", "CAT")] %>% group_by(TA170031, CAT) %>% summarise(Count = n())

T17_vtm_FTLW <- T17_vtm_FTLW[1:15, ]

T17_vtm_CAT <- T17_vtm_CAT[1:11, ]


ggplot(T17_vtm_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170031))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

head(T17_vtm_FTLW, 15)

ggplot(T17_vtm_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170031)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Type of Organization", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

prop.table(table(TIAS2017_FTL$TA170031))

vtm.pie.ftl.17 <- ggplot(data = T17_vtm_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170031))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral"), 
                    labels = c("Does not volunteer"))

prop.table(table(TIAS2017_IAC$TA170031))

vtm.pie.iac.17 <- ggplot(data = T17_vtm_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170031))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Type of Organization - Second Mention", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "sienna1", "midnightblue", "darkseagreen1", "lightpink"), 
                    labels = c("Does not volunteer", "Children and Youth", "Service Organizations", "Healthcare", "Religious", "Environmental", "Homelessness", "Animal rights", "Government programs", "Other"))

ggarrange(vtm.pie.ftl.17, vtm.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

#### 
# A14 Type Volunteer ORG--FOURTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FOURTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA170032)

prop.table(table(TIAS2017_IAC$TA170032))
prop.table(table(TIAS2017_FTL$TA170032))

# No FTL participants mentioned a 4th org in 2017 wave.
#### 
# A14 Type Volunteer ORG--FIFTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(FIFTH MENTION) [PROBE: Anything else?]”
####

table(TIAS$TA170033)

prop.table(table(TIAS2017_IAC$TA170033))
prop.table(table(TIAS2017_FTL$TA170033))

# No FTL participants mentioned a 5th org in 2017 wave.

#### 
# A14 Type Volunteer ORG--SIXTH MENTION: “Which types of organizations have you been involved with in your volunteer or community 
# service work in the last 12 months?--(SIXTH MENTION) [PROBE: Anything else?]”
####

prop.table(table(TIAS2017_IAC$TA170034))
prop.table(table(TIAS2017_FTL$TA170034))

# No FTL participants mentioned a 6th org in 2017 wave.

####
# Creating A14 Heatmaps 
####

A14_FTL17 <- TIAS2017_FTL %>% select(TA170029, TA170030, TA170031, TA170032, TA170033, TA170034, ID)

cols <- sapply(A14_FTL17, is.logical)
A14_FTL17[,cols] <- lapply(A14_FTL17[,cols], as.numeric)

A14_FTL17_TIDY <- A14_FTL17 %>% tidyr::gather(variable, volunteer_type, 1:6)

A14_FTL17_TIDY$variable <- factor(A14_FTL17_TIDY$variable, levels = c("TA170029", "TA170030", "TA170031", "TA170032", "TA170033", "TA170034"))

A14_FTL17_IDLEV <- dplyr::pull(A14_FTL17, ID)
A14_FTL17_TIDY$ID <- factor(A14_FTL17_TIDY$ID, levels = A14_FTL17_IDLEV)

A14_FTL17_TIDY$volunteer_type <- factor(A14_FTL17_TIDY$volunteer_type)

ggplot(A14_FTL17_TIDY, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(title = "TIAS 2017 FTL", x="Order of Mention", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise"), labels = c("Did Not Mention", "Youth Organization", "Hospital/Nursing Home", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 

A14_IAC17 <- TIAS2017_IAC %>% select(TA170029, TA170030, TA170031, TA170032, TA170033, TA170034, ID)

nrow(A14_IAC17)  

chunk <- 101  

n <- nrow(A14_IAC17)  

r <- rep(1:ceiling(n/chunk), each=chunk)[1:n]  

A14_IAC17_list <- split(A14_IAC17, r)   

length(A14_IAC17_list)  

tidy.vars <- function(x){
  x %>% tidyr::gather(variable, volunteer_type, 1:6)
}

A14_IAC17_tidylist <- lapply(A14_IAC17_list, tidy.vars)

for(i in 1:7) {
  A14_IAC17_tidylist[[i]]$variable <- factor(A14_IAC17_tidylist[[i]]$variable, levels = c("TA170029", "TA170030", "TA170031", "TA170032", "TA170033", "TA170034"))
}

set.ID.levels <- function(x){
  dplyr::pull(x, ID)
}

A14_IAC17_levlist <- lapply(A14_IAC17_list, set.ID.levels)

for(i in 1:7) {
  A14_IAC17_tidylist[[i]]$ID <- factor(A14_IAC17_tidylist[[i]]$ID, levels = A14_IAC17_levlist[[i]])
}

for(i in 1:7) {
  A14_IAC17_tidylist[[i]]$volunteer_type <- factor(A14_IAC17_tidylist[[i]]$volunteer_type)
}

create.A14.IAC17.heatmap <- function(x){
  ggplot(x, aes(x=variable, y=ID, fill=volunteer_type)) + geom_tile(color="white", size=0.5) +
    coord_equal() +
    labs(x="Order of Mention", y="TIAS 2017 IAC ID") +
    theme_tufte(base_family="Helvetica") +
    theme(axis.ticks=element_blank()) + 
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
    scale_fill_manual("Volunteer Type", values = c("slategray3", "coral1", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
                      labels = c("Did Not Mention", "Youth Organization", "Service Organization", "Hospital/Nursing Home", "Religious Organization", "Environmental Organization", "Shelters/Soup Kitchen/Habitat for Humanity", "Other")) 
}

A14.IAC17.heatmaps <- function(x){
  create.heatmap(A14_IAC17_tidylist[[x]])
}

# save or view in a horizontally wide frame to view all graphs properly

ggarrange(A14.IAC17.heatmaps(1) + rremove("legend"), A14.IAC17.heatmaps(2) + rremove("legend") + rremove("y.title"), A14.IAC17.heatmaps(3) + rremove("legend") + rremove("y.title"), A14.IAC17.heatmaps(4) + rremove("y.title"), ncol = 4, nrow = 1) 

ggarrange(A14.IAC17.heatmaps(5) + rremove("legend"), A14.IAC17.heatmaps(6) + rremove("legend") + rremove("y.title"), A14.IAC17.heatmaps(7) + rremove("y.title"), ncol = 3, nrow = 1) 

### Time Use - How Often Volunteered (Over 12 Mos) ===============================================================================

####
# A14B. How Often Volunteered: “During the last 12 months, about how often did you participate in volunteer or community service work? 
# Would you say: less than once a month, at least once a month, once a week, several times a week, almost every day, or every day?”
# Answers: 1 (Less than once a month); 2 (At least once a month); 3 (Once a week); 4 (Several times a week); 5 (Almost every day); 
# 6 (Every day); 8 (DK); 9 (NA/refused); 0 (Inap: no unpaid volunteer or community service work)
####

table(TIAS$TA170035)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA170035 = c(8, 9))) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA170035 = c(8, 9))) 

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA170035 = c(8, 9)))  

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA170035 = c(8, 9))) 

T17_TUH_FTLW <- TIAS[, c("TA170035", "FTL_COUNT")] %>% group_by(TA170035, FTL_COUNT) %>% summarise(Count = n())

T17_TUH_CAT <- TIAS2017[, c("TA170035", "CAT")] %>% group_by(TA170035, CAT) %>% summarise(Count = n())

T17_TUH_FTLCAT <- TIAS2017_FTL[, c("TA170035", "CAT")] %>% group_by(TA170035, CAT) %>% summarise(Count = n())

T17_TUH_IACCAT <- TIAS2017_IAC[, c("TA170035", "CAT")] %>% group_by(TA170035, CAT) %>% summarise(Count = n())

T17_TUH_FTLW <- T17_TUH_FTLW[1:20, ]

T17_TUH_CAT <- T17_TUH_CAT[1:14, ]

T17_TUH_IACCAT = T17_TUH_IACCAT[1:7, ]

head(T17_TUH_CAT, 14)

ggplot(T17_TUH_CAT, aes(x = CAT, y = Count, fill = as.factor(TA170035))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

head(T17_TUH_FTLW, 20)

ggplot(T17_TUH_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA170035)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

prop.table(table(TIAS2017_FTL$TA170035))

tuh.pie.ftl.17 <- ggplot(data = T17_TUH_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA170035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))


prop.table(table(TIAS2017_IAC$TA170035))

tuh.pie.iac.17 <- ggplot(data = T17_TUH_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA170035))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("How Often Volunteered (Over 12mos)", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "mediumpurple1"), 
                    labels = c("Did not volunteer", "Less than once a month", "At least once a month", "Once a week", "Several times a week", "Almost every day", "Every day"))

ggarrange(tuh.pie.ftl.17, tuh.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))


### Race - Hispanic ==============================================================================================================

####
# L6. Hispanicity: “In order to get an idea of the different races and ethnic groups that participate in the study, I would like to ask you 
# about your background. Are you Spanish, Hispanic, or Latino? That is, Mexican, Mexican American, Chicano, Puerto Rican, Cuban, or other Spanish?”
# Answers: 0 (Not Spanish, Hispanic, or Latino); 1 (Mexican); 2 (Mexican-American); 3 (Chicano); 4 (Puerto Rican); 5 (Cuban); 7 (Other Spanish); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA171960)

T17_HIS_FTLW <- TIAS[, c("TA171960", "FTL_COUNT")] %>% group_by(TA171960, FTL_COUNT) %>% summarise(Count = n())

T17_HIS_FTLW <- T17_HIS_FTLW[1:5, ]

T17_HIS_CAT <- TIAS2017[, c("TA171960", "CAT")] %>% group_by(TA171960, CAT) %>% summarise(Count = n())

T17_HIS_CAT <- T17_HIS_CAT[1:2, ]

T17_HIS_FTLCAT <- TIAS2017_FTL[, c("TA171960", "CAT")] %>% group_by(TA171960, CAT) %>% summarise(Count = n())

T17_HIS_IACCAT <- TIAS2017_IAC[, c("TA171960", "CAT")] %>% group_by(TA171960, CAT) %>% summarise(Count = n())

head(T17_HIS_CAT, 2)

ggplot(T17_HIS_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171960))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral"), labels = c("Not Spanish, Hispanic, or Latino"))

head(T17_HIS_FTLW, 5)

ggplot(T17_HIS_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171960)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral"), 
                    labels = c("Not Spanish, Hispanic, or Latino"))

prop.table(table(TIAS2017_FTL$TA171960))

his.pie.ftl.17 <- ggplot(data = T17_HIS_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171960))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral"), 
                    labels = c("Not Spanish, Hispanic, or Latino"))

prop.table(table(TIAS2017_IAC$TA171960))

his.pie.iac.17 <- ggplot(data = T17_HIS_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171960))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race - Hispanicity", values =  c("lightcoral"), 
                    labels = c("Not Spanish, Hispanic, or Latino"))

ggarrange(his.pie.ftl.17, his.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Race Identification ========================================================================================================== 

####
# L7. Race Mention #1: “What is your race? Are you white, black, American Indian, Alaska Native, Asian, Native Hawaiian or Other Pacific Islander?--1ST MENTION”
# Answers: 1 (White); 2 (Black, African-American); 3 (American Indian or Alaska Native); 4 (Asian); 5 (Native Hawaiian or Pacific Islander); 6 (Middle Eastern or North African);
# 7 (Some other race); 8 (DK); 9 (NA/refused)
####

table(TIAS$TA171955)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171955 = c(98, 99)))

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171955 = c(98, 99)))

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171955 = c(98, 99)))

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171955 = c(98, 99)))

T17_RAC_FTLW <- TIAS[, c("TA171955", "FTL_COUNT")] %>% group_by(TA171955, FTL_COUNT) %>% summarise(Count = n())

T17_RAC_FTLW <- T17_RAC_FTLW[1:22, ]

T17_RAC_CAT <- TIAS2017[, c("TA171955", "CAT")] %>% group_by(TA171955, CAT) %>% summarise(Count = n())

T17_RAC_CAT <- T17_RAC_CAT[1:12, ]

T17_RAC_FTLCAT <- TIAS2017_FTL[, c("TA171955", "CAT")] %>% group_by(TA171955, CAT) %>% summarise(Count = n())

T17_RAC_FTLCAT <- T17_RAC_FTLCAT[1:4, ]

T17_RAC_IACCAT <- TIAS2017_IAC[, c("TA171955", "CAT")] %>% group_by(TA171955, CAT) %>% summarise(Count = n())

T17_RAC_IACCAT <- T17_RAC_IACCAT[1:8, ]

head(T17_RAC_CAT, 12)

ggplot(T17_RAC_CAT, aes(x = CAT, y = Count, fill = as.factor(TA171955))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS 2017", x = "Category", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "darkseagreen1", "cornflowerblue"), 
                    labels = c("White", "Hispanic/Latinx", "Black or African American", "Asian", "American Indian or Alaska Native", "Middle Eastern or North African", "Native Hawaiian or Pacific Islander", "Other"))

head(T17_RAC_FTLW, 17)

ggplot(T17_RAC_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(TA171955)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS 2017", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "darkseagreen1", "cornflowerblue"), 
                    labels = c("White", "Hispanic/Latinx", "Black or African American", "Asian", "American Indian or Alaska Native", "Middle Eastern or North African", "Native Hawaiian or Pacific Islander", "Other"))

prop.table(table(TIAS2017_FTL$TA171955))

rac.pie.ftl.17 <- ggplot(data = T17_RAC_FTLCAT, aes(x = " ", y = Count, fill = as.factor(TA171955))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "#0072B2"), 
                    labels = c("White", "Hispanic/Latinx", "Black or African American", "American Indian or Alaska Native"))

prop.table(table(TIAS2017_IAC$TA171955))

rac.pie.iac.17 <- ggplot(data = T17_RAC_IACCAT, aes(x = " ", y = Count, fill = as.factor(TA171955))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() +
  scale_fill_manual("Race", values =  c("lightcoral", "lightskyblue", "#009E73", "gold", "#0072B2", "turquoise", "darkseagreen1", "cornflowerblue"), 
                    labels = c("White", "Hispanic/Latinx", "Black or African American", "Asian", "American Indian or Alaska Native", "Middle Eastern or North African", "Native Hawaiian or Pacific Islander", "Other"))

ggarrange(rac.pie.ftl.17, rac.pie.iac.17, ncol = 2, nrow = 1, labels = c("FTL 2017", "IAC 2017"))

### Daily Cigarette Usage ========================================================================================================

#### 
# H30. # Cigarettes Per Day: “On the average, how many cigarettes per day do you usually smoke?”
# Answers (One cigarette per day or fewer); 2-100 (Actual Number); 998 (DK)
####

table(TIAS$TA171809)

T17_CIG_FTLW <- TIAS[, c("TA171809", "FTL_COUNT")] %>% group_by(TA171809, FTL_COUNT) %>% summarise(Count = n())

T17_CIG_FTLW <- T17_CIG_FTLW[1:48, ]

T17_CIG_CAT <- TIAS2017[, c("TA171809", "CAT")] %>% group_by(TA171809, CAT) %>% summarise(Count = n())

T17_CIG_CAT <- T17_CIG_CAT[1:30, ]

ggplot(T17_CIG_FTLW, aes(x = FTL_COUNT, y = TA171809, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "Usual # of Cigarettes Per Day") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_CIG_CAT, aes(x = CAT, y = TA171809, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "Usual # of Cigarettes Per Day") + 
  guides(fill = guide_legend(title = "Category"))

### Body Mass Index (BMI) ========================================================================================================

####
# Body Mass Index - Calculated as: [( Weight in Pounds) / (Height in inches) x (Height in inches)] x 703
# Answers: 15.0-59.9 (Actual Value); 99.0 (DK/NA/refused)
####

table(TIAS$TA171978)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171978 = 99)) 

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171978 = 99)) 

T17_BMI_FTLW <- TIAS2017[, c("TA171978", "FTL_COUNT")] %>% group_by(TA171978, FTL_COUNT) %>% summarise(Count = n())

T17_BMI_FTLW <- T17_BMI_FTLW[1:356, ]

T17_BMI_CAT <- TIAS2017[, c("TA171978", "CAT_17")] %>% group_by(TA171978, CAT_17) %>% summarise(Count = n())

T17_BMI_CAT <- T17_BMI_CAT[1:342, ]

ggplot(T17_BMI_FTLW, aes(x = FTL_COUNT, y = TA171978, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "Body Mass Index (BMI)") + 
  scale_x_continuous(breaks = seq(0, 2, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves")) +
  stat_compare_means(comparisons = list(c("0", "1", "2")), label="p.format", method="anova") 

ggplot(T17_BMI_CAT, aes(x = CAT_17, y = TA171978, group = CAT_17, fill = as.factor(CAT_17))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "Body Mass Index (BMI)") + 
  guides(fill = guide_legend(title = "Category")) + 
  stat_compare_means(method = "t.test") 

### Usual Amount of Daily Sleep ==================================================================================================

####
# Number of Hours Sleep in 24-HR period: “How many hours do you usually sleep in a 24-hour period?”
# Answers: 1-24 (Actual Hours); 98 (DK); 99 (NA/refused)
#### 

table(TIAS$TA171798)

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171798 = c(98, 99)))  

TIAS2017 <- TIAS2017 %>% 
  replace_with_na(replace = list(TA171798 = c(98, 99)))  

TIAS2017_FTL <- TIAS2017_FTL %>% 
  replace_with_na(replace = list(TA171798 = c(98, 99))) 

TIAS2017_IAC <- TIAS2017_IAC %>% 
  replace_with_na(replace = list(TA171798 = c(98, 99)))  

T17_SLP_FTLW <- TIAS[, c("TA171798", "FTL_COUNT")] %>% group_by(TA171798, FTL_COUNT) %>% summarise(Count = n())

T17_SLP_FTLW <- T17_SLP_FTLW[1:42, ]

T17_SLP_CAT <- TIAS2017[, c("TA171798", "CAT")] %>% group_by(TA171798, CAT) %>% summarise(Count = n())

T17_SLP_CAT <- T17_SLP_CAT[1:27, ]

ggplot(T17_SLP_FTLW, aes(x = FTL_COUNT, y = TA171798, group = FTL_COUNT, fill = as.factor(FTL_COUNT))) +
  geom_boxplot() + 
  labs(title = "TIAS 2017", x = "# of Waves for Which Participant Identified as FTL", y = "Usual Hours of Sleep Per Night") + 
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  guides(fill = guide_legend(title = "# of FTL Waves"))

ggplot(T17_SLP_CAT, aes(x = CAT, y = TA171798, group = CAT, fill = as.factor(CAT))) +
  geom_boxplot() +
  labs(title = "TIAS 2017", x = "Category", y = "Usual Hours of Sleep Per Night") + 
  guides(fill = guide_legend(title = "Category"))

######################## TIAS PSID Individual-Level FTL Analysis ######################## 

### Relation to Head =============================================================================================================

### 
# Answers: 10 (Head in (wave year) or (wave year-2) Head who was mover-out nonresponse by the time of the wave year interview); 20 (Legal Wife in (wave year) or (wave year-2) Wife who was mover-out nonresponse by the time of the wave year interview); 
# 22 ("Wife"--female cohabitor who has lived with Head for 12 months or more; wave year-2 "Wife" who was mover-out nonresponse by the time of the wave year interview); 30 (Son or daughter of Head (includes adopted children but not stepchildren)); 
# 33 (Stepson or stepdaughter of Head (children of legal Wife [code 20] who are not children of Head)); 35 (Son or daughter of "Wife" but not Head (includes only those children of mothers whose relationship to Head is 22 but who are not children of Head)); 
# 37 (Son-in-law or daughter-in-law of Head (includes stepchildren-in-law)); 38 (Foster son or foster daughter, not legally adopted); 40 (Brother or sister of Head (includes step and half sisters and brothers)); 47 (Brother-in-law or sister-in-law of Head; 
# i.e., brother or sister of legal Wife, or spouse of Head's brother or sister); 48 (Brother or sister of Head's cohabitor (the cohabitor is coded 22 or 88)); 50 (Father or mother of Head (includes stepparents)); 57 (Father-in-law or mother-in-law of Head (includes parents of legal wives [code 20] only)); 
# 58 (Father or mother of Head's cohabitor (the cohabitor is coded 22 or 88)); 60 (Grandson or granddaughter of Head (includes grandchildren of legal Wife [code 20] only; those of a cohabitor are coded 97)); 65 (Great-grandson or great-granddaughter of Head (includes great-grandchildren of legal Wife [code 20]; those of a cohabitor are coded 97)); 
# 66 (Grandfather or grandmother of Head (includes stepgrandparents)); 67 (Grandfather or grandmother of legal Wife (code 20)); 68 (Great-grandfather or great-grandmother of Head); 69 (Great-grandfather or great-grandmother of legal Wife (code 20)); 70 (Nephew or niece of Head); 
# 71 (Nephew or niece of legal Wife (code 20)); 72 (Uncle or Aunt of Head); 73 (Uncle or Aunt of legal Wife (code 20)); 74 (Cousin of Head); 75 (Cousin of legal Wife (code 20)); 83 (Children of first-year cohabitor but not of Head (the parent of this child is coded 88)); 88 (First-year cohabitor of Head); 90 (Legal husband of Head); 
# 95 (Other relative of Head); 96 (Other relative of legal Wife (code 20)); 97 (Other relative of cohabitor (the cohabitor is code 22 or 88)); 98 (Other nonrelatives (includes homosexual partners, friends of children of the FU, etc.)); 0 (Inap.: from Latino sample (ER30001=7001-9308); from Immigrant 2017 sample (ER30001=4001-4851); main family nonresponse by wave year or mover-out nonresponse by wave year-2)
### 

RTH_FTL <- TIAS_FTL %>% dplyr::select(ER33803, ER33903, ER34003, ER34103, ER34203, ER34303, ER34503, PSID_ID)

RTH_FTL_S1 <- RTH_FTL[1:17, ]

RTH_FTL_S1_TIDY <- RTH_FTL_S1 %>% tidyr::gather(variable, rel_to_head, 1:7)

RTH_FTL_S1_TIDY$variable <- factor(RTH_FTL_S1_TIDY$variable, levels = c("ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303", "ER34503"))

RTH_FTL_S1_IDLEV <- dplyr::pull(RTH_FTL_S1, PSID_ID)

RTH_FTL_S1_TIDY$PSID_ID <- factor(RTH_FTL_S1_TIDY$PSID_ID, levels = RTH_FTL_S1_IDLEV)

RTH_FTL_S1_TIDY$rel_to_head <- factor(RTH_FTL_S1_TIDY$rel_to_head)

RTH_S1_PLOT <- ggplot(RTH_FTL_S1_TIDY, aes(x=variable, y=PSID_ID, fill=rel_to_head)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) +
  scale_fill_manual("Relation to Head", values = c("slategray3", "indianred2", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "steelblue1", "mediumpurple1"), 
  labels = c("Not included in wave", "Head (R)", "Son or daughter of R", "Stepson or stepdaughter of R", "Son or daughter of 'spouse' but not R", "Brother or sister of R", "Brother-in-law or sister-in-law of R", "Grandson or granddaughter of R")) 

RTH_FTL_S2 <- RTH_FTL[18:34, ]

RTH_FTL_S2_TIDY <- RTH_FTL_S2 %>% tidyr::gather(variable, rel_to_head, 1:7)

RTH_FTL_S2_TIDY$variable <- factor(RTH_FTL_S2_TIDY$variable, levels = c("ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303", "ER34503"))

RTH_FTL_S2_IDLEV <- dplyr::pull(RTH_FTL_S2, PSID_ID)

RTH_FTL_S2_TIDY$PSID_ID <- factor(RTH_FTL_S2_TIDY$PSID_ID, levels = RTH_FTL_S2_IDLEV)

RTH_FTL_S2_TIDY$rel_to_head <- factor(RTH_FTL_S2_TIDY$rel_to_head)

RTH_S2_PLOT <- ggplot(RTH_FTL_S2_TIDY, aes(x=variable, y=PSID_ID, fill=rel_to_head)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Relation to Head", values = c("slategray3","indianred2", "darkorange", "khaki1", "lightgreen", "mediumpurple1", "lightgoldenrod1"), 
  labels = c("Not included in wave", "Head (R)", "Son or daughter of R", "Stepson or stepdaughter of R", "Son or daughter of 'spouse' but not R","Grandson or granddaughter of R", "Nephew or niece of R")) 

RTH_FTL_S3 <- RTH_FTL[35:51, ]

RTH_FTL_S3_TIDY <- RTH_FTL_S3 %>% tidyr::gather(variable, rel_to_head, 1:7)

RTH_FTL_S3_TIDY$variable <- factor(RTH_FTL_S3_TIDY$variable, levels = c("ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303", "ER34503"))

RTH_FTL_S3_IDLEV <- dplyr::pull(RTH_FTL_S3, PSID_ID)

RTH_FTL_S3_TIDY$PSID_ID <- factor(RTH_FTL_S3_TIDY$PSID_ID, levels = RTH_FTL_S3_IDLEV)

RTH_FTL_S3_TIDY$rel_to_head <- factor(RTH_FTL_S3_TIDY$rel_to_head)

RTH_S3_PLOT <- ggplot(RTH_FTL_S3_TIDY, aes(x=variable, y=PSID_ID, fill=rel_to_head)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Relation to Head", values = c("slategray3", "indianred2", "darkorange", "khaki1", "mediumturquoise", "mediumpurple1", "lightgoldenrod1"), 
  labels = c("Not included in wave", "Head (R)", "Son or daughter of R", "Stepson or stepdaughter of R", "Brother or sister of R","Grandson or granddaughter of R", "Nephew or niece of R"))  

RTH_FTL_S4 <- RTH_FTL[52:68, ]

RTH_FTL_S4_TIDY <- RTH_FTL_S4 %>% tidyr::gather(variable, rel_to_head, 1:7)

RTH_FTL_S4_TIDY$variable <- factor(RTH_FTL_S4_TIDY$variable, levels = c("ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303", "ER34503"))

RTH_FTL_S4_IDLEV <- dplyr::pull(RTH_FTL_S4, PSID_ID)

RTH_FTL_S4_TIDY$PSID_ID <- factor(RTH_FTL_S4_TIDY$PSID_ID, levels = RTH_FTL_S4_IDLEV)

RTH_FTL_S4_TIDY$rel_to_head <- factor(RTH_FTL_S4_TIDY$rel_to_head)

RTH_S4_PLOT <- ggplot(RTH_FTL_S4_TIDY, aes(x=variable, y=PSID_ID, fill=rel_to_head)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Relation to Head", values = c("slategray3", "indianred2", "darkorange", "khaki1", "mediumturquoise", "mediumpurple1"),
  labels = c("Not included in wave", "Head (R)", "Son or daughter of R", "Stepson or stepdaughter of R", "Brother or sister of R","Grandson or granddaughter of R"))  

RTH_FTL_S5 <- RTH_FTL[69:85, ]

RTH_FTL_S5_TIDY <- RTH_FTL_S5 %>% tidyr::gather(variable, rel_to_head, 1:7)

RTH_FTL_S5_TIDY$variable <- factor(RTH_FTL_S5_TIDY$variable, levels = c("ER33803", "ER33903", "ER34003", "ER34103", "ER34203", "ER34303", "ER34503"))

RTH_FTL_S5_IDLEV <- dplyr::pull(RTH_FTL_S5, PSID_ID)

RTH_FTL_S5_TIDY$PSID_ID <- factor(RTH_FTL_S5_TIDY$PSID_ID, levels = RTH_FTL_S5_IDLEV)

RTH_FTL_S5_TIDY$rel_to_head <- factor(RTH_FTL_S5_TIDY$rel_to_head)

RTH_S5_PLOT <- ggplot(RTH_FTL_S5_TIDY, aes(x=variable, y=PSID_ID, fill=rel_to_head)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) + 
  scale_fill_manual("Relation to Head", values = c("slategray3", "indianred2", "darkorange", "khaki1", "lightgreen", "mediumturquoise", "mediumpurple1", "lightpink"),
  labels = c("Not included in wave", "Head (R)", "Son or daughter of R", "Stepson or stepdaughter of R", "Son or daughter of 'spouse' but not R", "Brother or sister of R","Grandson or granddaughter of R", "Nephew or niece of legal spouse"))  

ggarrange(RTH_S1_PLOT, RTH_S2_PLOT, RTH_S3_PLOT, RTH_S4_PLOT, RTH_S5_PLOT, ncol = 5, nrow = 1)

### Marital Status ===============================================================================================================

MAR_FTL <- TIAS_FTL %>% dplyr::select(TA050069, TA070069, TA090078, TA110079, TA130078, TA150070, TA170093, PSID_ID)

MAR_FTL_S1 <- MAR_FTL[1:17, ]

MAR_FTL_S1_TIDY <- MAR_FTL_S1 %>% tidyr::gather(variable, marital_status, 1:7)

MAR_FTL_S1_TIDY$variable <- factor(MAR_FTL_S1_TIDY$variable, levels = c("TA050069", "TA070069", "TA090078", "TA110079", "TA130078", "TA150070", "TA170093"))

MAR_FTL_S1_IDLEV <- dplyr::pull(MAR_FTL_S1, PSID_ID)

MAR_FTL_S1_TIDY$PSID_ID <- factor(MAR_FTL_S1_TIDY$PSID_ID, levels = MAR_FTL_S1_IDLEV)

MAR_FTL_S1_TIDY$marital_status <- factor(MAR_FTL_S1_TIDY$marital_status)

MAR_S1_PLOT <- ggplot(MAR_FTL_S1_TIDY, aes(x=variable, y=PSID_ID, fill=marital_status)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) 
MAR_FTL <- TIAS_FTL %>% dplyr::select(TA050069, TA070069, TA090078, TA110079, TA130078, TA150070, TA170093, PSID_ID)

MAR_FTL_S2 <- MAR_FTL[1:17, ]

MAR_FTL_S1_TIDY <- MAR_FTL_S1 %>% tidyr::gather(variable, marital_status, 1:7)

MAR_FTL_S1_TIDY$variable <- factor(MAR_FTL_S1_TIDY$variable, levels = c("TA050069", "TA070069", "TA090078", "TA110079", "TA130078", "TA150070", "TA170093"))

MAR_FTL_S1_IDLEV <- dplyr::pull(MAR_FTL_S1, PSID_ID)

MAR_FTL_S1_TIDY$PSID_ID <- factor(MAR_FTL_S1_TIDY$PSID_ID, levels = MAR_FTL_S1_IDLEV)

MAR_FTL_S1_TIDY$marital_status <- factor(MAR_FTL_S1_TIDY$marital_status)

MAR_S1_PLOT <- ggplot(MAR_FTL_S1_TIDY, aes(x=variable, y=PSID_ID, fill=marital_status)) + geom_tile(color="white", size=0.5) +
  coord_equal() +
  labs(x="Wave (2005 >> 2017)", y="ID") +
  theme_tufte(base_family="Helvetica") +
  theme(axis.ticks=element_blank()) + 
  theme(axis.text.x=element_text(angle = 45, hjust = 1)) 

### Sex of Individual =============================================================================================================

table(TIAS$ER32000)

TIAS_SEX_FTLW <- TIAS[, c("ER32000", "FTL_COUNT")] %>% group_by(ER32000, FTL_COUNT) %>% summarise(Count = n())

TIAS_SEX_CAT <- TIAS[, c("ER32000", "GREQ1_FTL")] %>% group_by(ER32000, GREQ1_FTL) %>% summarise(Count = n())

TIAS_SEX_FTLCAT <- TIAS_FTL[, c("ER32000", "GREQ1_FTL")] %>% group_by(ER32000, GREQ1_FTL) %>% summarise(Count = n())

TIAS_SEX_IACCAT <- TIAS_IAC[, c("ER32000", "GREQ1_FTL")] %>% group_by(ER32000, GREQ1_FTL) %>% summarise(Count = n())

ggplot(TIAS_SEX_FTLW, aes(x = FTL_COUNT, y = Count, fill = as.factor(ER32000)), xlab="Category") +
  geom_bar(stat="identity", width=1, position = "dodge") +
  scale_x_continuous(breaks = seq(0, 5, by = 1)) + 
  labs(title = "TIAS", x = "# of FTL Waves", y = "Count") + 
  scale_fill_manual("Sex", values =  c("turquoise", "mediumpurple1"))

ggplot(TIAS_SEX_CAT, aes(x = GREQ1_FTL, y = Count, fill = as.factor(ER32000))) + 
  geom_bar(stat="identity", width=1, position = "dodge") + 
  labs(title = "TIAS", x = "WTR FTL", y = "Count") + 
  scale_fill_manual("Sex", values =  c("turquoise", "mediumpurple1"), labels = c("Male", "Female"))

prop.table(table(TIAS_FTL$ER32000))

sex.pie.ftl.tias <- ggplot(data = TIAS_SEX_FTLCAT, aes(x = " ", y = Count, fill = as.factor(ER32000))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Sex", values =  c("turquoise", "mediumpurple1"), labels = c("Male", "Female"))

prop.table(table(TIAS_IAC$ER32000))

sex.pie.iac.tias <- ggplot(data = TIAS_SEX_IACCAT, aes(x = " ", y = Count, fill = as.factor(ER32000))) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start=0) + 
  theme_void() + 
  scale_fill_manual("Sex", values =  c("turquoise", "mediumpurple1"), labels = c("Male", "Female"))

ggarrange(sex.pie.ftl.tias, sex.pie.iac.tias, ncol = 2, nrow = 1, labels = c("FTL", "IAC"))

### Age of Individual (2005) =============================================================================================================

table(TIAS2005$ER33804)

table(TIAS2005_FTL$ER33804)

### Age of Individual (2007) =============================================================================================================

table(TIAS2007$ER33904)

table(TIAS2007_FTL$ER33904)

### Age of Individual (2009) =============================================================================================================

table(TIAS2009$ER34004)

table(TIAS2009_FTL$ER34004)

### Age of Individual (2011) =============================================================================================================

table(TIAS2011$ER34104)

table(TIAS2011_FTL$ER34104)

### Age of Individual (2013) =============================================================================================================

table(TIAS2013$ER34204)

table(TIAS2013_FTL$ER34204)

### Age of Individual (2015) =============================================================================================================

table(TIAS2015$ER34305)

table(TIAS2015_FTL$ER34305)

### Age of Individual (2017) =============================================================================================================

table(TIAS2017$ER34504)

table(TIAS2017_FTL$ER34504)

############################ TIAS-D Analysis ############################

##### =================== Amphetamine Usage =================== 

# =================== 2005 ===================  

table(TIAS$TA050784)  

amp_05 <- dplyr::select(TIAS, TA050784, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_05 <- na.omit(amp_05) # removing rows with NA 

amp_05 <- amp_05 %>% dplyr::rename(AMP = TA050784, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_05$AMP <- as.numeric(revalue(as.character(amp_05$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "5" = "1", "6" = "1")))

amp_05 <- amp_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_05$Sex <- as.integer(amp_05$Sex) # character to integer

amp_05 <- amp_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_05$FTL <- as.integer(amp_05$FTL) # character to integer

amp_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

table(TIAS$TA070755)  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070755 = 8))  

amp_07 <- dplyr::select(TIAS, TA070755, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_07 <- na.omit(amp_07) # removing rows with NA 

amp_07 <- amp_07 %>% dplyr::rename(AMP = TA070755, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_07$AMP <- as.numeric(revalue(as.character(amp_07$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "4" = "1")))

amp_07 <- amp_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_07$Sex <- as.integer(amp_07$Sex) # character to integer

class(amp_07$Sex) # confirming variable type 

amp_07 <- amp_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_07$FTL <- as.integer(amp_07$FTL) # character to integer

amp_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

table(TIAS$TA090814) 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090814 = 9))  

amp_09 <- dplyr::select(TIAS, TA090814, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_09 <- na.omit(amp_09) # removing rows with NA 

amp_09 <- amp_09 %>% dplyr::rename(AMP = TA090814, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_09$AMP <- as.numeric(revalue(as.character(amp_09$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "6" = "1")))

amp_09 <- amp_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_09$Sex <- as.integer(amp_09$Sex) # character to integer

class(amp_09$Sex) # confirming variable type 

amp_09 <- amp_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_09$FTL <- as.integer(amp_09$FTL) # character to integer

amp_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

table(TIAS$TA110930)  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110930 = 9))

amp_11 <- dplyr::select(TIAS, TA110930, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_11 <- na.omit(amp_11) # removing rows with NA 

amp_11 <- amp_11 %>% dplyr::rename(AMP = TA110930, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_11$AMP <- as.numeric(revalue(as.character(amp_11$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "4" = "1", "6" = "1")))

amp_11 <- amp_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_11$Sex <- as.integer(amp_11$Sex) # character to integer

class(amp_11$Sex) # confirming variable type 

amp_11 <- amp_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_11$FTL <- as.integer(amp_11$FTL) # character to integer

amp_11$Year <- c(rep(4, 1906)) # adding year 

# =================== 2013 =================== 

table(TIAS$TA130963)  

amp_13 <- dplyr::select(TIAS, TA130963, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_13 <- na.omit(amp_13) # removing rows with NA 

amp_13 <- amp_13 %>% dplyr::rename(AMP = TA130963, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_13$AMP <- as.numeric(revalue(as.character(amp_13$AMP), c("0" = "0", "1" = "1", "3" = "1", "4" = "1", "6" = "1")))

amp_13 <- amp_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_13$Sex <- as.integer(amp_13$Sex) # character to integer

class(amp_13$Sex) # confirming variable type 

amp_13 <- amp_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_13$FTL <- as.integer(amp_13$FTL) # character to integer

amp_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

table(TIAS$TA150985)  

amp_15 <- dplyr::select(TIAS, TA150985, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_15 <- na.omit(amp_15) # removing rows with NA 

amp_15 <- amp_15 %>% dplyr::rename(AMP = TA150985, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_15$AMP <- as.numeric(revalue(as.character(amp_15$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "4" = "1", "6" = "1")))

amp_15 <- amp_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_15$Sex <- as.integer(amp_15$Sex) # character to integer

class(amp_15$Sex) # confirming variable type 

amp_15 <- amp_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_15$FTL <- as.integer(amp_15$FTL) # character to integer

amp_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

table(TIAS$TA171868)  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171868 = 9))

amp_17 <- dplyr::select(TIAS, TA171868, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

amp_17 <- na.omit(amp_17) # removing rows with NA 

amp_17 <- amp_17 %>% dplyr::rename(AMP = TA171868, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

amp_17$AMP <- as.numeric(revalue(as.character(amp_17$AMP), c("0" = "0", "1" = "1", "2" = "1", "3" = "1", "4" = "1", "5" = "1", "6" = "1")))

amp_17 <- amp_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

amp_17$Sex <- as.integer(amp_17$Sex) # character to integer

class(amp_17$Sex) # confirming variable type 

amp_17 <- amp_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

amp_17$FTL <- as.integer(amp_17$FTL) # character to integer

amp_17$Year <- c(rep(7, 2525)) # adding year 

# =================== Analysis =================== 

amp_df <- rbind(amp_05, amp_07, amp_09, amp_11, amp_13, amp_15, amp_17)

table(amp_df$AMP)

amp_df$AMP <- as.factor(amp_df$AMP)

# ordinal logistic regression 

tab_model(glm(AMP ~ FTL + Age + Sex + Year, data = amp_df, family = binomial(link = "logit")))

##### =================== Barbiturate Usage =================== 

# =================== 2005 ===================  

table(TIAS$TA050808)  

brb_05 <- dplyr::select(TIAS, TA050808, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_05 <- na.omit(brb_05) # removing rows with NA 

brb_05 <- brb_05 %>% rename(BRB = TA050808, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_05 <- brb_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_05$Sex <- as.integer(brb_05$Sex) # character to integer

brb_05 <- brb_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_05$FTL <- as.integer(brb_05$FTL) # character to integer

brb_05$Year <- c(rep(1, 745)) # adding year 

# =================== 2007 ===================  

table(TIAS$TA070776)  

brb_07 <- dplyr::select(TIAS, TA070776, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_07 <- na.omit(brb_07) # removing rows with NA 

brb_07 <- brb_07 %>% rename(BRB = TA070776, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_07 <- brb_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_07$Sex <- as.integer(brb_07$Sex) # character to integer

brb_07 <- brb_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_07$FTL <- as.integer(brb_07$FTL) # character to integer

brb_07$Year <- c(rep(2, 1115)) # adding year 

# =================== 2009 =================== 

table(TIAS$TA090835) 

brb_09 <- dplyr::select(TIAS, TA090835, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_09 <- na.omit(brb_09) # removing rows with NA 

brb_09 <- brb_09 %>% rename(BRB = TA090835, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_09 <- brb_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_09$Sex <- as.integer(brb_09$Sex) # character to integer

brb_09 <- brb_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_09$FTL <- as.integer(brb_09$FTL) # character to integer

brb_09$Year <- c(rep(3, 1554)) # adding year 

# =================== 2011 =================== 

table(TIAS$TA110951)  

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA110951 = 9))

brb_11 <- dplyr::select(TIAS, TA110951, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_11 <- na.omit(brb_11) # removing rows with NA 

brb_11 <- brb_11 %>% rename(BRB = TA110951, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_11 <- brb_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_11$Sex <- as.integer(brb_11$Sex) # character to integer

brb_11 <- brb_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_11$FTL <- as.integer(brb_11$FTL) # character to integer

brb_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

table(TIAS$TA130984)  

brb_13 <- dplyr::select(TIAS, TA130984, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_13 <- na.omit(brb_13) # removing rows with NA 

brb_13 <- brb_13 %>% rename(BRB = TA130984, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_13 <- brb_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_13$Sex <- as.integer(brb_13$Sex) # character to integer

brb_13 <- brb_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_13$FTL <- as.integer(brb_13$FTL) # character to integer

brb_13$Year <- c(rep(5, 1804)) # adding year 

# =================== 2015 =================== 

table(TIAS$TA151006)  

brb_15 <- dplyr::select(TIAS, TA151006, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_15 <- na.omit(brb_15) # removing rows with NA 

brb_15 <- brb_15 %>% rename(BRB = TA151006, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_15 <- brb_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_15$Sex <- as.integer(brb_15$Sex) # character to integer

brb_15 <- brb_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_15$FTL <- as.integer(brb_15$FTL) # character to integer

brb_15$Year <- c(rep(6, 1641)) # adding year 

# =================== 2017 =================== 

table(TIAS$TA171868)  

brb_17 <- dplyr::select(TIAS, TA171868, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

brb_17 <- na.omit(brb_17) # removing rows with NA 

brb_17 <- brb_17 %>% rename(BRB = TA171868, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

brb_17 <- brb_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

brb_17$Sex <- as.integer(brb_17$Sex) # character to integer

brb_17 <- brb_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

brb_17$FTL <- as.integer(brb_17$FTL) # character to integer

brb_17$Year <- c(rep(7, 2525)) # adding year 

# =================== Analysis =================== 

brb_df <- rbind(brb_05, brb_07, brb_09, brb_11, brb_13, brb_15, brb_17)

table(brb_df$BRB)

brb_df$BRB <- as.factor(brb_df$BRB) 

# ordinal logistic regression 

tab_model(multinom(BRB ~ ., data = brb_df)) 

### =================== Non-Specific Psychological Distress =================== 

# =================== 2005 ===================  

table(TIAS$TA050938) # viewing NPD data for 2005

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA050938 = 99)) # removing NA value for NPD scale 

npd_05 <- dplyr::select(TIAS, TA050938, ER33804, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_05 <- na.omit(npd_05) # removing rows with NA 

npd_05 <- npd_05 %>% rename(NPD = TA050938, Age = ER33804, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_05 <- npd_05 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 
                          
npd_05$Sex <- as.integer(npd_05$Sex) # character to integer

class(npd_05$Sex) # confirming variable type 

npd_05 <- npd_05 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_05$FTL <- as.integer(npd_05$FTL) # character to integer

npd_05$Year <- c(rep(1, 743)) # adding year 

# =================== 2007 ===================  

table(TIAS$TA070919) # viewing NPD data for 2007

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA070919 = 99)) # removing NA value for NPD scale 

npd_07 <- dplyr::select(TIAS, TA070919, ER33904, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_07 <- na.omit(npd_07) # removing rows with NA 

npd_07 <- npd_07 %>% rename(NPD = TA070919, Age = ER33904, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_07 <- npd_07 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_07$Sex <- as.integer(npd_07$Sex) # character to integer

class(npd_07$Sex) # confirming variable type 

npd_07 <- npd_07 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_07$FTL <- as.integer(npd_07$FTL) # character to integer

npd_07$Year <- c(rep(2, 1114)) # adding year 

# =================== 2009 =================== 

table(TIAS$TA090983) # viewing NPD data for 2009

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA090983 = 99)) # removing NA value for NPD scale 

npd_09 <- dplyr::select(TIAS, TA090983, ER34004, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_09 <- na.omit(npd_09) # removing rows with NA 

npd_09 <- npd_09 %>% rename(NPD = TA090983, Age = ER34004, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_09 <- npd_09 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_09$Sex <- as.integer(npd_09$Sex) # character to integer

class(npd_09$Sex) # confirming variable type 

npd_09 <- npd_09 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_09$FTL <- as.integer(npd_09$FTL) # character to integer

npd_09$Year <- c(rep(3, 1553)) # adding year 

# =================== 2011 =================== 

table(TIAS$TA111125) # viewing NPD data for 2011, no NAs present

npd_11 <- dplyr::select(TIAS, TA111125, ER34104, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_11 <- na.omit(npd_11) # removing rows with NA 

npd_11 <- npd_11 %>% rename(NPD = TA111125, Age = ER34104, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_11 <- npd_11 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_11$Sex <- as.integer(npd_11$Sex) # character to integer

class(npd_11$Sex) # confirming variable type 

npd_11 <- npd_11 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_11$FTL <- as.integer(npd_11$FTL) # character to integer

npd_11$Year <- c(rep(4, 1907)) # adding year 

# =================== 2013 =================== 

table(TIAS$TA131217) # viewing NPD data for 2013

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA131217 = 99)) # removing NA value for NPD scale 

npd_13 <- dplyr::select(TIAS, TA131217, ER34204, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_13 <- na.omit(npd_13) # removing rows with NA 

npd_13 <- npd_13 %>% rename(NPD = TA131217, Age = ER34204, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_13 <- npd_13 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_13$Sex <- as.integer(npd_13$Sex) # character to integer

class(npd_13$Sex) # confirming variable type 

npd_13 <- npd_13 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_13$FTL <- as.integer(npd_13$FTL) # character to integer

npd_13$Year <- c(rep(5, 1802)) # adding year 

# =================== 2015 =================== 

table(TIAS$TA151277) # viewing NPD data for 2015 

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA151277 = 99)) # removing NA value for NPD scale 

npd_15 <- dplyr::select(TIAS, TA151277, ER34305, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_15 <- na.omit(npd_15) # removing rows with NA 

npd_15 <- npd_15 %>% rename(NPD = TA151277, Age = ER34305, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_15 <- npd_15 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_15$Sex <- as.integer(npd_15$Sex) # character to integer

class(npd_15$Sex) # confirming variable type 

npd_15 <- npd_15 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_15$FTL <- as.integer(npd_15$FTL) # character to integer

npd_15$Year <- c(rep(6, 1636)) # adding year 

# =================== 2017 =================== 

table(TIAS$TA171975) # viewing NPD data for 2017

TIAS <- TIAS %>% 
  replace_with_na(replace = list(TA171975 = 99)) # removing NA value for NPD scale 

npd_17 <- dplyr::select(TIAS, TA171975, ER34504, ER32000, GREQ1_FTL, PSID_ID) # extracting columns from TIAS

npd_17 <- na.omit(npd_17) # removing rows with NA 

npd_17 <- npd_17 %>% rename(NPD = TA171975, Age = ER34504, Sex = ER32000, FTL = GREQ1_FTL) # renaming columns

npd_17 <- npd_17 %>% mutate(Sex = dplyr::recode(Sex, `2` = "1", `1` = "0")) # recoding values 

npd_17$Sex <- as.integer(npd_17$Sex) # character to integer

class(npd_17$Sex) # confirming variable type 

npd_17 <- npd_17 %>% mutate(FTL = dplyr::recode(FTL, "FTL" = "1", "IAC" = "0")) # recoding values

npd_17$FTL <- as.integer(npd_17$FTL) # character to integer

npd_17$Year <- c(rep(7, 2512)) # adding year 

# =================== Analysis =================== 

npd_df <- rbind(npd_05, npd_07, npd_09, npd_11, npd_13, npd_15, npd_17)

# multiple linear regression

tab_model(lm(NPD ~ FTL + Age + Sex + Year, data = npd_df))  


